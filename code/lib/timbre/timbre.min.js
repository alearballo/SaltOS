(function(i){var h=Array.prototype.slice,g=Array.isArray,j=function(a){return"object"===typeof a&&a.constructor===Object},d=0,b=0,e=1,c=null,a={},f={},k="undefined"!==typeof module&&module.exports?"node":"undefined"!==typeof window?"browser":"unknown",n;n="browser"===k&&/(iPhone|iPad|iPod|Android)/i.test(navigator.userAgent)?!0:!1;var l=!1,m={},o=function(){var c=h.call(arguments),b=c[0],e;switch(typeof b){case "string":a[b]?e=new a[b](c.slice(1)):f[b]?e=f[b](c.slice(1)):console.warn('T("'+b+'") is not defined.');
break;case "number":e=new C(c);break;case "boolean":e=new E(c);break;case "function":e=new F(c);break;case "object":if(null!==b){if(b instanceof y)return b;if(b.context instanceof y)return b.context;b.constructor===Object?e=new G(c):g(b)&&(e=new H(c))}}e===i?(e=new C([0]),e._.isUndefined=!0):e._.isUndefined=!1;e._.originkey=b;for(var c=e._,b=e._.meta,k,l,d=e;null!==d&&d.constructor!==Object;){k=Object.getOwnPropertyNames(d);for(var n=0,m=k.length;n<m;++n)if(!b[k[n]])if(/^(constructor$|process$|_)/.test(k[n]))b[k[n]]=
"ignore";else if(l=Object.getOwnPropertyDescriptor(d,k[n]),"function"===typeof l.value)b[k[n]]="function";else if(l.get||l.set)b[k[n]]="property";d=Object.getPrototypeOf(d)}c.meta=b;e._.emit("init");return e},s=function(){return o.apply(null,arguments)},p=s.fn={},q=s.modules={};p.SignalArray=Float32Array;p.currentTimeIncr=0;p.emptycell=null;p.FINISHED_STATE=b;p.PLAYING_STATE=e;p.UNSCHEDULED_STATE=2;p.SCHEDULED_STATE=3;(function(){var a={};q.ready=function(f,c){a[f]=c};q.ready.done=function(f,c){var b=
a[f];b&&b(c);delete a[f]}})();Object.defineProperties(s,{version:{get:function(){return"WORKING"}},envtype:{get:function(){return k}},envmobile:{get:function(){return n}},env:{get:function(){return c.impl.env}},samplerate:{get:function(){return c.samplerate}},channels:{get:function(){return c.channels}},cellsize:{get:function(){return c.cellsize}},currentTime:{get:function(){return c.currentTime}},isPlaying:{get:function(){return 1===c.status}},isRecording:{get:function(){return 2===c.status}},amp:{set:function(a){"number"===
typeof a&&(c.amp=a)},get:function(){return c.amp}}});s.bind=function(a,f){c.bind(a,f);return s};s.setup=function(a){c.setup(a);return s};s.play=function(){c.play();return s};s.pause=function(){c.pause();return s};s.reset=function(){c.reset();c.events.emit("reset");return s};s.on=function(a,f){c.on(a,f);return s};s.addListener=s.on;s.once=function(a,f){c.once(a,f);return s};s.off=function(a,f){c.removeListener(a,f);return s};s.removeListener=s.off;s.removeAllListeners=function(a){c.removeAllListeners(a);
return s};s.listeners=function(a){return c.listeners(a)};s.rec=function(){return c.rec.apply(c,arguments)};s.use=function(a){g(m[a])&&m[a].forEach(function(a){a()});return this};s.timevalue=function(a){var f;if(f=/^(\d+(?:\.\d+)?)Hz$/i.exec(a))return 0===+f[1]?0:1E3/+f[1];if(f=/^bpm(\d+(?:\.\d+)?)?\s*(?:l(\d+))?(\.*)$/i.exec(a)){a=f[1];if(a===i)a=120;else if(a=+f[1],5>a||300<a)a=120;var c=f[2]?f[2]|0:4;return 0===a||0===c?0:f=1E3*(60/a*(4/c))*([1,1.5,1.75,1.875][(f[3]||"").length]||1)}if(f=/^bpm(\d+(?:\.\d+)?)?\s*(\d+)\.(\d+)\.(\d+)$/i.exec(a)){a=
f[1];if(a===i)a=120;else if(a=+f[1],5>a||300<a)a=120;f=1920*(f[2]|0)+480*(f[3]|0)+(f[4]|0);return 1E3*60/a*(f/480)}if(f=/^(\d+(?:\.\d+)?)secs?$/i.exec(a))return 1E3*+f[1];if(f=/^(\d+(?:\.\d+)?)mins?$/i.exec(a))return 6E4*+f[1];if(f=/^(?:([0-5]?[0-9]):)?(?:([0-5]?[0-9]):)(?:([0-5]?[0-9]))(?:\.([0-9]{1,3}))?$/.exec(a))return a=3600*(f[1]|0)+60*(f[2]|0)+(f[3]|0),a=1E3*a+(((f[4]||"")+"00").substr(0,3)|0);if(f=/^bpm(\d+(?:\.\d+)?)?\s*(?:(\d+)ticks)?$/i.exec(a)){a=f[1];if(a===i)a=120;else if(a=+f[1],5>
a||300<a)a=120;f=f[2]?f[2]|0:480;return 0===a?0:1E3*60/a*(f/480)}return(f=/^(\d+)samples(?:\/(\d+)Hz)?$/i.exec(a))?(a=f[2]?f[2]|0:s.samplerate,0===a?0:1E3*((f[1]|0)/a)):(f=/^(\d+)(?:ms)?$/i.exec(a))?f[1]|0:0};p.use=function(a,f){g(m[a])?m[a].push(f):m[a]=[f]};p.isDictionary=j;var r=function(){return this};p.nop=r;p.isSignalArray=function(a){return a instanceof Float32Array||a instanceof Float64Array||Array.isArray(a)&&a.__klass&&2===a.__klass.type?!0:!1};var t=function(a,f){function c(){this.constructor=
a}var f=f||y,b;for(b in f)f.hasOwnProperty(b)&&(a[b]=f[b]);c.prototype=f.prototype;a.prototype=new c;a.__super__=f.prototype;return a};p.extend=t;var v=function(a,f){for(var c=a&&a.prototype;c;){if(c===f.prototype)return!0;c=Object.getPrototypeOf(c)}return!1};p.constructorof=v;p.register=function(c,b){v(b,y)?a[c]=b:f[c]=b};p.alias=function(c,b){a[b]?a[c]=a[b]:f[b]&&(f[c]=f[b])};p.getClass=function(f){return a[f]};p.nextTick=function(a){c.nextTick(a);return s};var x=function(a){a._.ar=!0;a._.aronly=
!0};p.fixAR=x;var u=function(a){a._.ar=!1;a._.kronly=!0};p.fixKR=u;var w=function(){var a=this._,a=a.value*a.mul+a.add;isNaN(a)&&(a=0);for(var f=this.cells[0],c=0,b=f.length;c<b;++c)f[c]=a};Object.defineProperty(w,"unremovable",{value:!0,writable:!1});p.changeWithValue=w;var z=function(){var a=function(a){return function(){-1===c.timers.indexOf(a)&&(c.timers.push(a),c.events.emit("addObject"),a._.emit("start"))}},f=function(a){return function(){var f=c.timers.indexOf(a);-1!==f&&(c.timers.splice(f,
1),a._.emit("stop"),c.events.emit("removeObject"))}};return function(b){var e=a(b),k=f(b);b.start=function(){c.nextTick(e);return b};b.stop=function(){c.nextTick(k);return b};return b}}();p.timer=z;z=function(){var a=function(a){return function(){-1===c.listeners.indexOf(a)&&(c.listeners.push(a),c.events.emit("addObject"),a._.emit("listen"))}},f=function(a){return function(){var f=c.listeners.indexOf(a);-1!==f&&(c.listeners.splice(f,1),a._.emit("unlisten"),c.events.emit("removeObject"))}};return function(b){var e=
a(b),k=f(b);b.listen=function(){arguments.length&&b.append.apply(b,arguments);b.nodes.length&&c.nextTick(e);return b};b.unlisten=function(){arguments.length&&b.remove.apply(b,arguments);b.nodes.length||c.nextTick(k);return b};return b}}();p.listener=z;p.make_onended=function(a,f){return function(){a.playbackState=b;if("number"===typeof f)for(var c=a.cells[0],e=a.cells[1],k=a.cells[2],l=0,d=e.length;l<d;++l)c[0]=e[l]=k[l]=f;a._.emit("ended")}};p.inputSignalAR=function(a){var f=a.cells[0],c=a.cells[1],
b=a.cells[2],k=a.nodes,l=k.length,d,n=f.length,m=a.tickID,g,o;if(2===a.numChannels){g=!0;if(0!==l){for(a=0;a<l;++a)if(k[a].playbackState===e){k[a].process(m);c.set(k[a].cells[1]);b.set(k[a].cells[2]);g=!1;++a;break}for(;a<l;++a)if(k[a].playbackState===e){k[a].process(m);f=k[a].cells[1];o=k[a].cells[2];for(d=n;d;)d-=8,c[d]+=f[d],b[d]+=o[d],c[d+1]+=f[d+1],b[d+1]+=o[d+1],c[d+2]+=f[d+2],b[d+2]+=o[d+2],c[d+3]+=f[d+3],b[d+3]+=o[d+3],c[d+4]+=f[d+4],b[d+4]+=o[d+4],c[d+5]+=f[d+5],b[d+5]+=o[d+5],c[d+6]+=f[d+
6],b[d+6]+=o[d+6],c[d+7]+=f[d+7],b[d+7]+=o[d+7]}}g&&(c.set(p.emptycell),b.set(p.emptycell))}else{g=!0;if(0!==l){for(a=0;a<l;++a)if(k[a].playbackState===e){k[a].process(m);f.set(k[a].cells[1]);g=!1;++a;break}for(;a<l;++a)if(k[a].playbackState===e){c=k[a].process(m).cells[0];for(d=n;d;)d-=8,f[d]+=c[d],f[d+1]+=c[d+1],f[d+2]+=c[d+2],f[d+3]+=c[d+3],f[d+4]+=c[d+4],f[d+5]+=c[d+5],f[d+6]+=c[d+6],f[d+7]+=c[d+7]}}g&&f.set(p.emptycell)}};p.inputSignalKR=function(a){for(var f=a.nodes,c=f.length,b=a.tickID,k=
0,a=0;a<c;++a)f[a].playbackState===e&&(k+=f[a].process(b).cells[0][0]);return k};p.outputSignalAR=function(a){var f=a.cells[0],c=a.cells[1],b=a.cells[2],e=a._.mul,k=a._.add;if(2===a.numChannels)for(a=f.length;a;)a-=8,c[a]=c[a]*e+k,b[a]=b[a]*e+k,c[a+1]=c[a+1]*e+k,b[a+1]=b[a+1]*e+k,c[a+2]=c[a+2]*e+k,b[a+2]=b[a+2]*e+k,c[a+3]=c[a+3]*e+k,b[a+3]=b[a+3]*e+k,c[a+4]=c[a+4]*e+k,b[a+4]=b[a+4]*e+k,c[a+5]=c[a+5]*e+k,b[a+5]=b[a+5]*e+k,c[a+6]=c[a+6]*e+k,b[a+6]=b[a+6]*e+k,c[a+7]=c[a+7]*e+k,b[a+7]=b[a+7]*e+k,f[a]=
0.5*(c[a]+b[a]),f[a+1]=0.5*(c[a+1]+b[a+1]),f[a+2]=0.5*(c[a+2]+b[a+2]),f[a+3]=0.5*(c[a+3]+b[a+3]),f[a+4]=0.5*(c[a+4]+b[a+4]),f[a+5]=0.5*(c[a+5]+b[a+5]),f[a+6]=0.5*(c[a+6]+b[a+6]),f[a+7]=0.5*(c[a+7]+b[a+7]);else if(1!==e||0!==k)for(a=f.length;a;)a-=8,f[a]=f[a]*e+k,f[a+1]=f[a+1]*e+k,f[a+2]=f[a+2]*e+k,f[a+3]=f[a+3]*e+k,f[a+4]=f[a+4]*e+k,f[a+5]=f[a+5]*e+k,f[a+6]=f[a+6]*e+k,f[a+7]=f[a+7]*e+k};p.outputSignalKR=function(a){var f=a.cells[0],c=a.cells[1],b=a.cells[2],e=f[0]*a._.mul+a._.add;if(2===a.numChannels)for(a=
f.length;a;)a-=8,f[a]=f[a+1]=f[a+2]=f[a+3]=f[a+4]=f[a+5]=f[a+6]=f[a+7]=c[a]=c[a+1]=c[a+2]=c[a+3]=c[a+4]=c[a+5]=c[a+6]=c[a+7]=b[a]=b[a+1]=b[a+2]=b[a+3]=b[a+4]=b[a+5]=b[a+6]=b[a+7]=e;else for(a=f.length;a;)a-=8,f[a]=f[a+1]=f[a+2]=f[a+3]=f[a+4]=f[a+5]=f[a+6]=f[a+7]=e};p.fix_iOS6_1_problem=function(a){c.fix_iOS6_1_problem(a)};var y=function(){function a(f,b){this._={};var k=this._.events=new q.EventEmitter(this);this._.emit=function(){return k.emit.apply(k,arguments)};if(j(b[0])){var d=b.shift();this.once("init",
function(){this.set(d)})}this.tickID=-1;this.nodes=b.map(s);this.cells=[];this.numChannels=f;switch(f){case 0:this.L=this.R=new A(null);this.cells[0]=this.cells[1]=this.cells[2]=this.L.cell;break;case 1:this.L=this.R=new A(this);this.cells[0]=this.cells[1]=this.cells[2]=this.L.cell;break;case 2:this.L=new A(this),this.R=new A(this),this.cells[0]=new p.SignalArray(c.cellsize),this.cells[1]=this.L.cell,this.cells[2]=this.R.cell}this.playbackState=e;this._.ar=!0;this._.mul=1;this._.add=0;this._.dac=
null;this._.bypassed=!1;this._.meta={};this._.samplerate=c.samplerate;this._.cellsize=c.cellsize}var f=a.prototype;Object.defineProperties(f,{isUndefined:{get:function(){return this._.isUndefined}},isAr:{get:function(){return this._.ar}},isKr:{get:function(){return!this._.ar}},isBypassed:{get:function(){return this._.bypassed}},isEnded:{get:function(){return!(this.playbackState&1)}},mul:{set:function(a){"number"===typeof a&&(this._.mul=a,this._.emit("setMul",a))},get:function(){return this._.mul}},
add:{set:function(a){"number"===typeof a&&(this._.add=a,this._.emit("setAdd",a))},get:function(){return this._.add}}});f.toString=function(){return this.constructor.name};f.valueOf=function(){c.tickID!==this.tickID&&this.process(c.tickID);return this.cells[0][0]};f.append=function(){if(0<arguments.length){var a=h.call(arguments).map(s);this.nodes=this.nodes.concat(a);this._.emit("append",a)}return this};f.appendTo=function(a){a.append(this);return this};f.remove=function(){if(0<arguments.length){for(var a,
f=this.nodes,c=[],b=0,e=arguments.length;b<e;++b)if(-1!==(a=f.indexOf(arguments[b])))c.push(f[a]),f.splice(a,1);0<c.length&&this._.emit("remove",c)}return this};f.removeFrom=function(a){a.remove(this);return this};f.removeAll=function(){var a=this.nodes.slice();this.nodes=[];0<a.length&&this._.emit("remove",a);return this};f.removeAtIndex=function(a){var f=this.nodes[a];f&&(this.nodes.splice(a,1),this._.emit("remove",[f]));return this};f.on=f.addListener=function(a,f){this._.events.on(a,f);return this};
f.once=function(a,f){this._.events.once(a,f);return this};f.off=f.removeListener=function(a,f){this._.events.removeListener(a,f);return this};f.removeAllListeners=function(a){this._.events.removeAllListeners(a);return this};f.listeners=function(a){return this._.events.listeners(a)};f.set=function(a,f){var c,b,e=this._.meta;switch(typeof a){case "string":switch(e[a]){case "property":this[a]=f;break;case "function":this[a](f);break;default:for(c=this;null!==c;){if(b=Object.getOwnPropertyDescriptor(c,
a))if("function"===typeof b.value)e[a]="function",this[a](f);else if(b.get||b.set)e[a]="property",this[a]=f;c=Object.getPrototypeOf(c)}}break;case "object":for(c in a)this.set(c,a[c])}return this};f.get=function(a){if("property"===this._.meta[a])return this[a]};f.bang=function(){this._.emit.apply(this,["bang"].concat(h.call(arguments)));return this};f.process=r;f.bypass=function(){this._.bypassed=0===arguments.length?!0:!!arguments[0];return this};f.play=function(){var a=this._.dac;null===a&&(a=this._.dac=
new I(this));a.playbackState===b&&(a.play(),this._.emit.apply(this,["play"].concat(h.call(arguments))));return this};f.pause=function(){var a=this._.dac;a&&a.playbackState===e&&(a.pause(),this._.dac=null,this._.emit("pause"));return this};f.start=f.stop=f.listen=f.unlisten=function(){return this};f.ar=function(){0===arguments.length||arguments[0]?this._.kronly||(this._.ar=!0,this._.emit("ar",!0)):this.kr(!0);return this};f.kr=function(){0===arguments.length||arguments[0]?this._.aronly||(this._.ar=
!1,this._.emit("ar",!1)):this.ar(!0);return this};f.plot="browser"===k?function(a){var f=this._,c=a.target;if(!c)return this;var b=a.width||c.width||320,e=a.height||c.height||240,k=(a.x||0)+0.5,d=a.y||0,c=c.getContext("2d"),l;l=a.foreground!==i?a.foreground:f.plotForeground||"rgb(  0, 128, 255)";var n;n=a.background!==i?a.background:f.plotBackground||"rgb(255, 255, 255)";var m=a.lineWidth||f.plotLineWidth||1,g=!!f.plotCyclic,o=f.plotData||this.cells[0],j=a.range||f.plotRange||[-1.2,1.2],h=j[0],j=
e/(j[1]-h),s=b/o.length,p,q=o.length;c.save();c.rect(k,d,b,e);null!==n&&(c.fillStyle=n,c.fillRect(k,d,b,e));f.plotBefore&&f.plotBefore.call(this,c,k,d,b,e);if(f.plotBarStyle){c.fillStyle=l;for(n=l=0;n<q;++n)g=(o[n]-h)*j,p=e-g,c.fillRect(l+k,p+d,s,g),l+=s}else{c.strokeStyle=l;c.lineWidth=m;c.beginPath();l=0;m=e-(o[0]-h)*j;c.moveTo(l+k,m+d);for(n=1;n<q;++n)l+=s,p=e-(o[n]-h)*j,c.lineTo(l+k,p+d);g?c.lineTo(l+s+k,m+d):c.lineTo(l+s+k,p+d);c.stroke()}f.plotAfter&&f.plotAfter.call(this,c,k,d,b,e);if(a=a.border||
f.plotBorder)c.strokeStyle="string"===typeof a?a:"#000",c.lineWidth=1,c.strokeRect(k,d,b,e);c.restore();return this}:r;return a}();s.Object=y;var A=function(){function a(f){s.Object.call(this,-1,[]);x(this);this._.parent=f;this.cell=new p.SignalArray(c.cellsize);this.L=this.R=this;this.cells[0]=this.cells[1]=this.cells[2]=this.cell;this.numChannels=1}t(a);a.prototype.process=function(a){this.tickID!==a&&(this.tickID=a,this._.parent&&this._.parent.process(a));return this};return a}();s.ChannelObject=
A;var C=function(){function a(f){y.call(this,1,[]);u(this);this.value=f[0];if(j(f[1])){var c=f[1];this.once("init",function(){this.set(c)})}this.on("setAdd",w);this.on("setMul",w)}t(a);Object.defineProperties(a.prototype,{value:{set:function(a){"number"===typeof a&&(this._.value=isNaN(a)?0:a,w.call(this))},get:function(){return this._.value}}});return a}(),E=function(){function a(f){y.call(this,1,[]);u(this);this.value=f[0];if(j(f[1])){var c=f[1];this.once("init",function(){this.set(c)})}this.on("setAdd",
w);this.on("setMul",w)}t(a);Object.defineProperties(a.prototype,{value:{set:function(a){this._.value=a?1:0;w.call(this)},get:function(){return!!this._.value}}});return a}(),F=function(){function a(f){y.call(this,1,[]);u(this);this.func=f[0];this._.value=0;if(j(f[1])){var c=f[1];this.once("init",function(){this.set(c)})}this.on("setAdd",w);this.on("setMul",w)}t(a);var f=a.prototype;Object.defineProperties(f,{func:{set:function(a){"function"===typeof a&&(this._.func=a)},get:function(){return this._.func}},
args:{set:function(a){this._.args=g(a)?a:[a]},get:function(){return this._.args}}});f.bang=function(){var a=this._,f=h.call(arguments).concat(a.args),f=a.func.apply(this,f);"number"===typeof f&&(a.value=f,w.call(this));this._.emit("bang");return this};return a}(),H=function(){function a(f){y.call(this,1,[]);u(this);if(j(f[1])){var c=f[1];this.once("init",function(){this.set(c)})}}t(a);Object.defineProperties(a.prototype,{});return a}(),G=function(){function a(f){y.call(this,1,[]);u(this);if(j(f[1])){var c=
f[1];this.once("init",function(){this.set(c)})}}t(a);Object.defineProperties(a.prototype,{});return a}(),I=function(){function a(c){y.call(this,2,[]);this.playbackState=b;var e=this._;e.node=c;e.onplay=f(this);e.onpause=k(this)}t(a);var f=function(a){return function(){-1===c.inlets.indexOf(a)&&(c.inlets.push(a),c.events.emit("addObject"),a.playbackState=e,a._.emit("play"))}},k=function(a){return function(){var f=c.inlets.indexOf(a);-1!==f&&(c.inlets.splice(f,1),a.playbackState=b,a._.emit("pause"),
c.events.emit("removeObject"))}},d=a.prototype;d.play=function(){c.nextTick(this._.onplay);return this};d.pause=function(){c.nextTick(this._.onpause);return this};d.process=function(a){var f=this._.node;f.playbackState&1?(f.process(a),this.cells[1].set(f.cells[1]),this.cells[2].set(f.cells[2])):(this.cells[1].set(p.emptycell),this.cells[2].set(p.emptycell));return this};return a}(),z=function(){function a(){this._={};this.context=this;this.tickID=0;this.impl=null;this.amp=0.8;this.status=d;this.samplerate=
44100;this.channels=2;this.cellsize=64;this.streammsec=20;this.currentTime=this.streamsize=0;this.nextTicks=[];this.inlets=[];this.timers=[];this.listeners=[];this._.deferred=null;this.recStart=0;this.recBuffers=null;this.delayProcess=f(this);p.currentTimeIncr=1E3*this.cellsize/this.samplerate;p.emptycell=new p.SignalArray(this.cellsize);var c=this;q.ready("events",function(){c.events=new q.EventEmitter(c);c.reset()})}var f=function(a){return function(){a.recStart=Date.now();a.process()}},c=[8E3,
11025,12E3,16E3,22050,24E3,32E3,44100,48E3],b=[32,64,128,256],e=a.prototype;e.bind=function(a,f){if("function"===typeof a){var c=new a(this,f);"function"===typeof c.play&&"function"===typeof c.pause&&(this.impl=c,this.impl.defaultSamplerate&&(this.samplerate=this.impl.defaultSamplerate))}return this};e.setup=function(a){if("object"===typeof a&&(-1!==c.indexOf(a.samplerate)&&(this.samplerate=a.samplerate<=this.impl.maxSamplerate?a.samplerate:this.impl.maxSamplerate),-1!==b.indexOf(a.cellsize)&&(this.cellsize=
a.cellsize),"undefined"!==typeof a.f64))l=!!a.f64,p.SignalArray=l?Float64Array:Float32Array;p.currentTimeIncr=1E3*this.cellsize/this.samplerate;p.emptycell=new p.SignalArray(this.cellsize);return this};e.getAdjustSamples=function(a){a=a||this.samplerate;a=Math.ceil(Math.log(this.streammsec/1E3*a)*Math.LOG2E);return 1<<(8>a?8:14<a?14:a)};e.play=function(){this.status===d&&(this.status=1,this.streamsize=this.getAdjustSamples(),this.strmL=new p.SignalArray(this.streamsize),this.strmR=new p.SignalArray(this.streamsize),
this.impl.play(),this.events.emit("play"));return this};e.pause=function(){1===this.status&&(this.status=d,this.impl.pause(),this.events.emit("pause"));return this};e.reset=function(a){a&&(this._.events=null);this.currentTime=0;this.nextTicks=[];this.inlets=[];this.timers=[];this.listeners=[];this.events.on("addObject",function(){this.status===d&&(this.inlets.length>0||this.timers.length>0||this.listeners.length>0)&&this.play()});this.events.on("removeObject",function(){this.status===1&&this.inlets.length===
0&&(this.timers.length===0&&this.listeners.length===0)&&this.pause()});return this};e.process=function(){var a=this.tickID,f=this.strmL,c=this.strmR,b=this.amp,e,k,d,l=this.streamsize,n=0,m,g,o,j=this.cellsize,i=this.streamsize/this.cellsize,h=this.timers,s=this.inlets,q=this.listeners,r=p.currentTimeIncr;for(d=0;d<l;++d)f[d]=c[d]=0;for(;i--;){++a;m=0;for(g=h.length;m<g;++m)h[m].playbackState&1&&h[m].process(a);m=0;for(g=s.length;m<g;++m)if(e=s[m],e.process(a),e.playbackState&1){k=e.cells[1];e=e.cells[2];
o=0;for(d=n;o<j;++o,++d)f[d]+=k[o],c[d]+=e[o]}n+=j;m=0;for(g=q.length;m<g;++m)q[m].playbackState&1&&q[m].process(a);this.currentTime+=r;d=this.nextTicks.splice(0);m=0;for(g=d.length;m<g;++m)d[m].call(null)}for(d=0;d<l;++d)e=f[d]*b,-1>e?e=-1:1<e&&(e=1),f[d]=e,e=c[d]*b,-1>e?e=-1:1<e&&(e=1),c[d]=e;this.tickID=a;a=this.currentTime;if(2===this.status){if(2===this.recCh)this.recBuffers.push(new p.SignalArray(f)),this.recBuffers.push(new p.SignalArray(c));else{b=new p.SignalArray(f.length);d=0;for(l=b.length;d<
l;++d)b[d]=0.5*(f[d]+c[d]);this.recBuffers.push(b)}a>=this.maxDuration?this._.deferred.sub.reject():a>=this.recDuration?this._.deferred.sub.resolve():20<Date.now()-this.recStart?setTimeout(this.delayProcess,10):this.process()}};e.nextTick=function(a){this.status===d?a():this.nextTicks.push(a)};e.rec=function(){p.fix_iOS6_1_problem(!0);var a=new q.Deferred(this);if(this._.deferred)return console.warn("rec deferred is exists??"),a.reject().promise();if(this.status!==d)return console.log("status is not none",
this.status),a.reject().promise();var f=0,c=arguments,b=j(c[f])?c[f++]:{},f=c[f];if("function"!==typeof f)return console.warn("no function"),a.reject().promise();this._.deferred=a;this.status=2;this.reset();var e=new o("+"),l=new q.Deferred(this),n=this;l.then(k,function(){p.fix_iOS6_1_problem(!1);k.call(n,!0)});this._.deferred.sub=l;this.savedSamplerate=this.samplerate;this.samplerate=b.samplerate||this.samplerate;this.recDuration=b.recDuration||Infinity;this.maxDuration=b.maxDuration||6E5;this.recCh=
b.ch||1;2!==this.recCh&&(this.recCh=1);this.recBuffers=[];this.streamsize=this.getAdjustSamples();this.strmL=new p.SignalArray(this.streamsize);this.strmR=new p.SignalArray(this.streamsize);this.inlets.push(e);f({done:function(){l.resolve.apply(l,h.call(arguments))},send:function(){e.append.apply(e,arguments)}});setTimeout(this.delayProcess,10);return a.promise()};var k=function(){this.status=d;this.reset();var a=this.recBuffers,f=this.samplerate,c=this.streamsize,b;this.samplerate=this.savedSamplerate;
b=Infinity!==this.recDuration?0.001*this.recDuration*f|0:(a.length>>this.recCh-1)*c;var e,k=b/c|0,l=0,n=0,m=b;if(2===this.recCh){var g=new p.SignalArray(b),o=new p.SignalArray(b),j=new p.SignalArray(b);for(e=0;e<k;++e)if(g.set(a[l++],n),o.set(a[l++],n),n+=c,m-=c,0<m&&m<c){g.set(a[l++].subarray(0,m),n);o.set(a[l++].subarray(0,m),n);break}e=0;for(k=b;e<k;++e)j[e]=0.5*(g[e]+o[e]);a={samplerate:f,channels:2,buffer:j,bufferL:g,bufferR:o}}else{b=new p.SignalArray(b);for(e=0;e<k;++e)if(b.set(a[l++],n),n+=
c,m-=c,0<m&&m<c){b.set(a[l++].subarray(0,m),n);break}a={samplerate:f,channels:1,buffer:b,bufferL:b,bufferR:b}}this._.deferred.resolve.apply(this._.deferred,[].concat.apply([a],arguments));this._.deferred=null};e.on=function(a,f){this.events.on(a,f)};e.addListener=e.on;e.once=function(a,f){this.events.once(a,f)};e.removeListener=function(a,f){this.events.removeListener(a,f)};e.removeAllListeners=function(a){this.events.removeListeners(a)};e.listeners=function(a){return this.events.listeners(a)};e.fix_iOS6_1_problem=
function(a){this.impl.fix_iOS6_1_problem&&this.impl.fix_iOS6_1_problem(a)};return a}(),D=null,D="undefined"!==typeof webkitAudioContext?function(a){var f=new webkitAudioContext,c,b;p._audioContext=f;this.defaultSamplerate=this.maxSamplerate=f.sampleRate;this.env="webkit";var e=navigator.userAgent;e.match(/linux/i)?a.streammsec*=8:e.match(/win(dows)?\s*(nt 5\.1|xp)/i)&&(a.streammsec*=4);this.play=function(){var e,k=a.getAdjustSamples(f.sampleRate),d=a.streamsize,l,n;if(a.samplerate===f.sampleRate)e=
function(f){f=f.outputBuffer;a.process();f.getChannelData(0).set(a.strmL);f.getChannelData(1).set(a.strmR)};else if(a.samplerate*2===f.sampleRate)e=function(f){var c=a.strmL,b=a.strmR,e=f.outputBuffer,f=e.getChannelData(0),k=e.getChannelData(1),d=e.length,l;a.process();for(e=l=0;e<d;e=e+2,++l){f[e]=f[e+1]=c[l];k[e]=k[e+1]=b[l]}};else{l=d;n=a.samplerate/f.sampleRate;e=function(f){for(var c=a.strmL,b=a.strmR,e=f.outputBuffer,f=e.getChannelData(0),k=e.getChannelData(1),m=e.length,e=0;e<m;++e){if(l>=
d){a.process();l=l-d}f[e]=c[l|0];k[e]=b[l|0];l=l+n}}}c=f.createBufferSource();b=f.createJavaScriptNode(k,2,a.channels);b.onaudioprocess=e;c.noteOn(0);c.connect(b);b.connect(f.destination)};this.pause=function(){c.disconnect();b.disconnect()};if(n){var k=0,d=f.createBufferSource();this.fix_iOS6_1_problem=function(a){k=k+(a?1:-1);if(k===1){d.noteOn(0);d.connect(f.destination)}else k===0&&d.disconnect()}}}:"function"===typeof Audio&&"function"===typeof(new Audio).mozSetup?function(a){var f=function(){var a=
new Blob(["var t=0;onmessage=function(e){if(t)t=clearInterval(t),0;if(typeof e.data=='number'&&e.data>0)t=setInterval(function(){postMessage(0);},e.data);};"],{type:"text/javascript"}),a=URL.createObjectURL(a);return new Worker(a)}();this.maxSamplerate=48E3;this.defaultSamplerate=44100;this.env="moz";this.play=function(){var c=new Audio,b=new Float32Array(a.streamsize*a.channels),e=a.streammsec,k=0,d=1E3*(a.streamsize/a.samplerate),l=Date.now();c.mozSetup(a.channels,a.samplerate);f.onmessage=function(){if(!(k>
Date.now()-l)){var f=a.strmL,e=a.strmR,n=b.length,m=f.length;for(a.process();m--;)b[--n]=e[m],b[--n]=f[m];c.mozWriteAudio(b);k+=d}};f.postMessage(e)};this.pause=function(){f.postMessage(0)}}:function(){this.maxSamplerate=48E3;this.defaultSamplerate=8E3;this.env="nop";this.pause=this.play=r},c=(new z).bind(D),B=s;"node"===k?module.exports=global.timbre=B:"browser"===k&&(B.noConflict=function(){var a=window.timbre,f=window.T;return function(c){window.T===B&&(window.T=f);c&&window.timbre===B&&(window.timbre=
a);return B}}(),window.timbre=window.T=B)})();
(function(i){function h(d){this.samplerate=d;this.frequency=340;this.Q=1;this.b0=this.b1=this.b2=this.a1=this.a2=this.x1R=this.x2R=this.y1R=this.y2R=this.x1L=this.x2L=this.y1L=this.y2L=this.gain=0;this.setType("lpf")}var g=h.prototype;g.process=function(d,b){var e,c,a,f=this.x1L,k=this.x2L,n=this.y1L,l=this.y2L,m=this.x1R,g=this.x2R,j=this.y1R,h=this.y2R,i=this.b0,r=this.b1,t=this.b2,v=this.a1,x=this.a2,u,w;u=0;for(w=d.length;u<w;++u)e=d[u],c=i*e+r*f+t*k-v*n-x*l,k=f,f=e,l=n,n=c,e=b[u],a=i*e+r*m+t*
g-v*j-x*h,g=m,m=e,h=j,j=a,d[u]=c,b[u]=a;this.x1L=f;this.x2L=k;this.y1L=n;this.y2L=l;this.x1R=m;this.x2R=g;this.y1R=j;this.y2R=h};g.setType=function(d){var b;if(b=j[d])this.type=d,b.call(this,this.frequency,this.Q,this.gain)};g.setParams=function(d,b,e){this.frequency=d;this.Q=b;this.gain=e;var c=j[this.type];c&&c.call(this,d,b,e);return this};var j={lowpass:function(d,b){d/=0.5*this.samplerate;if(1<=d)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else if(0>=d)this.b0=this.b1=this.b2=this.a1=this.a2=
0;else{var e=Math.pow(10,0.05*(0>b?0:b)),c=Math.sqrt(0.5*(4-Math.sqrt(16-16/(e*e)))),e=Math.PI*d,c=0.5*c*Math.sin(e),c=0.5*(1-c)/(1+c),e=(0.5+c)*Math.cos(e),a=0.25*(0.5+c-e);this.b0=2*a;this.b1=4*a;this.b2=this.b0;this.a1=2*-e;this.a2=2*c}},highpass:function(d,b){d/=0.5*this.samplerate;if(1<=d)this.b0=this.b1=this.b2=this.a1=this.a2=0;else if(0>=d)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else{var e=Math.pow(10,0.05*(0>b?0:b)),c=Math.sqrt((4-Math.sqrt(16-16/(e*e)))/2),e=Math.PI*d,c=0.5*c*Math.sin(e),
c=0.5*(1-c)/(1+c),e=(0.5+c)*Math.cos(e),a=0.25*(0.5+c+e);this.b0=2*a;this.b1=-4*a;this.b2=this.b0;this.a1=2*-e;this.a2=2*c}},bandpass:function(d,b){d/=0.5*this.samplerate;if(0<d&&1>d)if(0<b){var e=Math.PI*d,c=Math.sin(e)/(2*b),e=Math.cos(e),a=1/(1+c);this.b0=c*a;this.b1=0;this.b2=-c*a;this.a1=-2*e*a;this.a2=(1-c)*a}else this.b0=this.b1=this.b2=this.a1=this.a2=0;else this.b0=this.b1=this.b2=this.a1=this.a2=0},lowshelf:function(d,b,e){d/=0.5*this.samplerate;b=Math.pow(10,e/40);if(1<=d)this.b0=b*b,this.b1=
this.b2=this.a1=this.a2=0;else if(0>=d)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else{var d=Math.PI*d,e=0.5*Math.sin(d)*Math.sqrt(0*(b+1/b)+2),d=Math.cos(d),e=2*Math.sqrt(b)*e,c=b+1,a=b-1,f=1/(c+a*d+e);this.b0=b*(c-a*d+e)*f;this.b1=2*b*(a-c*d)*f;this.b2=b*(c-a*d-e)*f;this.a1=-2*(a+c*d)*f;this.a2=(c+a*d-e)*f}},highshelf:function(d,b,e){d/=0.5*this.samplerate;b=Math.pow(10,e/40);if(1<=d)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else if(0>=d)this.b0=b*b,this.b1=this.b2=this.a1=this.a2=0;else{var d=
Math.PI*d,e=0.5*Math.sin(d)*Math.sqrt(0*(b+1/b)+2),d=Math.cos(d),e=2*Math.sqrt(b)*e,c=b+1,a=b-1,f=1/(c-a*d+e);this.b0=b*(c+a*d+e)*f;this.b1=-2*b*(a+c*d)*f;this.b2=b*(c+a*d-e)*f;this.a1=2*(a-c*d)*f;this.a2=(c-a*d-e)*f}},peaking:function(d,b,e){d/=0.5*this.samplerate;if(0<d&&1>d)if(e=Math.pow(10,e/40),0<b){var d=Math.PI*d,b=Math.sin(d)/(2*b),d=Math.cos(d),c=1/(1+b/e);this.b0=(1+b*e)*c;this.b1=-2*d*c;this.b2=(1-b*e)*c;this.a1=this.b1;this.a2=(1-b/e)*c}else this.b0=e*e,this.b1=this.b2=this.a1=this.a2=
0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0},notch:function(d,b){d/=0.5*this.samplerate;if(0<d&&1>d)if(0<b){var e=Math.PI*d,c=Math.sin(e)/(2*b),e=Math.cos(e),a=1/(1+c);this.b0=a;this.b1=-2*e*a;this.b2=a;this.a1=this.b1;this.a2=(1-c)*a}else this.b0=this.b1=this.b2=this.a1=this.a2=0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0},allpass:function(d,b){d/=0.5*this.samplerate;if(0<d&&1>d)if(0<b){var e=Math.PI*d,c=Math.sin(e)/(2*b),e=Math.cos(e),a=1/(1+c);this.b0=(1-c)*a;this.b1=-2*e*a;this.b2=
(1+c)*a;this.a1=this.b1;this.a2=this.b0}else this.b0=-1,this.b1=this.b2=this.a1=this.a2=0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0}};j.lpf=j.lowpass;j.hpf=j.highpass;j.bpf=j.bandpass;j.bef=j.notch;j.brf=j.notch;j.apf=j.allpass;i.modules.Biquad=h})(timbre);
(function(i){function h(d){this.samplerate=d;this.buffersize=1<<Math.round(Math.log(0.1*d)*Math.LOG2E);this.bufferL=new i.fn.SignalArray(this.buffersize+1);this.bufferR=new i.fn.SignalArray(this.buffersize+1);this._wave=this.wave=null;this.writeIndex=this.buffersize>>1;this.readIndex=0;this.delayTime=20;this.rate=4;this.depth=20;this.feedback=0.2;this.wet=0.5;this.phaseIncr=this.phase=0;this.phaseStep=4;this.setWaveType("sin");this.setDelayTime(this.delayTime);this.setRate(this.rate)}var g=h.prototype,
j=[];j[0]=function(){for(var d=new Float32Array(512),b=0;512>b;++b)d[b]=Math.sin(2*Math.PI*(b/512));return d}();j[1]=function(){for(var d=new Float32Array(512),b,e=0;512>e;++e)b=e/512-0.25,d[e]=1-4*Math.abs(Math.round(b)-b);return d}();g.setWaveType=function(d){"sin"===d?(this.wave=d,this._wave=j[0]):"tri"===d&&(this.wave=d,this._wave=j[1])};g.setDelayTime=function(d){this.delayTime=d;for(d=this.writeIndex-(0.001*d*this.samplerate|0);0>d;)d+=this.buffersize;this.readIndex=d};g.setRate=function(d){this.rate=
d;this.phaseIncr=512*this.rate/this.samplerate*this.phaseStep};g.process=function(d,b){var e=this.bufferL,c=this.bufferR,a=this.buffersize,f=a-1,k=this._wave,n=this.phase,l=this.phaseIncr,m=this.writeIndex,g=this.readIndex,j=this.depth,h=this.feedback,i,r,t,v=this.wet,x=1-v,u,w=d.length,z,y=this.phaseStep;for(u=0;u<w;){t=k[n|0]*j;for(n+=l;512<n;)n-=512;for(z=0;z<y;++z,++u)r=g+a+t&f,i=0.5*(e[r]+e[r+1]),e[m]=d[u]-i*h,d[u]=d[u]*x+i*v,i=0.5*(c[r]+c[r+1]),c[m]=b[u]-i*h,b[u]=b[u]*x+i*v,m=m+1&f,g=g+1&f}this.phase=
n;this.writeIndex=m;this.readIndex=g};i.modules.Chorus=h})(timbre);
(function(i){function h(g){this.samplerate=g;this.dbThreshold=-24;this.dbKnee=0;this.dbRatio=12;this.setParams(this.dbThreshold,this.dbKnee,this.dbRatio)}var g=h.prototype;g.setParams=function(g,d,b){this.dbThreshold=g;this.threshold=Math.pow(10,0.05*this.dbThreshold);this.dbRatio=b;this.ratio=Math.pow(10,0.05*this.dbRatio);this.slope=1/this.ratio;this.gain=1/(this.threshold+(1-this.threshold)*this.slope)};g.process=function(g,d){var b=this.threshold,e=this.slope,c=this.gain,a,f,k,n,l=g.length;for(n=
0;n<l;++n)f=g[n],k=d[n],a=0.5*(f+k),b>a?(f=b+(f-b)*e,k=b+(k-b)*e):a<-b&&(f=-b+(f+b)*e,k=-b+(k+b)*e),g[n]=f*c,g[n]=k*c};i.modules.Compressor=h})(timbre);
(function(i){function h(){}h.prototype.decode=function(g,j,d){if("string"===typeof g){if(/\.wav$/.test(g))return h.wav_decode(g,j,d);if(h.ogg_decode&&/\.ogg$/.test(g))return h.ogg_decode(g,j,d);if(h.mp3_decode&&/\.mp3$/.test(g))return h.mp3_decode(g,j,d)}if(h.webkit_decode)return h.webkit_decode(g,j,d);if(h.moz_decode)return h.moz_decode(g,j,d);j(!1)};i.modules.Decoder=h;h.getBinaryWithPath="browser"===i.envtype?function(g,j){i.fn.fix_iOS6_1_problem(!0);var d=new XMLHttpRequest;d.open("GET",g);d.responseType=
"arraybuffer";d.onreadystatechange=function(){4===d.readyState&&(d.response?j(new Uint8Array(d.response)):void 0!==d.responseBody&&j(new Uint8Array(VBArray(d.responseBody).toArray())),i.fn.fix_iOS6_1_problem(!1))};d.send()}:function(g,j){j("no support")};h.wav_decode=function(g,j,d){h.getBinaryWithPath(g,function(b){if("RIFF"!==String.fromCharCode(b[0],b[1],b[2],b[3])||b[4]+(b[5]<<8)+(b[6]<<16)+(b[7]<<24)+8!==b.length||"WAVE"!==String.fromCharCode(b[8],b[9],b[10],b[11])||"fmt "!==String.fromCharCode(b[12],
b[13],b[14],b[15]))return j(!1);var e=b[22]+(b[23]<<8),c=b[24]+(b[25]<<8)+(b[26]<<16)+(b[27]<<24),a=b[34]+(b[35]<<8);if("data"!==String.fromCharCode(b[36],b[37],b[38],b[39]))return j(!1);var f=b[40]+(b[41]<<8)+(b[42]<<16)+(b[43]<<24),k=(f/e>>1)/c;if(f>b.length-44)return j(!1);var n,f=new Float32Array(k*c|0);n=2===e?new Float32Array(k*c|0):f;j({samplerate:c,channels:e,bufferL:f,bufferR:n,duration:k});if(8===a)b=new Int8Array(b.buffer,44);else if(16===a)b=new Int16Array(b.buffer,44);else if(32===a)b=
new Int32Array(b.buffer,44);else if(24===a){for(var b=new Uint8Array(b.buffer,44),l,m,g,c=new Int32Array(b.length/3),k=0,i=b.length,h=0;k<i;)l=b[k++],m=b[k++],g=b[k++],l=l+(m<<8)+(g<<16),l=l&8388608?l-16777216:l,c[h++]=l;b=c}a=1/((1<<a-1)-1);if(2===e){e=k=0;for(c=f.length;e<c;++e)f[e]=b[k++]*a,n[e]=b[k++]*a}else{e=0;for(c=f.length;e<c;++e)f[e]=b[e]*a}d()})};h.webkit_decode=function(){if("undefined"!==typeof webkitAudioContext){var g=i.fn._audioContext,j=function(d,b,e){var c,a,f;if("string"===typeof d)return e(!1);
try{f=g.createBuffer(d.buffer,!1)}catch(k){return b(!1)}d=g.sampleRate;c=f.numberOfChannels;2===c?(a=f.getChannelData(0),f=f.getChannelData(1)):a=f=f.getChannelData(0);b({samplerate:d,channels:c,bufferL:a,bufferR:f,duration:a.length/d});e()};return function(d,b,e){if(d instanceof File){var c=new FileReader;c.onload=function(a){j(new Uint8Array(a.target.result),b,e)};c.readAsArrayBuffer(d)}else h.getBinaryWithPath(d,function(a){j(a,b,e)})}}}();h.moz_decode=function(){if("function"===typeof Audio&&
"function"===typeof(new Audio).mozSetup)return function(g,j,d){var b,e,c,a,f,k=0,n=new Audio(g);n.volume=0;n.addEventListener("loadedmetadata",function(){b=n.mozSampleRate;e=n.mozChannels;f=n.duration;c=new Float32Array(n.duration*b|0);a=2===e?new Float32Array(n.duration*b|0):c;2===e?n.addEventListener("MozAudioAvailable",function(f){for(var f=f.frameBuffer,b=0,e=f.length;b<e;b+=2)c[k]=f[b],a[k]=f[b+1],k+=1},!1):n.addEventListener("MozAudioAvailable",function(f){for(var f=f.frameBuffer,b=0,e=f.length;b<
e;++b)c[k]=a[k]=f[b],k+=1},!1);n.play();setTimeout(function(){j({samplerate:b,channels:e,bufferL:c,bufferR:a,duration:f})},1E3)},!1);n.addEventListener("ended",function(){d()},!1);n.load()}}()})(timbre);
(function(i){function h(c){this.context=c.context;this.then=c.then;this.done=function(){c.done.apply(c,arguments);return this};this.fail=function(){c.fail.apply(c,arguments);return this};this.pipe=function(){return c.pipe.apply(c,arguments)};this.always=function(){c.always.apply(c,arguments);return this};this.promise=function(){return this};this.isResolved=function(){return c.isResolved()};this.isRejected=function(){return c.isRejected()}}function g(c){this.context=c||this;this._state="pending";this._doneList=
[];this._failList=[];this._promise=new h(this)}var j=[].slice,d=function(c){return c&&"function"===typeof c.promise},b=g.prototype,e=function(c,a,f,b){if("pending"===this._state){this._state=c;for(var c=0,e=a.length;c<e;++c)a[c].apply(f,b);this._doneList=this._failList=null}};b.resolve=function(){var c=j.call(arguments,0);e.call(this,"resolved",this._doneList,this.context||this,c);return this};b.resolveWith=function(c){var a=j.call(arguments,1);e.call(this,"resolved",this._doneList,c,a);return this};
b.reject=function(){var c=j.call(arguments,0);e.call(this,"rejected",this._failList,this.context||this,c);return this};b.rejectWith=function(c){var a=j.call(arguments,1);e.call(this,"rejected",this._failList,c,a);return this};b.promise=function(){return this._promise};b.done=function(){for(var c=j.call(arguments),a="resolved"===this._state,f="pending"===this._state,b=this._doneList,e=0,d=c.length;e<d;++e)if("function"===typeof c[e])if(a)c[e]();else f&&b.push(c[e]);return this};b.fail=function(){for(var c=
j.call(arguments),a="rejected"===this._state,f="pending"===this._state,b=this._failList,e=0,d=c.length;e<d;++e)if("function"===typeof c[e])if(a)c[e]();else f&&b.push(c[e]);return this};b.always=function(){this.done.apply(this,arguments);this.fail.apply(this,arguments);return this};b.then=function(c,a){return this.done(c).fail(a)};b.pipe=function(c,a){var f=this,b=new g(this.context);this.done(function(){var a=c.apply(f.context,arguments);d(a)?a.then(function(){var f=j.call(arguments);b.resolveWith.apply(b,
[a].concat(f))}):b.resolveWith(f,a)});this.fail(function(){if("function"===typeof a){var c=a.apply(f.context,arguments);d(c)&&c.fail(function(){var a=j.call(arguments);b.rejectWith.apply(b,[c].concat(a))})}else b.reject.apply(b,arguments)});return b.promise()};b.isResolved=function(){return"resolved"===this._state};b.isRejected=function(){return"rejected"===this._state};b.state=function(){return this._state};g.when=function(c){var a=0,f=j.call(arguments),b=f.length,e=b;1===b&&!d(c)&&(e=0);var l=1===
e?c:new g,m=function(a,f){return function(c){f[a]=1<arguments.length?j.call(arguments):c;--e||l.resolve.apply(l,f)}};if(1<b)for(var o=Array(b),i=function(){l.reject()};a<b;++a)f[a]&&d(f[a])?f[a].promise().done(m(a,o)).fail(i):(o[a]=f[a],--e);e||l.resolve.apply(l,f);return l.promise()};i.modules.Deferred=g})(timbre);
(function(i){function h(a){this.samplerate=a||44100;this.value=j;this.status=l;this.curve="linear";this.step=1;this.emit=this.loopNode=this.releaseNode=null;this._envValue=new g(a);this._table=[];this._initValue=j;this._curveValue=0;this._defaultCurveType=b;this._counter=this._index=0}function g(a){this.samplerate=a;this.value=j;this.step=1;this._curveType=b;this._y2=this._y1=this._b1=this._a2=this._grow=this._curveValue=0}var j=h.ZERO=1.0E-6,d=h.CurveTypeSet=0,b=h.CurveTypeLin=1,e=h.CurveTypeExp=
2,c=h.CurveTypeSin=3,a=h.CurveTypeWel=4,f=h.CurveTypeCurve=5,k=h.CurveTypeSqr=6,n=h.CurveTypeCub=7,l=h.StatusWait=0,m=h.StatusGate=1,o=h.StatusSustain=2,s=h.StatusRelease=3,p=h.StatusEnd=4,q={set:d,lin:b,linear:b,exp:e,exponential:e,sin:c,sine:c,wel:a,welch:a,sqr:k,squared:k,cub:n,cubed:n};h.CurveTypeDict=q;var r=h.prototype;r.clone=function(){var a=new h(this.samplerate);a._table=this._table;a._initValue=this._initValue;a.setCurve(this.curve);null!==this.releaseNode&&a.setReleaseNode(this.releaseNode+
1);null!==this.loopNode&&a.setLoopNode(this.loopNode+1);a.setStep(this.step);a.reset();return a};r.setTable=function(a){this._initValue=a[0];this._table=a.slice(1);this.value=this._envValue.value=this._initValue;this._counter=this._index=0;this.status=l};r.setCurve=function(a){"number"===typeof a?(this._defaultCurveType=f,this._curveValue=a):this._defaultCurveType=q[a]||null;this.curve=a};r.setReleaseNode=function(a){"number"===typeof a&&0<a&&(this.releaseNode=a-1)};r.setLoopNode=function(a){"number"===
typeof a&&0<a&&(this.loopNode=a-1)};r.setStep=function(a){this.step=this._envValue.step=a};r.reset=function(){this.value=this._envValue.value=this._initValue;this._counter=this._index=0;this.status=l};r.release=function(){null!==this.releaseNode&&(this._counter=0,this.status=s)};r.getInfo=function(a){var f=this._table,c,b,e=0,k=Infinity,d=Infinity,l=!1;c=0;for(b=f.length;c<b;++c){this.loopNode===c&&(k=e);this.releaseNode===c&&(d=e=e<a?e+a:a);var n=f[c];Array.isArray(n)&&(e+=n[1])}Infinity!==k&&Infinity===
d&&(e+=a,l=!0);return{totalDuration:e,loopBeginTime:k,releaseBeginTime:d,isEndlessLoop:l}};r.calcStatus=function(){var a=this.status,c=this._table,e=this._index,k=this._counter,d=this._curveValue,l=this._defaultCurveType,n=this.loopNode,g=this.releaseNode,j=this._envValue,i,h,q=null;switch(a){case m:case s:for(;0>=k;)e>=c.length?a===m&&null!==n?e=n:(a=p,k=Infinity,q="ended"):a===m&&e===g?null!==n&&n<g?e=n:(a=o,k=Infinity,q="sustained"):(i=c[e++],k=i[0],h=null===i[2]?l:i[2],h===f&&(d=i[3],0.001>Math.abs(d)&&
(h=b)),i=i[1],k=j.setNext(k,i,h,d))}this.status=a;this.emit=q;this._index=e;this._counter=k;return a};r.next=function(){this.calcStatus()&1&&(this.value=this._envValue.next()||j);this._counter-=1;return this.value};r.process=function(a){var f=this._envValue,c,b=a.length;if(this.calcStatus()&1)for(c=0;c<b;++c)a[c]=f.next()||j;else{f=this.value||j;for(c=0;c<b;++c)a[c]=f}this.value=a[b-1];this._counter-=a.length};g.prototype.setNext=function(l,g,m,o){var j=this.value,i,h,s,p,q,g=0.001*g*this.samplerate/
this.step|0;1>g&&(g=1,m=d);switch(m){case d:this.value=l;break;case b:i=(l-j)/g;break;case e:i=0!==j?Math.pow(l/j,1/g):0;break;case c:o=Math.PI/g;h=0.5*(l+j);s=2*Math.cos(o);p=0.5*(l-j);q=p*Math.sin(0.5*Math.PI-o);break;case a:o=0.5*Math.PI/g;s=2*Math.cos(o);l>=j?(h=j,p=0,q=-Math.sin(o)*(l-j)):(h=l,p=j-l,q=Math.cos(o)*(j-l));break;case f:l=(l-j)/(1-Math.exp(o));h=j+l;s=l;i=Math.exp(o/g);break;case k:p=Math.sqrt(j);q=Math.sqrt(l);i=(q-p)/g;break;case n:p=Math.pow(j,0.33333333),q=Math.pow(l,0.33333333),
i=(q-p)/g}this.next=t[m];this._grow=i;this._a2=h;this._b1=s;this._y1=p;this._y2=q;return g};var t=[];t[d]=function(){return this.value};t[b]=function(){return this.value+=this._grow};t[e]=function(){return this.value*=this._grow};t[c]=function(){var a=this._b1*this._y1-this._y2;this.value=this._a2-a;this._y2=this._y1;this._y1=a;return this.value};t[a]=function(){var a=this._b1*this._y1-this._y2;this.value=this._a2+a;this._y2=this._y1;this._y1=a;return this.value};t[f]=function(){this._b1*=this._grow;
return this.value=this._a2-this._b1};t[k]=function(){this._y1+=this._grow;return this.value=this._y1*this._y1};t[n]=function(){this._y1+=this._grow;return this.value=this._y1*this._y1*this._y1};g.prototype.next=t[d];i.modules.Envelope=h;i.modules.EnvelopeValue=g})(timbre);
(function(i){function h(b){this.context=b;this._||(this._={})}var g=Array.isArray,j=[].slice,d=h.prototype;d.emit=function(b){var e=this._;if(!e.events)return!1;var c=e.events[b];if(!c)return!1;if("function"===typeof c){switch(arguments.length){case 1:c.call(this.context);break;case 2:c.call(this.context,arguments[1]);break;case 3:c.call(this.context,arguments[1],arguments[2]);break;default:e=j.call(arguments,1),c.apply(this.context,e)}return!0}if(g(c)){for(var e=j.call(arguments,1),c=c.slice(),a=
0,f=c.length;a<f;++a)c[a]instanceof i.Object?c[a].bang.apply(c[a],e):c[a].apply(this.context,e);return!0}if(c instanceof i.Object)e=j.call(arguments,1),c.bang.apply(c,e);else return!1};d.addListener=function(b,e){if("function"!==typeof e&&!(e instanceof i.Object))throw Error("addListener takes instances of Function or timbre.Object");var c=this._;c.events||(c.events={});c.events[b]?g(c.events[b])?c.events[b].push(e):c.events[b]=[c.events[b],e]:c.events[b]=e;return this};d.on=d.addListener;d.once=
function(b,e){var c=this,a;if("function"===typeof e)a=function(){c.removeListener(b,a);e.apply(c.context,arguments)};else if(e instanceof i.Object)a=function(){c.removeListener(b,a);e.bang.apply(e,arguments)};else throw Error("once takes instances of Function or timbre.Object");a.listener=e;c.on(b,a);return this};d.removeListener=function(b,e){if("function"!==typeof e&&!(e instanceof i.Object))throw Error("removeListener takes instances of Function or timbre.Object");var c=this._;if(!c.events||!c.events[b])return this;
var a=c.events[b];if(g(a)){for(var f=-1,k=0,d=a.length;k<d;++k)if(a[k]===e||a[k].listener&&a[k].listener===e){f=k;break}if(0>f)return this;a.splice(f,1);0===a.length&&(c.events[b]=null)}else if(a===e||a.listener&&a.listener===e)c.events[b]=null;return this};d.removeAllListeners=function(b){var e=this._;if(!e.events)return this;var c=!1,a=e.events[b];if(g(a))for(var f=a.length;f--;){var k=a[f];k.unremovable?c=!0:this.removeListener(b,k)}else a&&(a.unremovable?c=!0:this.removeListener(b,a));c||(e.events[b]=
null);return this};d.listeners=function(b){var e=this._;if(!e.events||!e.events[b])return[];e=e.events[b];if(!g(e))return e.unremovable?[]:[e];for(var e=e.slice(),b=[],c=0,a=e.length;c<a;++c)e[c].unremovable||b.push(e[c]);return b};i.modules.EventEmitter=h;i.modules.ready.done("events")})(timbre);
(function(i){function h(b){this.length=b=1<<Math.ceil(Math.log("number"===typeof b?b:512)*Math.LOG2E);this.buffer=new i.fn.SignalArray(b);this.real=new i.fn.SignalArray(b);this.imag=new i.fn.SignalArray(b);this._real=new i.fn.SignalArray(b);this._imag=new i.fn.SignalArray(b);this.mag=new i.fn.SignalArray(b>>1);this.minDecibels=-30;this.maxDecibels=-100;b=j.get(b);this._bitrev=b.bitrev;this._sintable=b.sintable;this._costable=b.costable}var g=h.prototype;g.setWindow=function(b){if("string"===typeof b){var e=
/([A-Za-z]+)(?:\(([01]\.?\d*)\))?/.exec(b);if(null!==e){var c=e[1].toLowerCase(),e=void 0!==e[2]?+e[2]:0.25;if(c=d[c]){this._window||(this._window=new i.fn.SignalArray(this.length));for(var a=this._window,f=0,k=this.length,e=0>e?0:1<e?1:e;f<k;++f)a[f]=c(f,k,e);this.windowName=b}}}};g.forward=function(b){var e=this.buffer,c=this.real,a=this.imag,f=this._window,k=this._bitrev,d=this._sintable,l=this._costable,g=e.length,o,j,i,h,r,t,v;if(f)for(o=0;o<g;++o)e[o]=b[o]*f[o];else e.set(b);for(o=0;o<g;++o)c[o]=
e[k[o]],a[o]=0;for(e=1;e<g;e=f){k=0;f=e+e;j=g/f;for(b=0;b<e;b++){i=l[k];h=d[k];for(o=b;o<g;o+=f)r=o+e,t=h*a[r]+i*c[r],v=i*a[r]-h*c[r],c[r]=c[o]-t,c[o]+=t,a[r]=a[o]-v,a[o]+=v;k+=j}}d=this.mag;for(o=0;o<g;++o)l=c[o],b=a[o],d[o]=Math.sqrt(l*l+b*b);return{real:c,imag:a}};g.inverse=function(b,e){var c=this.buffer,a=this._real,f=this._imag,k=this._bitrev,d=this._sintable,l=this._costable,g=c.length,o,j,i,h,r,t,v,x,u,w;for(o=0;o<g;++o)j=k[o],a[o]=+b[j],f[o]=-e[j];for(k=1;k<g;k=i){h=0;i=k+k;r=g/i;for(j=0;j<
k;j++){t=l[h];v=d[h];for(o=j;o<g;o+=i)x=o+k,u=v*f[x]+t*a[x],w=t*f[x]-v*a[x],a[x]=a[o]-u,a[o]+=u,f[x]=f[o]-w,f[o]+=w;h+=r}}for(o=0;o<g;++o)c[o]=a[o]/g;return c};g.getFrequencyData=function(b){var e=this.minDecibels,c,a=Math.min(this.mag.length,b.length);if(a){var f,k=this.mag,d=0;for(c=0;c<a;++c)f=k[c],b[c]=!f?e:20*Math.log(f)*Math.LOG10E,d<b[c]&&(d=b[c])}return b};var j={get:function(b){var e;if(!(e=j[b])){var c,a,f,k;e=new Int16Array(b);k=b>>1;for(c=a=0;;){e[c]=a;if(++c>=b)break;for(f=k;f<=a;)a-=
f,f>>=1;a+=f}a=Math.floor(Math.log(b)/Math.LN2);c=new i.fn.SignalArray((1<<a)-1);k=new i.fn.SignalArray((1<<a)-1);var d=2*Math.PI;a=0;for(f=c.length;a<f;++a)c[a]=Math.sin(d*(a/b)),k[a]=Math.cos(d*(a/b));e=j[b]={bitrev:e,sintable:c,costable:k}}return e}},d=function(){var b=Math.PI,e=2*Math.PI,c=Math.abs,a=Math.pow,f=Math.cos,k=Math.sin,d=Math.E;return{rectangular:function(){return 1},hann:function(a,c){return 0.5*(1-f(e*a/(c-1)))},hamming:function(a,c){return 0.54-0.46*f(e*a/(c-1))},tukery:function(a,
c,e){return a<e*(c-1)/2?0.5*(1+f(b*(2*a/(e*(c-1))-1))):(c-1)*(1-e/2)<a?0.5*(1+f(b*(2*a/(e*(c-1))-2/e+1))):1},cosine:function(a,f){return k(b*a/(f-1))},lanczos:function(a,f){return k(b*(2*a/(f-1)-1))/(b*(2*a/(f-1)-1))},triangular:function(a,f){return 2/(f+1)*((f+1)/2-c(a-(f-1)/2))},bartlett:function(a,f){return 2/(f-1)*((f-1)/2-c(a-(f-1)/2))},gaussian:function(f,c,b){return a(d,-0.5*a((f-(c-1)/2)/(b*(c-1)/2),2))},bartlettHann:function(a,b){return 0.62-0.48*c(a/(b-1)-0.5)-0.38*f(e*a/(b-1))},blackman:function(a,
c,k){var d=k/2;return(1-k)/2-0.5*f(e*a/(c-1))+d*f(4*b*a/(c-1))}}}();i.modules.FFT=h})(timbre);
(function(i){function h(c){this.samplerate=c||44100;this.wave=null;this.step=1;this.phase=this.value=this.frequency=0;this.feedback=!1;this._lastouts=this._x=0;this._coeff=g/this.samplerate;this._radtoinc=g/(2*Math.PI)}var g=1024,j=g-1,d=h.prototype;d.setWave=function(c){var a,f,e=this.wave;this.wave||(this.wave=new Float32Array(g+1));if("function"===typeof c)for(a=0;a<g;++a)e[a]=c(a/g);else if(i.fn.isSignalArray(c))if(c.length===e.length)e.set(c);else{f=c.length/g;for(a=0;a<g;++a)e[a]=c[a*f|0]}else"string"===
typeof c&&void 0!==(f=b(c))&&this.wave.set(f);this.wave[g]=this.wave[0]};d.reset=function(){this._x=0};d.next=function(){var c=this._x;this.value=this.wave[(c+this.phase*this._radtoinc|0)&j];c+=this.frequency*this._coeff*this.step;c>g&&(c-=g);this._x=c;return this.value};d.process=function(c){var a=this.wave,f=this._radtoinc,b,e=this._x,d,m,o=this.frequency*this._coeff,i,h=this.step;if(this.feedback){d=this._lastouts;f*=this.phase;for(i=0;i<h;++i)b=e+d*f,d=b|0,b-=d,d&=j,m=a[d],d=a[d+1],c[i]=d=m+b*
(d-m),e+=o;this._lastouts=d}else{f*=this.phase;for(i=0;i<h;++i)b=e+f,d=b|0,b-=d,d&=j,m=a[d],d=a[d+1],c[i]=m+b*(d-m),e+=o}e>g&&(e-=g);this._x=e;this.value=c[c.length-1]};d.processWithFreqArray=function(c,a){var f=this.wave,b=this._radtoinc,e,d=this._x,m,o,i=this._coeff,h,q=this.step;if(this.feedback){m=this._lastouts;b*=this.phase;for(h=0;h<q;++h)e=d+m*b,m=e|0,e-=m,m&=j,o=f[m],m=f[m+1],c[h]=m=o+e*(m-o),d+=a[h]*i;this._lastouts=m}else{b=this.phase*this._radtoinc;for(h=0;h<q;++h)e=d+b,m=e|0,e-=m,m&=
j,o=f[m],m=f[m+1],c[h]=o+e*(m-o),d+=a[h]*i}d>g&&(d-=g);this._x=d;this.value=c[c.length-1]};d.processWithPhaseArray=function(c,a){var f=this.wave,b=this._radtoinc,e,d=this._x,m,o,i=this.frequency*this._coeff,h,q=this.step;if(this.feedback){m=this._lastouts;b*=this.phase;for(h=0;h<q;++h)e=d+m*b,m=e|0,e-=m,m&=j,o=f[m],m=f[m+1],c[h]=m=o+e*(m-o),d+=i;this._lastouts=m}else for(h=0;h<q;++h)e=d+a[h]*b,m=e|0,e-=m,m&=j,o=f[m],m=f[m+1],c[h]=o+e*(m-o),d+=i;d>g&&(d-=g);this._x=d;this.value=c[c.length-1]};d.processWithFreqAndPhaseArray=
function(c,a,f){var b=this.wave,e=this._radtoinc,d,m=this._x,o,h,i=this._coeff,q,r=this.step;if(this.feedback){f=this._lastouts;e*=this.phase;for(q=0;q<r;++q)d=m+f*e,o=d|0,d-=o,o&=j,h=b[o],o=b[o+1],c[q]=f=h+d*(o-h),m+=a[q]*i;this._lastouts=f}else for(q=0;q<r;++q)d=m+f[q]*g,o=d|0,d-=o,o&=j,h=b[o],o=b[o+1],c[q]=h+d*(o-h),m+=a[q]*i;m>g&&(m-=g);this._x=m;this.value=c[c.length-1]};var b=function(c){var a=e[c];if(void 0!==a)return"function"===typeof a&&(a=a()),a;var f;f=/^([\-+]?)(\w+)(?:\((@[0-7])?:?(\d+)?\))?$/.exec(c);
if(null!==f){var a=f[1],b=f[3],d=f[4];f=e[f[2]];var l,g;if(void 0===f)a=void 0;else{"function"===typeof f&&(f=f());switch(b){case "@1":for(l=512;1024>l;++l)f[l]=0;break;case "@2":for(l=512;1024>l;++l)f[l]=Math.abs(f[l]);break;case "@3":for(l=256;512>l;++l)f[l]=0;for(l=512;768>l;++l)f[l]=Math.abs(f[l]);for(l=768;1024>l;++l)f[l]=0;break;case "@4":b=new Float32Array(1024);for(l=0;512>l;++l)b[l]=f[l<<1];f=b;break;case "@5":b=new Float32Array(1024);for(l=0;512>l;++l)b[l]=Math.abs(f[l<<1]);f=b}if(void 0!==
d&&50!==d){d*=0.01;d=0>d?0:1<d?1:d;b=new Float32Array(1024);d=1024*d|0;for(l=0;l<d;++l)b[l]=f[512*(l/d)|0];g=1024-d;for(d=0;1024>l;++l,++d)b[l]=f[512*(d/g)+512|0];f=b}if("+"===a)for(l=0;1024>l;++l)f[l]=0.5*f[l]+0.5;else if("-"===a)for(l=0;1024>l;++l)f[l]*=-1;a=f}if(void 0!==a)return e[c]=a}f=/^wavb\(((?:[0-9a-fA-F][0-9a-fA-F])+)\)$/.exec(c);if(null!==f){c=f[1];a=new Float32Array(1024);f=c.length>>1;if(-1!==[2,4,8,16,32,64,128,256,512,1024].indexOf(f))for(l=b=0;b<f;++b){d=parseInt(c.substr(2*b,2),
16);d=d&128?(d-256)/128:d/127;g=0;for(var h=1024/f;g<h;++g)a[l++]=d}return a}f=/^wavc\(([0-9a-fA-F]{8})\)$/.exec(c);if(null!==f){a=f[1];c=new Float32Array(1024);if(8===a.length){b=parseInt(a,16);f=new Float32Array(8);f[0]=1;for(a=0;7>a;++a)f[a+1]=0.0625*(b&15),b>>=4;for(a=0;8>a;++a){l=0;d=(a+1)/1024;for(b=0;1024>b;++b)c[b]+=Math.sin(2*Math.PI*l)*f[a],l+=d}for(a=f=0;1024>a;++a)if(f<(b=Math.abs(c[a])))f=b;if(0<f)for(a=0;1024>a;++a)c[a]/=f}return c}};h.getWavetable=b;h.setWavetable=function(c,a){var f,
b=new Float32Array(1024),d;if("function"===typeof a)for(d=0;1024>d;++d)b[d]=a(d/1024);else if(i.fn.isSignalArray(a))if(a.length===b.length)b.set(a);else{f=a.length/1024;for(d=0;1024>d;++d)b[d]=a[d*f|0]}e[c]=b};var e={sin:function(){for(var c=new Float32Array(1024),a=0;1024>a;++a)c[a]=Math.sin(2*Math.PI*(a/1024));return c},cos:function(){for(var c=new Float32Array(1024),a=0;1024>a;++a)c[a]=Math.cos(2*Math.PI*(a/1024));return c},pulse:function(){for(var c=new Float32Array(1024),a=0;1024>a;++a)c[a]=
512>a?1:-1;return c},tri:function(){for(var c=new Float32Array(1024),a,f=0;1024>f;++f)a=f/1024-0.25,c[f]=1-4*Math.abs(Math.round(a)-a);return c},saw:function(){for(var c=new Float32Array(1024),a,f=0;1024>f;++f)a=f/1024,c[f]=2*(a-Math.round(a));return c},fami:function(){for(var c=[0,0.125,0.25,0.375,0.5,0.625,0.75,0.875,0.875,0.75,0.625,0.5,0.375,0.25,0.125,0,-0.125,-0.25,-0.375,-0.5,-0.625,-0.75,-0.875,-1,-1,-0.875,-0.75,-0.625,-0.5,-0.375,-0.25,-0.125],a=new Float32Array(1024),f=0;1024>f;++f)a[f]=
c[f/1024*c.length|0];return a},konami:function(){for(var c=[-0.625,-0.875,-0.125,0.75,0.5,0.125,0.5,0.75,0.25,-0.125,0.5,0.875,0.625,0,0.25,0.375,-0.125,-0.75,0,0.625,0.125,-0.5,-0.375,-0.125,-0.75,-1,-0.625,0,-0.375,-0.875,-0.625,-0.25],a=new Float32Array(1024),f=0;1024>f;++f)a[f]=c[f/1024*c.length|0];return a}};i.modules.Oscillator=h})(timbre);
(function(i){function h(c,a){this.samplerate=c;var f,e,n=c/44100;e=2*d.length;this.comb=Array(e);this.combout=Array(e);for(f=0;f<e;++f)this.comb[f]=new g(d[f%d.length]*n),this.combout[f]=new i.fn.SignalArray(a);e=2*b.length;this.allpass=Array(e);for(f=0;f<e;++f)this.allpass[f]=new j(b[f%b.length]*n);this.outputs=[new i.fn.SignalArray(a),new i.fn.SignalArray(a)];this.damp=0;this.wet=0.33;this.setRoomSize(0.5);this.setDamp(0.5)}function g(c){this.buffer=new i.fn.SignalArray(c|0);this.buffersize=this.buffer.length;
this.damp=this.filterstore=this.feedback=this.bufidx=0}function j(c){this.buffer=new i.fn.SignalArray(c|0);this.buffersize=this.buffer.length;this.bufidx=0}var d=[1116,1188,1277,1356,1422,1491,1557,1617],b=[225,556,441,341],e=h.prototype;e.setRoomSize=function(c){var a=this.comb;this.roomsize=c;a[0].feedback=a[1].feedback=a[2].feedback=a[3].feedback=a[4].feedback=a[5].feedback=a[6].feedback=a[7].feedback=a[8].feedback=a[9].feedback=a[10].feedback=a[11].feedback=a[12].feedback=a[13].feedback=a[14].feedback=
a[15].feedback=0.28*c+0.7};e.setDamp=function(c){var a=this.comb;this.damp=c;a[0].damp=a[1].damp=a[2].damp=a[3].damp=a[4].damp=a[5].damp=a[6].damp=a[7].damp=a[8].damp=a[9].damp=a[10].damp=a[11].damp=a[12].damp=a[13].damp=a[14].damp=a[15].damp=0.4*c};e.process=function(c,a){var f=this.comb,b=this.combout,e=this.allpass,d=this.outputs[0],g=this.outputs[1],h=this.wet,i=1-h,j=c.length;f[0].process(c,b[0]);f[1].process(c,b[1]);f[2].process(c,b[2]);f[3].process(c,b[3]);f[4].process(c,b[4]);f[5].process(c,
b[5]);f[6].process(c,b[6]);f[7].process(c,b[7]);f[8].process(a,b[8]);f[9].process(a,b[9]);f[10].process(a,b[10]);f[11].process(a,b[11]);f[12].process(a,b[12]);f[13].process(a,b[13]);f[14].process(a,b[14]);f[15].process(a,b[15]);for(f=0;f<j;++f)d[f]=b[0][f]+b[1][f]+b[2][f]+b[3][f]+b[4][f]+b[5][f]+b[6][f]+b[7][f],g[f]=b[8][f]+b[9][f]+b[10][f]+b[11][f]+b[12][f]+b[13][f]+b[14][f]+b[15][f];e[0].process(d,d);e[1].process(d,d);e[2].process(d,d);e[3].process(d,d);e[4].process(g,g);e[5].process(g,g);e[6].process(g,
g);e[7].process(g,g);for(f=0;f<j;++f)c[f]=d[f]*h+c[f]*i,a[f]=g[f]*h+a[f]*i};g.prototype.process=function(b,a){var f,e,d=this.buffer,g=this.buffersize,m=this.bufidx,h=this.filterstore,i=this.feedback,j=this.damp,q=1-j,r,t=b.length;for(r=0;r<t;++r)f=0.015*b[r],e=d[m],h=e*q+h*j,d[m]=f+h*i,++m>=g&&(m=0),a[r]=e;this.bufidx=m;this.filterstore=h};j.prototype.process=function(b,a){var f,e,d,g=this.buffer,m=this.buffersize,h=this.bufidx,i,j=b.length;for(i=0;i<j;++i)f=b[i],d=g[h],e=-f+d,g[h]=f+0.5*d,++h>=m&&
(h=0),a[i]=e;this.bufidx=h};i.modules.Reverb=h})(timbre);
(function(i){function h(a){return new g(a)}function g(a){this.fragments=[];a&&this.fragments.push(new j(a,0,a.buffer.length/(a.samplerate||44100)))}function j(a,b,c,d,g,h,i){a||(a=e);this.buffer=a.buffer;this.samplerate=a.samplerate||44100;this.start=b;this._duration=c;this.reverse=d||!1;this.pitch=g||100;this.stretch=h||!1;this.pan=i||50}function d(a,b){this.tape=a;this.fragments=a.fragments;this.samplerate=b||44100;this.isEnded=!1;this.buffer=null;this.bufferEndIndex=this.bufferBeginIndex=this.bufferIndexIncr=
this.bufferIndex=0;this.fragment=null;this.fragmentIndex=0;this.panR=this.panL=0.7071067811865475}var b=new Float32Array(60),e={buffer:b,samplerate:1};h.silence=function(a){return(new h(e)).slice(0,1).fill(a)};h.join=function(a){for(var b=new g,c=0;c<a.length;c++)a[c]instanceof g&&b.add_fragments(a[c].fragments);return b};h.Tape=g;g.prototype.add_fragment=function(a){this.fragments.push(a);return this};g.prototype.add_fragments=function(a){for(var b=0;b<a.length;b++)this.fragments.push(a[b]);return this};
g.prototype.duration=function(){for(var a=0,b=0;b<this.fragments.length;b++)a+=this.fragments[b].duration();return a};g.prototype.slice=function(a,b){var c=this.duration();a+b>c&&(b=c-a);for(var c=new g,e=a,d=b,h=0;h<this.fragments.length;h++){var d=this.fragments[h].create(e,d),i=d[0],e=d[1],d=d[2];i&&c.add_fragment(i);if(0===d)break}return c};g.prototype.cut=g.prototype.slice;g.prototype.concat=function(a){var b=new g;b.add_fragments(this.fragments);b.add_fragments(a.fragments);return b};g.prototype.loop=
function(a){var b,c=[];for(b=0;b<this.fragments.length;b++)c.push(this.fragments[b].clone());var e=new g;for(b=0;b<a;b++)e.add_fragments(c);return e};g.prototype.times=g.prototype.loop;g.prototype.split=function(a){for(var b=this.duration()/a,c=[],e=0;e<a;e++)c.push(this.slice(e*b,b));return c};g.prototype.fill=function(a){var b=this.duration();if(0===b)throw"EmptyFragment";var c=a%b;return this.loop(a/b|0).plus(this.slice(0,c))};g.prototype.replace=function(a,b,c){var e=new g,b=a+b,e=e.plus(this.slice(0,
a)),d=e.duration();d<a&&(e=e.plus(h.silence(a-d)));e=e.plus(c);a=this.duration();a>b&&(e=e.plus(this.slice(b,a-b)));return e};g.prototype.reverse=function(){for(var a=new g,b=this.fragments.length;b--;){var c=this.fragments[b].clone();c.reverse=!c.isReversed();a.add_fragment(c)}return a};g.prototype.pitch=function(a,b){for(var c=new g,b=b||!1,e=0;e<this.fragments.length;e++){var d=this.fragments[e].clone();d.pitch*=0.01*a;d.stretch=b;c.add_fragment(d)}return c};g.prototype.stretch=function(a){return this.pitch(100*
(1/(0.01*a)),!0)};g.prototype.pan=function(a){var b=new g;100<a?a=100:0>a&&(a=0);for(var c=0;c<this.fragments.length;c++){var e=this.fragments[c].clone();e.pan=a;b.add_fragment(e)}return b};g.prototype.silence=function(){return h.silence(this.duration())};g.prototype.join=function(a){for(var b=new g,c=0;c<a.length;c++)a[c]instanceof g&&b.add_fragments(a[c].fragments);return b};j.prototype.duration=function(){return this._duration*(100/this.pitch)};j.prototype.original_duration=function(){return this._duration};
j.prototype.isReversed=function(){return this.reverse};j.prototype.isStretched=function(){return this.stretched};j.prototype.create=function(a,b){var c=this.duration();if(a>=c)return[null,a-c,b];a+b>=c?(c-=a,b-=c):(c=b,b=0);var e=this.clone();e.start=this.start+0.01*a*this.pitch;e._duration=0.01*c*this.pitch;e.reverse=!1;return[e,0,b]};j.prototype.clone=function(){var a=new j;a.buffer=this.buffer;a.samplerate=this.samplerate;a.start=this.start;a._duration=this._duration;a.reverse=this.reverse;a.pitch=
this.pitch;a.stretch=this.stretch;a.pan=this.pan;return a};h.Fragment=j;var c=function(){for(var a=new Float32Array(257),b=0;256>b;++b)a[b]=Math.sin(0.5*Math.PI*(b/256));a[256]=1;return a}(),a=function(){for(var a=new Float32Array(257),b=0;256>b;++b)a[b]=Math.cos(0.5*Math.PI*(b/256));a[256]=0;return a}();h.TapeStream=d;d.prototype.reset=function(){this.isEnded=!1;this.buffer=null;this.bufferEndIndex=this.bufferBeginIndex=this.bufferIndexIncr=this.bufferIndex=0;this.fragment=null;this.fragmentIndex=
0;this.panR=this.panL=0.7071067811865475;this.isLooped=!1;return this};d.prototype.fetch=function(f){var e=new i.fn.SignalArray(f),d=new i.fn.SignalArray(f),g=this.fragments;if(0===g.length)return[e,d];for(var m=100*this.samplerate,h=this.buffer,j=this.bufferIndex,p=this.bufferIndexIncr,q=this.bufferBeginIndex,r=this.bufferEndIndex,t=this.fragment,v=this.fragmentIndex,x=this.panL,u=this.panR,w=0;w<f;w++){for(;!h||j<q||j>=r;)if(!t||v<g.length)t=g[v++],h=t.buffer,p=t.samplerate/m*t.pitch,q=t.start*
t.samplerate,r=q+t.original_duration()*t.samplerate,j=256*(t.pan/100)|0,x=a[j],u=c[j],t.reverse?(p*=-1,j=r+p):j=q;else if(this.isLooped)h=null,r=q=p=j=0,t=null,v=0;else{this.isEnded=!0;h=b;j=p=0;break}e[w]=h[j|0]*x;d[w]=h[j|0]*u;j+=p}this.buffer=h;this.bufferIndex=j;this.bufferIndexIncr=p;this.bufferBeginIndex=q;this.bufferEndIndex=r;this.fragment=t;this.fragmentIndex=v;this.panL=x;this.panR=u;return[e,d]};i.modules.Scissor=h})(timbre);
(function(i){function h(g){this.samplerate=g;this.buffersize=1<<Math.ceil(Math.log(1.5*g)*Math.LOG2E);this.buffermask=this.buffersize-1;this.writeBufferL=new i.fn.SignalArray(this.buffersize);this.writeBufferR=new i.fn.SignalArray(this.buffersize);this.readBufferL=this.writeBufferL;this.readBufferR=this.writeBufferR;this.mix=this.cross=this.feedback=this.delaytime=null;this.writeIndex=this.readIndex=this.prevR=this.prevL=0;this.setParams(125,0.25,!1,0.45)}var g=h.prototype;g.setParams=function(g,
d,b,e){this.delaytime!==g&&(this.delaytime=g,g=0.001*g*this.samplerate|0,g>this.buffermask&&(g=this.buffermask),this.writeIndex=this.readIndex+g&this.buffermask);this.feedback!==d&&(this.feedback=d);this.cross!==b&&((this.cross=b)?(this.readBufferL=this.writeBufferR,this.readBufferR=this.writeBufferL):(this.readBufferL=this.writeBufferL,this.readBufferR=this.writeBufferR));this.mix!==e&&(this.mix=e)};g.process=function(g,d){var b=this.readBufferL,e=this.readBufferR,c=this.writeBufferL,a=this.writeBufferR,
f=this.readIndex,k=this.writeIndex,n=this.buffermask,l=this.feedback,m=this.mix,h=1-m,i=this.prevL,p=this.prevR,q,r,t=g.length;for(r=0;r<t;++r)q=b[f],c[k]=g[r]-q*l,g[r]=i=0.5*(g[r]*h+q*m+i),q=e[f],a[k]=d[r]-q*l,d[r]=p=0.5*(d[r]*h+q*m+p),f+=1,k=k+1&n;this.readIndex=f&this.buffermask;this.writeIndex=k;this.prevL=i;this.prevR=p};i.modules.StereoDelay=h})(timbre);
(function(i){function h(g){i.Object.call(this,2,g)}var g=i.fn;g.extend(h);h.prototype.process=function(h){var d=this._;this.tickID!==h&&(this.tickID=h,d.ar?(g.inputSignalAR(this),g.outputSignalAR(this)):(this.cells[0][0]=g.inputSignalKR(this),g.outputSignalKR(this)));return this};g.register("+",h)})(timbre);
(function(i){var h=i.fn,g=i.modules;h.register("audio",function(b){b=new (h.getClass("buffer"))(b);b.playbackState=h.FINISHED_STATE;b._.isLoaded=!1;Object.defineProperties(b,{isLoaded:{get:function(){return this._.isLoaded}}});b.load=j;b.loadthis=d;return b});var j=function(b){var e=this,c=this._,a=new g.Deferred(this),f=arguments,d=1;a.done(function(){e._.emit("done")});"function"===typeof f[d]&&(a.done(f[d++]),"function"===typeof f[d]&&a.fail(f[d++]));c.loadedTime=0;(new g.Decoder).decode(b,function(f,
b){var c=e._;if(f){e.playbackState=h.PLAYING_STATE;c.samplerate=f.samplerate;c.channels=f.channels;c.bufferMix=null;c.bufferL=f.bufferL;c.bufferR=f.bufferR;c.phase=0;c.phaseIncr=f.samplerate/i.samplerate;c.duration=f.duration*1E3;c.currentTime=0;if(c.isReversed){c.phaseIncr=c.phaseIncr*-1;c.phase=f.bufferL.length+c.phaseIncr}e._.emit("loadedmetadata")}else a.reject(b)},function(){e._.isLoaded=true;e._.plotFlush=true;e._.emit("loadeddata");a.resolveWith(e)});return a.promise()},d=function(){j.apply(this,
arguments);return this}})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);g.fixAR(this);a=this._;a.biquad=new d(a.samplerate);a.freq=i(340);a.band=i(1);a.gain=i(0);a.plotBefore=b;a.plotRange=[-18,18];a.plotFlush=!0}var g=i.fn,j=i.modules.FFT,d=i.modules.Biquad;g.extend(h);var b=function(a,b,c,e,d){a.lineWidth=1;a.strokeStyle="rgb(192, 192, 192)";for(var g=0.5*this._.samplerate,h=1;10>=h;++h)for(var i=1;4>=i;i++){var j=h*Math.pow(10,i);20>=j||g<=j||(a.beginPath(),j=Math.log(j/20)/Math.log(g/20),j=(j*e+b|0)+0.5,a.moveTo(j,
c),a.lineTo(j,c+d),a.stroke())}d/=6;for(h=1;6>h;h++)a.beginPath(),g=(c+h*d|0)+0.5,a.moveTo(b,g),a.lineTo(b+e,g),a.stroke()},e=h.prototype;Object.defineProperties(e,{type:{set:function(a){var b=this._;a!==b.biquad.type&&(b.biquad.setType(a),b.plotFlush=!0)},get:function(){return this._.biquad.type}},freq:{set:function(a){this._.freq=i(a)},get:function(){return this._.freq}},cutoff:{set:function(a){this._.freq=i(a)},get:function(){return this._.freq}},res:{set:function(a){this._.band=i(a)},get:function(){return this._.band}},
Q:{set:function(a){this._.band=i(a)},get:function(){return this._.band}},band:{set:function(a){this._.band=i(a)},get:function(){return this._.band}},gain:{set:function(a){this._.gain=i(a)},get:function(){return this._.gain}}});e.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;g.inputSignalAR(this);var c=b.freq.process(a).cells[0][0],e=b.band.process(a).cells[0][0],a=b.gain.process(a).cells[0][0];if(b.prevFreq!==c||b.prevband!==e||b.prevGain!==a)b.prevFreq=c,b.prevband=e,b.prevGain=
a,b.biquad.setParams(c,e,a),b.plotFlush=!0;b.bypassed||b.biquad.process(this.cells[1],this.cells[2]);g.outputSignalAR(this)}return this};var c=new j(2048),a=i.Object.prototype.plot;e.plot=function(f){if(this._.plotFlush){var b=new d(this._.samplerate);b.setType(this.type);b.setParams(this.freq.valueOf(),this.band.valueOf(),this.gain.valueOf());var e=new Float32Array(c.length);e[0]=1;b.process(e,e);c.forward(e);var b=new Float32Array(512),e=0.5*this._.samplerate,g=new Float32Array(512),m,h,i,j;c.getFrequencyData(g);
for(m=0;512>m;++m)i=20*Math.pow(e/20,m/512),h=i/(e/g.length),i=h|0,h-=i,0===i?i=g[i]:(j=g[i-1],i=g[i],i=(1-h)*j+h*i),b[m]=i;this._.plotData=b;this._.plotFlush=null}return a.call(this,f)};g.register("biquad",h);g.register("lowpass",function(a){return(new h(a)).set("type","lowpass")});g.register("highpass",function(a){return(new h(a)).set("type","highpass")});g.register("bandpass",function(a){return(new h(a)).set("type","bandpass")});g.register("lowshelf",function(a){return(new h(a)).set("type","lowshelf")});
g.register("highshelf",function(a){return(new h(a)).set("type","highshelf")});g.register("peaking",function(a){return(new h(a)).set("type","peaking")});g.register("notch",function(a){return(new h(a)).set("type","notch")});g.register("allpass",function(a){return(new h(a)).set("type","allpass")});g.alias("lpf","lowpass");g.alias("hpf","highpass");g.alias("bpf","bandpass");g.alias("bef","notch");g.alias("brf","notch");g.alias("apf","allpass")})(timbre);
(function(i){function h(a){i.Object.call(this,1,a);g.fixAR(this);a=this._;a.pitch=i(1);a.samplerate=44100;a.channels=0;a.bufferMix=null;a.bufferL=new Float32Array(0);a.bufferR=a.bufferL;a.isLooped=!1;a.isReversed=!1;a.duration=0;a.currentTime=0;a.currentTimeObj=null;a.phase=0;a.phaseIncr=0;a.onended=g.make_onended(this,0);a.onlooped=d(this)}var g=i.fn,j=g.isSignalArray;g.extend(h);var d=function(a){return function(){var b=a._;b.phase>=b.bufferL.length?b.phase=0:0>b.phase&&(b.phase=b.bufferL.length+
b.phaseIncr);a._.emit("looped")}},b=h.prototype,e=function(a){var b=this._;if("object"===typeof a){var c,e,d;if(j(a))c=e=a;else if("object"===typeof a&&(j(a.bufferL)&&j(a.bufferR)?(c=a.bufferL,e=a.bufferR):j(a.buffer)&&(c=e=a.buffer),"number"===typeof a.samplerate))d=a.samplerate;c&&e&&(0<d&&(b.samplerate=a.samplerate),b.bufferMix=null,b.bufferL=c,b.bufferR=e,b.phase=0,b.phaseIncr=b.samplerate/i.samplerate,b.duration=1E3*b.bufferL.length/b.samplerate,b.currentTime=0,b.plotFlush=!0,this.reverse(b.isReversed))}};
Object.defineProperties(b,{buffer:{set:e,get:function(){var a=this._;if(2===a.channels){if(!a.bufferMix){for(var b=new Float32Array(a.bufferL),c=a.bufferR,e=0,d=a.bufferMix.length;e<d;e++)b[e]=0.5*(b[e]+c[e]);a.bufferMix=b}return a.bufferMix}return a.bufferL}},bufferL:{get:function(){return this._.bufferL}},bufferR:{get:function(){return this._.bufferR}},pitch:{set:function(a){this._.pitch=i(a)},get:function(){return this._.pitch}},isLooped:{get:function(){return this._.isLooped}},isReversed:{get:function(){return this._.isReversed}},
samplerate:{get:function(){return this._.samplerate}},duration:{get:function(){return this._.duration}},currentTime:{set:function(a){if("number"===typeof a){var b=this._;0<=a&&a<=b.duration&&(b.phase=a/1E3*b.samplerate,b.currentTime=a)}else a instanceof i.Object?this._.currentTimeObj=a:null===a&&(this._.currentTimeObj=null)},get:function(){return this._.currentTimeObj?this._.currentTimeObj:this._.currentTime}}});b.clone=function(){var a=this._,b=i("buffer");a.bufferL&&(2===a.channels?e.call(b,{bufferL:a.bufferL,
bufferR:a.bufferR,samplerate:a.samplerate}):e.call(b,{buffer:a.bufferL,samplerate:a.samplerate}));b.loop(a.isLooped);b.reverse(a.isReversed);return b};b.slice=function(a,b){var c=this._,d=i(c.originkey),a="number"===typeof a?0.001*a*c.samplerate|0:0,b="number"===typeof b?0.001*b*c.samplerate|0:c.bufferL.length;if(a>b)var l=a,a=b,b=l;c.bufferL&&(2===c.channels?e.call(d,{bufferL:c.bufferL.subarray(a,b),bufferR:c.bufferR.subarray(a,b),samplerate:c.samplerate}):e.call(d,{buffer:c.bufferL.subarray(a,b),
samplerate:c.samplerate}),d.playbackState=g.PLAYING_STATE);d.loop(c.isLooped);d.reverse(c.isReversed);return d};b.reverse=function(a){var b=this._;b.isReversed=!!a;if(b.isReversed){if(0<b.phaseIncr&&(b.phaseIncr*=-1),0===b.phase&&b.buffer)b.phase=b.bufferL.length+b.phaseIncr}else 0>b.phaseIncr&&(b.phaseIncr*=-1);return this};b.loop=function(a){this._.isLooped=!!a;return this};b.bang=function(a){this.playbackState=!1===a?g.FINISHED_STATE:g.PLAYING_STATE;this._.phase=0;this._.emit("bang");return this};
b.process=function(a){var b=this._;if(!b.bufferL)return this;if(this.tickID!==a){this.tickID=a;var c=this.cells[1],e=this.cells[2],d=b.bufferL,m=b.bufferR,h=b.phase,i=b.cellsize;if(b.currentTimeObj){for(var j=b.currentTimeObj.process(a).cells[0],q,r=0.001*b.samplerate,a=0;a<i;++a)q=j[a],h=q*r,c[a]=d[h|0]||0,e[a]=m[h|0]||0;b.phase=h;b.currentTime=q}else{a=b.pitch.process(a).cells[0][0];q=b.phaseIncr*a;for(a=0;a<i;++a)c[a]=d[h|0]||0,e[a]=m[h|0]||0,h+=q;h>=d.length?b.isLooped?g.nextTick(b.onlooped):
g.nextTick(b.onended):0>h&&(b.isLooped?g.nextTick(b.onlooped):g.nextTick(b.onended));b.phase=h;b.currentTime+=g.currentTimeIncr}g.outputSignalAR(this)}return this};var c=i.Object.prototype.plot;b.plot=function(a){var b=this._,e=b.bufferL,d=b.bufferR;if(b.plotFlush){for(var g=new Float32Array(2048),m=0,h=e.length/2048,i=0;2048>i;i++)g[i]=0.5*(e[m|0]+d[m|0]),m+=h;b.plotData=g;b.plotFlush=null}return c.call(this,a)};g.register("buffer",h)})(timbre);
(function(i){function h(b){i.Object.call(this,2,b);g.fixAR(this);b=new j(this._.samplerate);b.setDelayTime(20);b.setRate(4);b.depth=20;b.feedback=0.2;b.mix=0.33;this._.chorus=b}var g=i.fn,j=i.modules.Chorus;g.extend(h);var d=h.prototype;Object.defineProperties(d,{type:{set:function(b){this._.chorus.setDelayTime(b)},get:function(){return this._.chorus.wave}},delay:{set:function(b){0.5<=b&&80>=b&&this._.chorus.setDelayTime(b)},get:function(){return this._.chorus.delayTime}},rate:{set:function(b){"number"===
typeof b&&0<b&&this._.chorus.setRate(b)},get:function(){return this._.chorus.rate}},depth:{set:function(b){"number"===typeof b&&(0<=b&&100>=b)&&(b*=this._.samplerate/44100,this._.chorus.depth=b)},get:function(){return this._.chorus.depth}},fb:{set:function(b){"number"===typeof b&&(-1<=b&&1>=b)&&(this._.chorus.feedback=0.99996*b)},get:function(){return this._.chorus.feedback}},mix:{set:function(b){this._.mix=i(b)},get:function(){return this._.mix}}});d.process=function(b){var e=this._;this.tickID!==
b&&(this.tickID=b,g.inputSignalAR(this),e.bypassed||e.chorus.process(this.cells[1],this.cells[2]),g.outputSignalAR(this));return this};g.register("chorus",h)})(timbre);
(function(i){function h(d){i.Object.call(this,2,d);d=this._;d.min=-0.8;d.max=0.8}var g=i.fn;g.extend(h);var j=h.prototype;Object.defineProperties(j,{minmax:{set:function(d){var b=this._;"number"===typeof d&&(b.min=-Math.abs(d),b.max=-b.min)},get:function(){return this._.max}},min:{set:function(d){var b=this._;"number"===typeof d&&(b.max<d?b.max=d:b.min=d)},get:function(){return this._.min}},max:{set:function(d){var b=this._;"number"===typeof d&&(d<b.min?b.min=d:b.max=d)},get:function(){return this._.max}}});
j.process=function(d){var b=this._;if(this.tickID!==d){this.tickID=d;var d=this.cells[1],e=this.cells[2],c=d.length,a=b.min,f=b.max,k;if(b.ar){g.inputSignalAR(this);for(b=0;b<c;++b)k=d[b],k<a?k=a:k>f&&(k=f),d[b]=k,k=e[b],k<a?k=a:k>f&&(k=f),e[b]=k;g.outputSignalAR(this)}else k=g.inputSignalKR(this),k<a?k=a:k>f&&(k=f),this.cells[0][0]=k,g.outputSignalKR(this)}return this};g.register("clip",h)})(timbre);
(function(i){function h(b){i.Object.call(this,2,b);g.fixAR(this);b=this._;b.prevThresh=-24;b.prevKnee=0;b.prevRatio=12;b.thresh=i(b.prevThresh);b.knee=0;b.ratio=i(b.prevRatio);b.comp=new j(b.samplerate);b.comp.setParams(b.prevThresh,b.prevKnee,b.prevRatio)}var g=i.fn,j=i.modules.Compressor;g.extend(h);var d=h.prototype;Object.defineProperties(d,{thresh:{set:function(b){this._.thresh=i(b)},get:function(){return this._.thresh}},knee:{set:function(b){this._.kne=i(b)},get:function(){return this._.knee}},
ratio:{set:function(b){this._.ratio=i(b)},get:function(){return this._.ratio}}});d.process=function(b){var e=this._;if(this.tickID!==b){this.tickID=b;g.inputSignalAR(this);var c=e.thresh.process(b).cells[0][0],b=e.ratio.process(b).cells[0][0];if(e.prevThresh!==c||0!==e.prevKnee||e.prevRatio!==b)e.prevThresh=c,e.prevKnee=0,e.prevRatio=b,e.comp.setParams(c,0,b);e.bypassed||e.comp.process(this.cells[1],this.cells[2]);g.outputSignalAR(this)}return this};g.register("comp",h)})(timbre);
(function(i){function h(b){i.Object.call(this,2,b);g.fixAR(this);b=this._;b.time=i(100);b.fb=i(0.2);b.cross=i(!1);b.mix=0.33;b.delay=new d(b.samplerate)}var g=i.fn,j=i.timevalue,d=i.modules.StereoDelay;g.extend(h);var b=h.prototype;Object.defineProperties(b,{time:{set:function(b){"string"===typeof b&&(b=j(b));this._.time=i(b)},get:function(){return this._.time}},fb:{set:function(b){this._.fb=i(b)},get:function(){return this._.fb}},cross:{set:function(b){this._.cross=i(b)},get:function(){return this._.cross}},
mix:{set:function(b){"number"===typeof b&&(this._.mix=1<b?1:0>b?0:b)},get:function(){return this._.mix}}});b.process=function(b){var c=this._;if(this.tickID!==b){this.tickID=b;var a=c.time.process(b).cells[0][0],f=c.fb.process(b).cells[0][0],b=0!==c.cross.process(b).cells[0][0],d=c.mix;if(c.prevTime!==a||c.prevFb!==f||c.prevCross!==b||c.prevMix!==d)c.prevTime=a,c.prevFb=f,c.prevCross=b,c.prevMix=d,c.delay.setParams(a,f,b,d);g.inputSignalAR(this);c.bypassed||c.delay.process(this.cells[1],this.cells[2]);
g.outputSignalAR(this)}return this};g.register("delay",h)})(timbre);
(function(i){function h(d){i.Object.call(this,2,d);g.fixAR(this);d=this._;d.pre=i(60);d.post=i(-18);d.x1L=d.x2L=d.y1L=d.y2L=0;d.x1R=d.x2R=d.y1R=d.y2R=0;d.b0=d.b1=d.b2=d.a1=d.a2=0;d.cutoff=0;d.Q=1;d.preScale=0;d.postScale=0}var g=i.fn;g.extend(h);var j=h.prototype;Object.defineProperties(j,{cutoff:{set:function(d){"number"===typeof d&&0<d&&(this._.cutoff=d)},get:function(){return this._.cutoff}},pre:{set:function(d){this._.pre=i(d)},get:function(){return this._.pre}},post:{set:function(d){this._.post=
i(d)},get:function(){return this._.post}}});j.process=function(d){var b=this._;if(this.tickID!==d){this.tickID=d;g.inputSignalAR(this);var e=-b.pre.process(d).cells[0][0],d=-b.post.process(d).cells[0][0];if(b.prevPreGain!==e||b.prevPostGain!==d)b.prevPreGain=e,b.prevPostGain=d,b.preScale=Math.pow(10,0.05*-e),b.postScale=Math.pow(10,0.05*-d);if(!b.bypassed){var e=this.cells[1],d=this.cells[2],c=b.preScale,a=b.postScale,f,k,h,l,m;if(b.cutoff){b.prevCutoff!==b.cutoff&&(b.prevCutoff=b.cutoff,k=2*Math.PI*
b.cutoff/b.samplerate,f=Math.cos(k),k=Math.sin(k)/(2*b.Q),h=1/(1+k),b.b0=0.5*(1-f)*h,b.b1=1-f*h,b.b2=0.5*(1-f)*h,b.a1=-2*f*h,b.a2=1-k*h);var i=b.x1L,j=b.x2L,p=b.y1L,q=b.y2L,r=b.x1R,t=b.x2R,v=b.y1R,x=b.y2R,u=b.b0,w=b.b1,z=b.b2,y=b.a1,A=b.a2;f=0;for(k=e.length;f<k;++f)l=e[f]*c,m=u*l+w*i+z*j-y*p-A*q,h=m*a,-1>h?h=-1:1<h&&(h=1),e[f]=h,j=i,i=l,q=p,p=m,l=d[f]*c,m=u*l+w*r+z*t-y*v-A*x,h=m*a,-1>h?h=-1:1<h&&(h=1),d[f]=h,t=r,r=l,x=v,v=m;b.x1L=i;b.x2L=j;b.y1L=p;b.y2L=q;b.x1R=r;b.x2R=t;b.y1R=v;b.y2R=x}else{f=0;
for(k=e.length;f<k;++f)h=e[f]*c*a,-1>h?h=-1:1<h&&(h=1),e[f]=h,h=d[f]*c*a,-1>h?h=-1:1<h&&(h=1),d[f]=h}}g.outputSignalAR(this)}return this};g.register("dist",h)})(timbre);
(function(i){function h(g){i.Object.call(this,2,g);this._.ar=!1}var g=i.fn;g.extend(h);h.prototype.process=function(h){var d=this._;if(this.tickID!==h){this.tickID=h;var b=this.nodes,e=this.cells[0],c=this.cells[1],a=this.cells[2],f,k=b.length,i=e.length,l,m;if(d.ar){if(0<b.length){b[0].process(h);l=b[0].cells[1];m=b[0].cells[2];c.set(l);a.set(m);for(f=1;f<k;++f){b[f].process(h);l=b[f].cells[1];m=b[f].cells[2];for(e=0;e<i;++e)d=l[e],c[e]=0===d?0:c[e]/d,d=m[e],a[e]=0===d?0:a[e]/d}}else for(e=0;e<i;++e)c[e]=
a[f]=0;g.outputSignalAR(this)}else{if(0<b.length){c=b[0].process(h).cells[0][0];for(f=1;f<k;++f)d=b[f].process(h).cells[0][0],c=0===d?0:c/d}else c=0;e[0]=c;g.outputSignalKR(this)}}return this};g.register("/",h)})(timbre);
(function(i){function h(f){i.Object.call(this,2,f);f=this._;f.env=new b(f.samplerate);f.env.setStep(f.cellsize);f.tmp=new j.SignalArray(f.cellsize);f.ar=!1;f.plotFlush=!0;f.onended=a(this);this.on("ar",c)}function g(a,b,c,f,e,d){"number"===typeof a[f]?c=a[f]:"number"===typeof a[e]?c=a[e]:d&&("string"===typeof a[f]?c=d(a[f]):"string"===typeof a[e]&&(c=d(a[e])));c<b&&(c=b);return c}var j=i.fn,d=i.timevalue,b=i.modules.Envelope,e=j.isDictionary;j.extend(h);var c=function(a){this._.env.setStep(a?1:this._.cellsize)},
a=function(a){return function(){a._.emit("ended")}},f=h.prototype;Object.defineProperties(f,{table:{set:function(a){if(Array.isArray(a)){for(var c=this._.env,f=[a[0]||n],e,g,k,h,i=1,j=a.length;i<j;++i)e=a[i][0]||n,g=a[i][1],k=a[i][2],"number"!==typeof g&&(g="string"===typeof g?d(g):10),10>g&&(g=10),"number"===typeof k?(h=k,k=b.CurveTypeCurve):(k=b.CurveTypeDict[k]||null,h=0),f.push([e,g,k,h]);c.setTable(f);this._.plotFlush=!0}},get:function(){return this._.env.table}},curve:{set:function(a){this._.env.setCurve(a)},
get:function(){return this._.env.curve}},releaseNode:{set:function(a){this._.env.setReleaseNode(a);this._.plotFlush=!0},get:function(){return this._.env.releaseNode+1}},loopNode:{set:function(a){this._.env.setLoopNode(a);this._.plotFlush=!0},get:function(){return this._.env.loopNode+1}}});f.clone=function(){var a=new h([]);a._.env=this._.env.clone();a._.ar=this._.ar;return a};f.reset=function(){this._.env.reset();return this};f.release=function(){var a=this._;a.env.release();a.emit("released");return this};
f.bang=function(){var a=this._;a.env.reset();a.env.status=b.StatusGate;a.emit("bang");return this};f.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;var a=this.cells[1],c=this.cells[2],f,e=b.cellsize;if(this.nodes.length)j.inputSignalAR(this);else for(f=0;f<e;++f)a[f]=c[f]=1;var d;f=null;if(b.ar){d=b.tmp;b.env.process(d);for(f=0;f<e;++f)a[f]*=d[f],c[f]*=d[f]}else{d=b.env.next();for(f=0;f<e;++f)a[f]*=d,c[f]*=d}f=b.env.emit;j.outputSignalAR(this);f&&("ended"===f?j.nextTick(b.onended):
this._.emit(f,b.value))}return this};var k=i.Object.prototype.plot;f.plot=function(a){if(this._.plotFlush){var c=this._.env.clone(),f=c.getInfo(1E3),e=f.totalDuration,d=f.loopBeginTime,g=f.releaseBeginTime,f=new Float32Array(256),h=0,i=e/f.length,j=!1,n=0.001*e*this._.samplerate|0,u,n=n/f.length;c.setStep(n);c.status=b.StatusGate;n=0;for(u=f.length;n<u;++n)f[n]=c.next(),h+=i,!j&&h>=g&&(c.release(),j=!0);this._.plotData=f;this._.plotBefore=function(a,b,c,f,k){var h;Infinity!==d&&Infinity!==g&&(c=b+
f*(d/e),h=b+f*(g/e),a.fillStyle="rgba(224, 224, 224, 0.8)",a.fillRect(c,0,h-c,k));Infinity!==g&&(c=b+f*(g/e),a.fillStyle="rgba(212, 212, 212, 0.8)",a.fillRect(c,0,f-c,k))};c=Infinity;h=-Infinity;for(n=0;n<u;++n)f[n]<c?c=f[n]:f[n]>h&&(h=f[n]);1>h&&(h=1);this._.plotRange=[c,h];this._.plotData=f;this._.plotFlush=null}return k.call(this,a)};j.register("env",h);var n=b.ZERO;j.register("perc",function(a){e(a[0])||a.unshift({});var b=a[0],c=g(b,10,10,"a","attackTime",d),f=g(b,10,1E3,"r","decayTime",d),k=
g(b,n,1,"lv","level");b.table=[n,[k,c],[n,f]];return new h(a)});j.register("adsr",function(a){e(a[0])||a.unshift({});var b=a[0],c=g(b,10,10,"a","attackTime",d),f=g(b,10,300,"d","decayTime",d),k=g(b,n,0.5,"s","sustainLevel"),i=g(b,10,1E3,"r","decayTime",d),j=g(b,n,1,"lv","level");b.table=[n,[j,c],[k,f],[n,i]];b.releaseNode=3;return new h(a)});j.register("adshr",function(a){e(a[0])||a.unshift({});var b=a[0],c=g(b,10,10,"a","attackTime",d),f=g(b,10,300,"d","decayTime",d),k=g(b,n,0.5,"s","sustainLevel"),
i=g(b,10,500,"h","holdTime",d),j=g(b,10,1E3,"r","decayTime",d),t=g(b,n,1,"lv","level");b.table=[n,[t,c],[k,f],[k,i],[n,j]];return new h(a)});j.register("asr",function(a){e(a[0])||a.unshift({});var b=a[0],c=g(b,10,10,"a","attackTime",d),f=g(b,n,0.5,"s","sustainLevel"),k=g(b,10,1E3,"r","releaseTime",d);b.table=[n,[f,c],[n,k]];b.releaseNode=2;return new h(a)});j.register("dadsr",function(a){e(a[0])||a.unshift({});var b=a[0],c=g(b,10,100,"dl","delayTime",d),f=g(b,10,10,"a","attackTime",d),k=g(b,10,300,
"d","decayTime",d),i=g(b,n,0.5,"s","sustainLevel"),j=g(b,10,1E3,"r","relaseTime",d),t=g(b,n,1,"lv","level");b.table=[n,[n,c],[t,f],[i,k],[n,j]];b.releaseNode=4;return new h(a)});j.register("ahdsfr",function(a){e(a[0])||a.unshift({});var b=a[0],c=g(b,10,10,"a","attackTime",d),f=g(b,10,10,"h","holdTime",d),k=g(b,10,300,"d","decayTime",d),i=g(b,n,0.5,"s","sustainLevel"),j=g(b,10,5E3,"f","fadeTime",d),t=g(b,10,1E3,"r","relaseTime",d),v=g(b,n,1,"lv","level");b.table=[n,[v,c],[v,f],[i,k],[n,j],[n,t]];b.releaseNode=
5;return new h(a)});j.register("linen",function(a){e(a[0])||a.unshift({});var b=a[0],c=g(b,10,10,"a","attackTime",d),f=g(b,10,1E3,"s","sustainTime",d),k=g(b,10,1E3,"r","releaseTime",d),i=g(b,n,1,"lv","level");b.table=[n,[i,c],[i,f],[n,k]];return new h(a)});j.register("env.tri",function(a){e(a[0])||a.unshift({});var b=a[0],c=g(b,20,1E3,"dur","duration",d),f=g(b,n,1,"lv","level"),c=0.5*c;b.table=[n,[f,c],[n,c]];return new h(a)});j.register("env.cutoff",function(a){e(a[0])||a.unshift({});var b=a[0],
c=g(b,10,100,"r","relaseTime",d),f=g(b,n,1,"lv","level");b.table=[f,[n,c]];return new h(a)})})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);g.fixAR(this);a=this._;a.biquads=Array(7);a.plotBefore=e;a.plotRange=[-18,18];a.plotFlush=!0}var g=i.fn,j=i.modules.FFT,d=i.modules.Biquad,b={hpf:0,lf:1,lmf:2,mf:3,hmf:4,hf:5,lpf:6};g.extend(h);var e=function(a,b,c,f,e){a.lineWidth=1;a.strokeStyle="rgb(192, 192, 192)";for(var d=0.5*this._.samplerate,g=1;10>=g;++g)for(var h=1;4>=h;h++){var i=g*Math.pow(10,h);20>=i||d<=i||(a.beginPath(),i=Math.log(i/20)/Math.log(d/20),i=(i*f+b|0)+0.5,a.moveTo(i,c),
a.lineTo(i,c+e),a.stroke())}e/=6;for(g=1;6>g;g++)a.beginPath(),d=(c+g*e|0)+0.5,a.moveTo(b,d),a.lineTo(b+f,d),a.stroke()},c=h.prototype;Object.defineProperties(c,{params:{set:function(a){if("object"===typeof a)for(var b=Object.keys(a),c=0,f=b.length;c<f;++c){var e=a[b[c]];Array.isArray(e)?this.setParams(b[c],e[0],e[1],e[2]):this.setParams(b[c])}}}});c.setParams=function(a,c,f,e){var g=this._;"string"===typeof a&&(a=b[a]);if(0<=a&&a<g.biquads.length){a|=0;if("number"===typeof c&&"number"===typeof f){"number"!==
typeof e&&(e=0);var h=g.biquads[a];if(!h)switch(h=g.biquads[a]=new d(g.samplerate),a){case 0:h.setType("highpass");break;case g.biquads.length-1:h.setType("lowpass");break;default:h.setType("peaking")}h.setParams(c,f,e)}else g.biquads[a]=void 0;g.plotFlush=!0}return this};c.getParams=function(a){if(a=this._.biquads[a|0])return{freq:a.frequency,Q:a.Q,gain:a.gain}};c.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;g.inputSignalAR(this);if(!b.bypassed)for(var a=this.cells[1],c=this.cells[2],
b=b.biquads,f=0,e=b.length;f<e;++f)b[f]&&b[f].process(a,c);g.outputSignalAR(this)}return this};var a=new j(2048),f=i.Object.prototype.plot;c.plot=function(b){if(this._.plotFlush){var c=this._,e=new Float32Array(a.length);e[0]=1;for(var g=0,h=c.biquads.length;g<h;++g){var i=this.getParams(g);if(i){var j=new d(c.samplerate);0===g?j.setType("highpass"):g===h-1?j.setType("lowpass"):j.setType("peaking");j.setParams(i.freq,i.Q,i.gain);j.process(e,e)}}a.forward(e);var e=new Float32Array(512),c=0.5*c.samplerate,
h=new Float32Array(512),q;a.getFrequencyData(h);for(g=0;512>g;++g)i=20*Math.pow(c/20,g/512),j=i/(c/h.length),i=j|0,j-=i,0===i?i=h[i]:(q=h[i-1],i=h[i],i=(1-j)*q+j*i),e[g]=i;this._.plotData=e;this._.plotFlush=null}return f.call(this,b)};g.register("eq",h)})(timbre);
(function(i){function h(b){i.Object.call(this,2,b);g.listener(this);g.fixAR(this);this.real=new i.ChannelObject(this);this.imag=new i.ChannelObject(this);this.cells[3]=this.real.cell;this.cells[4]=this.imag.cell;b=this._;b.fft=new j(2*b.cellsize);b.fftCell=new g.SignalArray(b.fft.length);b.prevCell=new g.SignalArray(b.cellsize);b.freqs=new g.SignalArray(b.fft.length>>1);b.plotFlush=!0;b.plotRange=[0,32];b.plotBarStyle=!0}var g=i.fn,j=i.modules.FFT;g.extend(h);var d=h.prototype;Object.defineProperties(d,
{window:{set:function(b){this._.fft.setWindow(b)},get:function(){return this._.fft.windowName}},spectrum:{get:function(){return this._.fft.getFrequencyData(this._.freqs)}}});d.process=function(b){var c=this._;if(this.tickID!==b){this.tickID=b;g.inputSignalAR(this);g.outputSignalAR(this);var b=this.cells[0],a=c.cellsize;c.fftCell.set(c.prevCell);c.fftCell.set(b,a);c.fft.forward(c.fftCell);c.prevCell.set(b);c.plotFlush=!0;this.cells[3].set(c.fft.real.subarray(0,a));this.cells[4].set(c.fft.imag.subarray(0,
a))}return this};var b=i.Object.prototype.plot;d.plot=function(e){this._.plotFlush&&(this._.plotData=this.spectrum,this._.plotFlush=null);return b.call(this,e)};g.register("fft",h)})(timbre);
(function(i){function h(d){i.Object.call(this,1,d);g.fixAR(this);d=this._;d.freq=i(440);d.reg=32768;d.shortFlag=!1;d.phase=0;d.lastValue=0}var g=i.fn;g.extend(h);var j=h.prototype;Object.defineProperties(j,{shortFlag:{set:function(d){this._.shortFlag=!!d},get:function(){return this._.shortFlag}},freq:{set:function(d){this._.freq=i(d)},get:function(){return this._.freq}}});j.process=function(d){var b=this._,e=this.cells[0];if(this.tickID!==d){this.tickID=d;var c=b.lastValue,a=b.phase,d=b.freq.process(d).cells[0][0]/
b.samplerate,f=b.reg,g=b.mul,h=b.add,i,j;if(b.shortFlag){i=0;for(j=e.length;i<j;++i)1<=a&&(f>>=1,f|=((f^f>>6)&1)<<15,c=(f&1)-0.5,a-=1),e[i]=c*g+h,a+=d}else{i=0;for(j=e.length;i<j;++i)1<=a&&(f>>=1,f|=((f^f>>1)&1)<<15,c=(f&1)-0.5,a-=1),e[i]=c*g+h,a+=d}b.reg=f;b.phase=a;b.lastValue=c}return this};g.register("fnoise",h)})(timbre);
(function(i){function h(b){i.Object.call(this,2,b);g.fixAR(this);this._.selected=0;this._.outputs=[]}var g=i.fn,j=function(){function b(b){i.Object.call(this,2,[]);g.fixAR(this);this._.parent=b}g.extend(b);b.prototype.process=function(b){this.tickID!==b&&(this.tickID=b,this._.parent.process(b));return this};return b}();g.extend(h);var d=h.prototype;Object.defineProperties(d,{selected:{set:function(b){var e=this._;if("number"===typeof b){e.selected=b;for(var b=e.outputs,e=0,c=b.length;e<c;++e)b[e]&&
(b[e].cells[0].set(g.emptycell),b[e].cells[1].set(g.emptycell),b[e].cells[2].set(g.emptycell))}},get:function(){return this._.selected}}});d.at=function(b){var e=this._,c=e.outputs[b];c||(e.outputs[b]=c=new j(this));return c};d.process=function(b){var e=this._;if(this.tickID!==b&&(this.tickID=b,g.inputSignalAR(this),g.outputSignalAR(this),b=e.outputs[e.selected]))b.cells[0].set(this.cells[0]),b.cells[1].set(this.cells[1]),b.cells[2].set(this.cells[2]);return this};g.register("gate",h)})(timbre);
(function(i){function h(b){i.Object.call(this,1,b);g.fixAR(this);b=this._;b.fft=new j(2*b.cellsize);b.fftCell=new g.SignalArray(this._.fft.length);b.realBuffer=new g.SignalArray(this._.fft.length);b.imagBuffer=new g.SignalArray(this._.fft.length)}var g=i.fn,j=i.modules.FFT;g.extend(h);var d=h.prototype;Object.defineProperties(d,{real:{set:function(b){this._.real=i(b)},get:function(){return this._.real}},imag:{set:function(b){this._.imag=i(b)},get:function(){return this._.imag}}});d.process=function(b){var e=
this._;if(this.tickID!==b&&(this.tickID=b,e.real&&e.imag)){var c=this.cells[0],a=e.realBuffer,f=e.imagBuffer,d=e.real.process(b).cells[0],b=e.imag.process(b).cells[0];a.set(d);f.set(b);c.set(e.fft.inverse(a,f).subarray(0,e.cellsize));g.outputSignalAR(this)}return this};g.register("ifft",h)})(timbre);
(function(i){function h(b){i.Object.call(this,1,b);g.timer(this);g.fixKR(this);b=this._;b.interval=i(1E3);b.count=0;b.delay=0;b.timeout=Infinity;b.currentTime=0;b.delaySamples=0;b.countSamples=0;b.onended=g.make_onended(this);this.on("start",d)}var g=i.fn,j=i.timevalue;g.extend(h);var d=function(){var b=this._;this.playbackState=g.PLAYING_STATE;b.delaySamples=b.samplerate*0.001*b.delay|0;b.countSamples=b.count=b.currentTime=0};Object.defineProperty(d,"unremovable",{value:!0,writable:!1});var b=h.prototype;
Object.defineProperties(b,{interval:{set:function(b){"string"===typeof b&&(b=j(b),0>=b&&(b=0));this._.interval=i(b)},get:function(){return this._.interval}},delay:{set:function(b){"string"===typeof b&&(b=j(b));"number"===typeof b&&0<=b&&(this._.delay=b,this._.delaySamples=this._.samplerate*0.001*b|0)},get:function(){return this._.delay}},count:{set:function(b){"number"===typeof b&&(this._.count=b)},get:function(){return this._.count}},timeout:{set:function(b){"string"===typeof b&&(b=j(b));"number"===
typeof b&&0<=b&&(this._.timeout=b)},get:function(){return this._.timeout}},currentTime:{get:function(){return this._.currentTime}}});b.bang=function(){var b=this._;this.playbackState=g.PLAYING_STATE;b.delaySamples=b.samplerate*0.001*b.delay|0;b.countSamples=b.count=b.currentTime=0;b.emit("bang");return this};b.process=function(b){var c=this.cells[0],a=this._;if(this.tickID!==b){this.tickID=b;0<a.delaySamples&&(a.delaySamples-=c.length);b=a.interval.process(b).cells[0][0];if(0>=a.delaySamples&&(a.countSamples-=
c.length,0>=a.countSamples)){a.countSamples+=0.001*a.samplerate*b|0;for(var b=this.nodes,f=a.count,d=f*a.mul+a.add,h=0,i=c.length;h<i;++h)c[h]=d;c=0;for(d=b.length;c<d;++c)b[c].bang(f);a.count+=1}a.currentTime+=g.currentTimeIncr;a.currentTime>=a.timeout&&g.nextTick(a.onended)}return this};g.register("interval",h)})(timbre);
(function(i){function h(b){i.Object.call(this,1,b);g.fixAR(this);var b=this._,e=Math.ceil(Math.log(b.samplerate)*Math.LOG2E);b.buffersize=1<<e;b.buffermask=b.buffersize-1;b.buffer=new g.SignalArray(b.buffersize);b.time=0;b.readIndex=0;b.writeIndex=0}var g=i.fn,j=i.timevalue;g.extend(h);var d=h.prototype;Object.defineProperties(d,{time:{set:function(b){"string"===typeof b&&(b=j(b));if("number"===typeof b&&0<b){var e=this._;e.time=b;b=0.001*b*e.samplerate|0;b>e.buffermask&&(b=e.buffermask);e.writeIndex=
e.readIndex+b&e.buffermask}},get:function(){return this._.time}}});d.process=function(b){var e=this._;if(this.tickID!==b){this.tickID=b;g.inputSignalAR(this);var b=this.cells[0],c=e.buffer,a=e.buffermask,f=e.readIndex,d=e.writeIndex,h,i=b.length;for(h=0;h<i;++h)c[d]=b[h],b[h]=c[f],f+=1,d=d+1&a;e.readIndex=f&a;e.writeIndex=d;g.outputSignalAR(this)}return this};g.register("lag",h)})(timbre);
(function(i){function h(b){i.Object.call(this,1,b);b=this._;b.input=0;b.value=0;b.prev=null;b.ar=!1;b.map=j}var g=i.fn;g.extend(h);var j=function(b){return b},d=h.prototype;Object.defineProperties(d,{input:{set:function(b){"number"===typeof b&&(this._.input=b)},get:function(){return this._.input}},map:{set:function(b){"function"===typeof b&&(this._.map=b)},get:function(){return this._.map}}});d.bang=function(){this._.prev=null;this._.emit("bang");return this};d.at=function(b){return this._.map?this._.map(b):
0};d.process=function(b){var e=this.cells[0],c=this._;if(this.tickID!==b){this.tickID=b;var a=this.nodes.length,b=e.length;if(c.ar&&a){g.inputSignalAR(this);var f=c.map;if(f)for(a=0;a<b;++a)e[a]=f(e[a]);c.value=e[b-1];g.outputSignalAR(this)}else{a=a?g.inputSignalKR(this):c.input;c.map&&c.prev!==a&&(c.prev=a,c.value=c.map(a));c=c.value*c.mul+c.add;for(a=0;a<b;++a)e[a]=c}}return this};g.register("map",h)})(timbre);
(function(i){function h(g){i.Object.call(this,1,g)}var g=i.fn;g.extend(h);h.prototype.process=function(h){var d=this.cells[0],b=this._;if(this.tickID!==h){this.tickID=h;var e=this.nodes,c=e.length,a,f=d.length,k,i;if(b.ar){if(0<e.length){k=e[0].process(h).cells[0];d.set(k);for(b=1;b<c;++b){k=e[b].process(h).cells[0];for(a=0;a<f;++a)i=k[a],d[a]<i&&(d[a]=i)}}else for(a=0;a<f;++a)d[a]=0;g.outputSignalAR(this)}else{if(0<e.length){k=e[0].process(h).cells[0][0];for(b=1;b<c;++b)i=e[b].process(h).cells[0][0],
k<i&&(k=i)}else k=0;d[0]=k;g.outputSignalKR(this)}}return this};g.register("max",h)})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);g.fixAR(this);a=this._;a.src=a.func=null;a.bufferL=new g.SignalArray(j);a.bufferR=new g.SignalArray(j);a.readIndex=0;a.writeIndex=0;a.totalRead=0;a.totalWrite=0}if("browser"===i.envtype){var g=i.fn,j=4096,d=j-1;g.extend(h);var b=h.prototype;b.listen=function(a){var b=e[i.env];b&&(b.set.call(this,a),b.listen.call(this))};b.unlisten=function(){var a=e[i.env];a&&a.unlisten.call(this);this.cells[0].set(g.emptycell);this.cells[1].set(g.emptycell);this.cells[2].set(g.emptycell);
for(var b=this._,a=b.bufferL,b=b.bufferR,c=0,d=a.length;c<d;++c)a[c]=b[c]=0};b.process=function(a){var b=this._;if(null===b.src)return this;if(this.tickID!==a){this.tickID=a;a=b.cellsize;if(b.totalWrite>b.totalRead+a){var c=b.readIndex,e=c+a;this.cells[1].set(b.bufferL.subarray(c,e));this.cells[2].set(b.bufferR.subarray(c,e));b.readIndex=e&d;b.totalRead+=a}g.outputSignalAR(this)}return this};var e={webkit:{set:function(a){var b=this._;a instanceof HTMLMediaElement&&(b.src=g._audioContext.createMediaElementSource(a))},
listen:function(){var a=this._,b=g._audioContext;a.gain=b.createGainNode();a.gain.gain.value=0;a.node=b.createJavaScriptNode(1024,2,2);a.node.onaudioprocess=c(this);a.src.connect(a.node);a.node.connect(a.gain);a.gain.connect(b.destination)},unlisten:function(){var a=this._;a.src&&a.src.disconnect();a.gain&&a.gain.disconnect();a.node&&a.node.disconnect()}}},c=function(a){return function(b){var c=a._,b=b.inputBuffer,e=b.length,g=c.writeIndex;c.bufferL.set(b.getChannelData(0),g);c.bufferR.set(b.getChannelData(1),
g);c.writeIndex=g+e&d;c.totalWrite+=e}};e.moz={set:function(a){var b=this._;a instanceof HTMLAudioElement&&(b.src=a,b.istep=b.samplerate/a.mozSampleRate)},listen:function(){var a=this._,b=a.bufferL,c=a.bufferR,e=0,g=0;2===a.src.mozChannels?(a.x=0,a.func=function(h){var i=a.writeIndex,j=a.totalWrite,h=h.frameBuffer,p,q=a.istep,r,t=h.length;p=a.x;for(r=0;r<t;r+=2){for(p+=q;0<p;)b[i]=0.5*(h[r]+e),c[i]=0.5*(h[r+1]+g),i=i+1&d,++j,p-=1;e=h[r];g=h[r+1]}a.x=p;a.writeIndex=i;a.totalWrite=j}):(a.x=0,a.func=
function(g){var h=a.writeIndex,i=a.totalWrite,g=g.frameBuffer,j,l=a.istep,r,t=g.length;j=a.x;for(r=0;r<t;++r){for(j+=l;0<=j;)b[h]=c[h]=0.5*(g[r]+e),h=h+1&d,++i,j-=1;e=g[r]}a.x=j;a.writeIndex=h;a.totalWrite=i});a.src.addEventListener("MozAudioAvailable",a.func)},unlisten:function(){var a=this._;a.func&&(a.src.removeEventListener("MozAudioAvailable",a.func),a.func=null)}};g.register("mediastream",h)}})(timbre);
(function(i){function h(d){i.Object.call(this,1,d);d=this._;d.midi=0;d.value=0;d.prev=null;d.a4=440;d.ar=!1}var g=i.fn;g.extend(h);var j=h.prototype;Object.defineProperties(j,{midi:{set:function(d){"number"===typeof d&&(this._.midi=d)},get:function(){return this._.midi}},a4:{set:function(d){"number"===typeof d&&(this._.a4=d,this._.prev=null)},get:function(){return this._.a4}}});j.bang=function(){this._.prev=null;this._.emit("bang");return this};j.at=function(d){return this._.a4*Math.pow(2,(d-69)/
12)};j.process=function(d){var b=this._;if(this.tickID!==d){this.tickID=d;var d=this.cells[0],e=this.nodes.length,c=d.length;if(b.ar&&e){g.inputSignalAR(this);for(var a=b.a4,e=0;e<c;++e)d[e]=a*Math.pow(2,(d[e]-69)/12);b.value=d[c-1];g.outputSignalAR(this)}else c=e?g.inputSignalKR(this):b.midi,b.prev!==c&&(b.prev=c,b.value=b.a4*Math.pow(2,(c-69)/12)),d[0]=b.value,g.outputSignalKR(this)}return this};g.register("midicps",h)})(timbre);
(function(i){function h(d){i.Object.call(this,1,d);d=this._;d.midi=0;d.value=0;d.prev=null;d.range=12;d.ar=!1}var g=i.fn;g.extend(h);var j=h.prototype;Object.defineProperties(j,{midi:{set:function(d){"number"===typeof d&&(this._.midi=d)},get:function(){return this._.midi}},range:{set:function(d){"number"===typeof d&&0<d&&(this._.range=d)},get:function(){return this._.range}}});j.bang=function(){this._.prev=null;this._.emit("bang");return this};j.at=function(d){return Math.pow(2,d/this._.range)};j.process=
function(d){var b=this.cells[0],e=this._;if(this.tickID!==d){this.tickID=d;var c=this.nodes.length,d=b.length;if(e.ar&&c){g.inputSignalAR(this);for(var a=e.range,c=0;c<d;++c)b[c]=Math.pow(2,b[c]/a);e.value=b[d-1];g.outputSignalAR(this)}else{c=this.nodes.length?g.inputSignalKR(this):e.midi;e.prev!==c&&(e.prev=c,e.value=Math.pow(2,c/e.range));e=e.value*e.mul+e.add;for(c=0;c<d;++c)b[c]=e}}return this};g.register("midiratio",h)})(timbre);
(function(i){function h(g){i.Object.call(this,1,g)}var g=i.fn;g.extend(h);h.prototype.process=function(h){var d=this.cells[0],b=this._;if(this.tickID!==h){this.tickID=h;var e=this.nodes,c=e.length,a,f=d.length,k,i;if(b.ar){if(0<e.length){k=e[0].process(h).cells[0];d.set(k);for(b=1;b<c;++b){k=e[b].process(h).cells[0];for(a=0;a<f;++a)i=k[a],d[a]>i&&(d[a]=i)}}else for(a=0;a<f;++a)d[a]=0;g.outputSignalAR(this)}else{if(0<e.length){k=e[0].process(h).cells[0][0];for(b=1;b<c;++b)i=e[b].process(h).cells[0][0],
k>i&&(k=i)}else k=0;d[0]=k;g.outputSignalKR(this)}}return this};g.register("min",h)})(timbre);
(function(i){function h(a){i.Object.call(this,0,a);g.timer(this);g.fixKR(this);a=this._;a.mml="";a.status={t:120,l:4,o:4,v:12,q:6,dot:0,tie:!1};a.commands=[];a.index=0;a.queue=[];a.currentTime=0;a.queueTime=0;a.segnoIndex=-1;a.loopStack=[];a.prevNote=0;a.remain=Infinity;a.onended=g.make_onended(this);this.on("start",j)}var g=i.fn;g.extend(h);var j=function(){var a=this._;this.playbackState=g.PLAYING_STATE;a.commands=e(a.mml);a.index=0;a.queue=[];a.currentTime=0;a.queueTime=0;a.segnoIndex=-1;a.loopStack=
[];a.prevNote=0;a.remain=Infinity;b(this)};Object.defineProperty(j,"unremoved",{value:!0,writable:!1});var d=h.prototype;Object.defineProperties(d,{mml:{set:function(a){var b=this._;"string"===typeof a&&(b.mml=a)},get:function(){return this._.mml}},currentTime:{get:function(){return this._.currentTime}}});d.process=function(a){var c=this._;if(this.tickID!==a){this.tickID=a;var a=this.nodes,e=c.queue,d,h,i;if(e.length)for(;e[0][0]<=c.currentTime;){var j=c.queue.shift();if(j[1]){h=0;for(i=a.length;h<
i;++h)d=a[h],d.noteOn?d.noteOn(j[1],j[3]):d.bang();c.remain=j[4];c.emit("mml","noteOn",{noteNum:j[1],velocity:j[3]});b(this)}else{h=0;for(i=a.length;h<i;++h)d=a[h],d.noteOff?d.noteOff(j[2],j[3]):d.release&&d.release();c.emit("mml","noteOff",{noteNum:j[2],velocity:j[3]})}if(0===e.length)break}c.remain-=g.currentTimeIncr;0===e.length&&0>=c.remain&&g.nextTick(c.onended);c.currentTime+=g.currentTimeIncr}return this};var b=function(a){var a=a._,b,c=a.commands,e=a.queue,d=a.index,g=a.status,h=a.queueTime,
i=a.loopStack,j,q,r,t,v;t=[];a:for(;;){if(c.length<=d)if(0<=a.segnoIndex)d=a.segnoIndex;else break;b=c[d++];switch(b.name){case "n":j=g.t||120;null!==b.len?(q=b.len,r=b.dot||0):(q=g.l,r=b.dot||g.dot);j=1E3*60/j*(4/q);j*=[1,1.5,1.75,1.875][r]||1;r=g.v<<3;if(g.tie){for(b=e.length;b--;)if(e[b][2]){e.splice(b,1);break}b=a.prevNote}else b=a.prevNote=b.val+12*(g.o+1),e.push([h,b,null,r,j]);if(0<q){q=g.q/8;if(1>q){q=h+j*q;e.push([q,null,b,r]);b=0;for(v=t.length;b<v;++b)e.push([q,null,t[b],r])}t=[];h+=j;
if(!g.tie)break a}else t.push(b);g.tie=!1;break;case "r":j=g.t||120;null!==b.len?(q=b.len,r=b.dot||0):(q=g.l,r=b.dot||g.dot);0<q&&(j=1E3*60/j*(4/q),j*=[1,1.5,1.75,1.875][r]||1,h+=j);break;case "l":g.l=b.val;g.dot=b.dot;break;case "o":g.o=b.val;break;case "<":9>g.o&&(g.o+=1);break;case ">":0<g.o&&(g.o-=1);break;case "v":g.v=b.val;break;case "(":15>g.v&&(g.v+=1);break;case ")":0<g.v&&(g.v-=1);break;case "q":g.q=b.val;break;case "&":g.tie=!0;break;case "$":a.segnoIndex=d;break;case "[":i.push([d,null,
null]);break;case "|":if((j=i[i.length-1])&&1===j[1])i.pop(),d=j[2];break;case "]":if(j=i[i.length-1])null===j[1]&&(j[1]=b.count,j[2]=d),j[1]-=1,0===j[1]?i.pop():d=j[0];break;case "t":g.t=null===b.val?120:b.val}}a.index=d;a.queueTime=h},e=function(a){var b,e,d,g,h,i,j,p=Array(a.length),q=[];h=0;for(i=c.length;h<i;++h){b=c[h];for(e=b.re;d=e.exec(a);){if(!p[d.index]){g=0;for(j=d[0].length;g<j;++g)p[d.index+g]=!0;if(g=b.func?b.func(d):{name:d[0]})g.index=d.index,g.origin=d[0],q.push(g)}for(;e.lastIndex<
a.length&&p[e.lastIndex];)++e.lastIndex}}q.sort(function(a,b){return a.index-b.index});return q},c=[{re:/([cdefgab])([\-+]?)(\d*)(\.*)/g,func:function(a){return{name:"n",val:{c:0,d:2,e:4,f:5,g:7,a:9,b:11}[a[1]]+({"-":-1,"+":1}[a[2]]||0),len:""===a[3]?null:Math.min(a[3]|0,64),dot:a[4].length}}},{re:/r(\d*)(\.*)/g,func:function(a){return{name:"r",len:""===a[1]?null:Math.max(1,Math.min(a[1]|0,64)),dot:a[2].length}}},{re:/&/g},{re:/l(\d*)(\.*)/g,func:function(a){return{name:"l",val:""===a[1]?4:Math.min(a[1]|
0,64),dot:a[2].length}}},{re:/o([0-9])/g,func:function(a){return{name:"o",val:""===a[1]?4:a[1]|0}}},{re:/[<>]/g},{re:/v(\d*)/g,func:function(a){return{name:"v",val:""===a[1]?12:Math.min(a[1]|0,15)}}},{re:/[()]/g},{re:/q([0-8])/g,func:function(a){return{name:"q",val:""===a[1]?6:Math.min(a[1]|0,8)}}},{re:/\[/g},{re:/\|/g},{re:/\](\d*)/g,func:function(a){return{name:"]",count:a[1]|0||2}}},{re:/t(\d*)/g,func:function(a){return{name:"t",val:""===a[1]?null:Math.max(5,Math.min(a[1]|0,300))}}},{re:/\$/g}];
g.register("mml",h)})(timbre);
(function(i){function h(g){i.Object.call(this,2,g)}var g=i.fn;g.extend(h);h.prototype.process=function(h){var d=this._;if(this.tickID!==h){this.tickID=h;var b=this.nodes,e=this.cells[0],c=this.cells[1],a=this.cells[2],f=b.length,i=e.length,n,l;if(d.ar){if(0<b.length){b[0].process(h);n=b[0].cells[1];l=b[0].cells[2];c.set(n);a.set(l);for(d=1;d<f;++d){b[d].process(h);n=b[d].cells[1];l=b[d].cells[2];for(e=0;e<i;++e)c[e]*=n[e],a[e]*=l[e]}}else for(e=0;e<i;++e)c[e]=a[e]=0;g.outputSignalAR(this)}else{if(0<
b.length){c=b[0].process(h).cells[0][0];for(d=1;d<f;++d)c*=b[d].process(h).cells[0][0]}else c=0;e[0]=c;g.outputSignalKR(this)}}return this};g.register("*",h)})(timbre);
(function(i){function h(d){i.Object.call(this,1,d);d=this._;d.defaultValue=0;d.index=0;d.dict={};d.ar=!1}var g=i.fn;g.extend(h);var j=h.prototype;Object.defineProperties(j,{dict:{set:function(d){if("object"===typeof d)this._.dict=d;else if("function"===typeof d){for(var b={},e=0;128>e;++e)b[e]=d(e);this._.dict=b}},get:function(){return this._.dict}},defaultValue:{set:function(d){"number"===typeof d&&(this._.defaultValue=d)},get:function(){return this._.defaultValue}},index:{set:function(d){"number"===
typeof d&&(this._.index=d)},get:function(){return this._.index}}});j.at=function(d){var b=this._;return(b.dict[d|0]||b.defaultValue)*b.mul+b.add};j.clear=function(){this._.dict={};return this};j.process=function(d){var b=this.cells[0],e=this._;if(this.tickID!==d){this.tickID=d;var c=this.nodes.length,a;a=e.dict;var f=e.defaultValue,h=e.mul,i=e.add,d=b.length;if(e.ar&&c){g.inputSignalAR(this);for(e=0;e<d;++e)c=b[e],c=0>c?c-0.5|0:c+0.5|0,b[e]=(a[c]||f)*h+i;g.outputSignalAR(this)}else{c=this.nodes.length?
g.inputSignalKR(this):e.index;a=(a[0>c?c-0.5|0:c+0.5|0]||f)*h+i;for(e=0;e<d;++e)b[e]=a}}return this};g.register("ndict",h)})(timbre);(function(i){function h(g){i.Object.call(this,1,g)}var g=i.fn;g.extend(h);h.prototype.process=function(g){var d=this.cells[0],b=this._;if(this.tickID!==g){this.tickID=g;var g=b.mul,e=b.add,c;if(b.ar){b=0;for(c=d.length;b<c;++b)d[b]=(2*Math.random()-1)*g+e}else{g=(2*Math.random()+1)*g+e;b=0;for(c=d.length;b<c;++b)d[b]=g}}return this};g.register("noise",h)})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);a=this._;a.freq=i(440);a.phase=i(0);a.osc=new d(a.samplerate);a.tmp=new g.SignalArray(a.cellsize);a.osc.step=a.cellsize;this.once("init",b)}var g=i.fn,j=i.timevalue,d=i.modules.Oscillator;g.extend(h);var b=function(){var a=this._;this.wave||(this.wave="sin");a.plotData=a.osc.wave;a.plotLineWidth=2;a.plotCyclic=!0;a.plotBefore=c},e=h.prototype;Object.defineProperties(e,{wave:{set:function(a){this._.osc.setWave(a)},get:function(){return this._.osc.wave}},
freq:{set:function(a){"string"===typeof a&&(a=j(a),a=0>=a?0:1E3/a);this._.freq=i(a)},get:function(){return this._.freq}},phase:{set:function(a){this._.phase=i(a);this._.osc.feedback=!1},get:function(){return this._.phase}},fb:{set:function(a){this._.phase=i(a);this._.osc.feedback=!0},get:function(){return this._.phase}}});e.bang=function(){this._.osc.reset();this._.emit("bang");return this};e.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;var c=this.cells[1],e=this.cells[2],d,
h=b.cellsize;if(this.nodes.length)g.inputSignalAR(this);else for(d=0;d<h;++d)c[d]=e[d]=1;d=b.osc;var i=b.freq.process(a).cells[0],j=b.phase.process(a).cells[0];d.frequency=i[0];d.phase=j[0];if(b.ar){a=b.tmp;b.freq.isAr?b.phase.isAr?d.processWithFreqAndPhaseArray(a,i,j):d.processWithFreqArray(a,i):b.phase.isAr?d.processWithPhaseArray(a,j):d.process(a);for(d=0;d<h;++d)c[d]*=a[d],e[d]*=a[d]}else{b=d.next();for(d=0;d<h;++d)c[d]*=b,e[d]*=b}g.outputSignalAR(this)}return this};var c;"browser"===i.envtype&&
(c=function(a,b,c,e,d){d=(d>>1)+0.5;a.strokeStyle="#ccc";a.lineWidth=1;a.beginPath();a.moveTo(b,d+c);a.lineTo(b+e,d+c);a.stroke()});g.register("osc",h);g.register("sin",function(a){return(new h(a)).set("wave","sin")});g.register("cos",function(a){return(new h(a)).set("wave","cos")});g.register("pulse",function(a){return(new h(a)).set("wave","pulse")});g.register("tri",function(a){return(new h(a)).set("wave","tri")});g.register("saw",function(a){return(new h(a)).set("wave","saw")});g.register("fami",
function(a){return(new h(a)).set("wave","fami")});g.register("konami",function(a){return(new h(a)).set("wave","konami")});g.register("+sin",function(a){return(new h(a)).set("wave","+sin").kr()});g.register("+pulse",function(a){return(new h(a)).set("wave","+pulse").kr()});g.register("+tri",function(a){return(new h(a)).set("wave","+tri").kr()});g.register("+saw",function(a){return(new h(a)).set("wave","+saw").kr()});g.alias("square","pulse")})(timbre);
(function(i){function h(b){i.Object.call(this,2,b);g.fixAR(this);b=this._;b.pos=i(0);b.panL=0.7071067811865475;b.panR=0.7071067811865475}var g=i.fn;g.extend(h);var j=function(){for(var b=new Float32Array(257),c=0;256>c;++c)b[c]=Math.sin(0.5*Math.PI*(c/256));b[256]=1;return b}(),d=function(){for(var b=new Float32Array(257),c=0;256>c;++c)b[c]=Math.cos(0.5*Math.PI*(c/256));b[256]=0;return b}(),b=h.prototype;Object.defineProperties(b,{pos:{set:function(b){this._.pos=i(b)},get:function(){return this._.pos}}});
b.process=function(b){var c=this._;if(this.tickID!==b){this.tickID=b;var a=c.pos.process(b).cells[0][0];if(c.prevPos!==a){var f=128*(a+1)|0;c.panL=d[f];c.panR=j[f];c.prevPos=a}var h=this.nodes,a=this.cells[1],f=this.cells[2],i,l=h.length,m,o=a.length,s;if(l){s=h[0].process(b).cells[0];for(m=0;m<o;++m)a[m]=f[m]=s[m];for(i=1;i<l;++i){s=h[i].process(b).cells[0];for(m=0;m<o;++m)a[m]=f[m]+=s[m]}b=c.panL;c=c.panR;for(m=0;m<o;++m)a[m]*=b,f[m]*=c}else a.set(g.emptycell),f.set(g.emptycell);g.outputSignalAR(this)}return this};
g.register("pan",h)})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);a=this._;a.value=0;a.env=new b(a.samplerate);a.env.step=a.cellsize;a.curve="lin";a.counter=0;a.ar=!1;a.onended=g.make_onended(this);this.on("ar",e)}var g=i.fn,j=i.timevalue,d=i.modules.Envelope,b=i.modules.EnvelopeValue;g.extend(h);var e=function(a){this._.env.step=a?1:this._.cellsize},c=h.prototype;Object.defineProperties(c,{value:{set:function(a){"number"===typeof a&&(this._.env.value=a)},get:function(){return this._.env.value}}});c.to=function(a,
b,c){var e=this._,g=e.env;"string"===typeof b?b=j(b):"undefined"===typeof b&&(b=0);if("undefined"===typeof c)e.counter=g.setNext(a,b,d.CurveTypeLin),e.curve="lin";else{var h=d.CurveTypeDict[c];e.counter="undefined"===typeof h?g.setNext(a,b,d.CurveTypeCurve,c):g.setNext(a,b,h);e.curve=c}e.plotFlush=!0;return this};c.setAt=function(a,b){var c=this._;this.to(c.env.value,b,"set");c.atValue=a;return this};c.linTo=function(a,b){return this.to(a,b,"lin")};c.expTo=function(a,b){return this.to(a,b,"exp")};
c.sinTo=function(a,b){return this.to(a,b,"sin")};c.welTo=function(a,b){return this.to(a,b,"wel")};c.sqrTo=function(a,b){return this.to(a,b,"sqr")};c.cubTo=function(a,b){return this.to(a,b,"cub")};c.cancel=function(){var a=this._;a.counter=a.env.setNext(a.env.value,0,d.CurveTypeSet);return this};c.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;var a=this.cells[1],c=this.cells[2],e,h=b.cellsize,i=b.env,j=b.counter,p;if(this.nodes.length)g.inputSignalAR(this);else for(e=0;e<h;++e)a[e]=
c[e]=1;0>=j&&("set"===b.curve?i.setNext(b.atValue,0,d.CurveTypeSet):i.setNext(i.value,0,d.CurveTypeSet),g.nextTick(b.onended),b.counter=Infinity);if(b.ar){for(e=0;e<h;++e)p=i.next(),a[e]*=p,c[e]*=p;b.counter-=b.cellsize}else{p=i.next();for(e=0;e<h;++e)a[e]*=p,c[e]*=p;b.counter-=1}g.outputSignalAR(this);b.value=p}return this};var a=i.Object.prototype.plot;c.plot=function(c){var e=this._;if(e.plotFlush){var g=new b(128),h=new Float32Array(128),i,j;if("set"===e.curve){i=100;for(j=h.length;i<j;++i)h[i]=
1}else{i=d.CurveTypeDict[e.curve];"undefined"===typeof i?g.setNext(1,1E3,d.CurveTypeCurve,e.curve):g.setNext(1,1E3,i);i=0;for(j=h.length;i<j;++i)h[i]=g.next()}e.plotData=h;e.plotRange=[0,1];e.plotFlush=null}return a.call(this,c)};g.register("param",h)})(timbre);
(function(i){function h(b){i.Object.call(this,2,b);g.fixAR(this);b=this._;b.freq=i("sin",{freq:1,add:1E3,mul:250}).kr();b.Q=i(1);b.allpass=[];this.steps=2}var g=i.fn,j=i.modules.Biquad;g.extend(h);var d=h.prototype;Object.defineProperties(d,{freq:{set:function(b){this._.freq=b},get:function(){return this._.freq}},Q:{set:function(b){this._.Q=i(b)},get:function(){return this._.Q}},steps:{set:function(b){if("number"===typeof b){b|=0;if(2===b||4===b||8===b||12===b){var e=this._.allpass;if(e.length<b)for(var c=
e.length;c<b;++c)e[c]=new j(this._.samplerate),e[c].setType("allpass")}this._.steps=b}},get:function(){return this._.steps}}});d.process=function(b){var e=this._;if(this.tickID!==b){this.tickID=b;g.inputSignalAR(this);if(!e.bypassed){var c=this.cells[1],a=this.cells[2],f=e.freq.process(b).cells[0][0],b=e.Q.process(b).cells[0][0],d=e.steps,h;for(h=0;h<d;h+=2)e.allpass[h].setParams(f,b,0),e.allpass[h].process(c,a),e.allpass[h+1].setParams(f,b,0),e.allpass[h+1].process(c,a)}g.outputSignalAR(this)}return this};
g.register("phaser",h)})(timbre);
(function(i){function h(h){i.Object.call(this,1,h);g.fixAR(this);for(var h=new Uint8Array(5),d=0;5>d;++d)h[d]=(1073741824*Math.random()|0)%25;this._.whites=h;this._.key=0}var g=i.fn;g.extend(h);h.prototype.process=function(g){var d=this.cells[0],b=this._;if(this.tickID!==g){this.tickID=g;var e,c,a=b.key,f=b.whites,h=b.mul,i=b.add,l,m,g=0;for(e=d.length;g<e;++g){c=a++;31<a&&(a=0);m=c^a;for(c=l=0;5>c;++c)m&1<<c&&(f[c]=(1073741824*Math.random()|0)%25),l+=f[c];d[g]=(0.01666666*l-1)*h+i}b.key=a}return this};
g.register("pink",h)})(timbre);
(function(i){function h(d){i.Object.call(this,1,d);this._.freq=440;this._.buffer=null;this._.readIndex=0;this._.writeIndex=0}var g=i.fn;g.extend(h);var j=h.prototype;Object.defineProperties(j,{freq:{set:function(d){"number"===typeof d&&(0>d&&(d=0),this._.freq=d)},get:function(){return this._.freq}}});j.bang=function(){for(var d=this._,b=d.samplerate/d.freq+0.5|0,e=d.buffer=new g.SignalArray(b<<1),c=0;c<b;++c)e[c]=2*Math.random()-1;d.readIndex=0;d.writeIndex=b;d.emit("bang");return this};j.process=
function(d){var b=this.cells[0],e=this._;if(this.tickID!==d&&(this.tickID=d,d=e.buffer)){var c=d.length,a=e.readIndex,f=e.writeIndex,g=e.mul,h=e.add,i,j,o=b.length;for(j=0;j<o;++j)i=d[a++],a>=c&&(a=0),i=0.5*(i+d[a]),d[f++]=i,f>=c&&(f=0),b[j]=i*g+h;e.readIndex=a;e.writeIndex=f}return this};g.register("pluck",h)})(timbre);
(function(i){function h(c){i.Object.call(this,1,c);g.listener(this);g.fixAR(this);c=this._;c.timeout=5E3;c.status=d;c.writeIndex=0;c.writeIndexIncr=1;c.currentTime=0;c.currentTimeIncr=1E3/c.samplerate;c.onended=b(this)}var g=i.fn,j=i.timevalue,d=0;g.extend(h);var b=function(b){return function(){var a=b._,f=new g.SignalArray(a.buffer.subarray(0,a.writeIndex|0));a.status=d;a.writeIndex=0;a.currentTime=0;a.emit("ended",{buffer:f,samplerate:a.samplerate})}},e=h.prototype;Object.defineProperties(e,{timeout:{set:function(b){"string"===
typeof b&&(b=j(b));"number"===typeof b&&0<b&&(this._.timeout=b)},get:function(){return this._.timeout}},samplerate:{set:function(b){"number"===typeof b&&(0<b&&b<=this._.samplerate)&&(this._.samplerate=b)},get:function(){return this._.samplerate}},currentTime:{get:function(){return this._.currentTime}}});e.start=function(){var b=this._,a;if(b.status===d){a=0.01*b.timeout*b.samplerate|0;if(!b.buffer||b.buffer.length<a)b.buffer=new g.SignalArray(a);b.writeIndex=0;b.writeIndexIncr=b.samplerate/i.samplerate;
b.currentTime=0;b.status=1;b.emit("start");this.listen()}return this};e.stop=function(){var b=this._;1===b.status&&(b.status=d,b.emit("stop"),g.nextTick(b.onended),this.unlisten());return this};e.bang=function(){this._.status===d?this.srart():1===this._.status&&this.stop();this._.emit("bang");return this};e.process=function(b){var a=this._,f=this.cells[0];if(this.tickID!==b){this.tickID=b;g.inputSignalAR(this);if(1===a.status){for(var e=f.length,d=a.buffer,h=a.timeout,i=a.writeIndex,j=a.writeIndexIncr,
s=a.currentTime,p=a.currentTimeIncr,b=0;b<e;++b)d[i|0]=f[b],i+=j,s+=p,h<=s&&g.nextTick(a.onended);a.writeIndex=i;a.currentTime=s}g.outputSignalAR(this)}return this};g.register("record",h);g.alias("rec","record")})(timbre);
(function(i){function h(b){i.Object.call(this,2,b);g.fixAR(this);this._.reverb=new j(this._.samplerate,this._.cellsize)}var g=i.fn,j=i.modules.Reverb;g.extend(h);var d=h.prototype;Object.defineProperties(d,{room:{set:function(b){"number"===typeof b&&this._.reverb.setRoomSize(1<b?1:0>b?0:b)},get:function(){return this._.reverb.roomsize}},damp:{set:function(b){"number"===typeof b&&this._.reverb.setDamp(1<b?1:0>b?0:b)},get:function(){return this._.reverb.damp}},mix:{set:function(b){"number"===typeof b&&
(this._.reverb.wet=1<b?1:0>b?0:b)},get:function(){return this._.reverb.wet}}});d.process=function(b){var e=this._;this.tickID!==b&&(this.tickID=b,g.inputSignalAR(this),e.bypassed||e.reverb.process(this.cells[1],this.cells[2]),g.outputSignalAR(this));return this};g.register("reverb",h)})(timbre);
(function(i){function h(b){i.Object.call(this,0,b);g.timer(this);g.fixKR(this);b=this._;b.queue=[];b.currentTime=0;b.maxRemain=1E3}var g=i.fn,j=i.timevalue;g.extend(h);var d=h.prototype;Object.defineProperties(d,{queue:{get:function(){return this._.queue}},remain:{get:function(){return this._.queue.length}},maxRemain:{set:function(b){"number"===typeof b&&0<b&&(this._.maxRemain=b)},get:function(){return this._.maxRemain}},isEmpty:{get:function(){return 0===this._.queue.length}},currentTime:{get:function(){return this._.currentTime}}});
d.sched=function(b,e){"string"===typeof b&&(b=j(b));"number"===typeof b&&this.schedAbs(this._.currentTime+b,e);return this};d.schedAbs=function(b,e){"string"===typeof b&&(b=j(b));if("number"===typeof b){var c=this._,a=c.queue;if(a.length>=c.maxRemain)return this;for(c=a.length;c--&&!(a[c][0]<b););a.splice(c+1,0,[b,i(e)])}return this};d.advance=function(b){"string"===typeof b&&(b=j(b));"number"===typeof b&&(this._.currentTime+=b);return this};d.clear=function(){this._.queue.splice(0);return this};
d.process=function(b){var e=this._;if(this.tickID!==b){this.tickID=b;var b=null,c=e.queue;if(c.length)for(;c[0][0]<e.currentTime;)if(e.queue.shift()[1].bang(),b="sched",0===c.length){b="empty";break}e.currentTime+=g.currentTimeIncr;b&&e.emit(b)}return this};g.register("schedule",h);g.alias("sche","schedule")})(timbre);
(function(i){function h(b){i.Object.call(this,2,b);g.listener(this);g.fixAR(this);b=this._;b.samples=0;b.writeIndex=0;b.plotFlush=!0;this.once("init",d)}var g=i.fn,j=i.timevalue;g.extend(h);var d=function(){this._.buffer||(this.size=1024);this._.interval||(this.interval=1E3)},b=h.prototype;Object.defineProperties(b,{size:{set:function(b){var a=this._;!a.buffer&&"number"===typeof b&&(a.buffer=new g.SignalArray(64>b?64:2048<b?2048:b),a.reservedinterval&&(this.interval=a.reservedinterval,a.reservedinterval=
null))},get:function(){return this._.buffer.length}},interval:{set:function(b){var a=this._;"string"===typeof b&&(b=j(b));"number"===typeof b&&0<b&&(a.buffer?(a.interval=b,a.samplesIncr=0.001*b*a.samplerate/a.buffer.length,1>a.samplesIncr&&(a.samplesIncr=1)):a.reservedinterval=b)},get:function(){return this._.interval}}});b.bang=function(){for(var b=this._,a=b.buffer,f=0,e=a.length;f<e;++f)a[f]=0;b.samples=0;b.writeIndex=0;this._.emit("bang");return this};b.process=function(b){var a=this._;if(this.tickID!==
b){this.tickID=b;g.inputSignalAR(this);g.outputSignalAR(this);var b=this.cells[0],f,e=a.cellsize,d=a.samples,h=a.samplesIncr,i=a.buffer,j=a.writeIndex,s=!1,p=i.length;for(f=0;f<e;++f)0>=d&&(i[j++]=b[f],j>=p&&(j=0),s=a.plotFlush=!0,d+=h),--d;a.samples=d;a.writeIndex=j;s&&this._.emit("data")}return this};var e=i.Object.prototype.plot;b.plot=function(b){var a=this._;if(a.plotFlush){for(var f=a.buffer,d=f.length-1,g=new Float32Array(f.length),h=a.writeIndex,i=0,j=f.length;i<j;i++)g[i]=f[++h&d];a.plotData=
g;a.plotFlush=null}return e.call(this,b)};g.register("scope",h)})(timbre);
(function(i){function h(c){i.Object.call(this,2,c);d.fixAR(this);c=this._;c.numberOfInputs=0;c.numberOfOutputs=0;c.bufferSize=0;c.bufferMask=0;c.duration=0;c.inputBufferL=null;c.inputBufferR=null;c.outputBufferL=null;c.outputBufferR=null;c.onaudioprocess=null;c.index=0;this.once("init",b)}function g(b,a){this.samplerate=b._.samplerate;this.length=b._.bufferSize;this.duration=b._.duration;this.numberOfChannels=a.length;this.getChannelData=function(b){return a[b]}}function j(b){var a=b._;this.node=
b;this.playbackTime=i.currentTime;this.inputBuffer=2===a.numberOfInputs?new g(b,[a.inputBufferL,a.inputBufferR]):new g(b,[a.inputBufferL]);this.outputBuffer=2===a.numberOfOutputs?new g(b,[a.outputBufferL,a.outputBufferR]):new g(b,[a.outputBufferL])}var d=i.fn;d.extend(h);var b=function(){var b=this._;0===b.numberOfInputs&&(this.numberOfInputs=1);0===b.numberOfOutputs&&(this.numberOfOutputs=1);0===b.bufferSize&&(this.bufferSize=1024)},e=h.prototype;Object.defineProperties(e,{numberOfInputs:{set:function(b){var a=
this._;0===a.numberOfInputs&&(a.numberOfInputs=2===b?2:1)},get:function(){return this._.numberOfInputs}},numberOfOutputs:{set:function(b){var a=this._;0===a.numberOfOutputs&&(a.numberOfOutputs=2===b?2:1)},get:function(){return this._.numberOfOutputs}},bufferSize:{set:function(b){var a=this._;0===a.bufferSize&&-1!==[256,512,1024,2048,4096,8192,16384].indexOf(b)&&(a.bufferSize=b,a.bufferMask=b-1,a.duration=b/a.samplerate,a.inputBufferL=new d.SignalArray(b),a.inputBufferR=new d.SignalArray(b),a.outputBufferL=
new d.SignalArray(b),a.outputBufferR=new d.SignalArray(b))},get:function(){return this._.bufferSize}},onaudioprocess:{set:function(b){"function"===typeof b&&(this._.onaudioprocess=b)},get:function(){return this._.onaudioprocess}}});e.process=function(b){var a=this._;if(this.tickID!==b){this.tickID=b;var b=a.cellsize,f=a.bufferMask,e=a.index,g=e+b,h,i=this.cells[1],o=this.cells[2];d.inputSignalAR(this);if(2===a.numberOfInputs)a.inputBufferL.set(i,e),a.inputBufferR.set(o,e);else{h=a.inputBufferL;for(var s=
0;s<b;s++)h[e+s]=0.5*(i[s]+o[s])}i.set(a.outputBufferL.subarray(e,g));o.set(a.outputBufferR.subarray(e,g));a.index=g&f;0===a.index&&a.onaudioprocess&&(a.onaudioprocess(new j(this)),1===a.numberOfOutputs&&a.outputBufferR.set(a.outputBufferL));d.outputSignalAR(this)}return this};d.register("script",h)})(timbre);
(function(i){function h(d){i.Object.call(this,2,d);this._.selected=0;this._.background=!1}var g=i.fn;g.extend(h);var j=h.prototype;Object.defineProperties(j,{selected:{set:function(d){"number"===typeof d&&(this._.selected=d,this.cells[1].set(g.emptycell),this.cells[2].set(g.emptycell))},get:function(){return this._.selected}},background:{set:function(d){this._.background=!!d},get:function(){return this._.background}}});j.process=function(d){var b=this._;if(this.tickID!==d){this.tickID=d;var e=this.nodes,
c,a=e.length;if(b.background)for(c=0;c<a;++c)e[c].process(d);if(e=e[b.selected])b.background||e.process(d),this.cells[1].set(e.cells[1]),this.cells[2].set(e.cells[2]);g.outputSignalAR(this)}return this};g.register("selector",h)})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);g.listener(this);g.fixAR(this);a=this._;a.status=b;a.samples=0;a.samplesIncr=0;a.writeIndex=0;a.plotFlush=!0;a.plotRange=[0,32];a.plotBarStyle=!0;this.once("init",e)}var g=i.fn,j=i.timevalue,d=i.modules.FFT,b=0;g.extend(h);var e=function(){var a=this._;a.fft||(this.size=512);a.interval||(this.interval=500)},c=h.prototype;Object.defineProperties(c,{size:{set:function(a){var b=this._;if(!b.fft&&"number"===typeof a&&(b.fft=new d(256>a?256:2048<a?2048:
a),b.buffer=new g.SignalArray(b.fft.length),b.freqs=new g.SignalArray(b.fft.length>>1),b.reservedwindow&&(b.fft.setWindow(b.reservedwindow),b.reservedwindow=null),b.reservedinterval))this.interval=b.reservedinterval,b.reservedinterval=null},get:function(){return this._.buffer.length}},window:{set:function(a){this._.fft.setWindow(a)},get:function(){return this._.fft.windowName}},interval:{set:function(a){var b=this._;"string"===typeof a&&(a=j(a));"number"===typeof a&&0<a&&(b.buffer?(b.interval=a,b.samplesIncr=
0.001*a*b.samplerate,b.samplesIncr<b.buffer.length&&(b.samplesIncr=b.buffer.length,b.interval=1E3*b.samplesIncr/b.samplerate)):b.reservedinterval=a)},get:function(){return this._.interval}},spectrum:{get:function(){return this._.fft.getFrequencyData(this._.freqs)}},real:{get:function(){return this._.fft.real}},imag:{get:function(){return this._.fft.imag}}});c.bang=function(){this._.samples=0;this._.writeIndex=0;this._.emit("bang");return this};c.process=function(a){var c=this._;if(this.tickID!==a){this.tickID=
a;g.inputSignalAR(this);g.outputSignalAR(this);var a=this.cells[0],e,d=a.length,h=c.status,i=c.samples,j=c.samplesIncr,p=c.writeIndex,q=c.buffer,r=q.length,t;for(e=0;e<d;++e)0>=i&&h===b&&(h=1,p=0,i+=j),1===h&&(q[p++]=a[e],r<=p&&(c.fft.forward(q),t=c.plotFlush=!0,h=b)),--i;c.samples=i;c.status=h;c.writeIndex=p;t&&this._.emit("data")}return this};var a=i.Object.prototype.plot;c.plot=function(b){this._.plotFlush&&(this._.plotData=this.spectrum,this._.plotFlush=null);return a.call(this,b)};g.register("spectrum",
h)})(timbre);
(function(i){function h(g){i.Object.call(this,2,g);this._.ar=!1}var g=i.fn;g.extend(h);h.prototype.process=function(h){var d=this._;if(this.tickID!==h){this.tickID=h;var b=this.nodes,e=this.cells[0],c=this.cells[1],a=this.cells[2],f,i=b.length,n=e.length,l;if(d.ar){if(0<b.length){b[0].process(h);d=b[0].cells[1];l=b[0].cells[2];c.set(d);a.set(l);for(f=1;f<i;++f){b[f].process(h);d=b[f].cells[1];l=b[f].cells[2];for(e=0;e<n;++e)c[e]-=d[e],a[e]-=l[e]}}else for(e=0;e<n;++e)c[e]=a[f]=0;g.outputSignalAR(this)}else{if(0<b.length){c=
b[0].process(h).cells[0][0];for(f=1;f<i;++f)c-=b[f].process(h).cells[0][0]}else c=0;e[0]=c;g.outputSignalKR(this)}}return this};g.register("-",h)})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);g.fixAR(this);a=this._;this.playbackState=g.FINISHED_STATE;a.poly=4;a.genList=[];a.genDict={};a.synthdef=null;a.remGen=b(this);a.onended=g.make_onended(this)}var g=i.fn;g.extend(h);var j=h.prototype;Object.defineProperties(j,{def:{set:function(a){"function"===typeof a&&(this._.synthdef=a)},get:function(){return this._.synthdef}},poly:{set:function(a){"number"===typeof a&&(0<a&&64>=a)&&(this._.poly=a)},get:function(){return this._.poly}}});var d=function(a,
b){return function(){a._.remGen(b.gen)}},b=function(a){return function(b){var c=a._,e=c.genList.indexOf(b);-1!==e&&c.genList.splice(e,1);c.genDict[b.noteNum]=null}},e=function(a,b,c,e){c|=0;0>=c?this.noteOff(this,a):127<c&&(c=127);var h=this._,j=h.genList,s=h.genDict,p=s[a];p&&h.remGen(p);b={freq:b,noteNum:a,velocity:c};if(e)for(var q in e)b[q]=e[q];b.doneAction=d(this,b);p=this._.synthdef.call(this,b);p instanceof i.Object&&(p.noteNum=a,j.push(p),s[a]=b.gen=p,this.playbackState=g.PLAYING_STATE,j.length>
h.poly&&h.remGen(j[0]))},c=function(){for(var a=new Float32Array(128),b=0;128>b;++b)a[b]=440*Math.pow(2,1*(b-69)/12);return a}();j.noteOn=function(a,b,d){var g=c[a]||440*Math.pow(2,(a-69)/12);e.call(this,a+0.5|0,g,b,d);return this};j.noteOff=function(a){(a=this._.genDict[a])&&a.release&&a.release();return this};j.noteOnWithFreq=function(a,b,c){var d=0<a?12*Math.log(1*a/440)*Math.LOG2E+69:0;e.call(this,d+0.5|0,a,b,c);return this};j.noteOffWithFreq=function(a){return this.noteOff((0<a?12*Math.log(1*
a/440)*Math.LOG2E+69:0)+0.5|0)};j.allNoteOff=function(){for(var a=this._.genList,b=0,c=a.length;b<c;++b)a[b].release&&a[b].release()};j.allSoundOff=function(){for(var a=this._,b=a.genList,a=a.genDict;b.length;)delete a[b.shift().noteNum]};j.process=function(a){var b=this.cells[0],c=this._;if(this.tickID!==a){this.tickID=a;if(this.playbackState===g.PLAYING_STATE){var e=c.genList,d,h=this.cells[1],i=this.cells[2],j,b=b.length,q,r;if(e.length){d=e[0];d.process(a);h.set(d.cells[1]);i.set(d.cells[2]);
c=1;for(j=e.length;c<j;++c){d=e[c];d.process(a);q=d.cells[1];r=d.cells[2];for(d=0;d<b;++d)h[d]+=q[d],i[d]+=r[d]}}else g.nextTick(c.onended)}g.outputSignalAR(this)}return this};g.register("SynthDef",h);var a={set:function(a){g.isDictionary(a)?"string"===typeof a.type&&(this._.env=a):a instanceof i.Object&&(this._.env=a)},get:function(){return this._.env}};g.register("OscGen",function(){var b={set:function(a){"string"===typeof a&&(this._.wave=a)},get:function(){return this._.wave}},c=function(a){var b=
this._,c,e;c=b.env||{};e=c.type||"perc";b=i("osc",{wave:b.wave,freq:a.freq,mul:a.velocity/128});c instanceof i.Object?"function"===typeof c.clone&&(b=c.clone().append(b)):b=i(e,c,b);b.on("ended",a.doneAction).bang();return b};return function(e){e=new h(e);e._.wave="sin";Object.defineProperties(e,{env:a,wave:b});e.def=c;return e}}());g.register("PluckGen",function(){var b=function(a){var b,c,e;c=this._.env||{};e=c.type||"perc";b=i("pluck",{freq:a.freq,mul:a.velocity/128}).bang();c instanceof i.Object?
"function"===typeof c.clone&&(b=c.clone().append(b)):b=i(e,c,b);b.on("ended",a.doneAction).bang();return b};return function(c){c=new h(c);Object.defineProperties(c,{env:a});c.def=b;return c}}())})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);g.fixAR(this);a=this._;a.isLooped=!1;a.onended=g.make_onended(this,0)}var g=i.fn,j=i.modules.Scissor,d=j.Tape,b=j.TapeStream,e=g.isSignalArray;g.extend(h);var c=h.prototype;Object.defineProperties(c,{tape:{set:function(a){a instanceof d?(this.playbackState=g.PLAYING_STATE,this._.tape=a,this._.tapeStream=new b(a,this._.samplerate)):"object"===typeof a&&e(a.buffer)&&(this.playbackState=g.PLAYING_STATE,this._.tape=new j(a),this._.tapeStream=new b(a,
this._.samplerate))},get:function(){return this._.tape}},isLooped:{get:function(){return this._.isLooped}}});c.loop=function(a){this._.isLooped=!!a;this._.tapeStream&&(this._.tapeStream.isLooped=this._.isLooped);return this};c.bang=function(){this.playbackState=g.PLAYING_STATE;this._.tapeStream&&this._.tapeStream.reset();this._.emit("bang");return this};c.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;if(a=b.tapeStream){var c=this.cells[1],e=this.cells[2],d=a.fetch(c.length);c.set(d[0]);
e.set(d[1]);this.playbackState===g.PLAYING_STATE&&a.isEnded&&g.nextTick(b.onended)}g.outputSignalAR(this)}return this};g.register("tape",h)})(timbre);
(function(i){function h(c){i.Object.call(this,0,c);g.timer(this);g.fixKR(this);c=this._;this.playbackState=g.FINISHED_STATE;c.currentTime=0;c.samplesMax=0;c.samples=0;c.onended=g.make_onended(this);this.once("init",d);this.on("start",b)}var g=i.fn,j=i.timevalue;g.extend(h);var d=function(){this._.timeout||(this.timeout=1E3)},b=function(){this.playbackState=g.PLAYING_STATE};Object.defineProperty(b,"unremovable",{value:!0,writable:!1});var e=h.prototype;Object.defineProperties(e,{timeout:{set:function(b){var a=
this._;"string"===typeof b&&(b=j(b));"number"===typeof b&&0<=b&&(this.playbackState=g.PLAYING_STATE,a.timeout=b,a.samplesMax=a.samplerate*0.001*b|0,a.samples=a.samplesMax)},get:function(){return this._.timeout}},currentTime:{get:function(){return this._.currentTime}}});e.bang=function(){var b=this._;this.playbackState=g.PLAYING_STATE;b.samples=b.samplesMax;b.currentTime=0;b.emit("bang");return this};e.process=function(b){var a=this.cells[0],e=this._;if(this.tickID!==b){this.tickID=b;0<e.samples&&
(e.samples-=a.length);if(0>=e.samples){for(var b=this.nodes,a=0,d=b.length;a<d;++a)b[a].bang();g.nextTick(e.onended)}e.currentTime+=g.currentTimeIncr}return this};g.register("timeout",h)})(timbre);
(function(i){function h(d){i.Object.call(this,1,d);g.fixAR(this);this._.curve=null}var g=i.fn;g.extend(h);var j=h.prototype;Object.defineProperties(j,{curve:{set:function(d){g.isSignalArray(d)&&(this._.curve=d)},get:function(){return this._.curve}}});j.process=function(d){var b=this._;if(this.tickID!==d){this.tickID=d;g.inputSignalAR(this);if(b.curve){var d=this.cells[0],e=b.curve,c=e.length,a,f=b.cellsize;for(a=0;a<f;++a)b=0.5*(d[a]+1)*c+0.5|0,0>b?b=0:b>=c-1&&(b=c-1),d[a]=e[b]}g.outputSignalAR(this)}return this};
g.register("waveshaper",h)})(timbre);
(function(i){function h(b){i.Object.call(this,1,b);b=this._;b.inMin=0;b.inMax=1;b.outMin=0;b.outMax=1;b.ar=!1;this.once("init",j)}var g=i.fn;g.extend(h);var j=function(){this._.warp||(this.warp="linlin")},d=h.prototype;Object.defineProperties(d,{inMin:{set:function(b){"number"===typeof b&&(this._.inMin=b)},get:function(){return this._.inMin}},inMax:{set:function(b){"number"===typeof b&&(this._.inMax=b)},get:function(){return this._.inMax}},outMin:{set:function(b){"number"===typeof b&&(this._.outMin=
b)},get:function(){return this._.outMin}},outMax:{set:function(b){"number"===typeof b&&(this._.outMax=b)},get:function(){return this._.outMax}},warp:{set:function(e){if("string"===typeof e){var c=b[e];c&&(this._.warp=c,this._.warpName=e)}},get:function(){return this._.warpName}}});d.process=function(b){var c=this._,a=this.cells[0];if(this.tickID!==b){this.tickID=b;var d=c.inMin,h=c.inMax,i=c.outMin,j=c.outMax,m=c.warp,o=this.nodes.length,s=c.mul,p=c.add,b=a.length;if(c.ar&&o){g.inputSignalAR(this);
for(c=0;c<b;++c)a[c]=m(a[c],d,h,i,j)*s+p;g.outputSignalAR(this)}else{c=this.nodes.length?g.inputSignalKR(this):0;d=m(c,d,h,i,j)*s+p;for(c=0;c<b;++c)a[c]=d}}return this};var b={linlin:function(b,c,a,d,g){return b<c?d:b>a?g:a===c?d:(b-c)/(a-c)*(g-d)+d},linexp:function(b,c,a,d,g){return b<c?d:b>a?g:0===d?0:a===c?g:Math.pow(g/d,(b-c)/(a-c))*d},explin:function(b,c,a,d,g){return b<c?d:b>a?g:0===c?g:Math.log(b/c)/Math.log(a/c)*(g-d)+d},expexp:function(b,c,a,d,g){return b<c?d:b>a?g:0===c||0===d?0:Math.pow(g/
d,Math.log(b/c)/Math.log(a/c))*d}};g.register("zmap",h)})(timbre);
