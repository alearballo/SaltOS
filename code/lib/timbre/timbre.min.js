(function(i){function h(){function a(b){for(var c=Array(b.byteLength),d=b.__klass.bits,f,j=0,k=c.length;j<k;++j)f=8*(j%d),c[j]=(b[j/d|0]&255<<f)>>>f;c.__view=b;return c}function b(k,e,o,p){var g,m,l;if(Array.isArray(e))if(e.__view){"undefined"===typeof o&&(o=0);"undefined"===typeof p&&(p=e.length-o);g=k.bits;p=e.slice(o,o+p);e=Array(p.length/g);m=0;for(l=e.length;m<l;++m)e[m]=0;m=0;for(l=p.length;m<l;++m)e[m/g|0]+=(p[m]&255)<<8*(m%g)}else e=e.slice();else e="number"===typeof e&&0<e?Array(e|0):[];
if(k.type!==d){m=0;for(l=e.length;m<l;++m)e[m]=(+e[m]||0)&65535}else{m=0;for(l=e.length;m<l;++m)e[m]=e[m]||0}if(k.type===c){m=0;for(l=e.length;m<l;++m)e[m]&1<<8*g-1&&(e[m]-=1<<8*g)}e.__klass=k;e.set=f;e.subarray=j;e.byteLength=k.bits*e.length;e.byteOffset=o||0;Object.defineProperty(e,"buffer",{get:function(){return new a(this)}});return e}var c=1,d=2,f=function(a,b){"undefined"===typeof b&&(b=0);var c,d=Math.min(this.length-b,a.length);for(c=0;c<d;++c)this[b+c]=a[c]},j=function(a,b){"undefined"===
typeof b&&(b=this.length);return new this.__klass(this.slice(a,b))};[["Int8Array",1,c],["Uint8Array",1,0],["Int16Array",2,c],["Uint16Array",2,0],["Int32Array",4,c],["Uint32Array",4,0],["Float32Array",4,d],["Float64Array",8,d]].forEach(function(a){var c={bits:a[1],type:a[2]};window[a[0]]=function(a,d,j){return b.call(this,c,a,d,j)}})}"undefined"===typeof Float32Array&&h();var g=Array.prototype.slice,l=Array.isArray,e=function(a){return"object"===typeof a&&a.constructor===Object},c=0,f=1,d=[8E3,11025,
12E3,16E3,22050,24E3,32E3,44100,48E3],b=[32,64,128,256],a=null,j={},o={},k="undefined"!==typeof module&&module.exports?"node":"undefined"!==typeof window?"browser":"unknown",p="browser"===k&&/(iPhone|iPad|iPod|Android)/i.test(navigator.userAgent),m=!1,t=function(){var a=g.call(arguments),b=a[0],c;switch(typeof b){case "string":j[b]?c=new j[b](a.slice(1)):o[b]&&(c=o[b](a.slice(1)));break;case "number":c=new y(a);break;case "boolean":c=new z(a);break;case "function":c=new C(a);break;case "object":if(null!==
b){if(b instanceof u)return b;if(b.context instanceof u)return b.context;b.constructor===Object?c=new D(a):l(b)&&(c=new E(a))}}c===i&&(c=new x([]),console.warn('T("'+b+'") is not defined.'));c._.originkey=b;for(var a=c._,b=c._.meta,d,f,e=c;null!==e&&e.constructor!==Object;){d=Object.getOwnPropertyNames(e);for(var k=0,p=d.length;k<p;++k)if(!b[d[k]])if(/^(constructor$|process$|_)/.test(d[k]))b[d[k]]="ignore";else if(f=Object.getOwnPropertyDescriptor(e,d[k]),"function"===typeof f.value)b[d[k]]="function";
else if(f.get||f.set)b[d[k]]="property";e=Object.getPrototypeOf(e)}a.meta=b;c._.emit("init");return c},r=function(){return t.apply(null,arguments)};Object.defineProperties(r,{version:{value:"WORKING"},envtype:{value:k},envmobile:{value:p},env:{get:function(){return a.impl.env}},samplerate:{get:function(){return a.samplerate}},channels:{get:function(){return a.channels}},cellsize:{get:function(){return a.cellsize}},currentTime:{get:function(){return a.currentTime}},isPlaying:{get:function(){return a.status===
f}},isRecording:{get:function(){return 3===a.status}},amp:{set:function(b){"number"===typeof b&&(a.amp=b)},get:function(){return a.amp}}});r.bind=function(b,c){a.bind(b,c);return r};r.setup=function(b){a.setup(b);return r};r.play=function(){a.play();return r};r.pause=function(){a.pause();return r};r.reset=function(){a.reset();a.events.emit("reset");return r};r.on=r.addListener=function(b,c){a.on(b,c);return r};r.once=function(b,c){a.once(b,c);return r};r.off=r.removeListener=function(b,c){a.off(b,
c);return r};r.removeAllListeners=function(b){a.removeAllListeners(b);return r};r.listeners=function(b){return a.listeners(b)};r.rec=function(){return a.rec.apply(a,arguments)};r.timevalue=function(a){var b;if(b=/^(\d+(?:\.\d+)?)Hz$/i.exec(a))return b=+b[1],0===b?0:1E3/b;if(b=/^bpm(\d+(?:\.\d+)?)?\s*(?:l(\d+))?(\.*)$/i.exec(a)){a=b[1];if(a===i)a=120;else if(a=+b[1],5>a||300<a)a=120;var c=b[2]?b[2]|0:4;return 0===a||0===c?0:b=1E3*(60/a*(4/c))*([1,1.5,1.75,1.875][(b[3]||"").length]||1)}if(b=/^bpm(\d+(?:\.\d+)?)?\s*(\d+)\.(\d+)\.(\d+)$/i.exec(a)){a=
b[1];if(a===i)a=120;else if(a=+b[1],5>a||300<a)a=120;b=1920*(b[2]|0)+480*(b[3]|0)+(b[4]|0);return 1E3*60/a*(b/480)}if(b=/^(\d+(?:\.\d+)?)secs?$/i.exec(a))return 1E3*+b[1];if(b=/^(\d+(?:\.\d+)?)mins?$/i.exec(a))return 6E4*+b[1];if(b=/^(?:([0-5]?[0-9]):)?(?:([0-5]?[0-9]):)(?:([0-5]?[0-9]))(?:\.([0-9]{1,3}))?$/.exec(a))return a=3600*(b[1]|0)+60*(b[2]|0)+(b[3]|0),a=1E3*a+(((b[4]||"")+"00").substr(0,3)|0);if(b=/^bpm(\d+(?:\.\d+)?)?\s*(?:(\d+)ticks)?$/i.exec(a)){a=b[1];if(a===i)a=120;else if(a=+b[1],5>
a||300<a)a=120;b=b[2]?b[2]|0:480;return 0===a?0:1E3*60/a*(b/480)}return(b=/^(\d+)samples(?:\/(\d+)Hz)?$/i.exec(a))?(a=b[2]?b[2]|0:r.samplerate,0===a?0:1E3*((b[1]|0)/a)):(b=/^(\d+)(?:ms)?$/i.exec(a))?b[1]|0:0};var n=r.fn={SignalArray:Float32Array,currentTimeIncr:0,emptycell:null,FINISHED_STATE:c,PLAYING_STATE:f,UNSCHEDULED_STATE:2,SCHEDULED_STATE:3};n.isArray=l;n.isDictionary=e;n.nop=function(){return this};n.isSignalArray=function(a){return a instanceof Float32Array||a instanceof Float64Array||Array.isArray(a)&&
a.__klass&&2===a.__klass.type?!0:!1};n.extend=function(a,b){function c(){this.constructor=a}var b=b||u,d;for(d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype;a.prototype=new c;a.__super__=b.prototype;return a};n.constructorof=function(a,b){for(var c=a&&a.prototype;c;){if(c===b.prototype)return!0;c=Object.getPrototypeOf(c)}return!1};n.register=function(a,b){n.constructorof(b,u)?j[a]=b:o[a]=b};n.alias=function(a,b){j[b]?j[a]=j[b]:o[b]&&(o[a]=o[b])};n.getClass=function(a){return j[a]};
n.nextTick=function(b){a.nextTick(b);return r};n.fixAR=function(a){a._.ar=!0;a._.aronly=!0};n.fixKR=function(a){a._.ar=!1;a._.kronly=!0};n.changeWithValue=function(){var a=this._,a=a.value*a.mul+a.add;isNaN(a)&&(a=0);for(var b=this.cells[0],c=0,d=b.length;c<d;++c)b[c]=a};n.changeWithValue.unremovable=!0;n.timer=function(){var b=function(b){return function(){-1===a.timers.indexOf(b)&&(a.timers.push(b),a.events.emit("addObject"),b._.emit("start"))}},c=function(b){return function(){var c=a.timers.indexOf(b);
-1!==c&&(a.timers.splice(c,1),b._.emit("stop"),a.events.emit("removeObject"))}};return function(d){var f=b(d),j=c(d);d.start=function(){a.nextTick(f);return d};d.stop=function(){a.nextTick(j);return d};return d}}();n.listener=function(){var b=function(b){return function(){-1===a.listeners.indexOf(b)&&(a.listeners.push(b),a.events.emit("addObject"),b._.emit("listen"))}},c=function(b){return function(){var c=a.listeners.indexOf(b);-1!==c&&(a.listeners.splice(c,1),b._.emit("unlisten"),a.events.emit("removeObject"))}};
return function(d){var f=b(d),j=c(d);d.listen=function(){arguments.length&&d.append.apply(d,arguments);d.nodes.length&&a.nextTick(f);return d};d.unlisten=function(){arguments.length&&d.remove.apply(d,arguments);d.nodes.length||a.nextTick(j);return d};return d}}();n.make_onended=function(a,b){return function(){a.playbackState=c;if("number"===typeof b)for(var d=a.cells[0],f=a.cells[1],j=a.cells[2],e=0,k=f.length;e<k;++e)d[0]=f[e]=j[e]=b;a._.emit("ended")}};n.inputSignalAR=function(a){var b=a.cells[0],
c=a.cells[1],d=a.cells[2],j=a.nodes,e=j.length,k,o=b.length,p=a.tickID,g,m;if(2===a.numChannels){g=!0;if(0!==e){for(a=0;a<e;++a)if(j[a].playbackState===f){j[a].process(p);c.set(j[a].cells[1]);d.set(j[a].cells[2]);g=!1;++a;break}for(;a<e;++a)if(j[a].playbackState===f){j[a].process(p);b=j[a].cells[1];m=j[a].cells[2];for(k=o;k;)k-=8,c[k]+=b[k],d[k]+=m[k],c[k+1]+=b[k+1],d[k+1]+=m[k+1],c[k+2]+=b[k+2],d[k+2]+=m[k+2],c[k+3]+=b[k+3],d[k+3]+=m[k+3],c[k+4]+=b[k+4],d[k+4]+=m[k+4],c[k+5]+=b[k+5],d[k+5]+=m[k+
5],c[k+6]+=b[k+6],d[k+6]+=m[k+6],c[k+7]+=b[k+7],d[k+7]+=m[k+7]}}g&&(c.set(n.emptycell),d.set(n.emptycell))}else{g=!0;if(0!==e){for(a=0;a<e;++a)if(j[a].playbackState===f){j[a].process(p);b.set(j[a].cells[1]);g=!1;++a;break}for(;a<e;++a)if(j[a].playbackState===f){c=j[a].process(p).cells[0];for(k=o;k;)k-=8,b[k]+=c[k],b[k+1]+=c[k+1],b[k+2]+=c[k+2],b[k+3]+=c[k+3],b[k+4]+=c[k+4],b[k+5]+=c[k+5],b[k+6]+=c[k+6],b[k+7]+=c[k+7]}}g&&b.set(n.emptycell)}};n.inputSignalKR=function(a){for(var b=a.nodes,c=b.length,
d=a.tickID,j=0,a=0;a<c;++a)b[a].playbackState===f&&(j+=b[a].process(d).cells[0][0]);return j};n.outputSignalAR=function(a){var b=a.cells[0],c=a.cells[1],d=a.cells[2],j=a._.mul,f=a._.add;if(2===a.numChannels)for(a=b.length;a;)a-=8,c[a]=c[a]*j+f,d[a]=d[a]*j+f,c[a+1]=c[a+1]*j+f,d[a+1]=d[a+1]*j+f,c[a+2]=c[a+2]*j+f,d[a+2]=d[a+2]*j+f,c[a+3]=c[a+3]*j+f,d[a+3]=d[a+3]*j+f,c[a+4]=c[a+4]*j+f,d[a+4]=d[a+4]*j+f,c[a+5]=c[a+5]*j+f,d[a+5]=d[a+5]*j+f,c[a+6]=c[a+6]*j+f,d[a+6]=d[a+6]*j+f,c[a+7]=c[a+7]*j+f,d[a+7]=d[a+
7]*j+f,b[a]=0.5*(c[a]+d[a]),b[a+1]=0.5*(c[a+1]+d[a+1]),b[a+2]=0.5*(c[a+2]+d[a+2]),b[a+3]=0.5*(c[a+3]+d[a+3]),b[a+4]=0.5*(c[a+4]+d[a+4]),b[a+5]=0.5*(c[a+5]+d[a+5]),b[a+6]=0.5*(c[a+6]+d[a+6]),b[a+7]=0.5*(c[a+7]+d[a+7]);else if(1!==j||0!==f)for(a=b.length;a;)a-=8,b[a]=b[a]*j+f,b[a+1]=b[a+1]*j+f,b[a+2]=b[a+2]*j+f,b[a+3]=b[a+3]*j+f,b[a+4]=b[a+4]*j+f,b[a+5]=b[a+5]*j+f,b[a+6]=b[a+6]*j+f,b[a+7]=b[a+7]*j+f};n.outputSignalKR=function(a){var b=a.cells[0],c=a.cells[1],d=a.cells[2],j=b[0]*a._.mul+a._.add;if(2===
a.numChannels)for(a=b.length;a;)a-=8,b[a]=b[a+1]=b[a+2]=b[a+3]=b[a+4]=b[a+5]=b[a+6]=b[a+7]=c[a]=c[a+1]=c[a+2]=c[a+3]=c[a+4]=c[a+5]=c[a+6]=c[a+7]=d[a]=d[a+1]=d[a+2]=d[a+3]=d[a+4]=d[a+5]=d[a+6]=d[a+7]=j;else for(a=b.length;a;)a-=8,b[a]=b[a+1]=b[a+2]=b[a+3]=b[a+4]=b[a+5]=b[a+6]=b[a+7]=j};n.fix_iOS6_1_problem=function(b){a.fix_iOS6_1_problem(b)};var q=r.modules={},s=q.EventEmitter=function(){function a(b){this.context=b;this.events={}}var b=a.prototype;b.emit=function(a){var b=this.events[a];if(!b)return!1;
var c;if("function"===typeof b){switch(arguments.length){case 1:b.call(this.context);break;case 2:b.call(this.context,arguments[1]);break;case 3:b.call(this.context,arguments[1],arguments[2]);break;default:c=g.call(arguments,1),b.apply(this.context,c)}return!0}if(l(b)){c=g.call(arguments,1);for(var b=b.slice(),d=0,j=b.length;d<j;++d)b[d]instanceof u?b[d].bang.apply(b[d],c):b[d].apply(this.context,c);return!0}if(b instanceof u)c=g.call(arguments,1),b.bang.apply(b,c);else return!1};b.on=function(a,
b){if("function"!==typeof b&&!(b instanceof u))throw Error("addListener takes instances of Function or timbre.Object");var c=this.events;c[a]?l(c[a])?c[a].push(b):c[a]=[c[a],b]:c[a]=b;return this};b.once=function(a,b){var c=this,d;if("function"===typeof b)d=function(){c.off(a,d);b.apply(c.context,arguments)};else if(b instanceof u)d=function(){c.off(a,d);b.bang.apply(b,arguments)};else throw Error("once takes instances of Function or timbre.Object");d.listener=b;c.on(a,d);return this};b.off=function(a,
b){if("function"!==typeof b&&!(b instanceof u))throw Error("removeListener takes instances of Function or timbre.Object");var c=this.events;if(!c[a])return this;var d=c[a];if(l(d)){for(var j=-1,f=0,k=d.length;f<k;++f)if(d[f]===b||d[f].listener&&d[f].listener===b){j=f;break}if(0>j)return this;d.splice(j,1);0===d.length&&(c[a]=null)}else if(d===b||d.listener&&d.listener===b)c[a]=null;return this};b.removeAllListeners=function(a){var b=this.events,c=!1,d=b[a];if(l(d))for(var j=d.length;j--;){var f=d[j];
f.unremovable?c=!0:this.off(a,f)}else d&&(d.unremovable?c=!0:this.off(a,d));c||(b[a]=null);return this};b.listeners=function(a){var b=this.events;if(!b[a])return[];b=b[a];if(!l(b))return b.unremovable?[]:[b];for(var b=b.slice(),a=[],c=0,d=b.length;c<d;++c)b[c].unremovable||a.push(b[c]);return a};return a}(),w=q.Deferred=function(){function a(c){this.context=c||this;this._state="pending";this._doneList=[];this._failList=[];this._promise=new b(this)}function b(a){this.context=a.context;this.then=a.then;
this.done=function(){a.done.apply(a,arguments);return this};this.fail=function(){a.fail.apply(a,arguments);return this};this.pipe=function(){return a.pipe.apply(a,arguments)};this.always=function(){a.always.apply(a,arguments);return this};this.promise=function(){return this};this.isResolved=function(){return a.isResolved()};this.isRejected=function(){return a.isRejected()}}var c=a.prototype,d=function(a,b,c,d){if("pending"===this._state){this._state=a;for(var a=0,j=b.length;a<j;++a)b[a].apply(c,d);
this._doneList=this._failList=null}},j=function(a){return a&&"function"===typeof a.promise};c.resolve=function(){var a=g.call(arguments,0);d.call(this,"resolved",this._doneList,this.context||this,a);return this};c.resolveWith=function(a){var b=g.call(arguments,1);d.call(this,"resolved",this._doneList,a,b);return this};c.reject=function(){var a=g.call(arguments,0);d.call(this,"rejected",this._failList,this.context||this,a);return this};c.rejectWith=function(a){var b=g.call(arguments,1);d.call(this,
"rejected",this._failList,a,b);return this};c.promise=function(){return this._promise};c.done=function(){for(var a=g.call(arguments),b="resolved"===this._state,c="pending"===this._state,d=this._doneList,j=0,f=a.length;j<f;++j)if("function"===typeof a[j])if(b)a[j]();else c&&d.push(a[j]);return this};c.fail=function(){for(var a=g.call(arguments),b="rejected"===this._state,c="pending"===this._state,d=this._failList,j=0,f=a.length;j<f;++j)if("function"===typeof a[j])if(b)a[j]();else c&&d.push(a[j]);return this};
c.always=function(){this.done.apply(this,arguments);this.fail.apply(this,arguments);return this};c.then=function(a,b){return this.done(a).fail(b)};c.pipe=function(b,c){var d=this,f=new a(this.context);this.done(function(){var a=b.apply(d.context,arguments);j(a)?a.then(function(){var b=g.call(arguments);f.resolveWith.apply(f,[a].concat(b))}):f.resolveWith(d,a)});this.fail(function(){if("function"===typeof c){var a=c.apply(d.context,arguments);j(a)&&a.fail(function(){var b=g.call(arguments);f.rejectWith.apply(f,
[a].concat(b))})}else f.reject.apply(f,arguments)});return f.promise()};c.isResolved=function(){return"resolved"===this._state};c.isRejected=function(){return"rejected"===this._state};c.state=function(){return this._state};a.when=function(b){var c=0,d=g.call(arguments),f=d.length,k=f;1===f&&!j(b)&&(k=0);var e=1===k?b:new a,o=function(a,b){return function(c){b[a]=1<arguments.length?g.call(arguments):c;--k||e.resolve.apply(e,b)}};if(1<f)for(var p=Array(f),m=function(){e.reject()};c<f;++c)d[c]&&j(d[c])?
d[c].promise().done(o(c,p)).fail(m):(p[c]=d[c],--k);k||e.resolve.apply(e,d);return e.promise()};return a}(),u=r.Object=function(){function b(c,d){this._={};var j=this._.events=new s(this);this._.emit=function(){return j.emit.apply(j,arguments)};if(e(d[0])){var k=d.shift();this.once("init",function(){this.set(k)})}this.tickID=-1;this.nodes=d.map(r);this.cells=[];this.numChannels=c;switch(c){case 0:this.L=this.R=new v(null);this.cells[0]=this.cells[1]=this.cells[2]=this.L.cell;break;case 1:this.L=this.R=
new v(this);this.cells[0]=this.cells[1]=this.cells[2]=this.L.cell;break;case 2:this.L=new v(this),this.R=new v(this),this.cells[0]=new n.SignalArray(a.cellsize),this.cells[1]=this.L.cell,this.cells[2]=this.R.cell}this.playbackState=f;this._.ar=!0;this._.mul=1;this._.add=0;this._.dac=null;this._.bypassed=!1;this._.meta={};this._.samplerate=a.samplerate;this._.cellsize=a.cellsize}var d=b.prototype;Object.defineProperties(d,{isAr:{get:function(){return this._.ar}},isKr:{get:function(){return!this._.ar}},
isBypassed:{get:function(){return this._.bypassed}},isEnded:{get:function(){return!(this.playbackState&1)}},mul:{set:function(a){"number"===typeof a&&(this._.mul=a,this._.emit("setMul",a))},get:function(){return this._.mul}},add:{set:function(a){"number"===typeof a&&(this._.add=a,this._.emit("setAdd",a))},get:function(){return this._.add}}});d.toString=function(){return this.constructor.name};d.valueOf=function(){a.tickID!==this.tickID&&this.process(a.tickID);return this.cells[0][0]};d.append=function(){if(0<
arguments.length){var a=g.call(arguments).map(r);this.nodes=this.nodes.concat(a);this._.emit("append",a)}return this};d.appendTo=function(a){a.append(this);return this};d.remove=function(){if(0<arguments.length){for(var a,b=this.nodes,c=[],d=0,j=arguments.length;d<j;++d)if(-1!==(a=b.indexOf(arguments[d])))c.push(b[a]),b.splice(a,1);0<c.length&&this._.emit("remove",c)}return this};d.removeFrom=function(a){a.remove(this);return this};d.removeAll=function(){var a=this.nodes.slice();this.nodes=[];0<a.length&&
this._.emit("remove",a);return this};d.removeAtIndex=function(a){var b=this.nodes[a];b&&(this.nodes.splice(a,1),this._.emit("remove",[b]));return this};d.on=d.addListener=function(a,b){this._.events.on(a,b);return this};d.once=function(a,b){this._.events.once(a,b);return this};d.off=d.removeListener=function(a,b){this._.events.off(a,b);return this};d.removeAllListeners=function(a){this._.events.removeAllListeners(a);return this};d.listeners=function(a){return this._.events.listeners(a)};d.set=function(a,
b){var c,d,j=this._.meta;switch(typeof a){case "string":switch(j[a]){case "property":this[a]=b;break;case "function":this[a](b);break;default:for(c=this;null!==c;){if(d=Object.getOwnPropertyDescriptor(c,a))if("function"===typeof d.value)j[a]="function",this[a](b);else if(d.get||d.set)j[a]="property",this[a]=b;c=Object.getPrototypeOf(c)}}break;case "object":for(c in a)this.set(c,a[c])}return this};d.get=function(a){if("property"===this._.meta[a])return this[a]};d.bang=function(){this._.emit.apply(this,
["bang"].concat(g.call(arguments)));return this};d.process=n.nop;d.bypass=function(){this._.bypassed=0===arguments.length?!0:!!arguments[0];return this};d.play=function(){var a=this._.dac;null===a&&(a=this._.dac=new F(this));a.playbackState===c&&(a.play(),this._.emit.apply(this,["play"].concat(g.call(arguments))));return this};d.pause=function(){var a=this._.dac;a&&a.playbackState===f&&(a.pause(),this._.dac=null,this._.emit("pause"));return this};d.start=d.stop=d.listen=d.unlisten=function(){return this};
d.ar=function(){0===arguments.length||arguments[0]?this._.kronly||(this._.ar=!0,this._.emit("ar",!0)):this.kr(!0);return this};d.kr=function(){0===arguments.length||arguments[0]?this._.aronly||(this._.ar=!1,this._.emit("ar",!1)):this.ar(!0);return this};d.plot="browser"===k?function(a){var b=this._,c=a.target;if(!c)return this;var d=a.width||c.width||320,j=a.height||c.height||240,f=(a.x||0)+0.5,k=a.y||0,c=c.getContext("2d"),e;e=a.foreground!==i?a.foreground:b.plotForeground||"rgb(  0, 128, 255)";
var o;o=a.background!==i?a.background:b.plotBackground||"rgb(255, 255, 255)";var p=a.lineWidth||b.plotLineWidth||1,g=!!b.plotCyclic,m=b.plotData||this.cells[0],l=a.range||b.plotRange||[-1.2,1.2],h=l[0],l=j/(l[1]-h),t=d/m.length,r,n=m.length;c.save();c.rect(f,k,d,j);null!==o&&(c.fillStyle=o,c.fillRect(f,k,d,j));b.plotBefore&&b.plotBefore.call(this,c,f,k,d,j);if(b.plotBarStyle){c.fillStyle=e;for(o=e=0;o<n;++o)g=(m[o]-h)*l,r=j-g,c.fillRect(e+f,r+k,t,g),e+=t}else{c.strokeStyle=e;c.lineWidth=p;c.beginPath();
e=0;p=j-(m[0]-h)*l;c.moveTo(e+f,p+k);for(o=1;o<n;++o)e+=t,r=j-(m[o]-h)*l,c.lineTo(e+f,r+k);g?c.lineTo(e+t+f,p+k):c.lineTo(e+t+f,r+k);c.stroke()}b.plotAfter&&b.plotAfter.call(this,c,f,k,d,j);if(a=a.border||b.plotBorder)c.strokeStyle="string"===typeof a?a:"#000",c.lineWidth=1,c.strokeRect(f,k,d,j);c.restore();return this}:n.nop;return b}(),v=r.ChannelObject=function(){function b(c){r.Object.call(this,-1,[]);n.fixAR(this);this._.parent=c;this.cell=new n.SignalArray(a.cellsize);this.L=this.R=this;this.cells[0]=
this.cells[1]=this.cells[2]=this.cell;this.numChannels=1}n.extend(b);b.prototype.process=function(a){this.tickID!==a&&(this.tickID=a,this._.parent&&this._.parent.process(a));return this};return b}(),x=function(){function a(b){u.call(this,2,b)}n.extend(a);a.prototype.process=function(a){var b=this._;this.tickID!==a&&(this.tickID=a,b.ar?(n.inputSignalAR(this),n.outputSignalAR(this)):(this.cells[0][0]=n.inputSignalKR(this),n.outputSignalKR(this)));return this};n.register("+",a);return a}(),y=function(){function a(b){u.call(this,
1,[]);n.fixKR(this);this.value=b[0];if(e(b[1])){var c=b[1];this.once("init",function(){this.set(c)})}this.on("setAdd",n.changeWithValue);this.on("setMul",n.changeWithValue)}n.extend(a);Object.defineProperties(a.prototype,{value:{set:function(a){"number"===typeof a&&(this._.value=isNaN(a)?0:a,n.changeWithValue.call(this))},get:function(){return this._.value}}});return a}(),z=function(){function a(b){u.call(this,1,[]);n.fixKR(this);this.value=b[0];if(e(b[1])){var c=b[1];this.once("init",function(){this.set(c)})}this.on("setAdd",
n.changeWithValue);this.on("setMul",n.changeWithValue)}n.extend(a);Object.defineProperties(a.prototype,{value:{set:function(a){this._.value=a?1:0;n.changeWithValue.call(this)},get:function(){return!!this._.value}}});return a}(),C=function(){function a(b){u.call(this,1,[]);n.fixKR(this);this.func=b[0];this._.value=0;if(e(b[1])){var c=b[1];this.once("init",function(){this.set(c)})}this.on("setAdd",n.changeWithValue);this.on("setMul",n.changeWithValue)}n.extend(a);var b=a.prototype;Object.defineProperties(b,
{func:{set:function(a){"function"===typeof a&&(this._.func=a)},get:function(){return this._.func}},args:{set:function(a){this._.args=l(a)?a:[a]},get:function(){return this._.args}}});b.bang=function(){var a=this._,b=g.call(arguments).concat(a.args),b=a.func.apply(this,b);"number"===typeof b&&(a.value=b,n.changeWithValue.call(this));this._.emit("bang");return this};return a}(),E=function(){function a(b){u.call(this,1,[]);n.fixKR(this);if(e(b[1])){var c=b[1];this.once("init",function(){this.set(c)})}}
n.extend(a);Object.defineProperties(a.prototype,{});return a}(),D=function(){function a(b){u.call(this,1,[]);n.fixKR(this);if(e(b[1])){var c=b[1];this.once("init",function(){this.set(c)})}}n.extend(a);Object.defineProperties(a.prototype,{});return a}(),F=function(){function b(a){u.call(this,2,[]);this.playbackState=c;var f=this._;f.node=a;f.onplay=d(this);f.onpause=j(this)}n.extend(b);var d=function(b){return function(){-1===a.inlets.indexOf(b)&&(a.inlets.push(b),a.events.emit("addObject"),b.playbackState=
f,b._.emit("play"))}},j=function(b){return function(){var d=a.inlets.indexOf(b);-1!==d&&(a.inlets.splice(d,1),b.playbackState=c,b._.emit("pause"),a.events.emit("removeObject"))}},k=b.prototype;k.play=function(){a.nextTick(this._.onplay)};k.pause=function(){a.nextTick(this._.onpause)};k.process=function(a){var b=this._.node;b.playbackState&1?(b.process(a),this.cells[1].set(b.cells[1]),this.cells[2].set(b.cells[2])):(this.cells[1].set(n.emptycell),this.cells[2].set(n.emptycell))};return b}(),q=function(){function a(){this._=
{};this.context=this;this.tickID=0;this.impl=null;this.amp=0.8;this.status=c;this.samplerate=44100;this.channels=2;this.cellsize=64;this.streammsec=20;this.currentTime=this.streamsize=0;this.nextTicks=[];this.inlets=[];this.timers=[];this.listeners=[];this._.deferred=null;this.recStart=0;this.recBuffers=null;this.delayProcess=j(this);this.events=new s(this);n.currentTimeIncr=1E3*this.cellsize/this.samplerate;n.emptycell=new n.SignalArray(this.cellsize);this.reset()}var j=function(a){return function(){a.recStart=
Date.now();a.process()}},k=a.prototype;k.bind=function(a,b){"function"===typeof a&&(this.impl=new a(this,b),this.impl.defaultSamplerate&&(this.samplerate=this.impl.defaultSamplerate));return this};k.setup=function(a){if("object"===typeof a&&(-1!==d.indexOf(a.samplerate)&&(this.samplerate=a.samplerate<=this.impl.maxSamplerate?a.samplerate:this.impl.maxSamplerate),-1!==b.indexOf(a.cellsize)&&(this.cellsize=a.cellsize),"undefined"!==typeof a.f64))m=!!a.f64,n.SignalArray=m?Float64Array:Float32Array;n.currentTimeIncr=
1E3*this.cellsize/this.samplerate;n.emptycell=new n.SignalArray(this.cellsize);return this};k.getAdjustSamples=function(a){a=a||this.samplerate;a=Math.ceil(Math.log(this.streammsec/1E3*a)*Math.LOG2E);return 1<<(8>a?8:14<a?14:a)};k.play=function(){this.status===c&&(this.status=f,this.streamsize=this.getAdjustSamples(),this.strmL=new n.SignalArray(this.streamsize),this.strmR=new n.SignalArray(this.streamsize),this.impl.play(),this.events.emit("play"));return this};k.pause=function(){this.status===f&&
(this.status=c,this.impl.pause(),this.events.emit("pause"));return this};k.reset=function(a){a&&(this._.events=null);this.currentTime=0;this.nextTicks=[];this.inlets=[];this.timers=[];this.listeners=[];this.events.on("addObject",function(){this.status===c&&this.inlets.length+this.timers.length+this.listeners.length>0&&this.play()});this.events.on("removeObject",function(){this.status===f&&this.inlets.length+this.timers.length+this.listeners.length===0&&this.pause()});return this};k.process=function(){var a=
this.tickID,b=this.strmL,c=this.strmR,d=this.amp,j,f,k,e=this.streamsize,o=0,p,g,m,l=this.cellsize,i=this.streamsize/this.cellsize,h=this.timers,t=this.inlets,r=this.listeners,q=n.currentTimeIncr;for(k=0;k<e;++k)b[k]=c[k]=0;for(;i--;){++a;p=0;for(g=h.length;p<g;++p)h[p].playbackState&1&&h[p].process(a);p=0;for(g=t.length;p<g;++p)if(j=t[p],j.process(a),j.playbackState&1){f=j.cells[1];j=j.cells[2];m=0;for(k=o;m<l;++m,++k)b[k]+=f[m],c[k]+=j[m]}o+=l;p=0;for(g=r.length;p<g;++p)r[p].playbackState&1&&r[p].process(a);
this.currentTime+=q;k=this.nextTicks.splice(0);p=0;for(g=k.length;p<g;++p)k[p].call(null)}for(k=0;k<e;++k)j=b[k]*d,-1>j?j=-1:1<j&&(j=1),b[k]=j,j=c[k]*d,-1>j?j=-1:1<j&&(j=1),c[k]=j;this.tickID=a;a=this.currentTime;if(3===this.status){if(2===this.recCh)this.recBuffers.push(new n.SignalArray(b)),this.recBuffers.push(new n.SignalArray(c));else{d=new n.SignalArray(b.length);k=0;for(e=d.length;k<e;++k)d[k]=0.5*(b[k]+c[k]);this.recBuffers.push(d)}a>=this.maxDuration?this._.deferred.sub.reject():a>=this.recDuration?
this._.deferred.sub.resolve():20<Date.now()-this.recStart?setTimeout(this.delayProcess,10):this.process()}};k.nextTick=function(a){this.status===c?a():this.nextTicks.push(a)};k.rec=function(){n.fix_iOS6_1_problem(!0);var a=new w(this);if(this._.deferred)return console.warn("rec deferred is exists??"),a.reject().promise();if(this.status!==c)return console.log("status is not none",this.status),a.reject().promise();var b=0,d=arguments,j=e(d[b])?d[b++]:{},b=d[b];if("function"!==typeof b)return console.warn("no function"),
a.reject().promise();this._.deferred=a;this.status=3;this.reset();var f=new t("+"),k=new w(this),p=this;k.then(o,function(){n.fix_iOS6_1_problem(!1);o.call(p,!0)});this._.deferred.sub=k;this.savedSamplerate=this.samplerate;this.samplerate=j.samplerate||this.samplerate;this.recDuration=j.recDuration||Infinity;this.maxDuration=j.maxDuration||6E5;this.recCh=j.ch||1;2!==this.recCh&&(this.recCh=1);this.recBuffers=[];this.streamsize=this.getAdjustSamples();this.strmL=new n.SignalArray(this.streamsize);
this.strmR=new n.SignalArray(this.streamsize);this.inlets.push(f);b({done:function(){k.resolve.apply(k,g.call(arguments))},send:function(){f.append.apply(f,arguments)}});setTimeout(this.delayProcess,10);return a.promise()};var o=function(){this.status=c;this.reset();var a=this.recBuffers,b=this.samplerate,d=this.streamsize,j;this.samplerate=this.savedSamplerate;j=Infinity!==this.recDuration?0.001*this.recDuration*b|0:(a.length>>this.recCh-1)*d;var f,k=j/d|0,e=0,o=0,p=j;if(2===this.recCh){var g=new n.SignalArray(j),
m=new n.SignalArray(j),l=new n.SignalArray(j);for(f=0;f<k;++f)if(g.set(a[e++],o),m.set(a[e++],o),o+=d,p-=d,0<p&&p<d){g.set(a[e++].subarray(0,p),o);m.set(a[e++].subarray(0,p),o);break}f=0;for(k=j;f<k;++f)l[f]=0.5*(g[f]+m[f]);a={samplerate:b,channels:2,buffer:l,bufferL:g,bufferR:m}}else{j=new n.SignalArray(j);for(f=0;f<k;++f)if(j.set(a[e++],o),o+=d,p-=d,0<p&&p<d){j.set(a[e++].subarray(0,p),o);break}a={samplerate:b,channels:1,buffer:j,bufferL:j,bufferR:j}}this._.deferred.resolve.apply(this._.deferred,
[].concat.apply([a],arguments));this._.deferred=null};k.on=function(a,b){this.events.on(a,b)};k.once=function(a,b){this.events.once(a,b)};k.off=function(a,b){this.events.off(a,b)};k.removeAllListeners=function(a){this.events.removeListeners(a)};k.listeners=function(a){return this.events.listeners(a)};k.fix_iOS6_1_problem=function(a){this.impl.fix_iOS6_1_problem&&this.impl.fix_iOS6_1_problem(a)};return a}(),A=null;"undefined"!==typeof webkitAudioContext?A=function(a){var b=new webkitAudioContext,c,
d;n._audioContext=b;this.defaultSamplerate=this.maxSamplerate=b.sampleRate;this.env="webkit";var j=navigator.userAgent;j.match(/linux/i)?a.streammsec*=8:j.match(/win(dows)?\s*(nt 5\.1|xp)/i)&&(a.streammsec*=4);this.play=function(){var j,f=a.getAdjustSamples(b.sampleRate),k=a.streamsize,e,o;if(a.samplerate===b.sampleRate)j=function(b){b=b.outputBuffer;a.process();b.getChannelData(0).set(a.strmL);b.getChannelData(1).set(a.strmR)};else if(a.samplerate*2===b.sampleRate)j=function(b){var c=a.strmL,d=a.strmR,
j=b.outputBuffer,b=j.getChannelData(0),f=j.getChannelData(1),k=j.length,e;a.process();for(j=e=0;j<k;j=j+2,++e){b[j]=b[j+1]=c[e];f[j]=f[j+1]=d[e]}};else{e=k;o=a.samplerate/b.sampleRate;j=function(b){for(var c=a.strmL,d=a.strmR,j=b.outputBuffer,b=j.getChannelData(0),f=j.getChannelData(1),p=j.length,j=0;j<p;++j){if(e>=k){a.process();e=e-k}b[j]=c[e|0];f[j]=d[e|0];e=e+o}}}c=b.createBufferSource();d=b.createJavaScriptNode(f,2,a.channels);d.onaudioprocess=j;c.noteOn(0);c.connect(d);d.connect(b.destination)};
this.pause=function(){c.disconnect();d.disconnect()};if(p){var f=0,k=b.createBufferSource();this.fix_iOS6_1_problem=function(a){f=f+(a?1:-1);if(f===1){k.noteOn(0);k.connect(b.destination)}else f===0&&k.disconnect()}}}:"function"===typeof Audio&&"function"===typeof(new Audio).mozSetup?A=function(a){var b=function(){var a=new Blob(["var t=0;onmessage=function(e){if(t)t=clearInterval(t),0;if(typeof e.data=='number'&&e.data>0)t=setInterval(function(){postMessage(0);},e.data);};"],{type:"text/javascript"}),
a=URL.createObjectURL(a);return new Worker(a)}();this.maxSamplerate=48E3;this.defaultSamplerate=44100;this.env="moz";this.play=function(){var c=new Audio,d=new Float32Array(a.streamsize*a.channels),j=a.streammsec,f=0,k=1E3*(a.streamsize/a.samplerate),e=Date.now();c.mozSetup(a.channels,a.samplerate);b.onmessage=function(){if(!(f>Date.now()-e)){var b=a.strmL,j=a.strmR,o=d.length,p=b.length;for(a.process();p--;)d[--o]=j[p],d[--o]=b[p];c.mozWriteAudio(d);f+=k}};b.postMessage(j)};this.pause=function(){b.postMessage(0)}}:
(function(){function a(c){var d=0;b();this.defaultSamplerate=this.maxSamplerate=44100;this.env="flash";this.play=function(){var a,b=Array(c.streamsize*c.channels),j=c.streammsec,k=0,e=1E3*(c.streamsize/c.samplerate),p=Date.now();a=function(){if(!(k>Date.now()-p)){var a=c.strmL,d=c.strmR,j=b.length,o=a.length;for(c.process();o--;)b[--j]=32768*d[o]|0,b[--j]=32768*a[o]|0;f.writeAudio(b.join(" "));k+=e}};f.setup?(f.setup(c.channels,c.samplerate),d=setInterval(a,j)):console.warn("Cannot find "+o)};this.pause=
function(){0!==d&&(f.cancel(),clearInterval(d),d=0)}}function b(){var a,d;d=o+"?"+ +new Date;var j=document.createElement("div");j.id=e;j.style.display="inline";j.width=j.height=1;c.plugins&&c.mimeTypes&&c.mimeTypes.length?(a=document.createElement("object"),a.id="TimbreFlashPlayer",a.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",a.width=a.height=1,a.setAttribute("data",d),a.setAttribute("type","application/x-shockwave-flash"),d=document.createElement("param"),d.setAttribute("name","allowScriptAccess"),
d.setAttribute("value","always"),a.appendChild(d),j.appendChild(a)):j.innerHTML='<object id="TimbreFlashPlayer" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="1" height="1">'+('<param name="movie" value="'+d+'" />')+'<param name="bgcolor" value="#FFFFFF" /><param name="quality" value="high" /><param name="allowScriptAccess" value="always" /></object>';window.addEventListener("load",function(){document.body.appendChild(j);f=document.TimbreFlashPlayer})}if(!("browser"!==k||p)){var c=navigator,
d;try{d=c.plugins&&c.mimeTypes&&c.mimeTypes.length?c.plugins["Shockwave Flash"].description.match(/([0-9]+)/)[0]:(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version").match(/([0-9]+)/)[0]}catch(j){d=-1}if(!(10>d)){var f,e="TimbreFlashPlayerDiv",o=function(){var a=document.getElementsByTagName("script");if(a&&a.length)for(var b,c=0,d=a.length;c<d;++c)if(b=/^(.*\/)timbre(.*)\.js$/i.exec(a[c].src))return b[1]+"timbre.swf"}();A=a}}}(),A||(A=function(){this.maxSamplerate=48E3;this.defaultSamplerate=
8E3;this.env="nop";this.pause=this.play=n.nop}));var a=(new q).bind(A),B=r;"node"===k?module.exports=global.timbre=B:"browser"===k&&(B.noConflict=function(){var a=window.timbre,b=window.T;return function(c){if(window.T===B)window.T=b;if(c&&window.timbre===B)window.timbre=a;return B}}(),window.timbre=window.T=B)})();
(function(i){function h(e){this.samplerate=e;this.frequency=340;this.Q=1;this.b0=this.b1=this.b2=this.a1=this.a2=this.x1R=this.x2R=this.y1R=this.y2R=this.x1L=this.x2L=this.y1L=this.y2L=this.gain=0;this.setType("lpf")}var g=h.prototype;g.process=function(e,c){var f,d,b,a=this.x1L,j=this.x2L,o=this.y1L,k=this.y2L,p=this.x1R,g=this.x2R,l=this.y1R,h=this.y2R,i=this.b0,q=this.b1,s=this.b2,w=this.a1,u=this.a2,v,x;v=0;for(x=e.length;v<x;++v)f=e[v],d=i*f+q*a+s*j-w*o-u*k,j=a,a=f,k=o,o=d,f=c[v],b=i*f+q*p+s*
g-w*l-u*h,g=p,p=f,h=l,l=b,e[v]=d,c[v]=b;this.x1L=a;this.x2L=j;this.y1L=o;this.y2L=k;this.x1R=p;this.x2R=g;this.y1R=l;this.y2R=h};g.setType=function(e){var c;if(c=l[e])this.type=e,c.call(this,this.frequency,this.Q,this.gain)};g.setParams=function(e,c,f){this.frequency=e;this.Q=c;this.gain=f;var d=l[this.type];d&&d.call(this,e,c,f);return this};var l={lowpass:function(e,c){e/=0.5*this.samplerate;if(1<=e)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else if(0>=e)this.b0=this.b1=this.b2=this.a1=this.a2=
0;else{var f=Math.pow(10,0.05*(0>c?0:c)),d=Math.sqrt(0.5*(4-Math.sqrt(16-16/(f*f)))),f=Math.PI*e,d=0.5*d*Math.sin(f),d=0.5*(1-d)/(1+d),f=(0.5+d)*Math.cos(f),b=0.25*(0.5+d-f);this.b0=2*b;this.b1=4*b;this.b2=this.b0;this.a1=2*-f;this.a2=2*d}},highpass:function(e,c){e/=0.5*this.samplerate;if(1<=e)this.b0=this.b1=this.b2=this.a1=this.a2=0;else if(0>=e)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else{var f=Math.pow(10,0.05*(0>c?0:c)),d=Math.sqrt((4-Math.sqrt(16-16/(f*f)))/2),f=Math.PI*e,d=0.5*d*Math.sin(f),
d=0.5*(1-d)/(1+d),f=(0.5+d)*Math.cos(f),b=0.25*(0.5+d+f);this.b0=2*b;this.b1=-4*b;this.b2=this.b0;this.a1=2*-f;this.a2=2*d}},bandpass:function(e,c){e/=0.5*this.samplerate;if(0<e&&1>e)if(0<c){var f=Math.PI*e,d=Math.sin(f)/(2*c),f=Math.cos(f),b=1/(1+d);this.b0=d*b;this.b1=0;this.b2=-d*b;this.a1=-2*f*b;this.a2=(1-d)*b}else this.b0=this.b1=this.b2=this.a1=this.a2=0;else this.b0=this.b1=this.b2=this.a1=this.a2=0},lowshelf:function(e,c,f){e/=0.5*this.samplerate;c=Math.pow(10,f/40);if(1<=e)this.b0=c*c,this.b1=
this.b2=this.a1=this.a2=0;else if(0>=e)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else{var e=Math.PI*e,f=0.5*Math.sin(e)*Math.sqrt(0*(c+1/c)+2),e=Math.cos(e),f=2*Math.sqrt(c)*f,d=c+1,b=c-1,a=1/(d+b*e+f);this.b0=c*(d-b*e+f)*a;this.b1=2*c*(b-d*e)*a;this.b2=c*(d-b*e-f)*a;this.a1=-2*(b+d*e)*a;this.a2=(d+b*e-f)*a}},highshelf:function(e,c,f){e/=0.5*this.samplerate;c=Math.pow(10,f/40);if(1<=e)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else if(0>=e)this.b0=c*c,this.b1=this.b2=this.a1=this.a2=0;else{var e=
Math.PI*e,f=0.5*Math.sin(e)*Math.sqrt(0*(c+1/c)+2),e=Math.cos(e),f=2*Math.sqrt(c)*f,d=c+1,b=c-1,a=1/(d-b*e+f);this.b0=c*(d+b*e+f)*a;this.b1=-2*c*(b+d*e)*a;this.b2=c*(d+b*e-f)*a;this.a1=2*(b-d*e)*a;this.a2=(d-b*e-f)*a}},peaking:function(e,c,f){e/=0.5*this.samplerate;if(0<e&&1>e)if(f=Math.pow(10,f/40),0<c){var e=Math.PI*e,c=Math.sin(e)/(2*c),e=Math.cos(e),d=1/(1+c/f);this.b0=(1+c*f)*d;this.b1=-2*e*d;this.b2=(1-c*f)*d;this.a1=this.b1;this.a2=(1-c/f)*d}else this.b0=f*f,this.b1=this.b2=this.a1=this.a2=
0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0},notch:function(e,c){e/=0.5*this.samplerate;if(0<e&&1>e)if(0<c){var f=Math.PI*e,d=Math.sin(f)/(2*c),f=Math.cos(f),b=1/(1+d);this.b0=b;this.b1=-2*f*b;this.b2=b;this.a1=this.b1;this.a2=(1-d)*b}else this.b0=this.b1=this.b2=this.a1=this.a2=0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0},allpass:function(e,c){e/=0.5*this.samplerate;if(0<e&&1>e)if(0<c){var f=Math.PI*e,d=Math.sin(f)/(2*c),f=Math.cos(f),b=1/(1+d);this.b0=(1-d)*b;this.b1=-2*f*b;this.b2=
(1+d)*b;this.a1=this.b1;this.a2=this.b0}else this.b0=-1,this.b1=this.b2=this.a1=this.a2=0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0}};l.lpf=l.lowpass;l.hpf=l.highpass;l.bpf=l.bandpass;l.bef=l.notch;l.brf=l.notch;l.apf=l.allpass;i.modules.Biquad=h})(timbre);
(function(i){function h(e){this.samplerate=e;this.buffersize=1<<Math.round(Math.log(0.1*e)*Math.LOG2E);this.bufferL=new i.fn.SignalArray(this.buffersize+1);this.bufferR=new i.fn.SignalArray(this.buffersize+1);this._wave=this.wave=null;this.writeIndex=this.buffersize>>1;this.readIndex=0;this.delayTime=20;this.rate=4;this.depth=20;this.feedback=0.2;this.wet=0.5;this.phaseIncr=this.phase=0;this.phaseStep=4;this.setWaveType("sin");this.setDelayTime(this.delayTime);this.setRate(this.rate)}var g=h.prototype,
l=[];l[0]=function(){for(var e=new Float32Array(512),c=0;512>c;++c)e[c]=Math.sin(2*Math.PI*(c/512));return e}();l[1]=function(){for(var e=new Float32Array(512),c,f=0;512>f;++f)c=f/512-0.25,e[f]=1-4*Math.abs(Math.round(c)-c);return e}();g.setWaveType=function(e){"sin"===e?(this.wave=e,this._wave=l[0]):"tri"===e&&(this.wave=e,this._wave=l[1])};g.setDelayTime=function(e){this.delayTime=e;for(e=this.writeIndex-(0.001*e*this.samplerate|0);0>e;)e+=this.buffersize;this.readIndex=e};g.setRate=function(e){this.rate=
e;this.phaseIncr=512*this.rate/this.samplerate*this.phaseStep};g.process=function(e,c){var f=this.bufferL,d=this.bufferR,b=this.buffersize,a=b-1,j=this._wave,o=this.phase,k=this.phaseIncr,p=this.writeIndex,g=this.readIndex,l=this.depth,h=this.feedback,i,q,s,w=this.wet,u=1-w,v,x=e.length,y,z=this.phaseStep;for(v=0;v<x;){s=j[o|0]*l;for(o+=k;512<o;)o-=512;for(y=0;y<z;++y,++v)q=g+b+s&a,i=0.5*(f[q]+f[q+1]),f[p]=e[v]-i*h,e[v]=e[v]*u+i*w,i=0.5*(d[q]+d[q+1]),d[p]=c[v]-i*h,c[v]=c[v]*u+i*w,p=p+1&a,g=g+1&a}this.phase=
o;this.writeIndex=p;this.readIndex=g};i.modules.Chorus=h})(timbre);
(function(i){function h(g){this.samplerate=g;this.dbThreshold=-24;this.dbKnee=0;this.dbRatio=12;this.setParams(this.dbThreshold,this.dbKnee,this.dbRatio)}var g=h.prototype;g.setParams=function(g,e,c){this.dbThreshold=g;this.threshold=Math.pow(10,0.05*this.dbThreshold);this.dbRatio=c;this.ratio=Math.pow(10,0.05*this.dbRatio);this.slope=1/this.ratio;this.gain=1/(this.threshold+(1-this.threshold)*this.slope)};g.process=function(g,e){var c=this.threshold,f=this.slope,d=this.gain,b,a,j,o,k=g.length;for(o=
0;o<k;++o)a=g[o],j=e[o],b=0.5*(a+j),c>b?(a=c+(a-c)*f,j=c+(j-c)*f):b<-c&&(a=-c+(a+c)*f,j=-c+(j+c)*f),g[o]=a*d,g[o]=j*d};i.modules.Compressor=h})(timbre);
(function(i){function h(){}h.prototype.decode=function(g,l,e){if("string"===typeof g){if(/\.wav$/.test(g))return h.wav_decode(g,l,e);if(h.ogg_decode&&/\.ogg$/.test(g))return h.ogg_decode(g,l,e);if(h.mp3_decode&&/\.mp3$/.test(g))return h.mp3_decode(g,l,e)}if(h.webkit_decode)return h.webkit_decode(g,l,e);if(h.moz_decode)return h.moz_decode(g,l,e);l(!1)};i.modules.Decoder=h;h.getBinaryWithPath="browser"===i.envtype?function(g,l){i.fn.fix_iOS6_1_problem(!0);var e=new XMLHttpRequest;e.open("GET",g);e.responseType=
"arraybuffer";e.onreadystatechange=function(){4===e.readyState&&(e.response?l(new Uint8Array(e.response)):void 0!==e.responseBody&&l(new Uint8Array(VBArray(e.responseBody).toArray())),i.fn.fix_iOS6_1_problem(!1))};e.send()}:function(g,l){l("no support")};h.wav_decode=function(g,l,e){h.getBinaryWithPath(g,function(c){if("RIFF"!==String.fromCharCode(c[0],c[1],c[2],c[3])||c[4]+(c[5]<<8)+(c[6]<<16)+(c[7]<<24)+8!==c.length||"WAVE"!==String.fromCharCode(c[8],c[9],c[10],c[11])||"fmt "!==String.fromCharCode(c[12],
c[13],c[14],c[15]))return l(!1);var f=c[22]+(c[23]<<8),d=c[24]+(c[25]<<8)+(c[26]<<16)+(c[27]<<24),b=c[34]+(c[35]<<8);if("data"!==String.fromCharCode(c[36],c[37],c[38],c[39]))return l(!1);var a=c[40]+(c[41]<<8)+(c[42]<<16)+(c[43]<<24),j=(a/f>>1)/d;if(a>c.length-44)return l(!1);var o,a=new Float32Array(j*d|0);o=2===f?new Float32Array(j*d|0):a;l({samplerate:d,channels:f,bufferL:a,bufferR:o,duration:j});if(8===b)c=new Int8Array(c.buffer,44);else if(16===b)c=new Int16Array(c.buffer,44);else if(32===b)c=
new Int32Array(c.buffer,44);else if(24===b){for(var c=new Uint8Array(c.buffer,44),k,p,g,d=new Int32Array(c.length/3),j=0,i=c.length,h=0;j<i;)k=c[j++],p=c[j++],g=c[j++],k=k+(p<<8)+(g<<16),k=k&8388608?k-16777216:k,d[h++]=k;c=d}b=1/((1<<b-1)-1);if(2===f){f=j=0;for(d=a.length;f<d;++f)a[f]=c[j++]*b,o[f]=c[j++]*b}else{f=0;for(d=a.length;f<d;++f)a[f]=c[f]*b}e()})};h.webkit_decode=function(){if("undefined"!==typeof webkitAudioContext){var g=i.fn._audioContext,l=function(e,c,f){var d,b,a;if("string"===typeof e)return f(!1);
try{a=g.createBuffer(e.buffer,!1)}catch(j){return c(!1)}e=g.sampleRate;d=a.numberOfChannels;2===d?(b=a.getChannelData(0),a=a.getChannelData(1)):b=a=a.getChannelData(0);c({samplerate:e,channels:d,bufferL:b,bufferR:a,duration:b.length/e});f()};return function(e,c,f){if(e instanceof File){var d=new FileReader;d.onload=function(b){l(new Uint8Array(b.target.result),c,f)};d.readAsArrayBuffer(e)}else h.getBinaryWithPath(e,function(b){l(b,c,f)})}}}();h.moz_decode=function(){if("function"===typeof Audio&&
"function"===typeof(new Audio).mozSetup)return function(g,l,e){var c,f,d,b,a,j=0,o=new Audio(g);o.volume=0;o.addEventListener("loadedmetadata",function(){c=o.mozSampleRate;f=o.mozChannels;a=o.duration;d=new Float32Array(o.duration*c|0);b=2===f?new Float32Array(o.duration*c|0):d;2===f?o.addEventListener("MozAudioAvailable",function(a){for(var a=a.frameBuffer,c=0,f=a.length;c<f;c+=2)d[j]=a[c],b[j]=a[c+1],j+=1},!1):o.addEventListener("MozAudioAvailable",function(a){for(var a=a.frameBuffer,c=0,f=a.length;c<
f;++c)d[j]=b[j]=a[c],j+=1},!1);o.play();setTimeout(function(){l({samplerate:c,channels:f,bufferL:d,bufferR:b,duration:a})},1E3)},!1);o.addEventListener("ended",function(){e()},!1);o.load()}}()})(timbre);
(function(i){function h(a){this.samplerate=a||44100;this.value=l;this.status=k;this.curve="linear";this.step=1;this.emit=this.loopNode=this.releaseNode=null;this._envValue=new g(a);this._table=[];this._initValue=l;this._curveValue=0;this._defaultCurveType=c;this._counter=this._index=0}function g(a){this.samplerate=a;this.value=l;this.step=1;this._curveType=c;this._y2=this._y1=this._b1=this._a2=this._grow=this._curveValue=0}var l=h.ZERO=1.0E-6,e=h.CurveTypeSet=0,c=h.CurveTypeLin=1,f=h.CurveTypeExp=
2,d=h.CurveTypeSin=3,b=h.CurveTypeWel=4,a=h.CurveTypeCurve=5,j=h.CurveTypeSqr=6,o=h.CurveTypeCub=7,k=h.StatusWait=0,p=h.StatusGate=1,m=h.StatusSustain=2,t=h.StatusRelease=3,r=h.StatusEnd=4,n={set:e,lin:c,linear:c,exp:f,exponential:f,sin:d,sine:d,wel:b,welch:b,sqr:j,squared:j,cub:o,cubed:o};h.CurveTypeDict=n;var q=h.prototype;q.clone=function(){var a=new h(this.samplerate);a._table=this._table;a._initValue=this._initValue;a.setCurve(this.curve);null!==this.releaseNode&&a.setReleaseNode(this.releaseNode+
1);null!==this.loopNode&&a.setLoopNode(this.loopNode+1);a.setStep(this.step);a.reset();return a};q.setTable=function(a){this._initValue=a[0];this._table=a.slice(1);this.value=this._envValue.value=this._initValue;this._counter=this._index=0;this.status=k};q.setCurve=function(b){"number"===typeof b?(this._defaultCurveType=a,this._curveValue=b):this._defaultCurveType=n[b]||null;this.curve=b};q.setReleaseNode=function(a){"number"===typeof a&&0<a&&(this.releaseNode=a-1)};q.setLoopNode=function(a){"number"===
typeof a&&0<a&&(this.loopNode=a-1)};q.setStep=function(a){this.step=this._envValue.step=a};q.reset=function(){this.value=this._envValue.value=this._initValue;this._counter=this._index=0;this.status=k};q.release=function(){null!==this.releaseNode&&(this._counter=0,this.status=t)};q.getInfo=function(a){var b=this._table,c,d,j=0,f=Infinity,k=Infinity,e=!1;c=0;for(d=b.length;c<d;++c){this.loopNode===c&&(f=j);this.releaseNode===c&&(k=j=j<a?j+a:a);var o=b[c];Array.isArray(o)&&(j+=o[1])}Infinity!==f&&Infinity===
k&&(j+=a,e=!0);return{totalDuration:j,loopBeginTime:f,releaseBeginTime:k,isEndlessLoop:e}};q.calcStatus=function(){var b=this.status,d=this._table,j=this._index,f=this._counter,k=this._curveValue,e=this._defaultCurveType,o=this.loopNode,g=this.releaseNode,l=this._envValue,i,h,n=null;switch(b){case p:case t:for(;0>=f;)j>=d.length?b===p&&null!==o?j=o:(b=r,f=Infinity,n="ended"):b===p&&j===g?null!==o&&o<g?j=o:(b=m,f=Infinity,n="sustained"):(i=d[j++],f=i[0],h=null===i[2]?e:i[2],h===a&&(k=i[3],0.001>Math.abs(k)&&
(h=c)),i=i[1],f=l.setNext(f,i,h,k))}this.status=b;this.emit=n;this._index=j;this._counter=f;return b};q.next=function(){this.calcStatus()&1&&(this.value=this._envValue.next()||l);this._counter-=1;return this.value};q.process=function(a){var b=this._envValue,c,d=a.length;if(this.calcStatus()&1)for(c=0;c<d;++c)a[c]=b.next()||l;else{b=this.value||l;for(c=0;c<d;++c)a[c]=b}this.value=a[d-1];this._counter-=a.length};g.prototype.setNext=function(k,g,p,m){var l=this.value,i,h,t,r,n,g=0.001*g*this.samplerate/
this.step|0;1>g&&(g=1,p=e);switch(p){case e:this.value=k;break;case c:i=(k-l)/g;break;case f:i=0!==l?Math.pow(k/l,1/g):0;break;case d:m=Math.PI/g;h=0.5*(k+l);t=2*Math.cos(m);r=0.5*(k-l);n=r*Math.sin(0.5*Math.PI-m);break;case b:m=0.5*Math.PI/g;t=2*Math.cos(m);k>=l?(h=l,r=0,n=-Math.sin(m)*(k-l)):(h=k,r=l-k,n=Math.cos(m)*(l-k));break;case a:k=(k-l)/(1-Math.exp(m));h=l+k;t=k;i=Math.exp(m/g);break;case j:r=Math.sqrt(l);n=Math.sqrt(k);i=(n-r)/g;break;case o:r=Math.pow(l,0.33333333),n=Math.pow(k,0.33333333),
i=(n-r)/g}this.next=s[p];this._grow=i;this._a2=h;this._b1=t;this._y1=r;this._y2=n;return g};var s=[];s[e]=function(){return this.value};s[c]=function(){return this.value+=this._grow};s[f]=function(){return this.value*=this._grow};s[d]=function(){var a=this._b1*this._y1-this._y2;this.value=this._a2-a;this._y2=this._y1;this._y1=a;return this.value};s[b]=function(){var a=this._b1*this._y1-this._y2;this.value=this._a2+a;this._y2=this._y1;this._y1=a;return this.value};s[a]=function(){this._b1*=this._grow;
return this.value=this._a2-this._b1};s[j]=function(){this._y1+=this._grow;return this.value=this._y1*this._y1};s[o]=function(){this._y1+=this._grow;return this.value=this._y1*this._y1*this._y1};g.prototype.next=s[e];i.modules.Envelope=h;i.modules.EnvelopeValue=g})(timbre);
(function(i){function h(c){this.length=c=1<<Math.ceil(Math.log("number"===typeof c?c:512)*Math.LOG2E);this.buffer=new i.fn.SignalArray(c);this.real=new i.fn.SignalArray(c);this.imag=new i.fn.SignalArray(c);this._real=new i.fn.SignalArray(c);this._imag=new i.fn.SignalArray(c);this.mag=new i.fn.SignalArray(c>>1);this.minDecibels=-30;this.maxDecibels=-100;c=l.get(c);this._bitrev=c.bitrev;this._sintable=c.sintable;this._costable=c.costable}var g=h.prototype;g.setWindow=function(c){if("string"===typeof c){var f=
/([A-Za-z]+)(?:\(([01]\.?\d*)\))?/.exec(c);if(null!==f){var d=f[1].toLowerCase(),f=void 0!==f[2]?+f[2]:0.25;if(d=e[d]){this._window||(this._window=new i.fn.SignalArray(this.length));for(var b=this._window,a=0,j=this.length,f=0>f?0:1<f?1:f;a<j;++a)b[a]=d(a,j,f);this.windowName=c}}}};g.forward=function(c){var f=this.buffer,d=this.real,b=this.imag,a=this._window,j=this._bitrev,e=this._sintable,k=this._costable,g=f.length,m,l,i,h,q,s,w;if(a)for(m=0;m<g;++m)f[m]=c[m]*a[m];else f.set(c);for(m=0;m<g;++m)d[m]=
f[j[m]],b[m]=0;for(f=1;f<g;f=a){j=0;a=f+f;l=g/a;for(c=0;c<f;c++){i=k[j];h=e[j];for(m=c;m<g;m+=a)q=m+f,s=h*b[q]+i*d[q],w=i*b[q]-h*d[q],d[q]=d[m]-s,d[m]+=s,b[q]=b[m]-w,b[m]+=w;j+=l}}e=this.mag;for(m=0;m<g;++m)k=d[m],c=b[m],e[m]=Math.sqrt(k*k+c*c);return{real:d,imag:b}};g.inverse=function(c,f){var d=this.buffer,b=this._real,a=this._imag,j=this._bitrev,e=this._sintable,k=this._costable,g=d.length,m,l,i,h,q,s,w,u,v,x;for(m=0;m<g;++m)l=j[m],b[m]=+c[l],a[m]=-f[l];for(j=1;j<g;j=i){h=0;i=j+j;q=g/i;for(l=0;l<
j;l++){s=k[h];w=e[h];for(m=l;m<g;m+=i)u=m+j,v=w*a[u]+s*b[u],x=s*a[u]-w*b[u],b[u]=b[m]-v,b[m]+=v,a[u]=a[m]-x,a[m]+=x;h+=q}}for(m=0;m<g;++m)d[m]=b[m]/g;return d};g.getFrequencyData=function(c){var f=this.minDecibels,d,b=Math.min(this.mag.length,c.length);if(b){var a,j=this.mag,e=0;for(d=0;d<b;++d)a=j[d],c[d]=!a?f:20*Math.log(a)*Math.LOG10E,e<c[d]&&(e=c[d])}return c};var l={get:function(c){var f;if(!(f=l[c])){var d,b,a,j;f=new Int16Array(c);j=c>>1;for(d=b=0;;){f[d]=b;if(++d>=c)break;for(a=j;a<=b;)b-=
a,a>>=1;b+=a}b=Math.floor(Math.log(c)/Math.LN2);d=new i.fn.SignalArray((1<<b)-1);j=new i.fn.SignalArray((1<<b)-1);var e=2*Math.PI;b=0;for(a=d.length;b<a;++b)d[b]=Math.sin(e*(b/c)),j[b]=Math.cos(e*(b/c));f=l[c]={bitrev:f,sintable:d,costable:j}}return f}},e=function(){var c=Math.PI,f=2*Math.PI,d=Math.abs,b=Math.pow,a=Math.cos,j=Math.sin,e=Math.E;return{rectangular:function(){return 1},hann:function(b,c){return 0.5*(1-a(f*b/(c-1)))},hamming:function(b,c){return 0.54-0.46*a(f*b/(c-1))},tukery:function(b,
d,j){return b<j*(d-1)/2?0.5*(1+a(c*(2*b/(j*(d-1))-1))):(d-1)*(1-j/2)<b?0.5*(1+a(c*(2*b/(j*(d-1))-2/j+1))):1},cosine:function(a,b){return j(c*a/(b-1))},lanczos:function(a,b){return j(c*(2*a/(b-1)-1))/(c*(2*a/(b-1)-1))},triangular:function(a,b){return 2/(b+1)*((b+1)/2-d(a-(b-1)/2))},bartlett:function(a,b){return 2/(b-1)*((b-1)/2-d(a-(b-1)/2))},gaussian:function(a,c,d){return b(e,-0.5*b((a-(c-1)/2)/(d*(c-1)/2),2))},bartlettHann:function(b,c){return 0.62-0.48*d(b/(c-1)-0.5)-0.38*a(f*b/(c-1))},blackman:function(b,
d,j){var e=j/2;return(1-j)/2-0.5*a(f*b/(d-1))+e*a(4*c*b/(d-1))}}}();i.modules.FFT=h})(timbre);
(function(i){function h(c){this.samplerate=c||44100;this.wave=null;this.step=1;this.phase=this.value=this.frequency=0;this.feedback=!1;this._lastouts=this._x=0;this._coeff=g/this.samplerate;this._radtoinc=g/(2*Math.PI)}var g=1024,l=g-1,e=h.prototype;e.setWave=function(d){var b,a,j=this.wave;this.wave||(this.wave=new Float32Array(g+1));if("function"===typeof d)for(b=0;b<g;++b)j[b]=d(b/g);else if(i.fn.isSignalArray(d))if(d.length===j.length)j.set(d);else{a=d.length/g;for(b=0;b<g;++b)j[b]=d[b*a|0]}else"string"===
typeof d&&void 0!==(a=c(d))&&this.wave.set(a);this.wave[g]=this.wave[0]};e.reset=function(){this._x=0};e.next=function(){var c=this._x;this.value=this.wave[(c+this.phase*this._radtoinc|0)&l];c+=this.frequency*this._coeff*this.step;c>g&&(c-=g);this._x=c;return this.value};e.process=function(c){var b=this.wave,a=this._radtoinc,j,f=this._x,k,e,m=this.frequency*this._coeff,i,h=this.step;if(this.feedback){k=this._lastouts;a*=this.phase;for(i=0;i<h;++i)j=f+k*a,k=j|0,j-=k,k&=l,e=b[k],k=b[k+1],c[i]=k=e+j*
(k-e),f+=m;this._lastouts=k}else{a*=this.phase;for(i=0;i<h;++i)j=f+a,k=j|0,j-=k,k&=l,e=b[k],k=b[k+1],c[i]=e+j*(k-e),f+=m}f>g&&(f-=g);this._x=f;this.value=c[c.length-1]};e.processWithFreqArray=function(c,b){var a=this.wave,j=this._radtoinc,f,k=this._x,e,m,i=this._coeff,h,n=this.step;if(this.feedback){e=this._lastouts;j*=this.phase;for(h=0;h<n;++h)f=k+e*j,e=f|0,f-=e,e&=l,m=a[e],e=a[e+1],c[h]=e=m+f*(e-m),k+=b[h]*i;this._lastouts=e}else{j=this.phase*this._radtoinc;for(h=0;h<n;++h)f=k+j,e=f|0,f-=e,e&=
l,m=a[e],e=a[e+1],c[h]=m+f*(e-m),k+=b[h]*i}k>g&&(k-=g);this._x=k;this.value=c[c.length-1]};e.processWithPhaseArray=function(c,b){var a=this.wave,j=this._radtoinc,f,k=this._x,e,m,i=this.frequency*this._coeff,h,n=this.step;if(this.feedback){e=this._lastouts;j*=this.phase;for(h=0;h<n;++h)f=k+e*j,e=f|0,f-=e,e&=l,m=a[e],e=a[e+1],c[h]=e=m+f*(e-m),k+=i;this._lastouts=e}else for(h=0;h<n;++h)f=k+b[h]*j,e=f|0,f-=e,e&=l,m=a[e],e=a[e+1],c[h]=m+f*(e-m),k+=i;k>g&&(k-=g);this._x=k;this.value=c[c.length-1]};e.processWithFreqAndPhaseArray=
function(c,b,a){var j=this.wave,f=this._radtoinc,k,e=this._x,m,h,i=this._coeff,n,q=this.step;if(this.feedback){a=this._lastouts;f*=this.phase;for(n=0;n<q;++n)k=e+a*f,m=k|0,k-=m,m&=l,h=j[m],m=j[m+1],c[n]=a=h+k*(m-h),e+=b[n]*i;this._lastouts=a}else for(n=0;n<q;++n)k=e+a[n]*g,m=k|0,k-=m,m&=l,h=j[m],m=j[m+1],c[n]=h+k*(m-h),e+=b[n]*i;e>g&&(e-=g);this._x=e;this.value=c[c.length-1]};var c=function(c){var b=f[c];if(void 0!==b)return"function"===typeof b&&(b=b()),b;var a;a=/^([\-+]?)(\w+)(?:\((@[0-7])?:?(\d+)?\))?$/.exec(c);
if(null!==a){var b=a[1],j=a[3],e=a[4];a=f[a[2]];var k,g;if(void 0===a)b=void 0;else{"function"===typeof a&&(a=a());switch(j){case "@1":for(k=512;1024>k;++k)a[k]=0;break;case "@2":for(k=512;1024>k;++k)a[k]=Math.abs(a[k]);break;case "@3":for(k=256;512>k;++k)a[k]=0;for(k=512;768>k;++k)a[k]=Math.abs(a[k]);for(k=768;1024>k;++k)a[k]=0;break;case "@4":j=new Float32Array(1024);for(k=0;512>k;++k)j[k]=a[k<<1];a=j;break;case "@5":j=new Float32Array(1024);for(k=0;512>k;++k)j[k]=Math.abs(a[k<<1]);a=j}if(void 0!==
e&&50!==e){e*=0.01;e=0>e?0:1<e?1:e;j=new Float32Array(1024);e=1024*e|0;for(k=0;k<e;++k)j[k]=a[512*(k/e)|0];g=1024-e;for(e=0;1024>k;++k,++e)j[k]=a[512*(e/g)+512|0];a=j}if("+"===b)for(k=0;1024>k;++k)a[k]=0.5*a[k]+0.5;else if("-"===b)for(k=0;1024>k;++k)a[k]*=-1;b=a}if(void 0!==b)return f[c]=b}a=/^wavb\(((?:[0-9a-fA-F][0-9a-fA-F])+)\)$/.exec(c);if(null!==a){c=a[1];b=new Float32Array(1024);a=c.length>>1;if(-1!==[2,4,8,16,32,64,128,256,512,1024].indexOf(a))for(k=j=0;j<a;++j){e=parseInt(c.substr(2*j,2),
16);e=e&128?(e-256)/128:e/127;g=0;for(var m=1024/a;g<m;++g)b[k++]=e}return b}a=/^wavc\(([0-9a-fA-F]{8})\)$/.exec(c);if(null!==a){b=a[1];c=new Float32Array(1024);if(8===b.length){j=parseInt(b,16);a=new Float32Array(8);a[0]=1;for(b=0;7>b;++b)a[b+1]=0.0625*(j&15),j>>=4;for(b=0;8>b;++b){k=0;e=(b+1)/1024;for(j=0;1024>j;++j)c[j]+=Math.sin(2*Math.PI*k)*a[b],k+=e}for(b=a=0;1024>b;++b)if(a<(j=Math.abs(c[b])))a=j;if(0<a)for(b=0;1024>b;++b)c[b]/=a}return c}};h.getWavetable=c;h.setWavetable=function(c,b){var a,
j=new Float32Array(1024),e;if("function"===typeof b)for(e=0;1024>e;++e)j[e]=b(e/1024);else if(i.fn.isSignalArray(b))if(b.length===j.length)j.set(b);else{a=b.length/1024;for(e=0;1024>e;++e)j[e]=b[e*a|0]}f[c]=j};var f={sin:function(){for(var c=new Float32Array(1024),b=0;1024>b;++b)c[b]=Math.sin(2*Math.PI*(b/1024));return c},cos:function(){for(var c=new Float32Array(1024),b=0;1024>b;++b)c[b]=Math.cos(2*Math.PI*(b/1024));return c},pulse:function(){for(var c=new Float32Array(1024),b=0;1024>b;++b)c[b]=
512>b?1:-1;return c},tri:function(){for(var c=new Float32Array(1024),b,a=0;1024>a;++a)b=a/1024-0.25,c[a]=1-4*Math.abs(Math.round(b)-b);return c},saw:function(){for(var c=new Float32Array(1024),b,a=0;1024>a;++a)b=a/1024,c[a]=2*(b-Math.round(b));return c},fami:function(){for(var c=[0,0.125,0.25,0.375,0.5,0.625,0.75,0.875,0.875,0.75,0.625,0.5,0.375,0.25,0.125,0,-0.125,-0.25,-0.375,-0.5,-0.625,-0.75,-0.875,-1,-1,-0.875,-0.75,-0.625,-0.5,-0.375,-0.25,-0.125],b=new Float32Array(1024),a=0;1024>a;++a)b[a]=
c[a/1024*c.length|0];return b},konami:function(){for(var c=[-0.625,-0.875,-0.125,0.75,0.5,0.125,0.5,0.75,0.25,-0.125,0.5,0.875,0.625,0,0.25,0.375,-0.125,-0.75,0,0.625,0.125,-0.5,-0.375,-0.125,-0.75,-1,-0.625,0,-0.375,-0.875,-0.625,-0.25],b=new Float32Array(1024),a=0;1024>a;++a)b[a]=c[a/1024*c.length|0];return b}};i.modules.Oscillator=h})(timbre);
(function(i){function h(d,b){this.samplerate=d;var a,j,f=d/44100;j=2*e.length;this.comb=Array(j);this.combout=Array(j);for(a=0;a<j;++a)this.comb[a]=new g(e[a%e.length]*f),this.combout[a]=new i.fn.SignalArray(b);j=2*c.length;this.allpass=Array(j);for(a=0;a<j;++a)this.allpass[a]=new l(c[a%c.length]*f);this.outputs=[new i.fn.SignalArray(b),new i.fn.SignalArray(b)];this.damp=0;this.wet=0.33;this.setRoomSize(0.5);this.setDamp(0.5)}function g(c){this.buffer=new i.fn.SignalArray(c|0);this.buffersize=this.buffer.length;
this.damp=this.filterstore=this.feedback=this.bufidx=0}function l(c){this.buffer=new i.fn.SignalArray(c|0);this.buffersize=this.buffer.length;this.bufidx=0}var e=[1116,1188,1277,1356,1422,1491,1557,1617],c=[225,556,441,341],f=h.prototype;f.setRoomSize=function(c){var b=this.comb;this.roomsize=c;b[0].feedback=b[1].feedback=b[2].feedback=b[3].feedback=b[4].feedback=b[5].feedback=b[6].feedback=b[7].feedback=b[8].feedback=b[9].feedback=b[10].feedback=b[11].feedback=b[12].feedback=b[13].feedback=b[14].feedback=
b[15].feedback=0.28*c+0.7};f.setDamp=function(c){var b=this.comb;this.damp=c;b[0].damp=b[1].damp=b[2].damp=b[3].damp=b[4].damp=b[5].damp=b[6].damp=b[7].damp=b[8].damp=b[9].damp=b[10].damp=b[11].damp=b[12].damp=b[13].damp=b[14].damp=b[15].damp=0.4*c};f.process=function(c,b){var a=this.comb,j=this.combout,f=this.allpass,e=this.outputs[0],g=this.outputs[1],m=this.wet,h=1-m,l=c.length;a[0].process(c,j[0]);a[1].process(c,j[1]);a[2].process(c,j[2]);a[3].process(c,j[3]);a[4].process(c,j[4]);a[5].process(c,
j[5]);a[6].process(c,j[6]);a[7].process(c,j[7]);a[8].process(b,j[8]);a[9].process(b,j[9]);a[10].process(b,j[10]);a[11].process(b,j[11]);a[12].process(b,j[12]);a[13].process(b,j[13]);a[14].process(b,j[14]);a[15].process(b,j[15]);for(a=0;a<l;++a)e[a]=j[0][a]+j[1][a]+j[2][a]+j[3][a]+j[4][a]+j[5][a]+j[6][a]+j[7][a],g[a]=j[8][a]+j[9][a]+j[10][a]+j[11][a]+j[12][a]+j[13][a]+j[14][a]+j[15][a];f[0].process(e,e);f[1].process(e,e);f[2].process(e,e);f[3].process(e,e);f[4].process(g,g);f[5].process(g,g);f[6].process(g,
g);f[7].process(g,g);for(a=0;a<l;++a)c[a]=e[a]*m+c[a]*h,b[a]=g[a]*m+b[a]*h};g.prototype.process=function(c,b){var a,j,f=this.buffer,e=this.buffersize,g=this.bufidx,m=this.filterstore,h=this.feedback,l=this.damp,i=1-l,q,s=c.length;for(q=0;q<s;++q)a=0.015*c[q],j=f[g],m=j*i+m*l,f[g]=a+m*h,++g>=e&&(g=0),b[q]=j;this.bufidx=g;this.filterstore=m};l.prototype.process=function(c,b){var a,j,f,e=this.buffer,g=this.buffersize,m=this.bufidx,h,l=c.length;for(h=0;h<l;++h)a=c[h],f=e[m],j=-a+f,e[m]=a+0.5*f,++m>=g&&
(m=0),b[h]=j;this.bufidx=m};i.modules.Reverb=h})(timbre);
(function(i){function h(a){return new g(a)}function g(a){this.fragments=[];a&&this.fragments.push(new l(a,0,a.buffer.length/(a.samplerate||44100)))}function l(a,b,c,d,e,g,h){a||(a=f);this.buffer=a.buffer;this.samplerate=a.samplerate||44100;this.start=b;this._duration=c;this.reverse=d||!1;this.pitch=e||100;this.stretch=g||!1;this.pan=h||50}function e(a,b){this.tape=a;this.fragments=a.fragments;this.samplerate=b||44100;this.isEnded=!1;this.buffer=null;this.bufferEndIndex=this.bufferBeginIndex=this.bufferIndexIncr=
this.bufferIndex=0;this.fragment=null;this.fragmentIndex=0;this.panR=this.panL=0.7071067811865475}var c=new Float32Array(60),f={buffer:c,samplerate:1};h.silence=function(a){return(new h(f)).slice(0,1).fill(a)};h.join=function(a){for(var b=new g,c=0;c<a.length;c++)a[c]instanceof g&&b.add_fragments(a[c].fragments);return b};h.Tape=g;g.prototype.add_fragment=function(a){this.fragments.push(a);return this};g.prototype.add_fragments=function(a){for(var b=0;b<a.length;b++)this.fragments.push(a[b]);return this};
g.prototype.duration=function(){for(var a=0,b=0;b<this.fragments.length;b++)a+=this.fragments[b].duration();return a};g.prototype.slice=function(a,b){var c=this.duration();a+b>c&&(b=c-a);for(var c=new g,d=a,f=b,e=0;e<this.fragments.length;e++){var f=this.fragments[e].create(d,f),h=f[0],d=f[1],f=f[2];h&&c.add_fragment(h);if(0===f)break}return c};g.prototype.cut=g.prototype.slice;g.prototype.concat=function(a){var b=new g;b.add_fragments(this.fragments);b.add_fragments(a.fragments);return b};g.prototype.loop=
function(a){var b,c=[];for(b=0;b<this.fragments.length;b++)c.push(this.fragments[b].clone());var d=new g;for(b=0;b<a;b++)d.add_fragments(c);return d};g.prototype.times=g.prototype.loop;g.prototype.split=function(a){for(var b=this.duration()/a,c=[],d=0;d<a;d++)c.push(this.slice(d*b,b));return c};g.prototype.fill=function(a){var b=this.duration();if(0===b)throw"EmptyFragment";var c=a%b;return this.loop(a/b|0).plus(this.slice(0,c))};g.prototype.replace=function(a,b,c){var d=new g,b=a+b,d=d.plus(this.slice(0,
a)),f=d.duration();f<a&&(d=d.plus(h.silence(a-f)));d=d.plus(c);a=this.duration();a>b&&(d=d.plus(this.slice(b,a-b)));return d};g.prototype.reverse=function(){for(var a=new g,b=this.fragments.length;b--;){var c=this.fragments[b].clone();c.reverse=!c.isReversed();a.add_fragment(c)}return a};g.prototype.pitch=function(a,b){for(var c=new g,b=b||!1,d=0;d<this.fragments.length;d++){var f=this.fragments[d].clone();f.pitch*=0.01*a;f.stretch=b;c.add_fragment(f)}return c};g.prototype.stretch=function(a){return this.pitch(100*
(1/(0.01*a)),!0)};g.prototype.pan=function(a){var b=new g;100<a?a=100:0>a&&(a=0);for(var c=0;c<this.fragments.length;c++){var d=this.fragments[c].clone();d.pan=a;b.add_fragment(d)}return b};g.prototype.silence=function(){return h.silence(this.duration())};g.prototype.join=function(a){for(var b=new g,c=0;c<a.length;c++)a[c]instanceof g&&b.add_fragments(a[c].fragments);return b};l.prototype.duration=function(){return this._duration*(100/this.pitch)};l.prototype.original_duration=function(){return this._duration};
l.prototype.isReversed=function(){return this.reverse};l.prototype.isStretched=function(){return this.stretched};l.prototype.create=function(a,b){var c=this.duration();if(a>=c)return[null,a-c,b];a+b>=c?(c-=a,b-=c):(c=b,b=0);var d=this.clone();d.start=this.start+0.01*a*this.pitch;d._duration=0.01*c*this.pitch;d.reverse=!1;return[d,0,b]};l.prototype.clone=function(){var a=new l;a.buffer=this.buffer;a.samplerate=this.samplerate;a.start=this.start;a._duration=this._duration;a.reverse=this.reverse;a.pitch=
this.pitch;a.stretch=this.stretch;a.pan=this.pan;return a};h.Fragment=l;var d=function(){for(var a=new Float32Array(257),b=0;256>b;++b)a[b]=Math.sin(0.5*Math.PI*(b/256));a[256]=1;return a}(),b=function(){for(var a=new Float32Array(257),b=0;256>b;++b)a[b]=Math.cos(0.5*Math.PI*(b/256));a[256]=0;return a}();h.TapeStream=e;e.prototype.reset=function(){this.isEnded=!1;this.buffer=null;this.bufferEndIndex=this.bufferBeginIndex=this.bufferIndexIncr=this.bufferIndex=0;this.fragment=null;this.fragmentIndex=
0;this.panR=this.panL=0.7071067811865475;this.isLooped=!1;return this};e.prototype.fetch=function(a){var f=new i.fn.SignalArray(a),e=new i.fn.SignalArray(a),k=this.fragments;if(0===k.length)return[f,e];for(var g=100*this.samplerate,m=this.buffer,h=this.bufferIndex,l=this.bufferIndexIncr,n=this.bufferBeginIndex,q=this.bufferEndIndex,s=this.fragment,w=this.fragmentIndex,u=this.panL,v=this.panR,x=0;x<a;x++){for(;!m||h<n||h>=q;)if(!s||w<k.length)s=k[w++],m=s.buffer,l=s.samplerate/g*s.pitch,n=s.start*
s.samplerate,q=n+s.original_duration()*s.samplerate,h=256*(s.pan/100)|0,u=b[h],v=d[h],s.reverse?(l*=-1,h=q+l):h=n;else if(this.isLooped)m=null,q=n=l=h=0,s=null,w=0;else{this.isEnded=!0;m=c;h=l=0;break}f[x]=m[h|0]*u;e[x]=m[h|0]*v;h+=l}this.buffer=m;this.bufferIndex=h;this.bufferIndexIncr=l;this.bufferBeginIndex=n;this.bufferEndIndex=q;this.fragment=s;this.fragmentIndex=w;this.panL=u;this.panR=v;return[f,e]};i.modules.Scissor=h})(timbre);
(function(i){function h(g){this.samplerate=g;this.buffersize=1<<Math.ceil(Math.log(1.5*g)*Math.LOG2E);this.buffermask=this.buffersize-1;this.writeBufferL=new i.fn.SignalArray(this.buffersize);this.writeBufferR=new i.fn.SignalArray(this.buffersize);this.readBufferL=this.writeBufferL;this.readBufferR=this.writeBufferR;this.mix=this.cross=this.feedback=this.delaytime=null;this.writeIndex=this.readIndex=this.prevR=this.prevL=0;this.setParams(125,0.25,!1,0.45)}var g=h.prototype;g.setParams=function(g,
e,c,f){this.delaytime!==g&&(this.delaytime=g,g=0.001*g*this.samplerate|0,g>this.buffermask&&(g=this.buffermask),this.writeIndex=this.readIndex+g&this.buffermask);this.feedback!==e&&(this.feedback=e);this.cross!==c&&((this.cross=c)?(this.readBufferL=this.writeBufferR,this.readBufferR=this.writeBufferL):(this.readBufferL=this.writeBufferL,this.readBufferR=this.writeBufferR));this.mix!==f&&(this.mix=f)};g.process=function(g,e){var c=this.readBufferL,f=this.readBufferR,d=this.writeBufferL,b=this.writeBufferR,
a=this.readIndex,j=this.writeIndex,o=this.buffermask,k=this.feedback,p=this.mix,m=1-p,h=this.prevL,i=this.prevR,n,q,s=g.length;for(q=0;q<s;++q)n=c[a],d[j]=g[q]-n*k,g[q]=h=0.5*(g[q]*m+n*p+h),n=f[a],b[j]=e[q]-n*k,e[q]=i=0.5*(e[q]*m+n*p+i),a+=1,j=j+1&o;this.readIndex=a&this.buffermask;this.writeIndex=j;this.prevL=h;this.prevR=i};i.modules.StereoDelay=h})(timbre);
(function(i){var h=i.fn,g=i.modules;h.register("audio",function(c){c=new (h.getClass("buffer"))(c);c.playbackState=h.FINISHED_STATE;c._.isLoaded=!1;Object.defineProperties(c,{isLoaded:{get:function(){return this._.isLoaded}}});c.load=l;c.loadthis=e;return c});var l=function(c){var f=this,d=this._,b=new g.Deferred(this),a=arguments,j=1;b.done(function(){f._.emit("done")});"function"===typeof a[j]&&(b.done(a[j++]),"function"===typeof a[j]&&b.fail(a[j++]));d.loadedTime=0;(new g.Decoder).decode(c,function(a,
c){var d=f._;if(a){f.playbackState=h.PLAYING_STATE;d.samplerate=a.samplerate;d.channels=a.channels;d.bufferMix=null;d.bufferL=a.bufferL;d.bufferR=a.bufferR;d.phase=0;d.phaseIncr=a.samplerate/i.samplerate;d.duration=a.duration*1E3;d.currentTime=0;if(d.isReversed){d.phaseIncr=d.phaseIncr*-1;d.phase=a.bufferL.length+d.phaseIncr}f._.emit("loadedmetadata")}else b.reject(c)},function(){f._.isLoaded=true;f._.plotFlush=true;f._.emit("loadeddata");b.resolveWith(f)});return b.promise()},e=function(){l.apply(this,
arguments);return this}})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);g.fixAR(this);a=this._;a.biquad=new e(a.samplerate);a.freq=i(340);a.band=i(1);a.gain=i(0);a.plotBefore=c;a.plotRange=[-18,18];a.plotFlush=!0}var g=i.fn,l=i.modules.FFT,e=i.modules.Biquad;g.extend(h);var c=function(a,b,c,d,f){a.lineWidth=1;a.strokeStyle="rgb(192, 192, 192)";for(var e=0.5*this._.samplerate,g=1;10>=g;++g)for(var h=1;4>=h;h++){var i=g*Math.pow(10,h);20>=i||e<=i||(a.beginPath(),i=Math.log(i/20)/Math.log(e/20),i=(i*d+b|0)+0.5,a.moveTo(i,
c),a.lineTo(i,c+f),a.stroke())}f/=6;for(g=1;6>g;g++)a.beginPath(),e=(c+g*f|0)+0.5,a.moveTo(b,e),a.lineTo(b+d,e),a.stroke()},f=h.prototype;Object.defineProperties(f,{type:{set:function(a){var b=this._;a!==b.biquad.type&&(b.biquad.setType(a),b.plotFlush=!0)},get:function(){return this._.biquad.type}},freq:{set:function(a){this._.freq=i(a)},get:function(){return this._.freq}},cutoff:{set:function(a){this._.freq=i(a)},get:function(){return this._.freq}},res:{set:function(a){this._.band=i(a)},get:function(){return this._.band}},
Q:{set:function(a){this._.band=i(a)},get:function(){return this._.band}},band:{set:function(a){this._.band=i(a)},get:function(){return this._.band}},gain:{set:function(a){this._.gain=i(a)},get:function(){return this._.gain}}});f.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;g.inputSignalAR(this);var c=b.freq.process(a).cells[0][0],d=b.band.process(a).cells[0][0],a=b.gain.process(a).cells[0][0];if(b.prevFreq!==c||b.prevband!==d||b.prevGain!==a)b.prevFreq=c,b.prevband=d,b.prevGain=
a,b.biquad.setParams(c,d,a),b.plotFlush=!0;b.bypassed||b.biquad.process(this.cells[1],this.cells[2]);g.outputSignalAR(this)}return this};var d=new l(2048),b=i.Object.prototype.plot;f.plot=function(a){if(this._.plotFlush){var c=new e(this._.samplerate);c.setType(this.type);c.setParams(this.freq.valueOf(),this.band.valueOf(),this.gain.valueOf());var f=new Float32Array(d.length);f[0]=1;c.process(f,f);d.forward(f);var c=new Float32Array(512),f=0.5*this._.samplerate,k=new Float32Array(512),g,h,i,l;d.getFrequencyData(k);
for(g=0;512>g;++g)i=20*Math.pow(f/20,g/512),h=i/(f/k.length),i=h|0,h-=i,0===i?i=k[i]:(l=k[i-1],i=k[i],i=(1-h)*l+h*i),c[g]=i;this._.plotData=c;this._.plotFlush=null}return b.call(this,a)};g.register("biquad",h);g.register("lowpass",function(a){return(new h(a)).set("type","lowpass")});g.register("highpass",function(a){return(new h(a)).set("type","highpass")});g.register("bandpass",function(a){return(new h(a)).set("type","bandpass")});g.register("lowshelf",function(a){return(new h(a)).set("type","lowshelf")});
g.register("highshelf",function(a){return(new h(a)).set("type","highshelf")});g.register("peaking",function(a){return(new h(a)).set("type","peaking")});g.register("notch",function(a){return(new h(a)).set("type","notch")});g.register("allpass",function(a){return(new h(a)).set("type","allpass")});g.alias("lpf","lowpass");g.alias("hpf","highpass");g.alias("bpf","bandpass");g.alias("bef","notch");g.alias("brf","notch");g.alias("apf","allpass")})(timbre);
(function(i){function h(b){i.Object.call(this,1,b);g.fixAR(this);b=this._;b.pitch=i(1);b.samplerate=44100;b.channels=0;b.bufferMix=null;b.bufferL=new Float32Array(0);b.bufferR=b.bufferL;b.isLooped=!1;b.isReversed=!1;b.duration=0;b.currentTime=0;b.currentTimeObj=null;b.phase=0;b.phaseIncr=0;b.onended=g.make_onended(this,0);b.onlooped=e(this)}var g=i.fn,l=g.isSignalArray;g.extend(h);var e=function(b){return function(){var a=b._;a.phase>=a.bufferL.length?a.phase=0:0>a.phase&&(a.phase=a.bufferL.length+
a.phaseIncr);b._.emit("looped")}},c=h.prototype,f=function(b){var a=this._;if("object"===typeof b){var c,d,f;if(l(b))c=d=b;else if("object"===typeof b&&(l(b.bufferL)&&l(b.bufferR)?(c=b.bufferL,d=b.bufferR):l(b.buffer)&&(c=d=b.buffer),"number"===typeof b.samplerate))f=b.samplerate;c&&d&&(0<f&&(a.samplerate=b.samplerate),a.bufferMix=null,a.bufferL=c,a.bufferR=d,a.phase=0,a.phaseIncr=a.samplerate/i.samplerate,a.duration=1E3*a.bufferL.length/a.samplerate,a.currentTime=0,a.plotFlush=!0,this.reverse(a.isReversed))}};
Object.defineProperties(c,{buffer:{set:f,get:function(){var b=this._;if(2===b.channels){if(!b.bufferMix){for(var a=new Float32Array(b.bufferL),c=b.bufferR,d=0,f=b.bufferMix.length;d<f;d++)a[d]=0.5*(a[d]+c[d]);b.bufferMix=a}return b.bufferMix}return b.bufferL}},bufferL:{get:function(){return this._.bufferL}},bufferR:{get:function(){return this._.bufferR}},pitch:{set:function(b){this._.pitch=i(b)},get:function(){return this._.pitch}},isLooped:{get:function(){return this._.isLooped}},isReversed:{get:function(){return this._.isReversed}},
samplerate:{get:function(){return this._.samplerate}},duration:{get:function(){return this._.duration}},currentTime:{set:function(b){if("number"===typeof b){var a=this._;0<=b&&b<=a.duration&&(a.phase=b/1E3*a.samplerate,a.currentTime=b)}else b instanceof i.Object?this._.currentTimeObj=b:null===b&&(this._.currentTimeObj=null)},get:function(){return this._.currentTimeObj?this._.currentTimeObj:this._.currentTime}}});c.clone=function(){var b=this._,a=i("buffer");b.bufferL&&(2===b.channels?f.call(a,{bufferL:b.bufferL,
bufferR:b.bufferR,samplerate:b.samplerate}):f.call(a,{buffer:b.bufferL,samplerate:b.samplerate}));a.loop(b.isLooped);a.reverse(b.isReversed);return a};c.slice=function(b,a){var c=this._,d=i(c.originkey),b="number"===typeof b?0.001*b*c.samplerate|0:0,a="number"===typeof a?0.001*a*c.samplerate|0:c.bufferL.length;if(b>a)var e=b,b=a,a=e;c.bufferL&&(2===c.channels?f.call(d,{bufferL:c.bufferL.subarray(b,a),bufferR:c.bufferR.subarray(b,a),samplerate:c.samplerate}):f.call(d,{buffer:c.bufferL.subarray(b,a),
samplerate:c.samplerate}),d.playbackState=g.PLAYING_STATE);d.loop(c.isLooped);d.reverse(c.isReversed);return d};c.reverse=function(b){var a=this._;a.isReversed=!!b;if(a.isReversed){if(0<a.phaseIncr&&(a.phaseIncr*=-1),0===a.phase&&a.buffer)a.phase=a.bufferL.length+a.phaseIncr}else 0>a.phaseIncr&&(a.phaseIncr*=-1);return this};c.loop=function(b){this._.isLooped=!!b;return this};c.bang=function(b){this.playbackState=!1===b?g.FINISHED_STATE:g.PLAYING_STATE;this._.phase=0;this._.emit("bang");return this};
c.process=function(b){var a=this._;if(!a.bufferL)return this;if(this.tickID!==b){this.tickID=b;var c=this.cells[1],d=this.cells[2],f=a.bufferL,e=a.bufferR,h=a.phase,i=a.cellsize;if(a.currentTimeObj){for(var l=a.currentTimeObj.process(b).cells[0],n,q=0.001*a.samplerate,b=0;b<i;++b)n=l[b],h=n*q,c[b]=f[h|0]||0,d[b]=e[h|0]||0;a.phase=h;a.currentTime=n}else{b=a.pitch.process(b).cells[0][0];n=a.phaseIncr*b;for(b=0;b<i;++b)c[b]=f[h|0]||0,d[b]=e[h|0]||0,h+=n;h>=f.length?a.isLooped?g.nextTick(a.onlooped):
g.nextTick(a.onended):0>h&&(a.isLooped?g.nextTick(a.onlooped):g.nextTick(a.onended));a.phase=h;a.currentTime+=g.currentTimeIncr}g.outputSignalAR(this)}return this};var d=i.Object.prototype.plot;c.plot=function(b){var a=this._,c=a.bufferL,f=a.bufferR;if(a.plotFlush){for(var e=new Float32Array(2048),g=0,h=c.length/2048,i=0;2048>i;i++)e[i]=0.5*(c[g|0]+f[g|0]),g+=h;a.plotData=e;a.plotFlush=null}return d.call(this,b)};g.register("buffer",h)})(timbre);
(function(i){function h(c){i.Object.call(this,2,c);g.fixAR(this);c=new l(this._.samplerate);c.setDelayTime(20);c.setRate(4);c.depth=20;c.feedback=0.2;c.mix=0.33;this._.chorus=c}var g=i.fn,l=i.modules.Chorus;g.extend(h);var e=h.prototype;Object.defineProperties(e,{type:{set:function(c){this._.chorus.setDelayTime(c)},get:function(){return this._.chorus.wave}},delay:{set:function(c){0.5<=c&&80>=c&&this._.chorus.setDelayTime(c)},get:function(){return this._.chorus.delayTime}},rate:{set:function(c){"number"===
typeof c&&0<c&&this._.chorus.setRate(c)},get:function(){return this._.chorus.rate}},depth:{set:function(c){"number"===typeof c&&(0<=c&&100>=c)&&(c*=this._.samplerate/44100,this._.chorus.depth=c)},get:function(){return this._.chorus.depth}},fb:{set:function(c){"number"===typeof c&&(-1<=c&&1>=c)&&(this._.chorus.feedback=0.99996*c)},get:function(){return this._.chorus.feedback}},mix:{set:function(c){this._.mix=i(c)},get:function(){return this._.mix}}});e.process=function(c){var f=this._;this.tickID!==
c&&(this.tickID=c,g.inputSignalAR(this),f.bypassed||f.chorus.process(this.cells[1],this.cells[2]),g.outputSignalAR(this));return this};g.register("chorus",h)})(timbre);
(function(i){function h(e){i.Object.call(this,2,e);e=this._;e.min=-0.8;e.max=0.8}var g=i.fn;g.extend(h);var l=h.prototype;Object.defineProperties(l,{minmax:{set:function(e){var c=this._;"number"===typeof e&&(c.min=-Math.abs(e),c.max=-c.min)},get:function(){return this._.max}},min:{set:function(e){var c=this._;"number"===typeof e&&(c.max<e?c.max=e:c.min=e)},get:function(){return this._.min}},max:{set:function(e){var c=this._;"number"===typeof e&&(e<c.min?c.min=e:c.max=e)},get:function(){return this._.max}}});
l.process=function(e){var c=this._;if(this.tickID!==e){this.tickID=e;var e=this.cells[1],f=this.cells[2],d=e.length,b=c.min,a=c.max,j;if(c.ar){g.inputSignalAR(this);for(c=0;c<d;++c)j=e[c],j<b?j=b:j>a&&(j=a),e[c]=j,j=f[c],j<b?j=b:j>a&&(j=a),f[c]=j;g.outputSignalAR(this)}else j=g.inputSignalKR(this),j<b?j=b:j>a&&(j=a),this.cells[0][0]=j,g.outputSignalKR(this)}return this};g.register("clip",h)})(timbre);
(function(i){function h(c){i.Object.call(this,2,c);g.fixAR(this);c=this._;c.prevThresh=-24;c.prevKnee=0;c.prevRatio=12;c.thresh=i(c.prevThresh);c.knee=0;c.ratio=i(c.prevRatio);c.comp=new l(c.samplerate);c.comp.setParams(c.prevThresh,c.prevKnee,c.prevRatio)}var g=i.fn,l=i.modules.Compressor;g.extend(h);var e=h.prototype;Object.defineProperties(e,{thresh:{set:function(c){this._.thresh=i(c)},get:function(){return this._.thresh}},knee:{set:function(c){this._.kne=i(c)},get:function(){return this._.knee}},
ratio:{set:function(c){this._.ratio=i(c)},get:function(){return this._.ratio}}});e.process=function(c){var f=this._;if(this.tickID!==c){this.tickID=c;g.inputSignalAR(this);var d=f.thresh.process(c).cells[0][0],c=f.ratio.process(c).cells[0][0];if(f.prevThresh!==d||0!==f.prevKnee||f.prevRatio!==c)f.prevThresh=d,f.prevKnee=0,f.prevRatio=c,f.comp.setParams(d,0,c);f.bypassed||f.comp.process(this.cells[1],this.cells[2]);g.outputSignalAR(this)}return this};g.register("comp",h)})(timbre);
(function(i){function h(c){i.Object.call(this,2,c);g.fixAR(this);c=this._;c.time=i(100);c.fb=i(0.2);c.cross=i(!1);c.mix=0.33;c.delay=new e(c.samplerate)}var g=i.fn,l=i.timevalue,e=i.modules.StereoDelay;g.extend(h);var c=h.prototype;Object.defineProperties(c,{time:{set:function(c){"string"===typeof c&&(c=l(c));this._.time=i(c)},get:function(){return this._.time}},fb:{set:function(c){this._.fb=i(c)},get:function(){return this._.fb}},cross:{set:function(c){this._.cross=i(c)},get:function(){return this._.cross}},
mix:{set:function(c){"number"===typeof c&&(this._.mix=1<c?1:0>c?0:c)},get:function(){return this._.mix}}});c.process=function(c){var d=this._;if(this.tickID!==c){this.tickID=c;var b=d.time.process(c).cells[0][0],a=d.fb.process(c).cells[0][0],c=0!==d.cross.process(c).cells[0][0],e=d.mix;if(d.prevTime!==b||d.prevFb!==a||d.prevCross!==c||d.prevMix!==e)d.prevTime=b,d.prevFb=a,d.prevCross=c,d.prevMix=e,d.delay.setParams(b,a,c,e);g.inputSignalAR(this);d.bypassed||d.delay.process(this.cells[1],this.cells[2]);
g.outputSignalAR(this)}return this};g.register("delay",h)})(timbre);
(function(i){function h(e){i.Object.call(this,2,e);g.fixAR(this);e=this._;e.pre=i(60);e.post=i(-18);e.x1L=e.x2L=e.y1L=e.y2L=0;e.x1R=e.x2R=e.y1R=e.y2R=0;e.b0=e.b1=e.b2=e.a1=e.a2=0;e.cutoff=0;e.Q=1;e.preScale=0;e.postScale=0}var g=i.fn;g.extend(h);var l=h.prototype;Object.defineProperties(l,{cutoff:{set:function(e){"number"===typeof e&&0<e&&(this._.cutoff=e)},get:function(){return this._.cutoff}},pre:{set:function(e){this._.pre=i(e)},get:function(){return this._.pre}},post:{set:function(e){this._.post=
i(e)},get:function(){return this._.post}}});l.process=function(e){var c=this._;if(this.tickID!==e){this.tickID=e;g.inputSignalAR(this);var f=-c.pre.process(e).cells[0][0],e=-c.post.process(e).cells[0][0];if(c.prevPreGain!==f||c.prevPostGain!==e)c.prevPreGain=f,c.prevPostGain=e,c.preScale=Math.pow(10,0.05*-f),c.postScale=Math.pow(10,0.05*-e);if(!c.bypassed){var f=this.cells[1],e=this.cells[2],d=c.preScale,b=c.postScale,a,j,h,k,p;if(c.cutoff){c.prevCutoff!==c.cutoff&&(c.prevCutoff=c.cutoff,j=2*Math.PI*
c.cutoff/c.samplerate,a=Math.cos(j),j=Math.sin(j)/(2*c.Q),h=1/(1+j),c.b0=0.5*(1-a)*h,c.b1=1-a*h,c.b2=0.5*(1-a)*h,c.a1=-2*a*h,c.a2=1-j*h);var i=c.x1L,l=c.x2L,r=c.y1L,n=c.y2L,q=c.x1R,s=c.x2R,w=c.y1R,u=c.y2R,v=c.b0,x=c.b1,y=c.b2,z=c.a1,C=c.a2;a=0;for(j=f.length;a<j;++a)k=f[a]*d,p=v*k+x*i+y*l-z*r-C*n,h=p*b,-1>h?h=-1:1<h&&(h=1),f[a]=h,l=i,i=k,n=r,r=p,k=e[a]*d,p=v*k+x*q+y*s-z*w-C*u,h=p*b,-1>h?h=-1:1<h&&(h=1),e[a]=h,s=q,q=k,u=w,w=p;c.x1L=i;c.x2L=l;c.y1L=r;c.y2L=n;c.x1R=q;c.x2R=s;c.y1R=w;c.y2R=u}else{a=0;
for(j=f.length;a<j;++a)h=f[a]*d*b,-1>h?h=-1:1<h&&(h=1),f[a]=h,h=e[a]*d*b,-1>h?h=-1:1<h&&(h=1),e[a]=h}}g.outputSignalAR(this)}return this};g.register("dist",h)})(timbre);
(function(i){function h(g){i.Object.call(this,2,g);this._.ar=!1}var g=i.fn;g.extend(h);h.prototype.process=function(h){var e=this._;if(this.tickID!==h){this.tickID=h;var c=this.nodes,f=this.cells[0],d=this.cells[1],b=this.cells[2],a,j=c.length,i=f.length,k,p;if(e.ar){if(0<c.length){c[0].process(h);k=c[0].cells[1];p=c[0].cells[2];d.set(k);b.set(p);for(a=1;a<j;++a){c[a].process(h);k=c[a].cells[1];p=c[a].cells[2];for(f=0;f<i;++f)e=k[f],d[f]=0===e?0:d[f]/e,e=p[f],b[f]=0===e?0:b[f]/e}}else for(f=0;f<i;++f)d[f]=
b[a]=0;g.outputSignalAR(this)}else{if(0<c.length){d=c[0].process(h).cells[0][0];for(a=1;a<j;++a)e=c[a].process(h).cells[0][0],d=0===e?0:d/e}else d=0;f[0]=d;g.outputSignalKR(this)}}return this};g.register("/",h)})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);a=this._;a.env=new c(a.samplerate);a.env.setStep(a.cellsize);a.tmp=new l.SignalArray(a.cellsize);a.ar=!1;a.plotFlush=!0;a.onended=b(this);this.on("ar",d)}function g(a,b,c,d,f,e){"number"===typeof a[d]?c=a[d]:"number"===typeof a[f]?c=a[f]:e&&("string"===typeof a[d]?c=e(a[d]):"string"===typeof a[f]&&(c=e(a[f])));c<b&&(c=b);return c}var l=i.fn,e=i.timevalue,c=i.modules.Envelope,f=l.isDictionary;l.extend(h);var d=function(a){this._.env.setStep(a?1:this._.cellsize)},
b=function(a){return function(){a._.emit("ended")}},a=h.prototype;Object.defineProperties(a,{table:{set:function(a){if(Array.isArray(a)){for(var b=this._.env,d=[a[0]||o],f,j,g,h,i=1,l=a.length;i<l;++i)f=a[i][0]||o,j=a[i][1],g=a[i][2],"number"!==typeof j&&(j="string"===typeof j?e(j):10),10>j&&(j=10),"number"===typeof g?(h=g,g=c.CurveTypeCurve):(g=c.CurveTypeDict[g]||null,h=0),d.push([f,j,g,h]);b.setTable(d);this._.plotFlush=!0}},get:function(){return this._.env.table}},curve:{set:function(a){this._.env.setCurve(a)},
get:function(){return this._.env.curve}},releaseNode:{set:function(a){this._.env.setReleaseNode(a);this._.plotFlush=!0},get:function(){return this._.env.releaseNode+1}},loopNode:{set:function(a){this._.env.setLoopNode(a);this._.plotFlush=!0},get:function(){return this._.env.loopNode+1}}});a.clone=function(){var a=new h([]);a._.env=this._.env.clone();a._.ar=this._.ar;return a};a.reset=function(){this._.env.reset();return this};a.release=function(){var a=this._;a.env.release();a.emit("released");return this};
a.bang=function(){var a=this._;a.env.reset();a.env.status=c.StatusGate;a.emit("bang");return this};a.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;var a=this.cells[1],c=this.cells[2],d,f=b.cellsize;if(this.nodes.length)l.inputSignalAR(this);else for(d=0;d<f;++d)a[d]=c[d]=1;var e;d=null;if(b.ar){e=b.tmp;b.env.process(e);for(d=0;d<f;++d)a[d]*=e[d],c[d]*=e[d]}else{e=b.env.next();for(d=0;d<f;++d)a[d]*=e,c[d]*=e}d=b.env.emit;l.outputSignalAR(this);d&&("ended"===d?l.nextTick(b.onended):
this._.emit(d,b.value))}return this};var j=i.Object.prototype.plot;a.plot=function(a){if(this._.plotFlush){var b=this._.env.clone(),d=b.getInfo(1E3),f=d.totalDuration,e=d.loopBeginTime,g=d.releaseBeginTime,d=new Float32Array(256),h=0,i=f/d.length,o=!1,l=0.001*f*this._.samplerate|0,v,l=l/d.length;b.setStep(l);b.status=c.StatusGate;l=0;for(v=d.length;l<v;++l)d[l]=b.next(),h+=i,!o&&h>=g&&(b.release(),o=!0);this._.plotData=d;this._.plotBefore=function(a,b,c,d,j){var k;Infinity!==e&&Infinity!==g&&(c=b+
d*(e/f),k=b+d*(g/f),a.fillStyle="rgba(224, 224, 224, 0.8)",a.fillRect(c,0,k-c,j));Infinity!==g&&(c=b+d*(g/f),a.fillStyle="rgba(212, 212, 212, 0.8)",a.fillRect(c,0,d-c,j))};b=Infinity;h=-Infinity;for(l=0;l<v;++l)d[l]<b?b=d[l]:d[l]>h&&(h=d[l]);1>h&&(h=1);this._.plotRange=[b,h];this._.plotData=d;this._.plotFlush=null}return j.call(this,a)};l.register("env",h);var o=c.ZERO;l.register("perc",function(a){f(a[0])||a.unshift({});var b=a[0],c=g(b,10,10,"a","attackTime",e),d=g(b,10,1E3,"r","decayTime",e),j=
g(b,o,1,"lv","level");b.table=[o,[j,c],[o,d]];return new h(a)});l.register("adsr",function(a){f(a[0])||a.unshift({});var b=a[0],c=g(b,10,10,"a","attackTime",e),d=g(b,10,300,"d","decayTime",e),j=g(b,o,0.5,"s","sustainLevel"),i=g(b,10,1E3,"r","decayTime",e),l=g(b,o,1,"lv","level");b.table=[o,[l,c],[j,d],[o,i]];b.releaseNode=3;return new h(a)});l.register("adshr",function(a){f(a[0])||a.unshift({});var b=a[0],c=g(b,10,10,"a","attackTime",e),d=g(b,10,300,"d","decayTime",e),j=g(b,o,0.5,"s","sustainLevel"),
i=g(b,10,500,"h","holdTime",e),l=g(b,10,1E3,"r","decayTime",e),s=g(b,o,1,"lv","level");b.table=[o,[s,c],[j,d],[j,i],[o,l]];return new h(a)});l.register("asr",function(a){f(a[0])||a.unshift({});var b=a[0],c=g(b,10,10,"a","attackTime",e),d=g(b,o,0.5,"s","sustainLevel"),j=g(b,10,1E3,"r","releaseTime",e);b.table=[o,[d,c],[o,j]];b.releaseNode=2;return new h(a)});l.register("dadsr",function(a){f(a[0])||a.unshift({});var b=a[0],c=g(b,10,100,"dl","delayTime",e),d=g(b,10,10,"a","attackTime",e),j=g(b,10,300,
"d","decayTime",e),i=g(b,o,0.5,"s","sustainLevel"),l=g(b,10,1E3,"r","relaseTime",e),s=g(b,o,1,"lv","level");b.table=[o,[o,c],[s,d],[i,j],[o,l]];b.releaseNode=4;return new h(a)});l.register("ahdsfr",function(a){f(a[0])||a.unshift({});var b=a[0],c=g(b,10,10,"a","attackTime",e),d=g(b,10,10,"h","holdTime",e),j=g(b,10,300,"d","decayTime",e),i=g(b,o,0.5,"s","sustainLevel"),l=g(b,10,5E3,"f","fadeTime",e),s=g(b,10,1E3,"r","relaseTime",e),w=g(b,o,1,"lv","level");b.table=[o,[w,c],[w,d],[i,j],[o,l],[o,s]];b.releaseNode=
5;return new h(a)});l.register("linen",function(a){f(a[0])||a.unshift({});var b=a[0],c=g(b,10,10,"a","attackTime",e),d=g(b,10,1E3,"s","sustainTime",e),j=g(b,10,1E3,"r","releaseTime",e),i=g(b,o,1,"lv","level");b.table=[o,[i,c],[i,d],[o,j]];return new h(a)});l.register("env.tri",function(a){f(a[0])||a.unshift({});var b=a[0],c=g(b,20,1E3,"dur","duration",e),d=g(b,o,1,"lv","level"),c=0.5*c;b.table=[o,[d,c],[o,c]];return new h(a)});l.register("env.cutoff",function(a){f(a[0])||a.unshift({});var b=a[0],
c=g(b,10,100,"r","relaseTime",e),d=g(b,o,1,"lv","level");b.table=[d,[o,c]];return new h(a)})})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);g.fixAR(this);a=this._;a.biquads=Array(7);a.plotBefore=f;a.plotRange=[-18,18];a.plotFlush=!0}var g=i.fn,l=i.modules.FFT,e=i.modules.Biquad,c={hpf:0,lf:1,lmf:2,mf:3,hmf:4,hf:5,lpf:6};g.extend(h);var f=function(a,b,c,d,f){a.lineWidth=1;a.strokeStyle="rgb(192, 192, 192)";for(var e=0.5*this._.samplerate,g=1;10>=g;++g)for(var h=1;4>=h;h++){var i=g*Math.pow(10,h);20>=i||e<=i||(a.beginPath(),i=Math.log(i/20)/Math.log(e/20),i=(i*d+b|0)+0.5,a.moveTo(i,c),
a.lineTo(i,c+f),a.stroke())}f/=6;for(g=1;6>g;g++)a.beginPath(),e=(c+g*f|0)+0.5,a.moveTo(b,e),a.lineTo(b+d,e),a.stroke()},d=h.prototype;Object.defineProperties(d,{params:{set:function(a){if("object"===typeof a)for(var b=Object.keys(a),c=0,d=b.length;c<d;++c){var f=a[b[c]];Array.isArray(f)?this.setParams(b[c],f[0],f[1],f[2]):this.setParams(b[c])}}}});d.setParams=function(a,b,d,f){var g=this._;"string"===typeof a&&(a=c[a]);if(0<=a&&a<g.biquads.length){a|=0;if("number"===typeof b&&"number"===typeof d){"number"!==
typeof f&&(f=0);var h=g.biquads[a];if(!h)switch(h=g.biquads[a]=new e(g.samplerate),a){case 0:h.setType("highpass");break;case g.biquads.length-1:h.setType("lowpass");break;default:h.setType("peaking")}h.setParams(b,d,f)}else g.biquads[a]=void 0;g.plotFlush=!0}return this};d.getParams=function(a){if(a=this._.biquads[a|0])return{freq:a.frequency,Q:a.Q,gain:a.gain}};d.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;g.inputSignalAR(this);if(!b.bypassed)for(var a=this.cells[1],c=this.cells[2],
b=b.biquads,d=0,f=b.length;d<f;++d)b[d]&&b[d].process(a,c);g.outputSignalAR(this)}return this};var b=new l(2048),a=i.Object.prototype.plot;d.plot=function(c){if(this._.plotFlush){var d=this._,f=new Float32Array(b.length);f[0]=1;for(var g=0,h=d.biquads.length;g<h;++g){var i=this.getParams(g);if(i){var l=new e(d.samplerate);0===g?l.setType("highpass"):g===h-1?l.setType("lowpass"):l.setType("peaking");l.setParams(i.freq,i.Q,i.gain);l.process(f,f)}}b.forward(f);var f=new Float32Array(512),d=0.5*d.samplerate,
h=new Float32Array(512),n;b.getFrequencyData(h);for(g=0;512>g;++g)i=20*Math.pow(d/20,g/512),l=i/(d/h.length),i=l|0,l-=i,0===i?i=h[i]:(n=h[i-1],i=h[i],i=(1-l)*n+l*i),f[g]=i;this._.plotData=f;this._.plotFlush=null}return a.call(this,c)};g.register("eq",h)})(timbre);
(function(i){function h(c){i.Object.call(this,2,c);g.listener(this);g.fixAR(this);this.real=new i.ChannelObject(this);this.imag=new i.ChannelObject(this);this.cells[3]=this.real.cell;this.cells[4]=this.imag.cell;c=this._;c.fft=new l(2*c.cellsize);c.fftCell=new g.SignalArray(c.fft.length);c.prevCell=new g.SignalArray(c.cellsize);c.freqs=new g.SignalArray(c.fft.length>>1);c.plotFlush=!0;c.plotRange=[0,32];c.plotBarStyle=!0}var g=i.fn,l=i.modules.FFT;g.extend(h);var e=h.prototype;Object.defineProperties(e,
{window:{set:function(c){this._.fft.setWindow(c)},get:function(){return this._.fft.windowName}},spectrum:{get:function(){return this._.fft.getFrequencyData(this._.freqs)}}});e.process=function(c){var d=this._;if(this.tickID!==c){this.tickID=c;g.inputSignalAR(this);g.outputSignalAR(this);var c=this.cells[0],b=d.cellsize;d.fftCell.set(d.prevCell);d.fftCell.set(c,b);d.fft.forward(d.fftCell);d.prevCell.set(c);d.plotFlush=!0;this.cells[3].set(d.fft.real.subarray(0,b));this.cells[4].set(d.fft.imag.subarray(0,
b))}return this};var c=i.Object.prototype.plot;e.plot=function(f){this._.plotFlush&&(this._.plotData=this.spectrum,this._.plotFlush=null);return c.call(this,f)};g.register("fft",h)})(timbre);
(function(i){function h(e){i.Object.call(this,1,e);g.fixAR(this);e=this._;e.freq=i(440);e.reg=32768;e.shortFlag=!1;e.phase=0;e.lastValue=0}var g=i.fn;g.extend(h);var l=h.prototype;Object.defineProperties(l,{shortFlag:{set:function(e){this._.shortFlag=!!e},get:function(){return this._.shortFlag}},freq:{set:function(e){this._.freq=i(e)},get:function(){return this._.freq}}});l.process=function(e){var c=this._,f=this.cells[0];if(this.tickID!==e){this.tickID=e;var d=c.lastValue,b=c.phase,e=c.freq.process(e).cells[0][0]/
c.samplerate,a=c.reg,j=c.mul,g=c.add,k,h;if(c.shortFlag){k=0;for(h=f.length;k<h;++k)1<=b&&(a>>=1,a|=((a^a>>6)&1)<<15,d=(a&1)-0.5,b-=1),f[k]=d*j+g,b+=e}else{k=0;for(h=f.length;k<h;++k)1<=b&&(a>>=1,a|=((a^a>>1)&1)<<15,d=(a&1)-0.5,b-=1),f[k]=d*j+g,b+=e}c.reg=a;c.phase=b;c.lastValue=d}return this};g.register("fnoise",h)})(timbre);
(function(i){function h(c){i.Object.call(this,2,c);g.fixAR(this);this._.selected=0;this._.outputs=[]}var g=i.fn,l=function(){function c(c){i.Object.call(this,2,[]);g.fixAR(this);this._.parent=c}g.extend(c);c.prototype.process=function(c){this.tickID!==c&&(this.tickID=c,this._.parent.process(c));return this};return c}();g.extend(h);var e=h.prototype;Object.defineProperties(e,{selected:{set:function(c){var f=this._;if("number"===typeof c){f.selected=c;for(var c=f.outputs,f=0,d=c.length;f<d;++f)c[f]&&
(c[f].cells[0].set(g.emptycell),c[f].cells[1].set(g.emptycell),c[f].cells[2].set(g.emptycell))}},get:function(){return this._.selected}}});e.at=function(c){var f=this._,d=f.outputs[c];d||(f.outputs[c]=d=new l(this));return d};e.process=function(c){var f=this._;if(this.tickID!==c&&(this.tickID=c,g.inputSignalAR(this),g.outputSignalAR(this),c=f.outputs[f.selected]))c.cells[0].set(this.cells[0]),c.cells[1].set(this.cells[1]),c.cells[2].set(this.cells[2]);return this};g.register("gate",h)})(timbre);
(function(i){function h(c){i.Object.call(this,1,c);g.fixAR(this);c=this._;c.fft=new l(2*c.cellsize);c.fftCell=new g.SignalArray(this._.fft.length);c.realBuffer=new g.SignalArray(this._.fft.length);c.imagBuffer=new g.SignalArray(this._.fft.length)}var g=i.fn,l=i.modules.FFT;g.extend(h);var e=h.prototype;Object.defineProperties(e,{real:{set:function(c){this._.real=i(c)},get:function(){return this._.real}},imag:{set:function(c){this._.imag=i(c)},get:function(){return this._.imag}}});e.process=function(c){var f=
this._;if(this.tickID!==c&&(this.tickID=c,f.real&&f.imag)){var d=this.cells[0],b=f.realBuffer,a=f.imagBuffer,e=f.real.process(c).cells[0],c=f.imag.process(c).cells[0];b.set(e);a.set(c);d.set(f.fft.inverse(b,a).subarray(0,f.cellsize));g.outputSignalAR(this)}return this};g.register("ifft",h)})(timbre);
(function(i){function h(c){i.Object.call(this,1,c);g.timer(this);g.fixKR(this);c=this._;c.interval=i(1E3);c.count=0;c.delay=0;c.timeout=Infinity;c.currentTime=0;c.delaySamples=0;c.countSamples=0;c.onended=g.make_onended(this);this.on("start",e)}var g=i.fn,l=i.timevalue;g.extend(h);var e=function(){var c=this._;this.playbackState=g.PLAYING_STATE;c.delaySamples=c.samplerate*0.001*c.delay|0;c.countSamples=c.count=c.currentTime=0};Object.defineProperty(e,"unremovable",{value:!0,writable:!1});var c=h.prototype;
Object.defineProperties(c,{interval:{set:function(c){"string"===typeof c&&(c=l(c),0>=c&&(c=0));this._.interval=i(c)},get:function(){return this._.interval}},delay:{set:function(c){"string"===typeof c&&(c=l(c));"number"===typeof c&&0<=c&&(this._.delay=c,this._.delaySamples=this._.samplerate*0.001*c|0)},get:function(){return this._.delay}},count:{set:function(c){"number"===typeof c&&(this._.count=c)},get:function(){return this._.count}},timeout:{set:function(c){"string"===typeof c&&(c=l(c));"number"===
typeof c&&0<=c&&(this._.timeout=c)},get:function(){return this._.timeout}},currentTime:{get:function(){return this._.currentTime}}});c.bang=function(){var c=this._;this.playbackState=g.PLAYING_STATE;c.delaySamples=c.samplerate*0.001*c.delay|0;c.countSamples=c.count=c.currentTime=0;c.emit("bang");return this};c.process=function(c){var d=this.cells[0],b=this._;if(this.tickID!==c){this.tickID=c;0<b.delaySamples&&(b.delaySamples-=d.length);c=b.interval.process(c).cells[0][0];if(0>=b.delaySamples&&(b.countSamples-=
d.length,0>=b.countSamples)){b.countSamples+=0.001*b.samplerate*c|0;for(var c=this.nodes,a=b.count,e=a*b.mul+b.add,h=0,k=d.length;h<k;++h)d[h]=e;d=0;for(e=c.length;d<e;++d)c[d].bang(a);b.count+=1}b.currentTime+=g.currentTimeIncr;b.currentTime>=b.timeout&&g.nextTick(b.onended)}return this};g.register("interval",h)})(timbre);
(function(i){function h(c){i.Object.call(this,1,c);g.fixAR(this);var c=this._,e=Math.ceil(Math.log(c.samplerate)*Math.LOG2E);c.buffersize=1<<e;c.buffermask=c.buffersize-1;c.buffer=new g.SignalArray(c.buffersize);c.time=0;c.readIndex=0;c.writeIndex=0}var g=i.fn,l=i.timevalue;g.extend(h);var e=h.prototype;Object.defineProperties(e,{time:{set:function(c){"string"===typeof c&&(c=l(c));if("number"===typeof c&&0<c){var e=this._;e.time=c;c=0.001*c*e.samplerate|0;c>e.buffermask&&(c=e.buffermask);e.writeIndex=
e.readIndex+c&e.buffermask}},get:function(){return this._.time}}});e.process=function(c){var e=this._;if(this.tickID!==c){this.tickID=c;g.inputSignalAR(this);var c=this.cells[0],d=e.buffer,b=e.buffermask,a=e.readIndex,j=e.writeIndex,h,k=c.length;for(h=0;h<k;++h)d[j]=c[h],c[h]=d[a],a+=1,j=j+1&b;e.readIndex=a&b;e.writeIndex=j;g.outputSignalAR(this)}return this};g.register("lag",h)})(timbre);
(function(i){function h(c){i.Object.call(this,1,c);c=this._;c.input=0;c.value=0;c.prev=null;c.ar=!1;c.map=l}var g=i.fn;g.extend(h);var l=function(c){return c},e=h.prototype;Object.defineProperties(e,{input:{set:function(c){"number"===typeof c&&(this._.input=c)},get:function(){return this._.input}},map:{set:function(c){"function"===typeof c&&(this._.map=c)},get:function(){return this._.map}}});e.bang=function(){this._.prev=null;this._.emit("bang");return this};e.at=function(c){return this._.map?this._.map(c):
0};e.process=function(c){var e=this.cells[0],d=this._;if(this.tickID!==c){this.tickID=c;var b=this.nodes.length,c=e.length;if(d.ar&&b){g.inputSignalAR(this);var a=d.map;if(a)for(b=0;b<c;++b)e[b]=a(e[b]);d.value=e[c-1];g.outputSignalAR(this)}else{b=b?g.inputSignalKR(this):d.input;d.map&&d.prev!==b&&(d.prev=b,d.value=d.map(b));d=d.value*d.mul+d.add;for(b=0;b<c;++b)e[b]=d}}return this};g.register("map",h)})(timbre);
(function(i){function h(g){i.Object.call(this,1,g)}var g=i.fn;g.extend(h);h.prototype.process=function(h){var e=this.cells[0],c=this._;if(this.tickID!==h){this.tickID=h;var f=this.nodes,d=f.length,b,a=e.length,j,i;if(c.ar){if(0<f.length){j=f[0].process(h).cells[0];e.set(j);for(c=1;c<d;++c){j=f[c].process(h).cells[0];for(b=0;b<a;++b)i=j[b],e[b]<i&&(e[b]=i)}}else for(b=0;b<a;++b)e[b]=0;g.outputSignalAR(this)}else{if(0<f.length){j=f[0].process(h).cells[0][0];for(c=1;c<d;++c)i=f[c].process(h).cells[0][0],
j<i&&(j=i)}else j=0;e[0]=j;g.outputSignalKR(this)}}return this};g.register("max",h)})(timbre);
(function(i){function h(b){i.Object.call(this,2,b);g.fixAR(this);b=this._;b.src=b.func=null;b.bufferL=new g.SignalArray(l);b.bufferR=new g.SignalArray(l);b.readIndex=0;b.writeIndex=0;b.totalRead=0;b.totalWrite=0}if("browser"===i.envtype){var g=i.fn,l=4096,e=l-1;g.extend(h);var c=h.prototype;c.listen=function(b){var a=f[i.env];a&&(a.set.call(this,b),a.listen.call(this))};c.unlisten=function(){var b=f[i.env];b&&b.unlisten.call(this);this.cells[0].set(g.emptycell);this.cells[1].set(g.emptycell);this.cells[2].set(g.emptycell);
for(var a=this._,b=a.bufferL,a=a.bufferR,c=0,d=b.length;c<d;++c)b[c]=a[c]=0};c.process=function(b){var a=this._;if(null===a.src)return this;if(this.tickID!==b){this.tickID=b;b=a.cellsize;if(a.totalWrite>a.totalRead+b){var c=a.readIndex,d=c+b;this.cells[1].set(a.bufferL.subarray(c,d));this.cells[2].set(a.bufferR.subarray(c,d));a.readIndex=d&e;a.totalRead+=b}g.outputSignalAR(this)}return this};var f={webkit:{set:function(b){var a=this._;b instanceof HTMLMediaElement&&(a.src=g._audioContext.createMediaElementSource(b))},
listen:function(){var b=this._,a=g._audioContext;b.gain=a.createGainNode();b.gain.gain.value=0;b.node=a.createJavaScriptNode(1024,2,2);b.node.onaudioprocess=d(this);b.src.connect(b.node);b.node.connect(b.gain);b.gain.connect(a.destination)},unlisten:function(){var b=this._;b.src&&b.src.disconnect();b.gain&&b.gain.disconnect();b.node&&b.node.disconnect()}}},d=function(b){return function(a){var c=b._,a=a.inputBuffer,d=a.length,f=c.writeIndex;c.bufferL.set(a.getChannelData(0),f);c.bufferR.set(a.getChannelData(1),
f);c.writeIndex=f+d&e;c.totalWrite+=d}};f.moz={set:function(b){var a=this._;b instanceof HTMLAudioElement&&(a.src=b,a.istep=a.samplerate/b.mozSampleRate)},listen:function(){var b=this._,a=b.bufferL,c=b.bufferR,d=0,f=0;2===b.src.mozChannels?(b.x=0,b.func=function(g){var h=b.writeIndex,i=b.totalWrite,g=g.frameBuffer,l,n=b.istep,q,s=g.length;l=b.x;for(q=0;q<s;q+=2){for(l+=n;0<l;)a[h]=0.5*(g[q]+d),c[h]=0.5*(g[q+1]+f),h=h+1&e,++i,l-=1;d=g[q];f=g[q+1]}b.x=l;b.writeIndex=h;b.totalWrite=i}):(b.x=0,b.func=
function(f){var g=b.writeIndex,k=b.totalWrite,f=f.frameBuffer,h,i=b.istep,l,s=f.length;h=b.x;for(l=0;l<s;++l){for(h+=i;0<=h;)a[g]=c[g]=0.5*(f[l]+d),g=g+1&e,++k,h-=1;d=f[l]}b.x=h;b.writeIndex=g;b.totalWrite=k});b.src.addEventListener("MozAudioAvailable",b.func)},unlisten:function(){var b=this._;b.func&&(b.src.removeEventListener("MozAudioAvailable",b.func),b.func=null)}};g.register("mediastream",h)}})(timbre);
(function(i){function h(e){i.Object.call(this,1,e);e=this._;e.midi=0;e.value=0;e.prev=null;e.a4=440;e.ar=!1}var g=i.fn;g.extend(h);var l=h.prototype;Object.defineProperties(l,{midi:{set:function(e){"number"===typeof e&&(this._.midi=e)},get:function(){return this._.midi}},a4:{set:function(e){"number"===typeof e&&(this._.a4=e,this._.prev=null)},get:function(){return this._.a4}}});l.bang=function(){this._.prev=null;this._.emit("bang");return this};l.at=function(e){return this._.a4*Math.pow(2,(e-69)/
12)};l.process=function(e){var c=this._;if(this.tickID!==e){this.tickID=e;var e=this.cells[0],f=this.nodes.length,d=e.length;if(c.ar&&f){g.inputSignalAR(this);for(var b=c.a4,f=0;f<d;++f)e[f]=b*Math.pow(2,(e[f]-69)/12);c.value=e[d-1];g.outputSignalAR(this)}else d=f?g.inputSignalKR(this):c.midi,c.prev!==d&&(c.prev=d,c.value=c.a4*Math.pow(2,(d-69)/12)),e[0]=c.value,g.outputSignalKR(this)}return this};g.register("midicps",h)})(timbre);
(function(i){function h(e){i.Object.call(this,1,e);e=this._;e.midi=0;e.value=0;e.prev=null;e.range=12;e.ar=!1}var g=i.fn;g.extend(h);var l=h.prototype;Object.defineProperties(l,{midi:{set:function(e){"number"===typeof e&&(this._.midi=e)},get:function(){return this._.midi}},range:{set:function(e){"number"===typeof e&&0<e&&(this._.range=e)},get:function(){return this._.range}}});l.bang=function(){this._.prev=null;this._.emit("bang");return this};l.at=function(e){return Math.pow(2,e/this._.range)};l.process=
function(e){var c=this.cells[0],f=this._;if(this.tickID!==e){this.tickID=e;var d=this.nodes.length,e=c.length;if(f.ar&&d){g.inputSignalAR(this);for(var b=f.range,d=0;d<e;++d)c[d]=Math.pow(2,c[d]/b);f.value=c[e-1];g.outputSignalAR(this)}else{d=this.nodes.length?g.inputSignalKR(this):f.midi;f.prev!==d&&(f.prev=d,f.value=Math.pow(2,d/f.range));f=f.value*f.mul+f.add;for(d=0;d<e;++d)c[d]=f}}return this};g.register("midiratio",h)})(timbre);
(function(i){function h(g){i.Object.call(this,1,g)}var g=i.fn;g.extend(h);h.prototype.process=function(h){var e=this.cells[0],c=this._;if(this.tickID!==h){this.tickID=h;var f=this.nodes,d=f.length,b,a=e.length,j,i;if(c.ar){if(0<f.length){j=f[0].process(h).cells[0];e.set(j);for(c=1;c<d;++c){j=f[c].process(h).cells[0];for(b=0;b<a;++b)i=j[b],e[b]>i&&(e[b]=i)}}else for(b=0;b<a;++b)e[b]=0;g.outputSignalAR(this)}else{if(0<f.length){j=f[0].process(h).cells[0][0];for(c=1;c<d;++c)i=f[c].process(h).cells[0][0],
j>i&&(j=i)}else j=0;e[0]=j;g.outputSignalKR(this)}}return this};g.register("min",h)})(timbre);
(function(i){function h(b){i.Object.call(this,0,b);g.timer(this);g.fixKR(this);b=this._;b.mml="";b.status={t:120,l:4,o:4,v:12,q:6,dot:0,tie:!1};b.commands=[];b.index=0;b.queue=[];b.currentTime=0;b.queueTime=0;b.segnoIndex=-1;b.loopStack=[];b.prevNote=0;b.remain=Infinity;b.onended=g.make_onended(this);this.on("start",l)}var g=i.fn;g.extend(h);var l=function(){var b=this._;this.playbackState=g.PLAYING_STATE;b.commands=f(b.mml);b.index=0;b.queue=[];b.currentTime=0;b.queueTime=0;b.segnoIndex=-1;b.loopStack=
[];b.prevNote=0;b.remain=Infinity;c(this)};Object.defineProperty(l,"unremoved",{value:!0,writable:!1});var e=h.prototype;Object.defineProperties(e,{mml:{set:function(b){var a=this._;"string"===typeof b&&(a.mml=b)},get:function(){return this._.mml}},currentTime:{get:function(){return this._.currentTime}}});e.process=function(b){var a=this._;if(this.tickID!==b){this.tickID=b;var b=this.nodes,d=a.queue,e,f,h;if(d.length)for(;d[0][0]<=a.currentTime;){var i=a.queue.shift();if(i[1]){f=0;for(h=b.length;f<
h;++f)e=b[f],e.noteOn?e.noteOn(i[1],i[3]):e.bang();a.remain=i[4];a.emit("mml","noteOn",{noteNum:i[1],velocity:i[3]});c(this)}else{f=0;for(h=b.length;f<h;++f)e=b[f],e.noteOff?e.noteOff(i[2],i[3]):e.release&&e.release();a.emit("mml","noteOff",{noteNum:i[2],velocity:i[3]})}if(0===d.length)break}a.remain-=g.currentTimeIncr;0===d.length&&0>=a.remain&&g.nextTick(a.onended);a.currentTime+=g.currentTimeIncr}return this};var c=function(b){var b=b._,a,c=b.commands,d=b.queue,e=b.index,f=b.status,g=b.queueTime,
h=b.loopStack,i,l,q,s,w;s=[];a:for(;;){if(c.length<=e)if(0<=b.segnoIndex)e=b.segnoIndex;else break;a=c[e++];switch(a.name){case "n":i=f.t||120;null!==a.len?(l=a.len,q=a.dot||0):(l=f.l,q=a.dot||f.dot);i=1E3*60/i*(4/l);i*=[1,1.5,1.75,1.875][q]||1;q=f.v<<3;if(f.tie){for(a=d.length;a--;)if(d[a][2]){d.splice(a,1);break}a=b.prevNote}else a=b.prevNote=a.val+12*(f.o+1),d.push([g,a,null,q,i]);if(0<l){l=f.q/8;if(1>l){l=g+i*l;d.push([l,null,a,q]);a=0;for(w=s.length;a<w;++a)d.push([l,null,s[a],q])}s=[];g+=i;
if(!f.tie)break a}else s.push(a);f.tie=!1;break;case "r":i=f.t||120;null!==a.len?(l=a.len,q=a.dot||0):(l=f.l,q=a.dot||f.dot);0<l&&(i=1E3*60/i*(4/l),i*=[1,1.5,1.75,1.875][q]||1,g+=i);break;case "l":f.l=a.val;f.dot=a.dot;break;case "o":f.o=a.val;break;case "<":9>f.o&&(f.o+=1);break;case ">":0<f.o&&(f.o-=1);break;case "v":f.v=a.val;break;case "(":15>f.v&&(f.v+=1);break;case ")":0<f.v&&(f.v-=1);break;case "q":f.q=a.val;break;case "&":f.tie=!0;break;case "$":b.segnoIndex=e;break;case "[":h.push([e,null,
null]);break;case "|":if((i=h[h.length-1])&&1===i[1])h.pop(),e=i[2];break;case "]":if(i=h[h.length-1])null===i[1]&&(i[1]=a.count,i[2]=e),i[1]-=1,0===i[1]?h.pop():e=i[0];break;case "t":f.t=null===a.val?120:a.val}}b.index=e;b.queueTime=g},f=function(b){var a,c,e,f,g,h,i,l=Array(b.length),n=[];g=0;for(h=d.length;g<h;++g){a=d[g];for(c=a.re;e=c.exec(b);){if(!l[e.index]){f=0;for(i=e[0].length;f<i;++f)l[e.index+f]=!0;if(f=a.func?a.func(e):{name:e[0]})f.index=e.index,f.origin=e[0],n.push(f)}for(;c.lastIndex<
b.length&&l[c.lastIndex];)++c.lastIndex}}n.sort(function(a,b){return a.index-b.index});return n},d=[{re:/([cdefgab])([\-+]?)(\d*)(\.*)/g,func:function(b){return{name:"n",val:{c:0,d:2,e:4,f:5,g:7,a:9,b:11}[b[1]]+({"-":-1,"+":1}[b[2]]||0),len:""===b[3]?null:Math.min(b[3]|0,64),dot:b[4].length}}},{re:/r(\d*)(\.*)/g,func:function(b){return{name:"r",len:""===b[1]?null:Math.max(1,Math.min(b[1]|0,64)),dot:b[2].length}}},{re:/&/g},{re:/l(\d*)(\.*)/g,func:function(b){return{name:"l",val:""===b[1]?4:Math.min(b[1]|
0,64),dot:b[2].length}}},{re:/o([0-9])/g,func:function(b){return{name:"o",val:""===b[1]?4:b[1]|0}}},{re:/[<>]/g},{re:/v(\d*)/g,func:function(b){return{name:"v",val:""===b[1]?12:Math.min(b[1]|0,15)}}},{re:/[()]/g},{re:/q([0-8])/g,func:function(b){return{name:"q",val:""===b[1]?6:Math.min(b[1]|0,8)}}},{re:/\[/g},{re:/\|/g},{re:/\](\d*)/g,func:function(b){return{name:"]",count:b[1]|0||2}}},{re:/t(\d*)/g,func:function(b){return{name:"t",val:""===b[1]?null:Math.max(5,Math.min(b[1]|0,300))}}},{re:/\$/g}];
g.register("mml",h)})(timbre);
(function(i){function h(g){i.Object.call(this,2,g)}var g=i.fn;g.extend(h);h.prototype.process=function(h){var e=this._;if(this.tickID!==h){this.tickID=h;var c=this.nodes,f=this.cells[0],d=this.cells[1],b=this.cells[2],a=c.length,j=f.length,i,k;if(e.ar){if(0<c.length){c[0].process(h);i=c[0].cells[1];k=c[0].cells[2];d.set(i);b.set(k);for(e=1;e<a;++e){c[e].process(h);i=c[e].cells[1];k=c[e].cells[2];for(f=0;f<j;++f)d[f]*=i[f],b[f]*=k[f]}}else for(f=0;f<j;++f)d[f]=b[f]=0;g.outputSignalAR(this)}else{if(0<
c.length){d=c[0].process(h).cells[0][0];for(e=1;e<a;++e)d*=c[e].process(h).cells[0][0]}else d=0;f[0]=d;g.outputSignalKR(this)}}return this};g.register("*",h)})(timbre);
(function(i){function h(e){i.Object.call(this,1,e);e=this._;e.defaultValue=0;e.index=0;e.dict={};e.ar=!1}var g=i.fn;g.extend(h);var l=h.prototype;Object.defineProperties(l,{dict:{set:function(e){if("object"===typeof e)this._.dict=e;else if("function"===typeof e){for(var c={},f=0;128>f;++f)c[f]=e(f);this._.dict=c}},get:function(){return this._.dict}},defaultValue:{set:function(e){"number"===typeof e&&(this._.defaultValue=e)},get:function(){return this._.defaultValue}},index:{set:function(e){"number"===
typeof e&&(this._.index=e)},get:function(){return this._.index}}});l.at=function(e){var c=this._;return(c.dict[e|0]||c.defaultValue)*c.mul+c.add};l.clear=function(){this._.dict={};return this};l.process=function(e){var c=this.cells[0],f=this._;if(this.tickID!==e){this.tickID=e;var d=this.nodes.length,b;b=f.dict;var a=f.defaultValue,j=f.mul,h=f.add,e=c.length;if(f.ar&&d){g.inputSignalAR(this);for(f=0;f<e;++f)d=c[f],d=0>d?d-0.5|0:d+0.5|0,c[f]=(b[d]||a)*j+h;g.outputSignalAR(this)}else{d=this.nodes.length?
g.inputSignalKR(this):f.index;b=(b[0>d?d-0.5|0:d+0.5|0]||a)*j+h;for(f=0;f<e;++f)c[f]=b}}return this};g.register("ndict",h)})(timbre);(function(i){function h(g){i.Object.call(this,1,g)}var g=i.fn;g.extend(h);h.prototype.process=function(g){var e=this.cells[0],c=this._;if(this.tickID!==g){this.tickID=g;var g=c.mul,f=c.add,d;if(c.ar){c=0;for(d=e.length;c<d;++c)e[c]=(2*Math.random()-1)*g+f}else{g=(2*Math.random()+1)*g+f;c=0;for(d=e.length;c<d;++c)e[c]=g}}return this};g.register("noise",h)})(timbre);
(function(i){function h(b){i.Object.call(this,2,b);b=this._;b.freq=i(440);b.phase=i(0);b.osc=new e(b.samplerate);b.tmp=new g.SignalArray(b.cellsize);b.osc.step=b.cellsize;this.once("init",c)}var g=i.fn,l=i.timevalue,e=i.modules.Oscillator;g.extend(h);var c=function(){var b=this._;this.wave||(this.wave="sin");b.plotData=b.osc.wave;b.plotLineWidth=2;b.plotCyclic=!0;b.plotBefore=d},f=h.prototype;Object.defineProperties(f,{wave:{set:function(b){this._.osc.setWave(b)},get:function(){return this._.osc.wave}},
freq:{set:function(b){"string"===typeof b&&(b=l(b),b=0>=b?0:1E3/b);this._.freq=i(b)},get:function(){return this._.freq}},phase:{set:function(b){this._.phase=i(b);this._.osc.feedback=!1},get:function(){return this._.phase}},fb:{set:function(b){this._.phase=i(b);this._.osc.feedback=!0},get:function(){return this._.phase}}});f.bang=function(){this._.osc.reset();this._.emit("bang");return this};f.process=function(b){var a=this._;if(this.tickID!==b){this.tickID=b;var c=this.cells[1],d=this.cells[2],e,
f=a.cellsize;if(this.nodes.length)g.inputSignalAR(this);else for(e=0;e<f;++e)c[e]=d[e]=1;e=a.osc;var h=a.freq.process(b).cells[0],i=a.phase.process(b).cells[0];e.frequency=h[0];e.phase=i[0];if(a.ar){b=a.tmp;a.freq.isAr?a.phase.isAr?e.processWithFreqAndPhaseArray(b,h,i):e.processWithFreqArray(b,h):a.phase.isAr?e.processWithPhaseArray(b,i):e.process(b);for(e=0;e<f;++e)c[e]*=b[e],d[e]*=b[e]}else{a=e.next();for(e=0;e<f;++e)c[e]*=a,d[e]*=a}g.outputSignalAR(this)}return this};var d;"browser"===i.envtype&&
(d=function(b,a,c,d,e){e=(e>>1)+0.5;b.strokeStyle="#ccc";b.lineWidth=1;b.beginPath();b.moveTo(a,e+c);b.lineTo(a+d,e+c);b.stroke()});g.register("osc",h);g.register("sin",function(b){return(new h(b)).set("wave","sin")});g.register("cos",function(b){return(new h(b)).set("wave","cos")});g.register("pulse",function(b){return(new h(b)).set("wave","pulse")});g.register("tri",function(b){return(new h(b)).set("wave","tri")});g.register("saw",function(b){return(new h(b)).set("wave","saw")});g.register("fami",
function(b){return(new h(b)).set("wave","fami")});g.register("konami",function(b){return(new h(b)).set("wave","konami")});g.register("+sin",function(b){return(new h(b)).set("wave","+sin").kr()});g.register("+pulse",function(b){return(new h(b)).set("wave","+pulse").kr()});g.register("+tri",function(b){return(new h(b)).set("wave","+tri").kr()});g.register("+saw",function(b){return(new h(b)).set("wave","+saw").kr()});g.alias("square","pulse")})(timbre);
(function(i){function h(c){i.Object.call(this,2,c);g.fixAR(this);c=this._;c.pos=i(0);c.panL=0.7071067811865475;c.panR=0.7071067811865475}var g=i.fn;g.extend(h);var l=function(){for(var c=new Float32Array(257),d=0;256>d;++d)c[d]=Math.sin(0.5*Math.PI*(d/256));c[256]=1;return c}(),e=function(){for(var c=new Float32Array(257),d=0;256>d;++d)c[d]=Math.cos(0.5*Math.PI*(d/256));c[256]=0;return c}(),c=h.prototype;Object.defineProperties(c,{pos:{set:function(c){this._.pos=i(c)},get:function(){return this._.pos}}});
c.process=function(c){var d=this._;if(this.tickID!==c){this.tickID=c;var b=d.pos.process(c).cells[0][0];if(d.prevPos!==b){var a=128*(b+1)|0;d.panL=e[a];d.panR=l[a];d.prevPos=b}var j=this.nodes,b=this.cells[1],a=this.cells[2],h,k=j.length,i,m=b.length,t;if(k){t=j[0].process(c).cells[0];for(i=0;i<m;++i)b[i]=a[i]=t[i];for(h=1;h<k;++h){t=j[h].process(c).cells[0];for(i=0;i<m;++i)b[i]=a[i]+=t[i]}c=d.panL;d=d.panR;for(i=0;i<m;++i)b[i]*=c,a[i]*=d}else b.set(g.emptycell),a.set(g.emptycell);g.outputSignalAR(this)}return this};
g.register("pan",h)})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);a=this._;a.value=0;a.env=new c(a.samplerate);a.env.step=a.cellsize;a.curve="lin";a.counter=0;a.ar=!1;a.onended=g.make_onended(this);this.on("ar",f)}var g=i.fn,l=i.timevalue,e=i.modules.Envelope,c=i.modules.EnvelopeValue;g.extend(h);var f=function(a){this._.env.step=a?1:this._.cellsize},d=h.prototype;Object.defineProperties(d,{value:{set:function(a){"number"===typeof a&&(this._.env.value=a)},get:function(){return this._.env.value}}});d.to=function(a,
b,c){var d=this._,f=d.env;"string"===typeof b?b=l(b):"undefined"===typeof b&&(b=0);if("undefined"===typeof c)d.counter=f.setNext(a,b,e.CurveTypeLin),d.curve="lin";else{var g=e.CurveTypeDict[c];d.counter="undefined"===typeof g?f.setNext(a,b,e.CurveTypeCurve,c):f.setNext(a,b,g);d.curve=c}d.plotFlush=!0;return this};d.setAt=function(a,b){var c=this._;this.to(c.env.value,b,"set");c.atValue=a;return this};d.linTo=function(a,b){return this.to(a,b,"lin")};d.expTo=function(a,b){return this.to(a,b,"exp")};
d.sinTo=function(a,b){return this.to(a,b,"sin")};d.welTo=function(a,b){return this.to(a,b,"wel")};d.sqrTo=function(a,b){return this.to(a,b,"sqr")};d.cubTo=function(a,b){return this.to(a,b,"cub")};d.cancel=function(){var a=this._;a.counter=a.env.setNext(a.env.value,0,e.CurveTypeSet);return this};d.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;var a=this.cells[1],c=this.cells[2],d,f=b.cellsize,h=b.env,i=b.counter,l;if(this.nodes.length)g.inputSignalAR(this);else for(d=0;d<f;++d)a[d]=
c[d]=1;0>=i&&("set"===b.curve?h.setNext(b.atValue,0,e.CurveTypeSet):h.setNext(h.value,0,e.CurveTypeSet),g.nextTick(b.onended),b.counter=Infinity);if(b.ar){for(d=0;d<f;++d)l=h.next(),a[d]*=l,c[d]*=l;b.counter-=b.cellsize}else{l=h.next();for(d=0;d<f;++d)a[d]*=l,c[d]*=l;b.counter-=1}g.outputSignalAR(this);b.value=l}return this};var b=i.Object.prototype.plot;d.plot=function(a){var d=this._;if(d.plotFlush){var f=new c(128),g=new Float32Array(128),h,i;if("set"===d.curve){h=100;for(i=g.length;h<i;++h)g[h]=
1}else{h=e.CurveTypeDict[d.curve];"undefined"===typeof h?f.setNext(1,1E3,e.CurveTypeCurve,d.curve):f.setNext(1,1E3,h);h=0;for(i=g.length;h<i;++h)g[h]=f.next()}d.plotData=g;d.plotRange=[0,1];d.plotFlush=null}return b.call(this,a)};g.register("param",h)})(timbre);
(function(i){function h(c){i.Object.call(this,2,c);g.fixAR(this);c=this._;c.freq=i("sin",{freq:1,add:1E3,mul:250}).kr();c.Q=i(1);c.allpass=[];this.steps=2}var g=i.fn,l=i.modules.Biquad;g.extend(h);var e=h.prototype;Object.defineProperties(e,{freq:{set:function(c){this._.freq=c},get:function(){return this._.freq}},Q:{set:function(c){this._.Q=i(c)},get:function(){return this._.Q}},steps:{set:function(c){if("number"===typeof c){c|=0;if(2===c||4===c||8===c||12===c){var e=this._.allpass;if(e.length<c)for(var d=
e.length;d<c;++d)e[d]=new l(this._.samplerate),e[d].setType("allpass")}this._.steps=c}},get:function(){return this._.steps}}});e.process=function(c){var e=this._;if(this.tickID!==c){this.tickID=c;g.inputSignalAR(this);if(!e.bypassed){var d=this.cells[1],b=this.cells[2],a=e.freq.process(c).cells[0][0],c=e.Q.process(c).cells[0][0],j=e.steps,h;for(h=0;h<j;h+=2)e.allpass[h].setParams(a,c,0),e.allpass[h].process(d,b),e.allpass[h+1].setParams(a,c,0),e.allpass[h+1].process(d,b)}g.outputSignalAR(this)}return this};
g.register("phaser",h)})(timbre);
(function(i){function h(h){i.Object.call(this,1,h);g.fixAR(this);for(var h=new Uint8Array(5),e=0;5>e;++e)h[e]=(1073741824*Math.random()|0)%25;this._.whites=h;this._.key=0}var g=i.fn;g.extend(h);h.prototype.process=function(g){var e=this.cells[0],c=this._;if(this.tickID!==g){this.tickID=g;var f,d,b=c.key,a=c.whites,j=c.mul,h=c.add,i,p,g=0;for(f=e.length;g<f;++g){d=b++;31<b&&(b=0);p=d^b;for(d=i=0;5>d;++d)p&1<<d&&(a[d]=(1073741824*Math.random()|0)%25),i+=a[d];e[g]=(0.01666666*i-1)*j+h}c.key=b}return this};
g.register("pink",h)})(timbre);
(function(i){function h(e){i.Object.call(this,1,e);this._.freq=440;this._.buffer=null;this._.readIndex=0;this._.writeIndex=0}var g=i.fn;g.extend(h);var l=h.prototype;Object.defineProperties(l,{freq:{set:function(e){"number"===typeof e&&(0>e&&(e=0),this._.freq=e)},get:function(){return this._.freq}}});l.bang=function(){for(var e=this._,c=e.samplerate/e.freq+0.5|0,f=e.buffer=new g.SignalArray(c<<1),d=0;d<c;++d)f[d]=2*Math.random()-1;e.readIndex=0;e.writeIndex=c;e.emit("bang");return this};l.process=
function(e){var c=this.cells[0],f=this._;if(this.tickID!==e&&(this.tickID=e,e=f.buffer)){var d=e.length,b=f.readIndex,a=f.writeIndex,g=f.mul,h=f.add,i,l,m=c.length;for(l=0;l<m;++l)i=e[b++],b>=d&&(b=0),i=0.5*(i+e[b]),e[a++]=i,a>=d&&(a=0),c[l]=i*g+h;f.readIndex=b;f.writeIndex=a}return this};g.register("pluck",h)})(timbre);
(function(i){function h(d){i.Object.call(this,1,d);g.listener(this);g.fixAR(this);d=this._;d.timeout=5E3;d.status=e;d.writeIndex=0;d.writeIndexIncr=1;d.currentTime=0;d.currentTimeIncr=1E3/d.samplerate;d.onended=c(this)}var g=i.fn,l=i.timevalue,e=0;g.extend(h);var c=function(c){return function(){var b=c._,a=new g.SignalArray(b.buffer.subarray(0,b.writeIndex|0));b.status=e;b.writeIndex=0;b.currentTime=0;b.emit("ended",{buffer:a,samplerate:b.samplerate})}},f=h.prototype;Object.defineProperties(f,{timeout:{set:function(c){"string"===
typeof c&&(c=l(c));"number"===typeof c&&0<c&&(this._.timeout=c)},get:function(){return this._.timeout}},samplerate:{set:function(c){"number"===typeof c&&(0<c&&c<=this._.samplerate)&&(this._.samplerate=c)},get:function(){return this._.samplerate}},currentTime:{get:function(){return this._.currentTime}}});f.start=function(){var c=this._,b;if(c.status===e){b=0.01*c.timeout*c.samplerate|0;if(!c.buffer||c.buffer.length<b)c.buffer=new g.SignalArray(b);c.writeIndex=0;c.writeIndexIncr=c.samplerate/i.samplerate;
c.currentTime=0;c.status=1;c.emit("start");this.listen()}return this};f.stop=function(){var c=this._;1===c.status&&(c.status=e,c.emit("stop"),g.nextTick(c.onended),this.unlisten());return this};f.bang=function(){this._.status===e?this.srart():1===this._.status&&this.stop();this._.emit("bang");return this};f.process=function(c){var b=this._,a=this.cells[0];if(this.tickID!==c){this.tickID=c;g.inputSignalAR(this);if(1===b.status){for(var e=a.length,f=b.buffer,h=b.timeout,i=b.writeIndex,l=b.writeIndexIncr,
t=b.currentTime,r=b.currentTimeIncr,c=0;c<e;++c)f[i|0]=a[c],i+=l,t+=r,h<=t&&g.nextTick(b.onended);b.writeIndex=i;b.currentTime=t}g.outputSignalAR(this)}return this};g.register("record",h);g.alias("rec","record")})(timbre);
(function(i){function h(c){i.Object.call(this,2,c);g.fixAR(this);this._.reverb=new l(this._.samplerate,this._.cellsize)}var g=i.fn,l=i.modules.Reverb;g.extend(h);var e=h.prototype;Object.defineProperties(e,{room:{set:function(c){"number"===typeof c&&this._.reverb.setRoomSize(1<c?1:0>c?0:c)},get:function(){return this._.reverb.roomsize}},damp:{set:function(c){"number"===typeof c&&this._.reverb.setDamp(1<c?1:0>c?0:c)},get:function(){return this._.reverb.damp}},mix:{set:function(c){"number"===typeof c&&
(this._.reverb.wet=1<c?1:0>c?0:c)},get:function(){return this._.reverb.wet}}});e.process=function(c){var e=this._;this.tickID!==c&&(this.tickID=c,g.inputSignalAR(this),e.bypassed||e.reverb.process(this.cells[1],this.cells[2]),g.outputSignalAR(this));return this};g.register("reverb",h)})(timbre);
(function(i){function h(c){i.Object.call(this,0,c);g.timer(this);g.fixKR(this);c=this._;c.queue=[];c.currentTime=0;c.maxRemain=1E3}var g=i.fn,l=i.timevalue;g.extend(h);var e=h.prototype;Object.defineProperties(e,{queue:{get:function(){return this._.queue}},remain:{get:function(){return this._.queue.length}},maxRemain:{set:function(c){"number"===typeof c&&0<c&&(this._.maxRemain=c)},get:function(){return this._.maxRemain}},isEmpty:{get:function(){return 0===this._.queue.length}},currentTime:{get:function(){return this._.currentTime}}});
e.sched=function(c,e){"string"===typeof c&&(c=l(c));"number"===typeof c&&this.schedAbs(this._.currentTime+c,e);return this};e.schedAbs=function(c,e){"string"===typeof c&&(c=l(c));if("number"===typeof c){var d=this._,b=d.queue;if(b.length>=d.maxRemain)return this;for(d=b.length;d--&&!(b[d][0]<c););b.splice(d+1,0,[c,i(e)])}return this};e.advance=function(c){"string"===typeof c&&(c=l(c));"number"===typeof c&&(this._.currentTime+=c);return this};e.clear=function(){this._.queue.splice(0);return this};
e.process=function(c){var e=this._;if(this.tickID!==c){this.tickID=c;var c=null,d=e.queue;if(d.length)for(;d[0][0]<e.currentTime;)if(e.queue.shift()[1].bang(),c="sched",0===d.length){c="empty";break}e.currentTime+=g.currentTimeIncr;c&&e.emit(c)}return this};g.register("schedule",h);g.alias("sche","schedule")})(timbre);
(function(i){function h(c){i.Object.call(this,2,c);g.listener(this);g.fixAR(this);c=this._;c.samples=0;c.writeIndex=0;c.plotFlush=!0;this.once("init",e)}var g=i.fn,l=i.timevalue;g.extend(h);var e=function(){this._.buffer||(this.size=1024);this._.interval||(this.interval=1E3)},c=h.prototype;Object.defineProperties(c,{size:{set:function(c){var b=this._;!b.buffer&&"number"===typeof c&&(b.buffer=new g.SignalArray(64>c?64:2048<c?2048:c),b.reservedinterval&&(this.interval=b.reservedinterval,b.reservedinterval=
null))},get:function(){return this._.buffer.length}},interval:{set:function(c){var b=this._;"string"===typeof c&&(c=l(c));"number"===typeof c&&0<c&&(b.buffer?(b.interval=c,b.samplesIncr=0.001*c*b.samplerate/b.buffer.length,1>b.samplesIncr&&(b.samplesIncr=1)):b.reservedinterval=c)},get:function(){return this._.interval}}});c.bang=function(){for(var c=this._,b=c.buffer,a=0,e=b.length;a<e;++a)b[a]=0;c.samples=0;c.writeIndex=0;this._.emit("bang");return this};c.process=function(c){var b=this._;if(this.tickID!==
c){this.tickID=c;g.inputSignalAR(this);g.outputSignalAR(this);var c=this.cells[0],a,e=b.cellsize,f=b.samples,h=b.samplesIncr,i=b.buffer,l=b.writeIndex,t=!1,r=i.length;for(a=0;a<e;++a)0>=f&&(i[l++]=c[a],l>=r&&(l=0),t=b.plotFlush=!0,f+=h),--f;b.samples=f;b.writeIndex=l;t&&this._.emit("data")}return this};var f=i.Object.prototype.plot;c.plot=function(c){var b=this._;if(b.plotFlush){for(var a=b.buffer,e=a.length-1,g=new Float32Array(a.length),h=b.writeIndex,i=0,l=a.length;i<l;i++)g[i]=a[++h&e];b.plotData=
g;b.plotFlush=null}return f.call(this,c)};g.register("scope",h)})(timbre);
(function(i){function h(d){i.Object.call(this,2,d);e.fixAR(this);d=this._;d.numberOfInputs=0;d.numberOfOutputs=0;d.bufferSize=0;d.bufferMask=0;d.duration=0;d.inputBufferL=null;d.inputBufferR=null;d.outputBufferL=null;d.outputBufferR=null;d.onaudioprocess=null;d.index=0;this.once("init",c)}function g(c,b){this.samplerate=c._.samplerate;this.length=c._.bufferSize;this.duration=c._.duration;this.numberOfChannels=b.length;this.getChannelData=function(a){return b[a]}}function l(c){var b=c._;this.node=
c;this.playbackTime=i.currentTime;this.inputBuffer=2===b.numberOfInputs?new g(c,[b.inputBufferL,b.inputBufferR]):new g(c,[b.inputBufferL]);this.outputBuffer=2===b.numberOfOutputs?new g(c,[b.outputBufferL,b.outputBufferR]):new g(c,[b.outputBufferL])}var e=i.fn;e.extend(h);var c=function(){var c=this._;0===c.numberOfInputs&&(this.numberOfInputs=1);0===c.numberOfOutputs&&(this.numberOfOutputs=1);0===c.bufferSize&&(this.bufferSize=1024)},f=h.prototype;Object.defineProperties(f,{numberOfInputs:{set:function(c){var b=
this._;0===b.numberOfInputs&&(b.numberOfInputs=2===c?2:1)},get:function(){return this._.numberOfInputs}},numberOfOutputs:{set:function(c){var b=this._;0===b.numberOfOutputs&&(b.numberOfOutputs=2===c?2:1)},get:function(){return this._.numberOfOutputs}},bufferSize:{set:function(c){var b=this._;0===b.bufferSize&&-1!==[256,512,1024,2048,4096,8192,16384].indexOf(c)&&(b.bufferSize=c,b.bufferMask=c-1,b.duration=c/b.samplerate,b.inputBufferL=new e.SignalArray(c),b.inputBufferR=new e.SignalArray(c),b.outputBufferL=
new e.SignalArray(c),b.outputBufferR=new e.SignalArray(c))},get:function(){return this._.bufferSize}},onaudioprocess:{set:function(c){"function"===typeof c&&(this._.onaudioprocess=c)},get:function(){return this._.onaudioprocess}}});f.process=function(c){var b=this._;if(this.tickID!==c){this.tickID=c;var c=b.cellsize,a=b.bufferMask,f=b.index,g=f+c,h,i=this.cells[1],m=this.cells[2];e.inputSignalAR(this);if(2===b.numberOfInputs)b.inputBufferL.set(i,f),b.inputBufferR.set(m,f);else{h=b.inputBufferL;for(var t=
0;t<c;t++)h[f+t]=0.5*(i[t]+m[t])}i.set(b.outputBufferL.subarray(f,g));m.set(b.outputBufferR.subarray(f,g));b.index=g&a;0===b.index&&b.onaudioprocess&&(b.onaudioprocess(new l(this)),1===b.numberOfOutputs&&b.outputBufferR.set(b.outputBufferL));e.outputSignalAR(this)}return this};e.register("script",h)})(timbre);
(function(i){function h(e){i.Object.call(this,2,e);this._.selected=0;this._.background=!1}var g=i.fn;g.extend(h);var l=h.prototype;Object.defineProperties(l,{selected:{set:function(e){"number"===typeof e&&(this._.selected=e,this.cells[1].set(g.emptycell),this.cells[2].set(g.emptycell))},get:function(){return this._.selected}},background:{set:function(e){this._.background=!!e},get:function(){return this._.background}}});l.process=function(e){var c=this._;if(this.tickID!==e){this.tickID=e;var f=this.nodes,
d,b=f.length;if(c.background)for(d=0;d<b;++d)f[d].process(e);if(f=f[c.selected])c.background||f.process(e),this.cells[1].set(f.cells[1]),this.cells[2].set(f.cells[2]);g.outputSignalAR(this)}return this};g.register("selector",h)})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);g.listener(this);g.fixAR(this);a=this._;a.status=c;a.samples=0;a.samplesIncr=0;a.writeIndex=0;a.plotFlush=!0;a.plotRange=[0,32];a.plotBarStyle=!0;this.once("init",f)}var g=i.fn,l=i.timevalue,e=i.modules.FFT,c=0;g.extend(h);var f=function(){var a=this._;a.fft||(this.size=512);a.interval||(this.interval=500)},d=h.prototype;Object.defineProperties(d,{size:{set:function(a){var b=this._;if(!b.fft&&"number"===typeof a&&(b.fft=new e(256>a?256:2048<a?2048:
a),b.buffer=new g.SignalArray(b.fft.length),b.freqs=new g.SignalArray(b.fft.length>>1),b.reservedwindow&&(b.fft.setWindow(b.reservedwindow),b.reservedwindow=null),b.reservedinterval))this.interval=b.reservedinterval,b.reservedinterval=null},get:function(){return this._.buffer.length}},window:{set:function(a){this._.fft.setWindow(a)},get:function(){return this._.fft.windowName}},interval:{set:function(a){var b=this._;"string"===typeof a&&(a=l(a));"number"===typeof a&&0<a&&(b.buffer?(b.interval=a,b.samplesIncr=
0.001*a*b.samplerate,b.samplesIncr<b.buffer.length&&(b.samplesIncr=b.buffer.length,b.interval=1E3*b.samplesIncr/b.samplerate)):b.reservedinterval=a)},get:function(){return this._.interval}},spectrum:{get:function(){return this._.fft.getFrequencyData(this._.freqs)}},real:{get:function(){return this._.fft.real}},imag:{get:function(){return this._.fft.imag}}});d.bang=function(){this._.samples=0;this._.writeIndex=0;this._.emit("bang");return this};d.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=
a;g.inputSignalAR(this);g.outputSignalAR(this);var a=this.cells[0],d,e=a.length,f=b.status,h=b.samples,i=b.samplesIncr,l=b.writeIndex,n=b.buffer,q=n.length,s;for(d=0;d<e;++d)0>=h&&f===c&&(f=1,l=0,h+=i),1===f&&(n[l++]=a[d],q<=l&&(b.fft.forward(n),s=b.plotFlush=!0,f=c)),--h;b.samples=h;b.status=f;b.writeIndex=l;s&&this._.emit("data")}return this};var b=i.Object.prototype.plot;d.plot=function(a){this._.plotFlush&&(this._.plotData=this.spectrum,this._.plotFlush=null);return b.call(this,a)};g.register("spectrum",
h)})(timbre);
(function(i){function h(g){i.Object.call(this,2,g);this._.ar=!1}var g=i.fn;g.extend(h);h.prototype.process=function(h){var e=this._;if(this.tickID!==h){this.tickID=h;var c=this.nodes,f=this.cells[0],d=this.cells[1],b=this.cells[2],a,j=c.length,i=f.length,k;if(e.ar){if(0<c.length){c[0].process(h);e=c[0].cells[1];k=c[0].cells[2];d.set(e);b.set(k);for(a=1;a<j;++a){c[a].process(h);e=c[a].cells[1];k=c[a].cells[2];for(f=0;f<i;++f)d[f]-=e[f],b[f]-=k[f]}}else for(f=0;f<i;++f)d[f]=b[a]=0;g.outputSignalAR(this)}else{if(0<c.length){d=
c[0].process(h).cells[0][0];for(a=1;a<j;++a)d-=c[a].process(h).cells[0][0]}else d=0;f[0]=d;g.outputSignalKR(this)}}return this};g.register("-",h)})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);g.fixAR(this);a=this._;this.playbackState=g.FINISHED_STATE;a.poly=4;a.genList=[];a.genDict={};a.synthdef=null;a.remGen=c(this);a.onended=g.make_onended(this)}var g=i.fn;g.extend(h);var l=h.prototype;Object.defineProperties(l,{def:{set:function(a){"function"===typeof a&&(this._.synthdef=a)},get:function(){return this._.synthdef}},poly:{set:function(a){"number"===typeof a&&(0<a&&64>=a)&&(this._.poly=a)},get:function(){return this._.poly}}});var e=function(a,
b){return function(){a._.remGen(b.gen)}},c=function(a){return function(b){var c=a._,d=c.genList.indexOf(b);-1!==d&&c.genList.splice(d,1);c.genDict[b.noteNum]=null}},f=function(a,b,c,d){c|=0;0>=c?this.noteOff(this,a):127<c&&(c=127);var f=this._,h=f.genList,l=f.genDict,r=l[a];r&&f.remGen(r);b={freq:b,noteNum:a,velocity:c};if(d)for(var n in d)b[n]=d[n];b.doneAction=e(this,b);r=this._.synthdef.call(this,b);r instanceof i.Object&&(r.noteNum=a,h.push(r),l[a]=b.gen=r,this.playbackState=g.PLAYING_STATE,h.length>
f.poly&&f.remGen(h[0]))},d=function(){for(var a=new Float32Array(128),b=0;128>b;++b)a[b]=440*Math.pow(2,1*(b-69)/12);return a}();l.noteOn=function(a,b,c){var e=d[a]||440*Math.pow(2,(a-69)/12);f.call(this,a+0.5|0,e,b,c);return this};l.noteOff=function(a){(a=this._.genDict[a])&&a.release&&a.release();return this};l.noteOnWithFreq=function(a,b,c){var d=0<a?12*Math.log(1*a/440)*Math.LOG2E+69:0;f.call(this,d+0.5|0,a,b,c);return this};l.noteOffWithFreq=function(a){return this.noteOff((0<a?12*Math.log(1*
a/440)*Math.LOG2E+69:0)+0.5|0)};l.allNoteOff=function(){for(var a=this._.genList,b=0,c=a.length;b<c;++b)a[b].release&&a[b].release()};l.allSoundOff=function(){for(var a=this._,b=a.genList,a=a.genDict;b.length;)delete a[b.shift().noteNum]};l.process=function(a){var b=this.cells[0],c=this._;if(this.tickID!==a){this.tickID=a;if(this.playbackState===g.PLAYING_STATE){var d=c.genList,e,f=this.cells[1],h=this.cells[2],i,b=b.length,l,q;if(d.length){e=d[0];e.process(a);f.set(e.cells[1]);h.set(e.cells[2]);
c=1;for(i=d.length;c<i;++c){e=d[c];e.process(a);l=e.cells[1];q=e.cells[2];for(e=0;e<b;++e)f[e]+=l[e],h[e]+=q[e]}}else g.nextTick(c.onended)}g.outputSignalAR(this)}return this};g.register("SynthDef",h);var b={set:function(a){g.isDictionary(a)?"string"===typeof a.type&&(this._.env=a):a instanceof i.Object&&(this._.env=a)},get:function(){return this._.env}};g.register("OscGen",function(){var a={set:function(a){"string"===typeof a&&(this._.wave=a)},get:function(){return this._.wave}},c=function(a){var b=
this._,c,d;c=b.env||{};d=c.type||"perc";b=i("osc",{wave:b.wave,freq:a.freq,mul:a.velocity/128});c instanceof i.Object?"function"===typeof c.clone&&(b=c.clone().append(b)):b=i(d,c,b);b.on("ended",a.doneAction).bang();return b};return function(d){d=new h(d);d._.wave="sin";Object.defineProperties(d,{env:b,wave:a});d.def=c;return d}}());g.register("PluckGen",function(){var a=function(a){var b,c,d;c=this._.env||{};d=c.type||"perc";b=i("pluck",{freq:a.freq,mul:a.velocity/128}).bang();c instanceof i.Object?
"function"===typeof c.clone&&(b=c.clone().append(b)):b=i(d,c,b);b.on("ended",a.doneAction).bang();return b};return function(c){c=new h(c);Object.defineProperties(c,{env:b});c.def=a;return c}}())})(timbre);
(function(i){function h(b){i.Object.call(this,2,b);g.fixAR(this);b=this._;b.isLooped=!1;b.onended=g.make_onended(this,0)}var g=i.fn,l=i.modules.Scissor,e=l.Tape,c=l.TapeStream,f=g.isSignalArray;g.extend(h);var d=h.prototype;Object.defineProperties(d,{tape:{set:function(b){b instanceof e?(this.playbackState=g.PLAYING_STATE,this._.tape=b,this._.tapeStream=new c(b,this._.samplerate)):"object"===typeof b&&f(b.buffer)&&(this.playbackState=g.PLAYING_STATE,this._.tape=new l(b),this._.tapeStream=new c(b,
this._.samplerate))},get:function(){return this._.tape}},isLooped:{get:function(){return this._.isLooped}}});d.loop=function(b){this._.isLooped=!!b;this._.tapeStream&&(this._.tapeStream.isLooped=this._.isLooped);return this};d.bang=function(){this.playbackState=g.PLAYING_STATE;this._.tapeStream&&this._.tapeStream.reset();this._.emit("bang");return this};d.process=function(b){var a=this._;if(this.tickID!==b){this.tickID=b;if(b=a.tapeStream){var c=this.cells[1],d=this.cells[2],e=b.fetch(c.length);c.set(e[0]);
d.set(e[1]);this.playbackState===g.PLAYING_STATE&&b.isEnded&&g.nextTick(a.onended)}g.outputSignalAR(this)}return this};g.register("tape",h)})(timbre);
(function(i){function h(d){i.Object.call(this,0,d);g.timer(this);g.fixKR(this);d=this._;this.playbackState=g.FINISHED_STATE;d.currentTime=0;d.samplesMax=0;d.samples=0;d.onended=g.make_onended(this);this.once("init",e);this.on("start",c)}var g=i.fn,l=i.timevalue;g.extend(h);var e=function(){this._.timeout||(this.timeout=1E3)},c=function(){this.playbackState=g.PLAYING_STATE};Object.defineProperty(c,"unremovable",{value:!0,writable:!1});var f=h.prototype;Object.defineProperties(f,{timeout:{set:function(c){var b=
this._;"string"===typeof c&&(c=l(c));"number"===typeof c&&0<=c&&(this.playbackState=g.PLAYING_STATE,b.timeout=c,b.samplesMax=b.samplerate*0.001*c|0,b.samples=b.samplesMax)},get:function(){return this._.timeout}},currentTime:{get:function(){return this._.currentTime}}});f.bang=function(){var c=this._;this.playbackState=g.PLAYING_STATE;c.samples=c.samplesMax;c.currentTime=0;c.emit("bang");return this};f.process=function(c){var b=this.cells[0],a=this._;if(this.tickID!==c){this.tickID=c;0<a.samples&&
(a.samples-=b.length);if(0>=a.samples){for(var c=this.nodes,b=0,e=c.length;b<e;++b)c[b].bang();g.nextTick(a.onended)}a.currentTime+=g.currentTimeIncr}return this};g.register("timeout",h)})(timbre);
(function(i){function h(e){i.Object.call(this,1,e);g.fixAR(this);this._.curve=null}var g=i.fn;g.extend(h);var l=h.prototype;Object.defineProperties(l,{curve:{set:function(e){g.isSignalArray(e)&&(this._.curve=e)},get:function(){return this._.curve}}});l.process=function(e){var c=this._;if(this.tickID!==e){this.tickID=e;g.inputSignalAR(this);if(c.curve){var e=this.cells[0],f=c.curve,d=f.length,b,a=c.cellsize;for(b=0;b<a;++b)c=0.5*(e[b]+1)*d+0.5|0,0>c?c=0:c>=d-1&&(c=d-1),e[b]=f[c]}g.outputSignalAR(this)}return this};
g.register("waveshaper",h)})(timbre);
(function(i){function h(c){i.Object.call(this,1,c);c=this._;c.inMin=0;c.inMax=1;c.outMin=0;c.outMax=1;c.ar=!1;this.once("init",l)}var g=i.fn;g.extend(h);var l=function(){this._.warp||(this.warp="linlin")},e=h.prototype;Object.defineProperties(e,{inMin:{set:function(c){"number"===typeof c&&(this._.inMin=c)},get:function(){return this._.inMin}},inMax:{set:function(c){"number"===typeof c&&(this._.inMax=c)},get:function(){return this._.inMax}},outMin:{set:function(c){"number"===typeof c&&(this._.outMin=
c)},get:function(){return this._.outMin}},outMax:{set:function(c){"number"===typeof c&&(this._.outMax=c)},get:function(){return this._.outMax}},warp:{set:function(e){if("string"===typeof e){var d=c[e];d&&(this._.warp=d,this._.warpName=e)}},get:function(){return this._.warpName}}});e.process=function(c){var d=this._,b=this.cells[0];if(this.tickID!==c){this.tickID=c;var a=d.inMin,e=d.inMax,h=d.outMin,i=d.outMax,l=d.warp,m=this.nodes.length,t=d.mul,r=d.add,c=b.length;if(d.ar&&m){g.inputSignalAR(this);
for(d=0;d<c;++d)b[d]=l(b[d],a,e,h,i)*t+r;g.outputSignalAR(this)}else{d=this.nodes.length?g.inputSignalKR(this):0;a=l(d,a,e,h,i)*t+r;for(d=0;d<c;++d)b[d]=a}}return this};var c={linlin:function(c,d,b,a,e){return c<d?a:c>b?e:b===d?a:(c-d)/(b-d)*(e-a)+a},linexp:function(c,d,b,a,e){return c<d?a:c>b?e:0===a?0:b===d?e:Math.pow(e/a,(c-d)/(b-d))*a},explin:function(c,d,b,a,e){return c<d?a:c>b?e:0===d?e:Math.log(c/d)/Math.log(b/d)*(e-a)+a},expexp:function(c,d,b,a,e){return c<d?a:c>b?e:0===d||0===a?0:Math.pow(e/
a,Math.log(c/d)/Math.log(b/d))*a}};g.register("zmap",h)})(timbre);
