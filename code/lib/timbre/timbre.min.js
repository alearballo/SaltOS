(function(k){function i(){function a(e){for(var b=Array(e.byteLength),d=e.BYTES_PER_ELEMENT,j,g=0,c=b.length;g<c;++g)j=8*(g%d),b[g]=(e[g/d|0]&255<<j)>>>j;b.__view=e;return b}function e(c,l,f,o){var n,h,s;if(Array.isArray(l))if(l.__view)if("undefined"===typeof f&&(f=0),"undefined"===typeof o&&(o=l.length-f),n=c.bytes,c.type===d)l=l.__view.slice(f/n|0,(f+o)/n|0);else{o=l.slice(f,f+o);l=Array(o.length/n|0);h=0;for(s=l.length;h<s;++h)l[h]=0;h=0;for(s=o.length;h<s;++h)l[h/n|0]+=(o[h]&255)<<8*(h%n)}else l=
l.slice();else l="number"===typeof l&&0<l?Array(l|0):[];if(c.type!==d){h=0;for(s=l.length;h<s;++h)l[h]=(+l[h]||0)&65535}else{h=0;for(s=l.length;h<s;++h)l[h]=l[h]||0}if(c.type===b){h=0;for(s=l.length;h<s;++h)l[h]&1<<8*n-1&&(l[h]-=1<<8*n)}l.__klass=c;l.constructor=window[c.name];l.set=j;l.subarray=g;l.BYTES_PER_ELEMENT=c.bytes;l.byteLength=c.bytes*l.length;l.byteOffset=f||0;Object.defineProperty(l,"buffer",{get:function(){return new a(this)}});return l}var b=1,d=2,j=function(a,e){"undefined"===typeof e&&
(e=0);var b,d=Math.min(this.length-e,a.length);for(b=0;b<d;++b)this[e+b]=a[b]},g=function(a,e){"undefined"===typeof e&&(e=this.length);return new this.__klass(this.slice(a,e))};[["Int8Array",1,b],["Uint8Array",1,0],["Int16Array",2,b],["Uint16Array",2,0],["Int32Array",4,b],["Uint32Array",4,0],["Float32Array",4,d],["Float64Array",8,d]].forEach(function(a){var b=a[0],d={bytes:a[1],type:a[2],name:b};window[b]=function(a,b,g){return e.call(this,d,a,b,g)}})}"undefined"===typeof Float32Array&&i();var f=
function(){return t.apply(null,arguments)},h=Array.prototype.slice,c=0,b=1,g=[8E3,11025,12E3,16E3,22050,24E3,32E3,44100,48E3],d=[32,64,128,256],a=null,e={},j={},o="undefined"!==typeof module&&module.exports?"node":"undefined"!==typeof window?"browser":"unknown",l="browser"===o&&/(iPhone|iPad|iPod|Android)/i.test(navigator.userAgent),n=!1,s=120,t=function(){var a=h.call(arguments),b=a[0],d;switch(typeof b){case "string":e[b]?d=new e[b](a.slice(1)):j[b]&&(d=j[b](a.slice(1)));break;case "number":d=new z(a);
break;case "boolean":d=new C(a);break;case "function":d=new D(a);break;case "object":if(null!==b){if(b instanceof u)return b;if(b.context instanceof u)return b.context;q(b)?d=new E(a):p(b)&&(d=new F(a))}}d===k&&(d=new y(a.slice(1)),console.warn('T("'+b+'") is not defined.'));a=d._;a.originkey=b;for(var b=a,g=d._.meta,l,c,f=d;null!==f&&f.constructor!==Object;){l=Object.getOwnPropertyNames(f);for(var o=0,n=l.length;o<n;++o)if(!g[l[o]])if(/^(constructor$|process$|_)/.test(l[o]))g[l[o]]="ignore";else if(c=
Object.getOwnPropertyDescriptor(f,l[o]),"function"===typeof c.value)g[l[o]]="function";else if(c.get||c.set)g[l[o]]="property";f=Object.getPrototypeOf(f)}b.meta=g;a.emit("init");return d};Object.defineProperties(f,{version:{value:"WORKING"},envtype:{value:o},envmobile:{value:l},env:{get:function(){return a.impl.env}},samplerate:{get:function(){return a.samplerate}},channels:{get:function(){return a.channels}},cellsize:{get:function(){return a.cellsize}},currentTime:{get:function(){return a.currentTime}},
isPlaying:{get:function(){return a.status===b}},isRecording:{get:function(){return 3===a.status}},amp:{set:function(e){"number"===typeof e&&(a.amp=e)},get:function(){return a.amp}},bpm:{set:function(a){"number"===typeof a&&5<=a&&300>=a&&(s=a)},get:function(){return s}}});f.bind=function(e,b){a.bind(e,b);return f};f.setup=function(e){a.setup(e);return f};f.play=function(){a.play();return f};f.pause=function(){a.pause();return f};f.reset=function(){a.reset();a.events.emit("reset");return f};f.on=f.addListener=
function(e,b){a.on(e,b);return f};f.once=function(e,b){a.once(e,b);return f};f.off=f.removeListener=function(e,b){a.off(e,b);return f};f.removeAllListeners=function(e){a.removeAllListeners(e);return f};f.listeners=function(e){return a.listeners(e)};f.rec=function(){return a.rec.apply(a,arguments)};f.timevalue=function(){var a=function(a){var e=s;if(a=/^bpm(\d+(?:\.\d+)?)/i.exec(a))e=Math.max(5,Math.min(300,+(a[1]||0)));return e};return function(e){var b,d;if(b=/^(\d+(?:\.\d+)?)Hz$/i.exec(e))return 0===
+b[1]?0:1E3/+b[1];if(b=/L(\d+)?(\.*)$/i.exec(e))return e=1E3*60/a(e)*(4/(b[1]||4)),e*=[1,1.5,1.75,1.875][(b[2]||"").length]||1;if(b=/^(\d+(?:\.\d+)?|\.(?:\d+))(min|sec|m)s?$/i.exec(e))switch(b[2]){case "min":return 6E4*+(b[1]||0);case "sec":return 1E3*+(b[1]||0);case "m":return+(b[1]||0)}return(b=/^(?:([0-5]?[0-9]):)?(?:([0-5]?[0-9]):)(?:([0-5]?[0-9]))(?:\.([0-9]{1,3}))?$/.exec(e))?(d=3600*(b[1]||0)+60*(b[2]||0)+(b[3]||0),d=1E3*d+(((b[4]||"")+"00").substr(0,3)|0)):(b=/(\d+)\.(\d+)\.(\d+)$/i.exec(e))?
(d=480*(4*b[1]+ +b[2])+ +b[3],1E3*60/a(e)*(d/480)):(b=/(\d+)ticks$/i.exec(e))?1E3*60/a(e)*(b[1]/480):(b=/^(\d+)samples(?:\/(\d+)Hz)?$/i.exec(e))?1E3*b[1]/(b[2]||f.samplerate):0}}();var m=f.fn={SignalArray:Float32Array,currentTimeIncr:0,emptycell:null,FINISHED_STATE:c,PLAYING_STATE:b,UNSCHEDULED_STATE:2,SCHEDULED_STATE:3},p=m.isArray=Array.isArray,q=m.isDictionary=function(a){return"object"===typeof a&&a.constructor===Object};m.nop=function(){return this};m.isSignalArray=function(a){return a instanceof
Float32Array||a instanceof Float64Array||Array.isArray(a)&&a.__klass&&2===a.__klass.type?!0:!1};m.extend=function(a,e){function b(){this.constructor=a}var e=e||u,d;for(d in e)e.hasOwnProperty(d)&&(a[d]=e[d]);b.prototype=e.prototype;a.prototype=new b;a.__super__=e.prototype;return a};m.constructorof=function(a,e){for(var b=a&&a.prototype;b;){if(b===e.prototype)return!0;b=Object.getPrototypeOf(b)}return!1};m.register=function(a,b){m.constructorof(b,u)?e[a]=b:j[a]=b};m.alias=function(a,b){e[b]?e[a]=
e[b]:j[b]&&(j[a]=j[b])};m.getClass=function(a){return e[a]};m.pointer=function(a,e,b){e=(a.byteOffset+e)*a.BYTES_PER_ELEMENT;return"number"===typeof b?new a.constructor(a.buffer,e,b):new a.constructor(a.buffer,e)};m.nextTick=function(e){a.nextTick(e);return f};m.fixAR=function(a){a._.ar=!0;a._.aronly=!0};m.fixKR=function(a){a._.ar=!1;a._.kronly=!0};m.changeWithValue=function(){var a=this._,a=a.value*a.mul+a.add;isNaN(a)&&(a=0);for(var e=this.cells[0],b=0,d=e.length;b<d;++b)e[b]=a};m.changeWithValue.unremovable=
!0;m.timer=function(){var e=function(e){return function(){-1===a.timers.indexOf(e)&&(a.timers.push(e),a.events.emit("addObject"),e._.emit("start"))}},b=function(e){return function(){var b=a.timers.indexOf(e);-1!==b&&(a.timers.splice(b,1),e._.emit("stop"),a.events.emit("removeObject"))}};return function(d){var g=e(d),j=b(d);d.start=function(){a.nextTick(g);return d};d.stop=function(){a.nextTick(j);return d};return d}}();m.listener=function(){var e=function(e){return function(){-1===a.listeners.indexOf(e)&&
(a.listeners.push(e),a.events.emit("addObject"),e._.emit("listen"))}},b=function(e){return function(){var b=a.listeners.indexOf(e);-1!==b&&(a.listeners.splice(b,1),e._.emit("unlisten"),a.events.emit("removeObject"))}};return function(d){var g=e(d),j=b(d);d.listen=function(){arguments.length&&d.append.apply(d,arguments);d.nodes.length&&a.nextTick(g);return d};d.unlisten=function(){arguments.length&&d.remove.apply(d,arguments);d.nodes.length||a.nextTick(j);return d};return d}}();m.make_onended=function(a,
e){return function(){a.playbackState=c;if("number"===typeof e)for(var b=a.cells[0],d=a.cells[1],g=a.cells[2],j=0,l=d.length;j<l;++j)b[0]=d[j]=g[j]=e;a._.emit("ended")}};m.inputSignalAR=function(a){var e=a.cells[0],d=a.cells[1],g=a.cells[2],j=a.nodes,l=j.length,c,f=e.length,o=a.tickID,n,h;if(2===a.numChannels){n=!0;if(0!==l){for(a=0;a<l;++a)if(j[a].playbackState===b){j[a].process(o);d.set(j[a].cells[1]);g.set(j[a].cells[2]);n=!1;++a;break}for(;a<l;++a)if(j[a].playbackState===b){j[a].process(o);e=j[a].cells[1];
h=j[a].cells[2];for(c=f;c;)c-=8,d[c]+=e[c],g[c]+=h[c],d[c+1]+=e[c+1],g[c+1]+=h[c+1],d[c+2]+=e[c+2],g[c+2]+=h[c+2],d[c+3]+=e[c+3],g[c+3]+=h[c+3],d[c+4]+=e[c+4],g[c+4]+=h[c+4],d[c+5]+=e[c+5],g[c+5]+=h[c+5],d[c+6]+=e[c+6],g[c+6]+=h[c+6],d[c+7]+=e[c+7],g[c+7]+=h[c+7]}}n&&(d.set(m.emptycell),g.set(m.emptycell))}else{n=!0;if(0!==l){for(a=0;a<l;++a)if(j[a].playbackState===b){j[a].process(o);e.set(j[a].cells[0]);n=!1;++a;break}for(;a<l;++a)if(j[a].playbackState===b){d=j[a].process(o).cells[0];for(c=f;c;)c-=
8,e[c]+=d[c],e[c+1]+=d[c+1],e[c+2]+=d[c+2],e[c+3]+=d[c+3],e[c+4]+=d[c+4],e[c+5]+=d[c+5],e[c+6]+=d[c+6],e[c+7]+=d[c+7]}}n&&e.set(m.emptycell)}};m.inputSignalKR=function(a){for(var e=a.nodes,d=e.length,g=a.tickID,j=0,a=0;a<d;++a)e[a].playbackState===b&&(j+=e[a].process(g).cells[0][0]);return j};m.outputSignalAR=function(a){var e=a.cells[0],b=a.cells[1],d=a.cells[2],g=a._.mul,j=a._.add;if(2===a.numChannels)for(a=e.length;a;)a-=8,b[a]=b[a]*g+j,d[a]=d[a]*g+j,b[a+1]=b[a+1]*g+j,d[a+1]=d[a+1]*g+j,b[a+2]=
b[a+2]*g+j,d[a+2]=d[a+2]*g+j,b[a+3]=b[a+3]*g+j,d[a+3]=d[a+3]*g+j,b[a+4]=b[a+4]*g+j,d[a+4]=d[a+4]*g+j,b[a+5]=b[a+5]*g+j,d[a+5]=d[a+5]*g+j,b[a+6]=b[a+6]*g+j,d[a+6]=d[a+6]*g+j,b[a+7]=b[a+7]*g+j,d[a+7]=d[a+7]*g+j,e[a]=0.5*(b[a]+d[a]),e[a+1]=0.5*(b[a+1]+d[a+1]),e[a+2]=0.5*(b[a+2]+d[a+2]),e[a+3]=0.5*(b[a+3]+d[a+3]),e[a+4]=0.5*(b[a+4]+d[a+4]),e[a+5]=0.5*(b[a+5]+d[a+5]),e[a+6]=0.5*(b[a+6]+d[a+6]),e[a+7]=0.5*(b[a+7]+d[a+7]);else if(1!==g||0!==j)for(a=e.length;a;)a-=8,e[a]=e[a]*g+j,e[a+1]=e[a+1]*g+j,e[a+2]=
e[a+2]*g+j,e[a+3]=e[a+3]*g+j,e[a+4]=e[a+4]*g+j,e[a+5]=e[a+5]*g+j,e[a+6]=e[a+6]*g+j,e[a+7]=e[a+7]*g+j};m.outputSignalKR=function(a){var e=a.cells[0],b=a.cells[1],d=a.cells[2],g=e[0]*a._.mul+a._.add;if(2===a.numChannels)for(a=e.length;a;)a-=8,e[a]=e[a+1]=e[a+2]=e[a+3]=e[a+4]=e[a+5]=e[a+6]=e[a+7]=b[a]=b[a+1]=b[a+2]=b[a+3]=b[a+4]=b[a+5]=b[a+6]=b[a+7]=d[a]=d[a+1]=d[a+2]=d[a+3]=d[a+4]=d[a+5]=d[a+6]=d[a+7]=g;else for(a=e.length;a;)a-=8,e[a]=e[a+1]=e[a+2]=e[a+3]=e[a+4]=e[a+5]=e[a+6]=e[a+7]=g};m.fix_iOS6_1_problem=
function(e){a.fix_iOS6_1_problem(e)};var r=f.modules={},v=r.EventEmitter=function(){function a(e){this.context=e;this.events={}}var e=a.prototype;e.emit=function(a){var e=this.events[a];if(!e)return!1;var b;if("function"===typeof e){switch(arguments.length){case 1:e.call(this.context);break;case 2:e.call(this.context,arguments[1]);break;case 3:e.call(this.context,arguments[1],arguments[2]);break;default:b=h.call(arguments,1),e.apply(this.context,b)}return!0}if(p(e)){b=h.call(arguments,1);for(var e=
e.slice(),d=0,g=e.length;d<g;++d)e[d]instanceof u?e[d].bang.apply(e[d],b):e[d].apply(this.context,b);return!0}if(e instanceof u)b=h.call(arguments,1),e.bang.apply(e,b);else return!1};e.on=function(a,e){if("function"!==typeof e&&!(e instanceof u))throw Error("addListener takes instances of Function or timbre.Object");var b=this.events;b[a]?p(b[a])?b[a].push(e):b[a]=[b[a],e]:b[a]=e;return this};e.once=function(a,e){var b=this,d;if("function"===typeof e)d=function(){b.off(a,d);e.apply(b.context,arguments)};
else if(e instanceof u)d=function(){b.off(a,d);e.bang.apply(e,arguments)};else throw Error("once takes instances of Function or timbre.Object");d.listener=e;b.on(a,d);return this};e.off=function(a,e){if("function"!==typeof e&&!(e instanceof u))throw Error("removeListener takes instances of Function or timbre.Object");var b=this.events;if(!b[a])return this;var d=b[a];if(p(d)){for(var g=-1,j=0,c=d.length;j<c;++j)if(d[j]===e||d[j].listener&&d[j].listener===e){g=j;break}if(0>g)return this;d.splice(g,
1);0===d.length&&(b[a]=null)}else if(d===e||d.listener&&d.listener===e)b[a]=null;return this};e.removeAllListeners=function(a){var e=this.events,b=!1,d=e[a];if(p(d))for(var g=d.length;g--;){var j=d[g];j.unremovable?b=!0:this.off(a,j)}else d&&(d.unremovable?b=!0:this.off(a,d));b||(e[a]=null);return this};e.listeners=function(a){var e=this.events;if(!e[a])return[];e=e[a];if(!p(e))return e.unremovable?[]:[e];for(var e=e.slice(),a=[],b=0,d=e.length;b<d;++b)e[b].unremovable||a.push(e[b]);return a};return a}(),
w=r.Deferred=function(){function a(b){this.context=b||this;this._state="pending";this._doneList=[];this._failList=[];this._promise=new e(this)}function e(a){this.context=a.context;this.then=a.then;this.done=function(){a.done.apply(a,arguments);return this};this.fail=function(){a.fail.apply(a,arguments);return this};this.pipe=function(){return a.pipe.apply(a,arguments)};this.always=function(){a.always.apply(a,arguments);return this};this.promise=function(){return this};this.isResolved=function(){return a.isResolved()};
this.isRejected=function(){return a.isRejected()}}var b=a.prototype,d=function(a,e,b,d){if("pending"===this._state){this._state=a;for(var a=0,g=e.length;a<g;++a)e[a].apply(b,d);this._doneList=this._failList=null}},g=function(a){return a&&"function"===typeof a.promise};b.resolve=function(){var a=h.call(arguments,0);d.call(this,"resolved",this._doneList,this.context||this,a);return this};b.resolveWith=function(a){var e=h.call(arguments,1);d.call(this,"resolved",this._doneList,a,e);return this};b.reject=
function(){var a=h.call(arguments,0);d.call(this,"rejected",this._failList,this.context||this,a);return this};b.rejectWith=function(a){var e=h.call(arguments,1);d.call(this,"rejected",this._failList,a,e);return this};b.promise=function(){return this._promise};b.done=function(){for(var a=h.call(arguments),e="resolved"===this._state,b="pending"===this._state,d=this._doneList,g=0,j=a.length;g<j;++g)if("function"===typeof a[g])if(e)a[g]();else b&&d.push(a[g]);return this};b.fail=function(){for(var a=
h.call(arguments),e="rejected"===this._state,b="pending"===this._state,d=this._failList,g=0,j=a.length;g<j;++g)if("function"===typeof a[g])if(e)a[g]();else b&&d.push(a[g]);return this};b.always=function(){this.done.apply(this,arguments);this.fail.apply(this,arguments);return this};b.then=function(a,e){return this.done(a).fail(e)};b.pipe=function(e,b){var d=this,j=new a(this.context);this.done(function(){var a=e.apply(d.context,arguments);g(a)?a.then(function(){var e=h.call(arguments);j.resolveWith.apply(j,
[a].concat(e))}):j.resolveWith(d,a)});this.fail(function(){if("function"===typeof b){var a=b.apply(d.context,arguments);g(a)&&a.fail(function(){var e=h.call(arguments);j.rejectWith.apply(j,[a].concat(e))})}else j.reject.apply(j,arguments)});return j.promise()};b.isResolved=function(){return"resolved"===this._state};b.isRejected=function(){return"rejected"===this._state};b.state=function(){return this._state};a.when=function(e){var b=0,d=h.call(arguments),j=d.length,c=j;1===j&&!g(e)&&(c=0);var l=1===
c?e:new a,f=function(a,e){return function(b){e[a]=1<arguments.length?h.call(arguments):b;--c||l.resolve.apply(l,e)}};if(1<j)for(var o=Array(j),n=function(){l.reject()};b<j;++b)d[b]&&g(d[b])?d[b].promise().done(f(b,o)).fail(n):(o[b]=d[b],--c);c||l.resolve.apply(l,d);return l.promise()};return a}(),u=f.Object=function(){function e(d,g){this._={};var j=this._.events=new v(this);this._.emit=function(){return j.emit.apply(j,arguments)};if(q(g[0])){var c=g.shift();this.once("init",function(){this.set(c)})}this.tickID=
-1;this.nodes=g.map(f);this.cells=[];this.numChannels=d;switch(d){case 0:this.L=this.R=new x(null);this.cells[0]=this.cells[1]=this.cells[2]=this.L.cell;break;case 1:this.L=this.R=new x(this);this.cells[0]=this.cells[1]=this.cells[2]=this.L.cell;break;case 2:this.L=new x(this),this.R=new x(this),this.cells[0]=new m.SignalArray(a.cellsize),this.cells[1]=this.L.cell,this.cells[2]=this.R.cell}this.playbackState=b;this._.ar=!0;this._.mul=1;this._.add=0;this._.dac=null;this._.bypassed=!1;this._.meta={};
this._.samplerate=a.samplerate;this._.cellsize=a.cellsize}var d=e.prototype;Object.defineProperties(d,{isAr:{get:function(){return this._.ar}},isKr:{get:function(){return!this._.ar}},isBypassed:{get:function(){return this._.bypassed}},isEnded:{get:function(){return!(this.playbackState&1)}},mul:{set:function(a){"number"===typeof a&&(this._.mul=a,this._.emit("setMul",a))},get:function(){return this._.mul}},add:{set:function(a){"number"===typeof a&&(this._.add=a,this._.emit("setAdd",a))},get:function(){return this._.add}}});
d.toString=function(){return this.constructor.name};d.valueOf=function(){a.tickID!==this.tickID&&this.process(a.tickID);return this.cells[0][0]};d.append=function(){if(0<arguments.length){var a=h.call(arguments).map(f);this.nodes=this.nodes.concat(a);this._.emit("append",a)}return this};d.appendTo=function(a){a.append(this);return this};d.remove=function(){if(0<arguments.length){for(var a,e=this.nodes,b=[],d=0,g=arguments.length;d<g;++d)if(-1!==(a=e.indexOf(arguments[d])))b.push(e[a]),e.splice(a,
1);0<b.length&&this._.emit("remove",b)}return this};d.removeFrom=function(a){a.remove(this);return this};d.removeAll=function(){var a=this.nodes.slice();this.nodes=[];0<a.length&&this._.emit("remove",a);return this};d.removeAtIndex=function(a){var e=this.nodes[a];e&&(this.nodes.splice(a,1),this._.emit("remove",[e]));return this};d.on=d.addListener=function(a,e){this._.events.on(a,e);return this};d.once=function(a,e){this._.events.once(a,e);return this};d.off=d.removeListener=function(a,e){this._.events.off(a,
e);return this};d.removeAllListeners=function(a){this._.events.removeAllListeners(a);return this};d.listeners=function(a){return this._.events.listeners(a)};d.set=function(a,e){var b,d,g=this._.meta;switch(typeof a){case "string":switch(g[a]){case "property":this[a]=e;break;case "function":this[a](e);break;default:for(b=this;null!==b;){if(d=Object.getOwnPropertyDescriptor(b,a))if("function"===typeof d.value)g[a]="function",this[a](e);else if(d.get||d.set)g[a]="property",this[a]=e;b=Object.getPrototypeOf(b)}}break;
case "object":for(b in a)this.set(b,a[b])}return this};d.get=function(a){if("property"===this._.meta[a])return this[a]};d.bang=function(){this._.emit.apply(this,["bang"].concat(h.call(arguments)));return this};d.process=m.nop;d.bypass=function(){this._.bypassed=0===arguments.length?!0:!!arguments[0];return this};d.play=function(){var a=this._.dac;null===a&&(a=this._.dac=new G(this));a.playbackState===c&&(a.play(),this._.emit.apply(this,["play"].concat(h.call(arguments))));return this};d.pause=function(){var a=
this._.dac;a&&a.playbackState===b&&(a.pause(),this._.dac=null,this._.emit("pause"));return this};d.start=d.stop=d.listen=d.unlisten=function(){return this};d.ar=function(){0===arguments.length||arguments[0]?this._.kronly||(this._.ar=!0,this._.emit("ar",!0)):this.kr(!0);return this};d.kr=function(){0===arguments.length||arguments[0]?this._.aronly||(this._.ar=!1,this._.emit("ar",!1)):this.ar(!0);return this};d.plot="browser"===o?function(a){var e=this._,b=a.target;if(!b)return this;var d=a.width||b.width||
320,g=a.height||b.height||240,j=(a.x||0)+0.5,c=a.y||0,b=b.getContext("2d"),l;l=a.foreground!==k?a.foreground:e.plotForeground||"rgb(  0, 128, 255)";var f;f=a.background!==k?a.background:e.plotBackground||"rgb(255, 255, 255)";var o=a.lineWidth||e.plotLineWidth||1,n=!!e.plotCyclic,h=e.plotData||this.cells[0],s=a.range||e.plotRange||[-1.2,1.2],m=s[0],s=g/(s[1]-m),i=d/h.length,t,p=h.length;b.save();b.rect(j,c,d,g);null!==f&&(b.fillStyle=f,b.fillRect(j,c,d,g));e.plotBefore&&e.plotBefore.call(this,b,j,
c,d,g);if(e.plotBarStyle){b.fillStyle=l;for(f=l=0;f<p;++f)n=(h[f]-m)*s,t=g-n,b.fillRect(l+j,t+c,i,n),l+=i}else{b.strokeStyle=l;b.lineWidth=o;b.beginPath();l=0;o=g-(h[0]-m)*s;b.moveTo(l+j,o+c);for(f=1;f<p;++f)l+=i,t=g-(h[f]-m)*s,b.lineTo(l+j,t+c);n?b.lineTo(l+i+j,o+c):b.lineTo(l+i+j,t+c);b.stroke()}e.plotAfter&&e.plotAfter.call(this,b,j,c,d,g);if(a=a.border||e.plotBorder)b.strokeStyle="string"===typeof a?a:"#000",b.lineWidth=1,b.strokeRect(j,c,d,g);b.restore();return this}:m.nop;return e}(),x=f.ChannelObject=
function(){function e(b){f.Object.call(this,-1,[]);m.fixAR(this);this._.parent=b;this.cell=new m.SignalArray(a.cellsize);this.L=this.R=this;this.cells[0]=this.cells[1]=this.cells[2]=this.cell;this.numChannels=1}m.extend(e);e.prototype.process=function(a){this.tickID!==a&&(this.tickID=a,this._.parent&&this._.parent.process(a));return this};return e}(),y=function(){function a(e){u.call(this,2,e)}m.extend(a);a.prototype.process=function(a){var e=this._;this.tickID!==a&&(this.tickID=a,e.ar?(m.inputSignalAR(this),
m.outputSignalAR(this)):(this.cells[0][0]=m.inputSignalKR(this),m.outputSignalKR(this)));return this};m.register("+",a);return a}(),z=function(){function a(e){u.call(this,1,[]);m.fixKR(this);this.value=e[0];if(q(e[1])){var b=e[1];this.once("init",function(){this.set(b)})}this.on("setAdd",m.changeWithValue);this.on("setMul",m.changeWithValue)}m.extend(a);Object.defineProperties(a.prototype,{value:{set:function(a){"number"===typeof a&&(this._.value=isNaN(a)?0:a,m.changeWithValue.call(this))},get:function(){return this._.value}}});
return a}(),C=function(){function a(e){u.call(this,1,[]);m.fixKR(this);this.value=e[0];if(q(e[1])){var b=e[1];this.once("init",function(){this.set(b)})}this.on("setAdd",m.changeWithValue);this.on("setMul",m.changeWithValue)}m.extend(a);Object.defineProperties(a.prototype,{value:{set:function(a){this._.value=a?1:0;m.changeWithValue.call(this)},get:function(){return!!this._.value}}});return a}(),D=function(){function a(e){u.call(this,1,[]);m.fixKR(this);this.func=e[0];this._.value=0;if(q(e[1])){var b=
e[1];this.once("init",function(){this.set(b)})}this.on("setAdd",m.changeWithValue);this.on("setMul",m.changeWithValue)}m.extend(a);var e=a.prototype;Object.defineProperties(e,{func:{set:function(a){"function"===typeof a&&(this._.func=a)},get:function(){return this._.func}},args:{set:function(a){this._.args=p(a)?a:[a]},get:function(){return this._.args}}});e.bang=function(){var a=this._,e=h.call(arguments).concat(a.args),e=a.func.apply(this,e);"number"===typeof e&&(a.value=e,m.changeWithValue.call(this));
this._.emit("bang");return this};return a}(),F=function(){function a(e){u.call(this,1,[]);m.fixKR(this);if(q(e[1])){var b=e[1];this.once("init",function(){this.set(b)})}}m.extend(a);Object.defineProperties(a.prototype,{});return a}(),E=function(){function a(e){u.call(this,1,[]);m.fixKR(this);if(q(e[1])){var b=e[1];this.once("init",function(){this.set(b)})}}m.extend(a);Object.defineProperties(a.prototype,{});return a}(),G=function(){function e(a){u.call(this,2,[]);this.playbackState=c;var b=this._;
b.node=a;b.onplay=d(this);b.onpause=g(this)}m.extend(e);var d=function(e){return function(){-1===a.inlets.indexOf(e)&&(a.inlets.push(e),a.events.emit("addObject"),e.playbackState=b,e._.emit("play"))}},g=function(e){return function(){var b=a.inlets.indexOf(e);-1!==b&&(a.inlets.splice(b,1),e.playbackState=c,e._.emit("pause"),a.events.emit("removeObject"))}},j=e.prototype;j.play=function(){a.nextTick(this._.onplay)};j.pause=function(){a.nextTick(this._.onpause)};j.process=function(a){var e=this._.node;
e.playbackState&1?(e.process(a),this.cells[1].set(e.cells[1]),this.cells[2].set(e.cells[2])):(this.cells[1].set(m.emptycell),this.cells[2].set(m.emptycell))};return e}(),r=function(){function a(){this.context=this;this.tickID=0;this.impl=null;this.amp=0.8;this.status=c;this.samplerate=44100;this.channels=2;this.cellsize=64;this.streammsec=20;this.currentTime=this.streamsize=0;this.nextTicks=[];this.inlets=[];this.timers=[];this.listeners=[];this.deferred=null;this.recStart=0;this.recBuffers=null;
this.delayProcess=e(this);this.events=null;m.currentTimeIncr=1E3*this.cellsize/this.samplerate;m.emptycell=new m.SignalArray(this.cellsize);this.reset(!0)}var e=function(a){return function(){a.recStart=Date.now();a.process()}},j=a.prototype;j.bind=function(a,e){"function"===typeof a&&(this.impl=new a(this,e),this.impl.defaultSamplerate&&(this.samplerate=this.impl.defaultSamplerate));return this};j.setup=function(a){if("object"===typeof a&&(-1!==g.indexOf(a.samplerate)&&(this.samplerate=a.samplerate<=
this.impl.maxSamplerate?a.samplerate:this.impl.maxSamplerate),-1!==d.indexOf(a.cellsize)&&(this.cellsize=a.cellsize),"undefined"!==typeof a.f64))n=!!a.f64,m.SignalArray=n?Float64Array:Float32Array;m.currentTimeIncr=1E3*this.cellsize/this.samplerate;m.emptycell=new m.SignalArray(this.cellsize);return this};j.getAdjustSamples=function(a){a=a||this.samplerate;a=Math.ceil(Math.log(this.streammsec/1E3*a)*Math.LOG2E);return 1<<(8>a?8:14<a?14:a)};j.play=function(){this.status===c&&(this.status=b,this.streamsize=
this.getAdjustSamples(),this.strmL=new m.SignalArray(this.streamsize),this.strmR=new m.SignalArray(this.streamsize),this.impl.play(),this.events.emit("play"));return this};j.pause=function(){this.status===b&&(this.status=c,this.impl.pause(),this.events.emit("pause"));return this};j.reset=function(a){a&&(this.events=(new v(this)).on("addObject",function(){this.status===c&&this.play()}).on("removeObject",function(){this.status===b&&0===this.inlets.length+this.timers.length+this.listeners.length&&this.pause()}));
this.currentTime=0;this.nextTicks=[];this.inlets=[];this.timers=[];this.listeners=[];return this};j.process=function(){var a=this.tickID,e=this.strmL,b=this.strmR,d=this.amp,j,g,c,l=this.streamsize,f=0,o,n,h,s=this.cellsize,i=this.streamsize/this.cellsize,k=this.timers,t=this.inlets,p=this.listeners,q=m.currentTimeIncr;for(c=0;c<l;++c)e[c]=b[c]=0;for(;i--;){++a;o=0;for(n=k.length;o<n;++o)k[o].playbackState&1&&k[o].process(a);o=0;for(n=t.length;o<n;++o)if(j=t[o],j.process(a),j.playbackState&1){g=j.cells[1];
j=j.cells[2];h=0;for(c=f;h<s;++h,++c)e[c]+=g[h],b[c]+=j[h]}f+=s;o=0;for(n=p.length;o<n;++o)p[o].playbackState&1&&p[o].process(a);this.currentTime+=q;c=this.nextTicks.splice(0);o=0;for(n=c.length;o<n;++o)c[o]()}for(c=0;c<l;++c)j=e[c]*d,-1>j?j=-1:1<j&&(j=1),e[c]=j,j=b[c]*d,-1>j?j=-1:1<j&&(j=1),b[c]=j;this.tickID=a;a=this.currentTime;if(3===this.status){if(2===this.recCh)this.recBuffers.push(new m.SignalArray(e)),this.recBuffers.push(new m.SignalArray(b));else{d=new m.SignalArray(e.length);c=0;for(l=
d.length;c<l;++c)d[c]=0.5*(e[c]+b[c]);this.recBuffers.push(d)}a>=this.maxDuration?this.deferred.sub.reject():a>=this.recDuration?this.deferred.sub.resolve():20<Date.now()-this.recStart?setTimeout(this.delayProcess,10):this.process()}};j.nextTick=function(a){this.status===c?a():this.nextTicks.push(a)};j.rec=function(){m.fix_iOS6_1_problem(!0);var a=new w(this);if(this.deferred)return console.warn("rec deferred is exists??"),a.reject().promise();if(this.status!==c)return console.log("status is not none",
this.status),a.reject().promise();var e=0,b=arguments,d=q(b[e])?b[e++]:{},e=b[e];if("function"!==typeof e)return console.warn("no function"),a.reject().promise();this.deferred=a;this.status=3;this.reset();var j=new t("+"),g=new w(this),o=this;g.then(l,function(){m.fix_iOS6_1_problem(!1);l.call(o,!0)});this.deferred.sub=g;this.savedSamplerate=this.samplerate;this.samplerate=d.samplerate||this.samplerate;this.recDuration=d.recDuration||Infinity;this.maxDuration=d.maxDuration||6E5;this.recCh=d.ch||1;
2!==this.recCh&&(this.recCh=1);this.recBuffers=[];this.streamsize=this.getAdjustSamples();this.strmL=new m.SignalArray(this.streamsize);this.strmR=new m.SignalArray(this.streamsize);this.inlets.push(j);e({done:function(){g.resolve.apply(g,h.call(arguments))},send:function(){j.append.apply(j,arguments)}});setTimeout(this.delayProcess,10);return a.promise()};var l=function(){this.status=c;this.reset();var a=this.recBuffers,e=this.samplerate,b=this.streamsize,d;this.samplerate=this.savedSamplerate;d=
Infinity!==this.recDuration?0.001*this.recDuration*e|0:(a.length>>this.recCh-1)*b;var j,g=d/b|0,l=0,o=0,f=d;if(2===this.recCh){var n=new m.SignalArray(d),h=new m.SignalArray(d),s=new m.SignalArray(d);for(j=0;j<g;++j)if(n.set(a[l++],o),h.set(a[l++],o),o+=b,f-=b,0<f&&f<b){n.set(a[l++].subarray(0,f),o);h.set(a[l++].subarray(0,f),o);break}j=0;for(g=d;j<g;++j)s[j]=0.5*(n[j]+h[j]);a={samplerate:e,channels:2,buffer:[s,n,h]}}else{d=new m.SignalArray(d);for(j=0;j<g;++j)if(d.set(a[l++],o),o+=b,f-=b,0<f&&f<
b){d.set(a[l++].subarray(0,f),o);break}a={samplerate:e,channels:1,buffer:[d]}}this.deferred.resolve.apply(this.deferred,[].concat.apply([a],arguments));this.deferred=null};j.on=function(a,e){this.events.on(a,e)};j.once=function(a,e){this.events.once(a,e)};j.off=function(a,e){this.events.off(a,e)};j.removeAllListeners=function(a){this.events.removeListeners(a)};j.listeners=function(a){return this.events.listeners(a)};j.fix_iOS6_1_problem=function(a){this.impl.fix_iOS6_1_problem&&this.impl.fix_iOS6_1_problem(a)};
return a}(),A=null;"undefined"!==typeof webkitAudioContext?A=function(a){var e=new webkitAudioContext,b,d;m._audioContext=e;this.defaultSamplerate=this.maxSamplerate=e.sampleRate;this.env="webkit";var j=navigator.userAgent;j.match(/linux/i)?a.streammsec*=8:j.match(/win(dows)?\s*(nt 5\.1|xp)/i)&&(a.streammsec*=4);this.play=function(){var j,g=a.getAdjustSamples(e.sampleRate),c=a.streamsize,l,o;if(a.samplerate===e.sampleRate)j=function(e){e=e.outputBuffer;a.process();e.getChannelData(0).set(a.strmL);
e.getChannelData(1).set(a.strmR)};else if(a.samplerate*2===e.sampleRate)j=function(e){var b=a.strmL,d=a.strmR,j=e.outputBuffer,e=j.getChannelData(0),g=j.getChannelData(1),c=j.length,l;a.process();for(j=l=0;j<c;j=j+2,++l){e[j]=e[j+1]=b[l];g[j]=g[j+1]=d[l]}};else{l=c;o=a.samplerate/e.sampleRate;j=function(e){for(var b=a.strmL,d=a.strmR,j=e.outputBuffer,e=j.getChannelData(0),g=j.getChannelData(1),f=j.length,j=0;j<f;++j){if(l>=c){a.process();l=l-c}e[j]=b[l|0];g[j]=d[l|0];l=l+o}}}b=e.createBufferSource();
d=e.createJavaScriptNode(g,2,a.channels);d.onaudioprocess=j;b.noteOn(0);b.connect(d);d.connect(e.destination)};this.pause=function(){b.disconnect();d.disconnect()};if(l){var g=0,c=e.createBufferSource();this.fix_iOS6_1_problem=function(a){g=g+(a?1:-1);if(g===1){c.noteOn(0);c.connect(e.destination)}else g===0&&c.disconnect()}}}:"function"===typeof Audio&&"function"===typeof(new Audio).mozSetup?A=function(a){var e=function(){var a=new Blob(["var t=0;onmessage=function(e){if(t)t=clearInterval(t),0;if(typeof e.data=='number'&&e.data>0)t=setInterval(function(){postMessage(0);},e.data);};"],
{type:"text/javascript"}),a=URL.createObjectURL(a);return new Worker(a)}();this.maxSamplerate=48E3;this.defaultSamplerate=44100;this.env="moz";this.play=function(){var b=new Audio,d=new Float32Array(a.streamsize*a.channels),j=a.streammsec,g=0,c=1E3*(a.streamsize/a.samplerate),l=Date.now();b.mozSetup(a.channels,a.samplerate);e.onmessage=function(){if(!(g>Date.now()-l)){var e=a.strmL,j=a.strmR,o=d.length,f=e.length;for(a.process();f--;)d[--o]=j[f],d[--o]=e[f];b.mozWriteAudio(d);g+=c}};e.postMessage(j)};
this.pause=function(){e.postMessage(0)}}:(function(){function a(b){var d=0;e();this.defaultSamplerate=this.maxSamplerate=44100;this.env="flash";this.play=function(){var a,e=Array(b.streamsize*b.channels),j=b.streammsec,c=0,l=1E3*(b.streamsize/b.samplerate),o=Date.now();a=function(){if(!(c>Date.now()-o)){var a=b.strmL,d=b.strmR,j=e.length,f=a.length;for(b.process();f--;)e[--j]=32768*d[f]|0,e[--j]=32768*a[f]|0;g.writeAudio(e.join(" "));c+=l}};g.setup?(g.setup(b.channels,b.samplerate),d=setInterval(a,
j)):console.warn("Cannot find "+f)};this.pause=function(){0!==d&&(g.cancel(),clearInterval(d),d=0)}}function e(){var a,d;d=f+"?"+ +new Date;var j=document.createElement("div");j.id=c;j.style.display="inline";j.width=j.height=1;b.plugins&&b.mimeTypes&&b.mimeTypes.length?(a=document.createElement("object"),a.id="TimbreFlashPlayer",a.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",a.width=a.height=1,a.setAttribute("data",d),a.setAttribute("type","application/x-shockwave-flash"),d=document.createElement("param"),
d.setAttribute("name","allowScriptAccess"),d.setAttribute("value","always"),a.appendChild(d),j.appendChild(a)):j.innerHTML='<object id="TimbreFlashPlayer" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="1" height="1">'+('<param name="movie" value="'+d+'" />')+'<param name="bgcolor" value="#FFFFFF" /><param name="quality" value="high" /><param name="allowScriptAccess" value="always" /></object>';window.addEventListener("load",function(){document.body.appendChild(j);g=document.TimbreFlashPlayer})}
if(!("browser"!==o||l)){var b=navigator,d;try{d=b.plugins&&b.mimeTypes&&b.mimeTypes.length?b.plugins["Shockwave Flash"].description.match(/([0-9]+)/)[0]:(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version").match(/([0-9]+)/)[0]}catch(j){d=-1}if(!(10>d)){var g,c="TimbreFlashPlayerDiv",f=function(){var a=document.getElementsByTagName("script");if(a&&a.length)for(var e,b=0,d=a.length;b<d;++b)if(e=/^(.*\/)timbre(.*)\.js$/i.exec(a[b].src))return e[1]+"timbre.swf"}();A=a}}}(),A||
(A=function(){this.maxSamplerate=48E3;this.defaultSamplerate=8E3;this.env="nop";this.pause=this.play=m.nop}));var a=(new r).bind(A),B=f;"node"===o?module.exports=global.timbre=B:"browser"===o&&(B.noConflict=function(){var a=window.timbre,e=window.T;return function(b){if(window.T===B)window.T=e;if(b&&window.timbre===B)window.timbre=a;return B}}(),window.timbre=window.T=B)})();
(function(k){function i(c){this.samplerate=c;this.frequency=340;this.Q=1;this.b0=this.b1=this.b2=this.a1=this.a2=this.x1R=this.x2R=this.y1R=this.y2R=this.x1L=this.x2L=this.y1L=this.y2L=this.gain=0;this.setType("lpf")}var f=i.prototype;f.process=function(c,b){var g,d,a,e=this.x1L,j=this.x2L,f=this.y1L,l=this.y2L,n=this.x1R,h=this.x2R,i=this.y1R,m=this.y2R,k=this.b0,q=this.b1,r=this.b2,v=this.a1,w=this.a2,u,x;u=0;for(x=c.length;u<x;++u)g=c[u],d=k*g+q*e+r*j-v*f-w*l,j=e,e=g,l=f,f=d,g=b[u],a=k*g+q*n+r*
h-v*i-w*m,h=n,n=g,m=i,i=a,c[u]=d,b[u]=a;this.x1L=e;this.x2L=j;this.y1L=f;this.y2L=l;this.x1R=n;this.x2R=h;this.y1R=i;this.y2R=m};f.setType=function(c){var b;if(b=h[c])this.type=c,b.call(this,this.frequency,this.Q,this.gain)};f.setParams=function(c,b,g){this.frequency=c;this.Q=b;this.gain=g;var d=h[this.type];d&&d.call(this,c,b,g);return this};var h={lowpass:function(c,b){c/=0.5*this.samplerate;if(1<=c)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else if(0>=c)this.b0=this.b1=this.b2=this.a1=this.a2=
0;else{var g=Math.pow(10,0.05*(0>b?0:b)),d=Math.sqrt(0.5*(4-Math.sqrt(16-16/(g*g)))),g=Math.PI*c,d=0.5*d*Math.sin(g),d=0.5*(1-d)/(1+d),g=(0.5+d)*Math.cos(g),a=0.25*(0.5+d-g);this.b0=2*a;this.b1=4*a;this.b2=this.b0;this.a1=2*-g;this.a2=2*d}},highpass:function(c,b){c/=0.5*this.samplerate;if(1<=c)this.b0=this.b1=this.b2=this.a1=this.a2=0;else if(0>=c)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else{var g=Math.pow(10,0.05*(0>b?0:b)),d=Math.sqrt((4-Math.sqrt(16-16/(g*g)))/2),g=Math.PI*c,d=0.5*d*Math.sin(g),
d=0.5*(1-d)/(1+d),g=(0.5+d)*Math.cos(g),a=0.25*(0.5+d+g);this.b0=2*a;this.b1=-4*a;this.b2=this.b0;this.a1=2*-g;this.a2=2*d}},bandpass:function(c,b){c/=0.5*this.samplerate;if(0<c&&1>c)if(0<b){var g=Math.PI*c,d=Math.sin(g)/(2*b),g=Math.cos(g),a=1/(1+d);this.b0=d*a;this.b1=0;this.b2=-d*a;this.a1=-2*g*a;this.a2=(1-d)*a}else this.b0=this.b1=this.b2=this.a1=this.a2=0;else this.b0=this.b1=this.b2=this.a1=this.a2=0},lowshelf:function(c,b,g){c/=0.5*this.samplerate;b=Math.pow(10,g/40);if(1<=c)this.b0=b*b,this.b1=
this.b2=this.a1=this.a2=0;else if(0>=c)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else{var c=Math.PI*c,g=0.5*Math.sin(c)*Math.sqrt(0*(b+1/b)+2),c=Math.cos(c),g=2*Math.sqrt(b)*g,d=b+1,a=b-1,e=1/(d+a*c+g);this.b0=b*(d-a*c+g)*e;this.b1=2*b*(a-d*c)*e;this.b2=b*(d-a*c-g)*e;this.a1=-2*(a+d*c)*e;this.a2=(d+a*c-g)*e}},highshelf:function(c,b,g){c/=0.5*this.samplerate;b=Math.pow(10,g/40);if(1<=c)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else if(0>=c)this.b0=b*b,this.b1=this.b2=this.a1=this.a2=0;else{var c=
Math.PI*c,g=0.5*Math.sin(c)*Math.sqrt(0*(b+1/b)+2),c=Math.cos(c),g=2*Math.sqrt(b)*g,d=b+1,a=b-1,e=1/(d-a*c+g);this.b0=b*(d+a*c+g)*e;this.b1=-2*b*(a+d*c)*e;this.b2=b*(d+a*c-g)*e;this.a1=2*(a-d*c)*e;this.a2=(d-a*c-g)*e}},peaking:function(c,b,g){c/=0.5*this.samplerate;if(0<c&&1>c)if(g=Math.pow(10,g/40),0<b){var c=Math.PI*c,b=Math.sin(c)/(2*b),c=Math.cos(c),d=1/(1+b/g);this.b0=(1+b*g)*d;this.b1=-2*c*d;this.b2=(1-b*g)*d;this.a1=this.b1;this.a2=(1-b/g)*d}else this.b0=g*g,this.b1=this.b2=this.a1=this.a2=
0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0},notch:function(c,b){c/=0.5*this.samplerate;if(0<c&&1>c)if(0<b){var g=Math.PI*c,d=Math.sin(g)/(2*b),g=Math.cos(g),a=1/(1+d);this.b0=a;this.b1=-2*g*a;this.b2=a;this.a1=this.b1;this.a2=(1-d)*a}else this.b0=this.b1=this.b2=this.a1=this.a2=0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0},allpass:function(c,b){c/=0.5*this.samplerate;if(0<c&&1>c)if(0<b){var g=Math.PI*c,d=Math.sin(g)/(2*b),g=Math.cos(g),a=1/(1+d);this.b0=(1-d)*a;this.b1=-2*g*a;this.b2=
(1+d)*a;this.a1=this.b1;this.a2=this.b0}else this.b0=-1,this.b1=this.b2=this.a1=this.a2=0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0}};h.lpf=h.lowpass;h.hpf=h.highpass;h.bpf=h.bandpass;h.bef=h.notch;h.brf=h.notch;h.apf=h.allpass;k.modules.Biquad=i})(timbre);
(function(k){function i(c){this.samplerate=c;this.buffersize=1<<Math.round(Math.log(0.1*c)*Math.LOG2E);this.bufferL=new k.fn.SignalArray(this.buffersize+1);this.bufferR=new k.fn.SignalArray(this.buffersize+1);this._wave=this.wave=null;this.writeIndex=this.buffersize>>1;this.readIndex=0;this.delayTime=20;this.rate=4;this.depth=20;this.feedback=0.2;this.wet=0.5;this.phaseIncr=this.phase=0;this.phaseStep=4;this.setWaveType("sin");this.setDelayTime(this.delayTime);this.setRate(this.rate)}var f=i.prototype,
h=[];h[0]=function(){for(var c=new Float32Array(512),b=0;512>b;++b)c[b]=Math.sin(2*Math.PI*(b/512));return c}();h[1]=function(){for(var c=new Float32Array(512),b,g=0;512>g;++g)b=g/512-0.25,c[g]=1-4*Math.abs(Math.round(b)-b);return c}();f.setWaveType=function(c){"sin"===c?(this.wave=c,this._wave=h[0]):"tri"===c&&(this.wave=c,this._wave=h[1])};f.setDelayTime=function(c){this.delayTime=c;for(c=this.writeIndex-(0.001*c*this.samplerate|0);0>c;)c+=this.buffersize;this.readIndex=c};f.setRate=function(c){this.rate=
c;this.phaseIncr=512*this.rate/this.samplerate*this.phaseStep};f.process=function(c,b){var g=this.bufferL,d=this.bufferR,a=this.buffersize,e=a-1,j=this._wave,f=this.phase,l=this.phaseIncr,n=this.writeIndex,h=this.readIndex,i=this.depth,m=this.feedback,k,q,r,v=this.wet,w=1-v,u,x=c.length,y,z=this.phaseStep;for(u=0;u<x;){r=j[f|0]*i;for(f+=l;512<f;)f-=512;for(y=0;y<z;++y,++u)q=h+a+r&e,k=0.5*(g[q]+g[q+1]),g[n]=c[u]-k*m,c[u]=c[u]*w+k*v,k=0.5*(d[q]+d[q+1]),d[n]=b[u]-k*m,b[u]=b[u]*w+k*v,n=n+1&e,h=h+1&e}this.phase=
f;this.writeIndex=n;this.readIndex=h};k.modules.Chorus=i})(timbre);
(function(k){function i(f){this.samplerate=f;this.dbThreshold=-24;this.dbKnee=0;this.dbRatio=12;this.setParams(this.dbThreshold,this.dbKnee,this.dbRatio)}var f=i.prototype;f.setParams=function(f,c,b){this.dbThreshold=f;this.threshold=Math.pow(10,0.05*this.dbThreshold);this.dbRatio=b;this.ratio=Math.pow(10,0.05*this.dbRatio);this.slope=1/this.ratio;this.gain=1/(this.threshold+(1-this.threshold)*this.slope)};f.process=function(f,c){var b=this.threshold,g=this.slope,d=this.gain,a,e,j,o,l=f.length;for(o=
0;o<l;++o)e=f[o],j=c[o],a=0.5*(e+j),b>a?(e=b+(e-b)*g,j=b+(j-b)*g):a<-b&&(e=-b+(e+b)*g,j=-b+(j+b)*g),f[o]=e*d,f[o]=j*d};k.modules.Compressor=i})(timbre);
(function(k){function i(){}i.prototype.decode=function(f,h,c){if("string"===typeof f){if(/\.wav$/.test(f))return i.wav_decode(f,h,c);if(i.ogg_decode&&/\.ogg$/.test(f))return i.ogg_decode(f,h,c);if(i.mp3_decode&&/\.mp3$/.test(f))return i.mp3_decode(f,h,c)}else if("object"===typeof f){if("wav"===f.type)return i.wav_decode(f.data,h,c);if(i.ogg_decode&&"ogg"===f.type)return i.ogg_decode(f.data,h,c);if(i.mp3_decode&&"mp3"===f.type)return i.mp3_decode(f.data,h,c)}if(i.webkit_decode)return"object"===typeof f?
i.webkit_decode(f.data,h,c):i.webkit_decode(f,h,c);if(i.moz_decode)return i.moz_decode(f,h,c);h(!1)};k.modules.Decoder=i;i.getBinaryWithPath="browser"===k.envtype?function(f,h){k.fn.fix_iOS6_1_problem(!0);var c=new XMLHttpRequest;c.open("GET",f);c.responseType="arraybuffer";c.onreadystatechange=function(){4===c.readyState&&(c.response?h(new Uint8Array(c.response)):void 0!==c.responseBody&&h(new Uint8Array(VBArray(c.responseBody).toArray())),k.fn.fix_iOS6_1_problem(!1))};c.send()}:function(f,h){h("no support")};
i.wav_decode=function(){var f=function(f,c,b){if("RIFF"!==String.fromCharCode(f[0],f[1],f[2],f[3])||f[4]+(f[5]<<8)+(f[6]<<16)+(f[7]<<24)+8!==f.length||"WAVE"!==String.fromCharCode(f[8],f[9],f[10],f[11])||"fmt "!==String.fromCharCode(f[12],f[13],f[14],f[15]))return c(!1);var g=f[22]+(f[23]<<8),d=f[24]+(f[25]<<8)+(f[26]<<16)+(f[27]<<24),a=f[34]+(f[35]<<8);if("data"!==String.fromCharCode(f[36],f[37],f[38],f[39]))return c(!1);var e=f[40]+(f[41]<<8)+(f[42]<<16)+(f[43]<<24),j=(e/g>>1)/d;if(e>f.length-44)return c(!1);
var o,l,e=new Float32Array(j*d|0);2===g&&(o=new Float32Array(e.length),l=new Float32Array(e.length));c({samplerate:d,channels:g,buffer:[e,o,l],duration:j});if(8===a)f=new Int8Array(f.buffer,44);else if(16===a)f=new Int16Array(f.buffer,44);else if(32===a)f=new Int32Array(f.buffer,44);else if(24===a){for(var f=new Uint8Array(f.buffer,44),n,s,i,c=new Int32Array(f.length/3),d=0,j=f.length,k=0;d<j;)n=f[d++],s=f[d++],i=f[d++],n=n+(s<<8)+(i<<16),n=n&8388608?n-16777216:n,c[k++]=n;f=c}a=1/((1<<a-1)-1);if(2===
g){g=d=0;for(c=e.length;g<c;++g)j=o[g]=f[d++]*a,j+=l[g]=f[d++]*a,e[g]=0.5*j}else{g=0;for(c=e.length;g<c;++g)e[g]=f[g]*a}b()};return function(h,c,b){"string"===typeof h?i.getBinaryWithPath(h,function(g){f(g,c,b)}):f(h,c,b)}}();i.webkit_decode=function(){if("undefined"!==typeof webkitAudioContext){var f=k.fn._audioContext,h=function(c,b,g){var d,a,e,j;if("string"===typeof c)return g(!1);try{e=f.createBuffer(c.buffer,!1)}catch(o){return b(!1)}c=f.sampleRate;d=e.numberOfChannels;2===d?(console.log(e),
a=e.getChannelData(0),e=e.getChannelData(1)):a=e=e.getChannelData(0);j=a.length/c;for(var l=new Float32Array(a),n=0,h=l.length;n<h;++n)l[n]=0.5*(l[n]+e[n]);b({samplerate:c,channels:d,buffer:[l,a,e],duration:j});g()};return function(c,b,g){if(c instanceof File){var d=new FileReader;d.onload=function(a){h(new Uint8Array(a.target.result),b,g)};d.readAsArrayBuffer(c)}else"string"===typeof c?i.getBinaryWithPath(c,function(a){h(a,b,g)}):h(c,b,g)}}}();i.moz_decode=function(){if("function"===typeof Audio&&
"function"===typeof(new Audio).mozSetup)return function(f,h,c){var b,g,d,a,e,j,o=0,l=new Audio(f);l.volume=0;l.addEventListener("loadedmetadata",function(){b=l.mozSampleRate;g=l.mozChannels;j=l.duration;d=new Float32Array(l.duration*b|0);2===g&&(a=new Float32Array(l.duration*b|0),e=new Float32Array(l.duration*b|0));2===g?l.addEventListener("MozAudioAvailable",function(b){for(var j=b.frameBuffer,g=0,c=j.length;g<c;g=g+2){b=a[o]=j[g];b=b+(e[o]=j[g+1]);d[o]=b*0.5;o=o+1}},!1):l.addEventListener("MozAudioAvailable",
function(a){for(var a=a.frameBuffer,e=0,b=a.length;e<b;++e){d[e]=a[e];o=o+1}},!1);l.play();setTimeout(function(){h({samplerate:b,channels:g,buffer:[d,a,e],duration:j})},1E3)},!1);l.addEventListener("ended",function(){c()},!1);l.load()}}()})(timbre);
(function(k){function i(a){this.samplerate=a||44100;this.value=h;this.status=l;this.curve="linear";this.step=1;this.emit=this.loopNode=this.releaseNode=null;this._envValue=new f(a);this._table=[];this._initValue=h;this._curveValue=0;this._defaultCurveType=b;this._counter=this._index=0}function f(a){this.samplerate=a;this.value=h;this.step=1;this._curveType=b;this._y2=this._y1=this._b1=this._a2=this._grow=this._curveValue=0}var h=i.ZERO=1.0E-6,c=i.CurveTypeSet=0,b=i.CurveTypeLin=1,g=i.CurveTypeExp=
2,d=i.CurveTypeSin=3,a=i.CurveTypeWel=4,e=i.CurveTypeCurve=5,j=i.CurveTypeSqr=6,o=i.CurveTypeCub=7,l=i.StatusWait=0,n=i.StatusGate=1,s=i.StatusSustain=2,t=i.StatusRelease=3,m=i.StatusEnd=4,p={set:c,lin:b,linear:b,exp:g,exponential:g,sin:d,sine:d,wel:a,welch:a,sqr:j,squared:j,cub:o,cubed:o};i.CurveTypeDict=p;var q=i.prototype;q.clone=function(){var a=new i(this.samplerate);a._table=this._table;a._initValue=this._initValue;a.setCurve(this.curve);null!==this.releaseNode&&a.setReleaseNode(this.releaseNode+
1);null!==this.loopNode&&a.setLoopNode(this.loopNode+1);a.setStep(this.step);a.reset();return a};q.setTable=function(a){this._initValue=a[0];this._table=a.slice(1);this.value=this._envValue.value=this._initValue;this._counter=this._index=0;this.status=l};q.setCurve=function(a){"number"===typeof a?(this._defaultCurveType=e,this._curveValue=a):this._defaultCurveType=p[a]||null;this.curve=a};q.setReleaseNode=function(a){"number"===typeof a&&0<a&&(this.releaseNode=a-1)};q.setLoopNode=function(a){"number"===
typeof a&&0<a&&(this.loopNode=a-1)};q.setStep=function(a){this.step=this._envValue.step=a};q.reset=function(){this.value=this._envValue.value=this._initValue;this._counter=this._index=0;this.status=l};q.release=function(){null!==this.releaseNode&&(this._counter=0,this.status=t)};q.getInfo=function(a){var e=this._table,b,d,j=0,g=Infinity,c=Infinity,l=!1;b=0;for(d=e.length;b<d;++b){this.loopNode===b&&(g=j);this.releaseNode===b&&(c=j=j<a?j+a:a);var f=e[b];Array.isArray(f)&&(j+=f[1])}Infinity!==g&&Infinity===
c&&(j+=a,l=!0);return{totalDuration:j,loopBeginTime:g,releaseBeginTime:c,isEndlessLoop:l}};q.calcStatus=function(){var a=this.status,d=this._table,j=this._index,g=this._counter,c=this._curveValue,l=this._defaultCurveType,f=this.loopNode,o=this.releaseNode,h=this._envValue,i,k,p=null;switch(a){case n:case t:for(;0>=g;)j>=d.length?a===n&&null!==f?j=f:(a=m,g=Infinity,p="ended"):a===n&&j===o?null!==f&&f<o?j=f:(a=s,g=Infinity,p="sustained"):(i=d[j++],g=i[0],k=null===i[2]?l:i[2],k===e&&(c=i[3],0.001>Math.abs(c)&&
(k=b)),i=i[1],g=h.setNext(g,i,k,c))}this.status=a;this.emit=p;this._index=j;this._counter=g;return a};q.next=function(){this.calcStatus()&1&&(this.value=this._envValue.next()||h);this._counter-=1;return this.value};q.process=function(a){var e=this._envValue,b,d=a.length;if(this.calcStatus()&1)for(b=0;b<d;++b)a[b]=e.next()||h;else{e=this.value||h;for(b=0;b<d;++b)a[b]=e}this.value=a[d-1];this._counter-=a.length};f.prototype.setNext=function(l,f,n,h){var s=this.value,i,k,m,t,p,f=0.001*f*this.samplerate/
this.step|0;1>f&&(f=1,n=c);switch(n){case c:this.value=l;break;case b:i=(l-s)/f;break;case g:i=0!==s?Math.pow(l/s,1/f):0;break;case d:h=Math.PI/f;k=0.5*(l+s);m=2*Math.cos(h);t=0.5*(l-s);p=t*Math.sin(0.5*Math.PI-h);break;case a:h=0.5*Math.PI/f;m=2*Math.cos(h);l>=s?(k=s,t=0,p=-Math.sin(h)*(l-s)):(k=l,t=s-l,p=Math.cos(h)*(s-l));break;case e:l=(l-s)/(1-Math.exp(h));k=s+l;m=l;i=Math.exp(h/f);break;case j:t=Math.sqrt(s);p=Math.sqrt(l);i=(p-t)/f;break;case o:t=Math.pow(s,0.33333333),p=Math.pow(l,0.33333333),
i=(p-t)/f}this.next=r[n];this._grow=i;this._a2=k;this._b1=m;this._y1=t;this._y2=p;return f};var r=[];r[c]=function(){return this.value};r[b]=function(){return this.value+=this._grow};r[g]=function(){return this.value*=this._grow};r[d]=function(){var a=this._b1*this._y1-this._y2;this.value=this._a2-a;this._y2=this._y1;this._y1=a;return this.value};r[a]=function(){var a=this._b1*this._y1-this._y2;this.value=this._a2+a;this._y2=this._y1;this._y1=a;return this.value};r[e]=function(){this._b1*=this._grow;
return this.value=this._a2-this._b1};r[j]=function(){this._y1+=this._grow;return this.value=this._y1*this._y1};r[o]=function(){this._y1+=this._grow;return this.value=this._y1*this._y1*this._y1};f.prototype.next=r[c];k.modules.Envelope=i;k.modules.EnvelopeValue=f})(timbre);
(function(k){function i(b){this.length=b=1<<Math.ceil(Math.log("number"===typeof b?b:512)*Math.LOG2E);this.buffer=new k.fn.SignalArray(b);this.real=new k.fn.SignalArray(b);this.imag=new k.fn.SignalArray(b);this._real=new k.fn.SignalArray(b);this._imag=new k.fn.SignalArray(b);this.mag=new k.fn.SignalArray(b>>1);this.minDecibels=-30;this.maxDecibels=-100;b=h.get(b);this._bitrev=b.bitrev;this._sintable=b.sintable;this._costable=b.costable}var f=i.prototype;f.setWindow=function(b){if("string"===typeof b){var g=
/([A-Za-z]+)(?:\(([01]\.?\d*)\))?/.exec(b);if(null!==g){var d=g[1].toLowerCase(),g=void 0!==g[2]?+g[2]:0.25;if(d=c[d]){this._window||(this._window=new k.fn.SignalArray(this.length));for(var a=this._window,e=0,j=this.length,g=0>g?0:1<g?1:g;e<j;++e)a[e]=d(e,j,g);this.windowName=b}}}};f.forward=function(b){var g=this.buffer,d=this.real,a=this.imag,e=this._window,j=this._bitrev,c=this._sintable,l=this._costable,f=g.length,h,i,k,p,q,r,v;if(e)for(h=0;h<f;++h)g[h]=b[h]*e[h];else g.set(b);for(h=0;h<f;++h)d[h]=
g[j[h]],a[h]=0;for(g=1;g<f;g=e){j=0;e=g+g;i=f/e;for(b=0;b<g;b++){k=l[j];p=c[j];for(h=b;h<f;h+=e)q=h+g,r=p*a[q]+k*d[q],v=k*a[q]-p*d[q],d[q]=d[h]-r,d[h]+=r,a[q]=a[h]-v,a[h]+=v;j+=i}}c=this.mag;for(h=0;h<f;++h)l=d[h],b=a[h],c[h]=Math.sqrt(l*l+b*b);return{real:d,imag:a}};f.inverse=function(b,g){var d=this.buffer,a=this._real,e=this._imag,j=this._bitrev,c=this._sintable,l=this._costable,f=d.length,h,i,k,p,q,r,v,w,u,x;for(h=0;h<f;++h)i=j[h],a[h]=+b[i],e[h]=-g[i];for(j=1;j<f;j=k){p=0;k=j+j;q=f/k;for(i=0;i<
j;i++){r=l[p];v=c[p];for(h=i;h<f;h+=k)w=h+j,u=v*e[w]+r*a[w],x=r*e[w]-v*a[w],a[w]=a[h]-u,a[h]+=u,e[w]=e[h]-x,e[h]+=x;p+=q}}for(h=0;h<f;++h)d[h]=a[h]/f;return d};f.getFrequencyData=function(b){var g=this.minDecibels,d,a=Math.min(this.mag.length,b.length);if(a){var e,j=this.mag,c=0;for(d=0;d<a;++d)e=j[d],b[d]=!e?g:20*Math.log(e)*Math.LOG10E,c<b[d]&&(c=b[d])}return b};var h={get:function(b){var g;if(!(g=h[b])){var d,a,e,j;g=new Int16Array(b);j=b>>1;for(d=a=0;;){g[d]=a;if(++d>=b)break;for(e=j;e<=a;)a-=
e,e>>=1;a+=e}a=Math.floor(Math.log(b)/Math.LN2);d=new k.fn.SignalArray((1<<a)-1);j=new k.fn.SignalArray((1<<a)-1);var c=2*Math.PI;a=0;for(e=d.length;a<e;++a)d[a]=Math.sin(c*(a/b)),j[a]=Math.cos(c*(a/b));g=h[b]={bitrev:g,sintable:d,costable:j}}return g}},c=function(){var b=Math.PI,g=2*Math.PI,d=Math.abs,a=Math.pow,e=Math.cos,j=Math.sin,c=Math.E;return{rectangular:function(){return 1},hann:function(a,b){return 0.5*(1-e(g*a/(b-1)))},hamming:function(a,b){return 0.54-0.46*e(g*a/(b-1))},tukery:function(a,
d,j){return a<j*(d-1)/2?0.5*(1+e(b*(2*a/(j*(d-1))-1))):(d-1)*(1-j/2)<a?0.5*(1+e(b*(2*a/(j*(d-1))-2/j+1))):1},cosine:function(a,e){return j(b*a/(e-1))},lanczos:function(a,e){return j(b*(2*a/(e-1)-1))/(b*(2*a/(e-1)-1))},triangular:function(a,e){return 2/(e+1)*((e+1)/2-d(a-(e-1)/2))},bartlett:function(a,e){return 2/(e-1)*((e-1)/2-d(a-(e-1)/2))},gaussian:function(e,b,d){return a(c,-0.5*a((e-(b-1)/2)/(d*(b-1)/2),2))},bartlettHann:function(a,b){return 0.62-0.48*d(a/(b-1)-0.5)-0.38*e(g*a/(b-1))},blackman:function(a,
d,j){var c=j/2;return(1-j)/2-0.5*e(g*a/(d-1))+c*e(4*b*a/(d-1))}}}();k.modules.FFT=i})(timbre);
(function(k){function i(b){this.samplerate=b||44100;this.wave=null;this.step=1;this.phase=this.value=this.frequency=0;this.feedback=!1;this._lastouts=this._x=0;this._coeff=f/this.samplerate;this._radtoinc=f/(2*Math.PI)}var f=1024,h=f-1,c=i.prototype;c.setWave=function(d){var a,e,j=this.wave;this.wave||(this.wave=new Float32Array(f+1));if("function"===typeof d)for(a=0;a<f;++a)j[a]=d(a/f);else if(k.fn.isSignalArray(d))if(d.length===j.length)j.set(d);else{e=d.length/f;for(a=0;a<f;++a)j[a]=d[a*e|0]}else"string"===
typeof d&&void 0!==(e=b(d))&&this.wave.set(e);this.wave[f]=this.wave[0]};c.reset=function(){this._x=0};c.next=function(){var b=this._x;this.value=this.wave[(b+this.phase*this._radtoinc|0)&h];b+=this.frequency*this._coeff*this.step;b>f&&(b-=f);this._x=b;return this.value};c.process=function(b){var a=this.wave,e=this._radtoinc,j,g=this._x,c,n,i=this.frequency*this._coeff,k,m=this.step;if(this.feedback){c=this._lastouts;e*=this.phase;for(k=0;k<m;++k)j=g+c*e,c=j|0,j-=c,c&=h,n=a[c],c=a[c+1],b[k]=c=n+j*
(c-n),g+=i;this._lastouts=c}else{e*=this.phase;for(k=0;k<m;++k)j=g+e,c=j|0,j-=c,c&=h,n=a[c],c=a[c+1],b[k]=n+j*(c-n),g+=i}g>f&&(g-=f);this._x=g;this.value=b[b.length-1]};c.processWithFreqArray=function(b,a){var e=this.wave,j=this._radtoinc,g,c=this._x,n,i,k=this._coeff,m,p=this.step;if(this.feedback){n=this._lastouts;j*=this.phase;for(m=0;m<p;++m)g=c+n*j,n=g|0,g-=n,n&=h,i=e[n],n=e[n+1],b[m]=n=i+g*(n-i),c+=a[m]*k;this._lastouts=n}else{j=this.phase*this._radtoinc;for(m=0;m<p;++m)g=c+j,n=g|0,g-=n,n&=
h,i=e[n],n=e[n+1],b[m]=i+g*(n-i),c+=a[m]*k}c>f&&(c-=f);this._x=c;this.value=b[b.length-1]};c.processWithPhaseArray=function(b,a){var e=this.wave,j=this._radtoinc,g,c=this._x,n,i,k=this.frequency*this._coeff,m,p=this.step;if(this.feedback){n=this._lastouts;j*=this.phase;for(m=0;m<p;++m)g=c+n*j,n=g|0,g-=n,n&=h,i=e[n],n=e[n+1],b[m]=n=i+g*(n-i),c+=k;this._lastouts=n}else for(m=0;m<p;++m)g=c+a[m]*j,n=g|0,g-=n,n&=h,i=e[n],n=e[n+1],b[m]=i+g*(n-i),c+=k;c>f&&(c-=f);this._x=c;this.value=b[b.length-1]};c.processWithFreqAndPhaseArray=
function(b,a,e){var j=this.wave,g=this._radtoinc,c,n=this._x,i,k,m=this._coeff,p,q=this.step;if(this.feedback){e=this._lastouts;g*=this.phase;for(p=0;p<q;++p)c=n+e*g,i=c|0,c-=i,i&=h,k=j[i],i=j[i+1],b[p]=e=k+c*(i-k),n+=a[p]*m;this._lastouts=e}else for(p=0;p<q;++p)c=n+e[p]*f,i=c|0,c-=i,i&=h,k=j[i],i=j[i+1],b[p]=k+c*(i-k),n+=a[p]*m;n>f&&(n-=f);this._x=n;this.value=b[b.length-1]};var b=function(b){var a=g[b];if(void 0!==a)return"function"===typeof a&&(a=a()),a;var e;e=/^([\-+]?)(\w+)(?:\((@[0-7])?:?(\d+)?\))?$/.exec(b);
if(null!==e){var a=e[1],j=e[3],c=e[4];e=g[e[2]];var f,n;if(void 0===e)a=void 0;else{"function"===typeof e&&(e=e());switch(j){case "@1":for(f=512;1024>f;++f)e[f]=0;break;case "@2":for(f=512;1024>f;++f)e[f]=Math.abs(e[f]);break;case "@3":for(f=256;512>f;++f)e[f]=0;for(f=512;768>f;++f)e[f]=Math.abs(e[f]);for(f=768;1024>f;++f)e[f]=0;break;case "@4":j=new Float32Array(1024);for(f=0;512>f;++f)j[f]=e[f<<1];e=j;break;case "@5":j=new Float32Array(1024);for(f=0;512>f;++f)j[f]=Math.abs(e[f<<1]);e=j}if(void 0!==
c&&50!==c){c*=0.01;c=0>c?0:1<c?1:c;j=new Float32Array(1024);c=1024*c|0;for(f=0;f<c;++f)j[f]=e[512*(f/c)|0];n=1024-c;for(c=0;1024>f;++f,++c)j[f]=e[512*(c/n)+512|0];e=j}if("+"===a)for(f=0;1024>f;++f)e[f]=0.5*e[f]+0.5;else if("-"===a)for(f=0;1024>f;++f)e[f]*=-1;a=e}if(void 0!==a)return g[b]=a}e=/^wavb\(((?:[0-9a-fA-F][0-9a-fA-F])+)\)$/.exec(b);if(null!==e){b=e[1];a=new Float32Array(1024);e=b.length>>1;if(-1!==[2,4,8,16,32,64,128,256,512,1024].indexOf(e))for(f=j=0;j<e;++j){c=parseInt(b.substr(2*j,2),
16);c=c&128?(c-256)/128:c/127;n=0;for(var h=1024/e;n<h;++n)a[f++]=c}return a}e=/^wavc\(([0-9a-fA-F]{8})\)$/.exec(b);if(null!==e){a=e[1];b=new Float32Array(1024);if(8===a.length){j=parseInt(a,16);e=new Float32Array(8);e[0]=1;for(a=0;7>a;++a)e[a+1]=0.0625*(j&15),j>>=4;for(a=0;8>a;++a){f=0;c=(a+1)/1024;for(j=0;1024>j;++j)b[j]+=Math.sin(2*Math.PI*f)*e[a],f+=c}for(a=e=0;1024>a;++a)if(e<(j=Math.abs(b[a])))e=j;if(0<e)for(a=0;1024>a;++a)b[a]/=e}return b}};i.getWavetable=b;i.setWavetable=function(b,a){var e,
j=new Float32Array(1024),c;if("function"===typeof a)for(c=0;1024>c;++c)j[c]=a(c/1024);else if(k.fn.isSignalArray(a))if(a.length===j.length)j.set(a);else{e=a.length/1024;for(c=0;1024>c;++c)j[c]=a[c*e|0]}g[b]=j};var g={sin:function(){for(var b=new Float32Array(1024),a=0;1024>a;++a)b[a]=Math.sin(2*Math.PI*(a/1024));return b},cos:function(){for(var b=new Float32Array(1024),a=0;1024>a;++a)b[a]=Math.cos(2*Math.PI*(a/1024));return b},pulse:function(){for(var b=new Float32Array(1024),a=0;1024>a;++a)b[a]=
512>a?1:-1;return b},tri:function(){for(var b=new Float32Array(1024),a,e=0;1024>e;++e)a=e/1024-0.25,b[e]=1-4*Math.abs(Math.round(a)-a);return b},saw:function(){for(var b=new Float32Array(1024),a,e=0;1024>e;++e)a=e/1024,b[e]=2*(a-Math.round(a));return b},fami:function(){for(var b=[0,0.125,0.25,0.375,0.5,0.625,0.75,0.875,0.875,0.75,0.625,0.5,0.375,0.25,0.125,0,-0.125,-0.25,-0.375,-0.5,-0.625,-0.75,-0.875,-1,-1,-0.875,-0.75,-0.625,-0.5,-0.375,-0.25,-0.125],a=new Float32Array(1024),e=0;1024>e;++e)a[e]=
b[e/1024*b.length|0];return a},konami:function(){for(var b=[-0.625,-0.875,-0.125,0.75,0.5,0.125,0.5,0.75,0.25,-0.125,0.5,0.875,0.625,0,0.25,0.375,-0.125,-0.75,0,0.625,0.125,-0.5,-0.375,-0.125,-0.75,-1,-0.625,0,-0.375,-0.875,-0.625,-0.25],a=new Float32Array(1024),e=0;1024>e;++e)a[e]=b[e/1024*b.length|0];return a}};k.modules.Oscillator=i})(timbre);
(function(k){function i(d,a){this.samplerate=d;var e,j,g=d/44100;j=2*c.length;this.comb=Array(j);this.combout=Array(j);for(e=0;e<j;++e)this.comb[e]=new f(c[e%c.length]*g),this.combout[e]=new k.fn.SignalArray(a);j=2*b.length;this.allpass=Array(j);for(e=0;e<j;++e)this.allpass[e]=new h(b[e%b.length]*g);this.outputs=[new k.fn.SignalArray(a),new k.fn.SignalArray(a)];this.damp=0;this.wet=0.33;this.setRoomSize(0.5);this.setDamp(0.5)}function f(b){this.buffer=new k.fn.SignalArray(b|0);this.buffersize=this.buffer.length;
this.damp=this.filterstore=this.feedback=this.bufidx=0}function h(b){this.buffer=new k.fn.SignalArray(b|0);this.buffersize=this.buffer.length;this.bufidx=0}var c=[1116,1188,1277,1356,1422,1491,1557,1617],b=[225,556,441,341],g=i.prototype;g.setRoomSize=function(b){var a=this.comb;this.roomsize=b;a[0].feedback=a[1].feedback=a[2].feedback=a[3].feedback=a[4].feedback=a[5].feedback=a[6].feedback=a[7].feedback=a[8].feedback=a[9].feedback=a[10].feedback=a[11].feedback=a[12].feedback=a[13].feedback=a[14].feedback=
a[15].feedback=0.28*b+0.7};g.setDamp=function(b){var a=this.comb;this.damp=b;a[0].damp=a[1].damp=a[2].damp=a[3].damp=a[4].damp=a[5].damp=a[6].damp=a[7].damp=a[8].damp=a[9].damp=a[10].damp=a[11].damp=a[12].damp=a[13].damp=a[14].damp=a[15].damp=0.4*b};g.process=function(b,a){var e=this.comb,j=this.combout,g=this.allpass,c=this.outputs[0],f=this.outputs[1],h=this.wet,i=1-h,k=b.length;e[0].process(b,j[0]);e[1].process(b,j[1]);e[2].process(b,j[2]);e[3].process(b,j[3]);e[4].process(b,j[4]);e[5].process(b,
j[5]);e[6].process(b,j[6]);e[7].process(b,j[7]);e[8].process(a,j[8]);e[9].process(a,j[9]);e[10].process(a,j[10]);e[11].process(a,j[11]);e[12].process(a,j[12]);e[13].process(a,j[13]);e[14].process(a,j[14]);e[15].process(a,j[15]);for(e=0;e<k;++e)c[e]=j[0][e]+j[1][e]+j[2][e]+j[3][e]+j[4][e]+j[5][e]+j[6][e]+j[7][e],f[e]=j[8][e]+j[9][e]+j[10][e]+j[11][e]+j[12][e]+j[13][e]+j[14][e]+j[15][e];g[0].process(c,c);g[1].process(c,c);g[2].process(c,c);g[3].process(c,c);g[4].process(f,f);g[5].process(f,f);g[6].process(f,
f);g[7].process(f,f);for(e=0;e<k;++e)b[e]=c[e]*h+b[e]*i,a[e]=f[e]*h+a[e]*i};f.prototype.process=function(b,a){var e,j,c=this.buffer,g=this.buffersize,f=this.bufidx,h=this.filterstore,i=this.feedback,k=this.damp,p=1-k,q,r=b.length;for(q=0;q<r;++q)e=0.015*b[q],j=c[f],h=j*p+h*k,c[f]=e+h*i,++f>=g&&(f=0),a[q]=j;this.bufidx=f;this.filterstore=h};h.prototype.process=function(b,a){var e,j,c,g=this.buffer,f=this.buffersize,h=this.bufidx,i,k=b.length;for(i=0;i<k;++i)e=b[i],c=g[h],j=-e+c,g[h]=e+0.5*c,++h>=f&&
(h=0),a[i]=j;this.bufidx=h};k.modules.Reverb=i})(timbre);
(function(k){function i(a){return new f(a)}function f(a){this.fragments=[];a&&this.fragments.push(new h(a,0,a.buffer[0].length/(a.samplerate||44100)))}function h(a,b,d,c,f,h,i){a||(a=g);this.buffer=a.buffer[0];this.samplerate=a.samplerate||44100;this.start=b;this._duration=d;this.reverse=c||!1;this.pitch=f||100;this.stretch=h||!1;this.pan=i||50}function c(a,b){this.tape=a;this.fragments=a.fragments;this.samplerate=b||44100;this.isEnded=!1;this.buffer=null;this.bufferEndIndex=this.bufferBeginIndex=
this.bufferIndexIncr=this.bufferIndex=0;this.fragment=null;this.fragmentIndex=0;this.panR=this.panL=0.7071067811865475}var b=new Float32Array(60),g={buffer:b,samplerate:1};i.silence=function(a){return(new i(g)).slice(0,1).fill(a)};i.join=function(a){for(var b=new f,d=0;d<a.length;d++)a[d]instanceof f&&b.add_fragments(a[d].fragments);return b};i.Tape=f;f.prototype.add_fragment=function(a){this.fragments.push(a);return this};f.prototype.add_fragments=function(a){for(var b=0;b<a.length;b++)this.fragments.push(a[b]);
return this};f.prototype.duration=function(){for(var a=0,b=0;b<this.fragments.length;b++)a+=this.fragments[b].duration();return a};f.prototype.slice=function(a,b){var d=this.duration();a+b>d&&(b=d-a);for(var d=new f,c=a,g=b,h=0;h<this.fragments.length;h++){var g=this.fragments[h].create(c,g),i=g[0],c=g[1],g=g[2];i&&d.add_fragment(i);if(0===g)break}return d};f.prototype.cut=f.prototype.slice;f.prototype.concat=function(a){var b=new f;b.add_fragments(this.fragments);b.add_fragments(a.fragments);return b};
f.prototype.loop=function(a){var b,d=[];for(b=0;b<this.fragments.length;b++)d.push(this.fragments[b].clone());var g=new f;for(b=0;b<a;b++)g.add_fragments(d);return g};f.prototype.times=f.prototype.loop;f.prototype.split=function(a){for(var b=this.duration()/a,d=[],g=0;g<a;g++)d.push(this.slice(g*b,b));return d};f.prototype.fill=function(a){var b=this.duration();if(0===b)throw"EmptyFragment";var d=a%b;return this.loop(a/b|0).plus(this.slice(0,d))};f.prototype.replace=function(a,b,d){var g=new f,b=
a+b,g=g.plus(this.slice(0,a)),c=g.duration();c<a&&(g=g.plus(i.silence(a-c)));g=g.plus(d);a=this.duration();a>b&&(g=g.plus(this.slice(b,a-b)));return g};f.prototype.reverse=function(){for(var a=new f,b=this.fragments.length;b--;){var d=this.fragments[b].clone();d.reverse=!d.isReversed();a.add_fragment(d)}return a};f.prototype.pitch=function(a,b){for(var d=new f,b=b||!1,g=0;g<this.fragments.length;g++){var c=this.fragments[g].clone();c.pitch*=0.01*a;c.stretch=b;d.add_fragment(c)}return d};f.prototype.stretch=
function(a){return this.pitch(100*(1/(0.01*a)),!0)};f.prototype.pan=function(a){var b=new f;100<a?a=100:0>a&&(a=0);for(var d=0;d<this.fragments.length;d++){var g=this.fragments[d].clone();g.pan=a;b.add_fragment(g)}return b};f.prototype.silence=function(){return i.silence(this.duration())};f.prototype.join=function(a){for(var b=new f,d=0;d<a.length;d++)a[d]instanceof f&&b.add_fragments(a[d].fragments);return b};h.prototype.duration=function(){return this._duration*(100/this.pitch)};h.prototype.original_duration=
function(){return this._duration};h.prototype.isReversed=function(){return this.reverse};h.prototype.isStretched=function(){return this.stretched};h.prototype.create=function(a,b){var d=this.duration();if(a>=d)return[null,a-d,b];a+b>=d?(d-=a,b-=d):(d=b,b=0);var g=this.clone();g.start=this.start+0.01*a*this.pitch;g._duration=0.01*d*this.pitch;g.reverse=!1;return[g,0,b]};h.prototype.clone=function(){var a=new h;a.buffer=this.buffer;a.samplerate=this.samplerate;a.start=this.start;a._duration=this._duration;
a.reverse=this.reverse;a.pitch=this.pitch;a.stretch=this.stretch;a.pan=this.pan;return a};i.Fragment=h;var d=function(){for(var a=new Float32Array(257),b=0;256>b;++b)a[b]=Math.sin(0.5*Math.PI*(b/256));a[256]=1;return a}(),a=function(){for(var a=new Float32Array(257),b=0;256>b;++b)a[b]=Math.cos(0.5*Math.PI*(b/256));a[256]=0;return a}();i.TapeStream=c;c.prototype.reset=function(){this.isEnded=!1;this.buffer=null;this.bufferEndIndex=this.bufferBeginIndex=this.bufferIndexIncr=this.bufferIndex=0;this.fragment=
null;this.fragmentIndex=0;this.panR=this.panL=0.7071067811865475;this.isLooped=!1;return this};c.prototype.fetch=function(e){var g=new k.fn.SignalArray(e),c=new k.fn.SignalArray(e),f=this.fragments;if(0===f.length)return[g,c];for(var n=100*this.samplerate,h=this.buffer,i=this.bufferIndex,m=this.bufferIndexIncr,p=this.bufferBeginIndex,q=this.bufferEndIndex,r=this.fragment,v=this.fragmentIndex,w=this.panL,u=this.panR,x=0;x<e;x++){for(;!h||i<p||i>=q;)if(!r||v<f.length)r=f[v++],h=r.buffer,m=r.samplerate/
n*r.pitch,p=r.start*r.samplerate,q=p+r.original_duration()*r.samplerate,i=256*(r.pan/100)|0,w=a[i],u=d[i],r.reverse?(m*=-1,i=q+m):i=p;else if(this.isLooped)h=null,q=p=m=i=0,r=null,v=0;else{this.isEnded=!0;h=b;i=m=0;break}g[x]=h[i|0]*w;c[x]=h[i|0]*u;i+=m}this.buffer=h;this.bufferIndex=i;this.bufferIndexIncr=m;this.bufferBeginIndex=p;this.bufferEndIndex=q;this.fragment=r;this.fragmentIndex=v;this.panL=w;this.panR=u;return[g,c]};k.modules.Scissor=i})(timbre);
(function(k){function i(f){this.samplerate=f;this.buffersize=1<<Math.ceil(Math.log(1.5*f)*Math.LOG2E);this.buffermask=this.buffersize-1;this.writeBufferL=new k.fn.SignalArray(this.buffersize);this.writeBufferR=new k.fn.SignalArray(this.buffersize);this.readBufferL=this.writeBufferL;this.readBufferR=this.writeBufferR;this.mix=this.cross=this.feedback=this.delaytime=null;this.writeIndex=this.readIndex=this.prevR=this.prevL=0;this.setParams(125,0.25,!1,0.45)}var f=i.prototype;f.setParams=function(f,
c,b,g){this.delaytime!==f&&(this.delaytime=f,f=0.001*f*this.samplerate|0,f>this.buffermask&&(f=this.buffermask),this.writeIndex=this.readIndex+f&this.buffermask);this.feedback!==c&&(this.feedback=c);this.cross!==b&&((this.cross=b)?(this.readBufferL=this.writeBufferR,this.readBufferR=this.writeBufferL):(this.readBufferL=this.writeBufferL,this.readBufferR=this.writeBufferR));this.mix!==g&&(this.mix=g)};f.process=function(f,c){var b=this.readBufferL,g=this.readBufferR,d=this.writeBufferL,a=this.writeBufferR,
e=this.readIndex,j=this.writeIndex,o=this.buffermask,l=this.feedback,n=this.mix,i=1-n,k=this.prevL,m=this.prevR,p,q,r=f.length;for(q=0;q<r;++q)p=b[e],d[j]=f[q]-p*l,f[q]=k=0.5*(f[q]*i+p*n+k),p=g[e],a[j]=c[q]-p*l,c[q]=m=0.5*(c[q]*i+p*n+m),e+=1,j=j+1&o;this.readIndex=e&this.buffermask;this.writeIndex=j;this.prevL=k;this.prevR=m};k.modules.StereoDelay=i})(timbre);
(function(k){var i=k.fn,f=k.modules;i.register("audio",function(b){b=new (i.getClass("buffer"))(b);b.playbackState=i.FINISHED_STATE;b._.isLoaded=!1;Object.defineProperties(b,{isLoaded:{get:function(){return this._.isLoaded}}});b.load=h;b.loadthis=c;return b});var h=function(b){var g=this,d=this._,a=new f.Deferred(this),e=arguments,c=1;a.done(function(){g._.emit("done")});"function"===typeof e[c]&&(a.done(e[c++]),"function"===typeof e[c]&&a.fail(e[c++]));d.loadedTime=0;(new f.Decoder).decode(b,function(e,
b){var d=g._;if(e){g.playbackState=i.PLAYING_STATE;d.samplerate=e.samplerate;d.channels=e.channels;d.bufferMix=null;d.buffer=e.buffer;d.phase=0;d.phaseIncr=e.samplerate/k.samplerate;d.duration=e.duration*1E3;d.currentTime=0;if(d.isReversed){d.phaseIncr=d.phaseIncr*-1;d.phase=e.buffer[0].length+d.phaseIncr}g._.emit("loadedmetadata")}else a.reject(b)},function(){g._.isLoaded=true;g._.plotFlush=true;g._.emit("loadeddata");a.resolveWith(g)});return a.promise()},c=function(){h.apply(this,arguments);return this}})(timbre);
(function(k){function i(a){k.Object.call(this,2,a);f.fixAR(this);a=this._;a.biquad=new c(a.samplerate);a.freq=k(340);a.band=k(1);a.gain=k(0);a.plotBefore=b;a.plotRange=[-18,18];a.plotFlush=!0}var f=k.fn,h=k.modules.FFT,c=k.modules.Biquad;f.extend(i);var b=function(a,b,d,g,c){a.lineWidth=1;a.strokeStyle="rgb(192, 192, 192)";for(var f=0.5*this._.samplerate,h=1;10>=h;++h)for(var i=1;4>=i;i++){var k=h*Math.pow(10,i);20>=k||f<=k||(a.beginPath(),k=Math.log(k/20)/Math.log(f/20),k=(k*g+b|0)+0.5,a.moveTo(k,
d),a.lineTo(k,d+c),a.stroke())}c/=6;for(h=1;6>h;h++)a.beginPath(),f=(d+h*c|0)+0.5,a.moveTo(b,f),a.lineTo(b+g,f),a.stroke()},g=i.prototype;Object.defineProperties(g,{type:{set:function(a){var b=this._;a!==b.biquad.type&&(b.biquad.setType(a),b.plotFlush=!0)},get:function(){return this._.biquad.type}},freq:{set:function(a){this._.freq=k(a)},get:function(){return this._.freq}},cutoff:{set:function(a){this._.freq=k(a)},get:function(){return this._.freq}},res:{set:function(a){this._.band=k(a)},get:function(){return this._.band}},
Q:{set:function(a){this._.band=k(a)},get:function(){return this._.band}},band:{set:function(a){this._.band=k(a)},get:function(){return this._.band}},gain:{set:function(a){this._.gain=k(a)},get:function(){return this._.gain}}});g.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;f.inputSignalAR(this);var d=b.freq.process(a).cells[0][0],g=b.band.process(a).cells[0][0],a=b.gain.process(a).cells[0][0];if(b.prevFreq!==d||b.prevband!==g||b.prevGain!==a)b.prevFreq=d,b.prevband=g,b.prevGain=
a,b.biquad.setParams(d,g,a),b.plotFlush=!0;b.bypassed||b.biquad.process(this.cells[1],this.cells[2]);f.outputSignalAR(this)}return this};var d=new h(2048),a=k.Object.prototype.plot;g.plot=function(e){if(this._.plotFlush){var b=new c(this._.samplerate);b.setType(this.type);b.setParams(this.freq.valueOf(),this.band.valueOf(),this.gain.valueOf());var g=new Float32Array(d.length);g[0]=1;b.process(g,g);d.forward(g);var b=new Float32Array(512),g=0.5*this._.samplerate,f=new Float32Array(512),h,i,k,m;d.getFrequencyData(f);
for(h=0;512>h;++h)k=20*Math.pow(g/20,h/512),i=k/(g/f.length),k=i|0,i-=k,0===k?k=f[k]:(m=f[k-1],k=f[k],k=(1-i)*m+i*k),b[h]=k;this._.plotData=b;this._.plotFlush=null}return a.call(this,e)};f.register("biquad",i);f.register("lowpass",function(a){return(new i(a)).set("type","lowpass")});f.register("highpass",function(a){return(new i(a)).set("type","highpass")});f.register("bandpass",function(a){return(new i(a)).set("type","bandpass")});f.register("lowshelf",function(a){return(new i(a)).set("type","lowshelf")});
f.register("highshelf",function(a){return(new i(a)).set("type","highshelf")});f.register("peaking",function(a){return(new i(a)).set("type","peaking")});f.register("notch",function(a){return(new i(a)).set("type","notch")});f.register("allpass",function(a){return(new i(a)).set("type","allpass")});f.alias("lpf","lowpass");f.alias("hpf","highpass");f.alias("bpf","bandpass");f.alias("bef","notch");f.alias("brf","notch");f.alias("apf","allpass")})(timbre);
(function(k){function i(a){k.Object.call(this,1,a);f.fixAR(this);a=this._;a.pitch=k(1);a.samplerate=44100;a.channels=0;a.bufferMix=null;a.buffer=[];a.isLooped=!1;a.isReversed=!1;a.duration=0;a.currentTime=0;a.currentTimeObj=null;a.phase=0;a.phaseIncr=0;a.onended=f.make_onended(this,0);a.onlooped=c(this)}var f=k.fn,h=f.isSignalArray;f.extend(i);var c=function(a){return function(){var e=a._;e.phase>=e.buffer[0].length?e.phase=0:0>e.phase&&(e.phase=e.buffer[0].length+e.phaseIncr);a._.emit("looped")}},
b=i.prototype,g=function(a){var e=this._;if("object"===typeof a){var b=[],d;h(a)?b[0]=a:"object"===typeof a&&(Array.isArray(a.buffer)?h(a.buffer[0])&&(b=h(a.buffer[1])&&h(a.buffer[2])?a.buffer:[a.buffer[0]]):h(a.buffer)&&(b=[a.buffer]),"number"===typeof a.samplerate&&(d=a.samplerate));b.length&&(0<d&&(e.samplerate=a.samplerate),e.bufferMix=null,e.buffer=b,e.phase=0,e.phaseIncr=e.samplerate/k.samplerate,e.duration=1E3*e.buffer[0].length/e.samplerate,e.currentTime=0,e.plotFlush=!0,this.reverse(e.isReversed))}};
Object.defineProperties(b,{buffer:{set:g,get:function(){var a=this._;return{samplerate:a.samplerate,channels:a.channels,buffer:a.buffer}}},pitch:{set:function(a){this._.pitch=k(a)},get:function(){return this._.pitch}},isLooped:{get:function(){return this._.isLooped}},isReversed:{get:function(){return this._.isReversed}},samplerate:{get:function(){return this._.samplerate}},duration:{get:function(){return this._.duration}},currentTime:{set:function(a){if("number"===typeof a){var b=this._;0<=a&&a<=
b.duration&&(b.phase=a/1E3*b.samplerate,b.currentTime=a)}else a instanceof k.Object?this._.currentTimeObj=a:null===a&&(this._.currentTimeObj=null)},get:function(){return this._.currentTimeObj?this._.currentTimeObj:this._.currentTime}}});b.clone=function(){var a=this._,b=k("buffer");a.buffer.length&&g.call(b,{buffer:a.buffer,samplerate:a.samplerate,channels:a.channels});b.loop(a.isLooped);b.reverse(a.isReversed);return b};b.slice=function(a,b){var d=this._,c=k(d.originkey);if(d.buffer.length){a="number"===
typeof a?0.001*a*d.samplerate|0:0;b="number"===typeof b?0.001*b*d.samplerate|0:d.buffer[0].length;if(a>b)var l=a,a=b,b=l;2===d.channels?g.call(c,{buffer:[f.pointer(d.buffer[0],a,b-a),f.pointer(d.buffer[1],a,b-a),f.pointer(d.buffer[2],a,b-a)],samplerate:d.samplerate}):g.call(c,{buffer:f.pointer(d.buffer[0],a,b-a),samplerate:d.samplerate});c.playbackState=f.PLAYING_STATE}c.loop(d.isLooped);c.reverse(d.isReversed);return c};b.reverse=function(a){var b=this._;b.isReversed=!!a;if(b.isReversed){if(0<b.phaseIncr&&
(b.phaseIncr*=-1),0===b.phase&&b.buffer.length)b.phase=b.buffer[0].length+b.phaseIncr}else 0>b.phaseIncr&&(b.phaseIncr*=-1);return this};b.loop=function(a){this._.isLooped=!!a;return this};b.bang=function(a){this.playbackState=!1===a?f.FINISHED_STATE:f.PLAYING_STATE;this._.phase=0;this._.emit("bang");return this};b.process=function(a){var b=this._;if(!b.buffer.length)return this;if(this.tickID!==a){this.tickID=a;var d=this.cells[1],g=this.cells[2],c=b.phase,h=b.cellsize,i,k;2===b.channels?(i=b.buffer[1],
k=b.buffer[2]):i=k=b.buffer[0];if(b.currentTimeObj){for(var m=b.currentTimeObj.process(a).cells[0],p,q=0.001*b.samplerate,a=0;a<h;++a)p=m[a],c=p*q,d[a]=i[c|0]||0,g[a]=k[c|0]||0;b.phase=c;b.currentTime=p}else{a=b.pitch.process(a).cells[0][0];p=b.phaseIncr*a;for(a=0;a<h;++a)d[a]=i[c|0]||0,g[a]=k[c|0]||0,c+=p;c>=i.length?b.isLooped?f.nextTick(b.onlooped):f.nextTick(b.onended):0>c&&(b.isLooped?f.nextTick(b.onlooped):f.nextTick(b.onended));b.phase=c;b.currentTime+=f.currentTimeIncr}f.outputSignalAR(this)}return this};
var d=k.Object.prototype.plot;b.plot=function(a){var b=this._,g,c;if(b.plotFlush){2===b.channels?(g=b.buffer[1],c=b.buffer[2]):g=c=b.buffer[0];for(var f=new Float32Array(2048),h=0,i=g.length/2048,k=0;2048>k;k++)f[k]=0.5*(g[h|0]+c[h|0]),h+=i;b.plotData=f;b.plotFlush=null}return d.call(this,a)};f.register("buffer",i)})(timbre);
(function(k){function i(b){k.Object.call(this,2,b);f.fixAR(this);b=new h(this._.samplerate);b.setDelayTime(20);b.setRate(4);b.depth=20;b.feedback=0.2;b.mix=0.33;this._.chorus=b}var f=k.fn,h=k.modules.Chorus;f.extend(i);var c=i.prototype;Object.defineProperties(c,{type:{set:function(b){this._.chorus.setDelayTime(b)},get:function(){return this._.chorus.wave}},delay:{set:function(b){0.5<=b&&80>=b&&this._.chorus.setDelayTime(b)},get:function(){return this._.chorus.delayTime}},rate:{set:function(b){"number"===
typeof b&&0<b&&this._.chorus.setRate(b)},get:function(){return this._.chorus.rate}},depth:{set:function(b){"number"===typeof b&&(0<=b&&100>=b)&&(b*=this._.samplerate/44100,this._.chorus.depth=b)},get:function(){return this._.chorus.depth}},fb:{set:function(b){"number"===typeof b&&(-1<=b&&1>=b)&&(this._.chorus.feedback=0.99996*b)},get:function(){return this._.chorus.feedback}},mix:{set:function(b){this._.mix=k(b)},get:function(){return this._.mix}}});c.process=function(b){var g=this._;this.tickID!==
b&&(this.tickID=b,f.inputSignalAR(this),g.bypassed||g.chorus.process(this.cells[1],this.cells[2]),f.outputSignalAR(this));return this};f.register("chorus",i)})(timbre);
(function(k){function i(c){k.Object.call(this,2,c);c=this._;c.min=-0.8;c.max=0.8}var f=k.fn;f.extend(i);var h=i.prototype;Object.defineProperties(h,{minmax:{set:function(c){var b=this._;"number"===typeof c&&(b.min=-Math.abs(c),b.max=-b.min)},get:function(){return this._.max}},min:{set:function(c){var b=this._;"number"===typeof c&&(b.max<c?b.max=c:b.min=c)},get:function(){return this._.min}},max:{set:function(c){var b=this._;"number"===typeof c&&(c<b.min?b.min=c:b.max=c)},get:function(){return this._.max}}});
h.process=function(c){var b=this._;if(this.tickID!==c){this.tickID=c;var c=this.cells[1],g=this.cells[2],d=c.length,a=b.min,e=b.max,j;if(b.ar){f.inputSignalAR(this);for(b=0;b<d;++b)j=c[b],j<a?j=a:j>e&&(j=e),c[b]=j,j=g[b],j<a?j=a:j>e&&(j=e),g[b]=j;f.outputSignalAR(this)}else j=f.inputSignalKR(this),j<a?j=a:j>e&&(j=e),this.cells[0][0]=j,f.outputSignalKR(this)}return this};f.register("clip",i)})(timbre);
(function(k){function i(b){k.Object.call(this,2,b);f.fixAR(this);b=this._;b.prevThresh=-24;b.prevKnee=0;b.prevRatio=12;b.thresh=k(b.prevThresh);b.knee=0;b.ratio=k(b.prevRatio);b.comp=new h(b.samplerate);b.comp.setParams(b.prevThresh,b.prevKnee,b.prevRatio)}var f=k.fn,h=k.modules.Compressor;f.extend(i);var c=i.prototype;Object.defineProperties(c,{thresh:{set:function(b){this._.thresh=k(b)},get:function(){return this._.thresh}},knee:{set:function(b){this._.kne=k(b)},get:function(){return this._.knee}},
ratio:{set:function(b){this._.ratio=k(b)},get:function(){return this._.ratio}}});c.process=function(b){var g=this._;if(this.tickID!==b){this.tickID=b;f.inputSignalAR(this);var d=g.thresh.process(b).cells[0][0],b=g.ratio.process(b).cells[0][0];if(g.prevThresh!==d||0!==g.prevKnee||g.prevRatio!==b)g.prevThresh=d,g.prevKnee=0,g.prevRatio=b,g.comp.setParams(d,0,b);g.bypassed||g.comp.process(this.cells[1],this.cells[2]);f.outputSignalAR(this)}return this};f.register("comp",i)})(timbre);
(function(k){function i(b){k.Object.call(this,2,b);f.fixAR(this);b=this._;b.time=k(100);b.fb=k(0.2);b.cross=k(!1);b.mix=0.33;b.delay=new c(b.samplerate)}var f=k.fn,h=k.timevalue,c=k.modules.StereoDelay;f.extend(i);var b=i.prototype;Object.defineProperties(b,{time:{set:function(b){"string"===typeof b&&(b=h(b));this._.time=k(b)},get:function(){return this._.time}},fb:{set:function(b){this._.fb=k(b)},get:function(){return this._.fb}},cross:{set:function(b){this._.cross=k(b)},get:function(){return this._.cross}},
mix:{set:function(b){"number"===typeof b&&(this._.mix=1<b?1:0>b?0:b)},get:function(){return this._.mix}}});b.process=function(b){var d=this._;if(this.tickID!==b){this.tickID=b;var a=d.time.process(b).cells[0][0],e=d.fb.process(b).cells[0][0],b=0!==d.cross.process(b).cells[0][0],c=d.mix;if(d.prevTime!==a||d.prevFb!==e||d.prevCross!==b||d.prevMix!==c)d.prevTime=a,d.prevFb=e,d.prevCross=b,d.prevMix=c,d.delay.setParams(a,e,b,c);f.inputSignalAR(this);d.bypassed||d.delay.process(this.cells[1],this.cells[2]);
f.outputSignalAR(this)}return this};f.register("delay",i)})(timbre);
(function(k){function i(c){k.Object.call(this,2,c);f.fixAR(this);c=this._;c.pre=k(60);c.post=k(-18);c.x1L=c.x2L=c.y1L=c.y2L=0;c.x1R=c.x2R=c.y1R=c.y2R=0;c.b0=c.b1=c.b2=c.a1=c.a2=0;c.cutoff=0;c.Q=1;c.preScale=0;c.postScale=0}var f=k.fn;f.extend(i);var h=i.prototype;Object.defineProperties(h,{cutoff:{set:function(c){"number"===typeof c&&0<c&&(this._.cutoff=c)},get:function(){return this._.cutoff}},pre:{set:function(c){this._.pre=k(c)},get:function(){return this._.pre}},post:{set:function(c){this._.post=
k(c)},get:function(){return this._.post}}});h.process=function(c){var b=this._;if(this.tickID!==c){this.tickID=c;f.inputSignalAR(this);var g=-b.pre.process(c).cells[0][0],c=-b.post.process(c).cells[0][0];if(b.prevPreGain!==g||b.prevPostGain!==c)b.prevPreGain=g,b.prevPostGain=c,b.preScale=Math.pow(10,0.05*-g),b.postScale=Math.pow(10,0.05*-c);if(!b.bypassed){var g=this.cells[1],c=this.cells[2],d=b.preScale,a=b.postScale,e,j,h,l,n;if(b.cutoff){b.prevCutoff!==b.cutoff&&(b.prevCutoff=b.cutoff,j=2*Math.PI*
b.cutoff/b.samplerate,e=Math.cos(j),j=Math.sin(j)/(2*b.Q),h=1/(1+j),b.b0=0.5*(1-e)*h,b.b1=1-e*h,b.b2=0.5*(1-e)*h,b.a1=-2*e*h,b.a2=1-j*h);var i=b.x1L,k=b.x2L,m=b.y1L,p=b.y2L,q=b.x1R,r=b.x2R,v=b.y1R,w=b.y2R,u=b.b0,x=b.b1,y=b.b2,z=b.a1,C=b.a2;e=0;for(j=g.length;e<j;++e)l=g[e]*d,n=u*l+x*i+y*k-z*m-C*p,h=n*a,-1>h?h=-1:1<h&&(h=1),g[e]=h,k=i,i=l,p=m,m=n,l=c[e]*d,n=u*l+x*q+y*r-z*v-C*w,h=n*a,-1>h?h=-1:1<h&&(h=1),c[e]=h,r=q,q=l,w=v,v=n;b.x1L=i;b.x2L=k;b.y1L=m;b.y2L=p;b.x1R=q;b.x2R=r;b.y1R=v;b.y2R=w}else{e=0;
for(j=g.length;e<j;++e)h=g[e]*d*a,-1>h?h=-1:1<h&&(h=1),g[e]=h,h=c[e]*d*a,-1>h?h=-1:1<h&&(h=1),c[e]=h}}f.outputSignalAR(this)}return this};f.register("dist",i)})(timbre);
(function(k){function i(f){k.Object.call(this,2,f);this._.ar=!1}var f=k.fn;f.extend(i);i.prototype.process=function(h){var c=this._;if(this.tickID!==h){this.tickID=h;var b=this.nodes,g=this.cells[0],d=this.cells[1],a=this.cells[2],e,j=b.length,i=g.length,l,n;if(c.ar){if(0<b.length){b[0].process(h);l=b[0].cells[1];n=b[0].cells[2];d.set(l);a.set(n);for(e=1;e<j;++e){b[e].process(h);l=b[e].cells[1];n=b[e].cells[2];for(g=0;g<i;++g)c=l[g],d[g]=0===c?0:d[g]/c,c=n[g],a[g]=0===c?0:a[g]/c}}else for(g=0;g<i;++g)d[g]=
a[e]=0;f.outputSignalAR(this)}else{if(0<b.length){d=b[0].process(h).cells[0][0];for(e=1;e<j;++e)c=b[e].process(h).cells[0][0],d=0===c?0:d/c}else d=0;g[0]=d;f.outputSignalKR(this)}}return this};f.register("/",i)})(timbre);
(function(k){function i(e){k.Object.call(this,2,e);e=this._;e.env=new b(e.samplerate);e.env.setStep(e.cellsize);e.tmp=new h.SignalArray(e.cellsize);e.ar=!1;e.plotFlush=!0;e.onended=a(this);this.on("ar",d)}function f(a,b,e,d,c,g){"number"===typeof a[d]?e=a[d]:"number"===typeof a[c]?e=a[c]:g&&("string"===typeof a[d]?e=g(a[d]):"string"===typeof a[c]&&(e=g(a[c])));e<b&&(e=b);return e}var h=k.fn,c=k.timevalue,b=k.modules.Envelope,g=h.isDictionary;h.extend(i);var d=function(a){this._.env.setStep(a?1:this._.cellsize)},
a=function(a){return function(){a._.emit("ended")}},e=i.prototype;Object.defineProperties(e,{table:{set:function(a){if(Array.isArray(a)){for(var e=this._.env,d=[a[0]||o],g,f,j,h,i=1,k=a.length;i<k;++i)g=a[i][0]||o,f=a[i][1],j=a[i][2],"number"!==typeof f&&(f="string"===typeof f?c(f):10),10>f&&(f=10),"number"===typeof j?(h=j,j=b.CurveTypeCurve):(j=b.CurveTypeDict[j]||null,h=0),d.push([g,f,j,h]);e.setTable(d);this._.plotFlush=!0}},get:function(){return this._.env.table}},curve:{set:function(a){this._.env.setCurve(a)},
get:function(){return this._.env.curve}},releaseNode:{set:function(a){this._.env.setReleaseNode(a);this._.plotFlush=!0},get:function(){return this._.env.releaseNode+1}},loopNode:{set:function(a){this._.env.setLoopNode(a);this._.plotFlush=!0},get:function(){return this._.env.loopNode+1}}});e.clone=function(){var a=new i([]);a._.env=this._.env.clone();a._.ar=this._.ar;return a};e.reset=function(){this._.env.reset();return this};e.release=function(){var a=this._;a.env.release();a.emit("released");return this};
e.bang=function(){var a=this._;a.env.reset();a.env.status=b.StatusGate;a.emit("bang");return this};e.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;var a=this.cells[1],e=this.cells[2],d,c=b.cellsize;if(this.nodes.length)h.inputSignalAR(this);else for(d=0;d<c;++d)a[d]=e[d]=1;var g;d=null;if(b.ar){g=b.tmp;b.env.process(g);for(d=0;d<c;++d)a[d]*=g[d],e[d]*=g[d]}else{g=b.env.next();for(d=0;d<c;++d)a[d]*=g,e[d]*=g}d=b.env.emit;h.outputSignalAR(this);d&&("ended"===d?h.nextTick(b.onended):
this._.emit(d,b.value))}return this};var j=k.Object.prototype.plot;e.plot=function(a){if(this._.plotFlush){var e=this._.env.clone(),d=e.getInfo(1E3),c=d.totalDuration,g=d.loopBeginTime,f=d.releaseBeginTime,d=new Float32Array(256),h=0,i=c/d.length,k=!1,o=0.001*c*this._.samplerate|0,u,o=o/d.length;e.setStep(o);e.status=b.StatusGate;o=0;for(u=d.length;o<u;++o)d[o]=e.next(),h+=i,!k&&h>=f&&(e.release(),k=!0);this._.plotData=d;this._.plotBefore=function(a,b,e,d,j){var h;Infinity!==g&&Infinity!==f&&(e=b+
d*(g/c),h=b+d*(f/c),a.fillStyle="rgba(224, 224, 224, 0.8)",a.fillRect(e,0,h-e,j));Infinity!==f&&(e=b+d*(f/c),a.fillStyle="rgba(212, 212, 212, 0.8)",a.fillRect(e,0,d-e,j))};e=Infinity;h=-Infinity;for(o=0;o<u;++o)d[o]<e?e=d[o]:d[o]>h&&(h=d[o]);1>h&&(h=1);this._.plotRange=[e,h];this._.plotData=d;this._.plotFlush=null}return j.call(this,a)};h.register("env",i);var o=b.ZERO;h.register("perc",function(a){g(a[0])||a.unshift({});var b=a[0],e=f(b,10,10,"a","attackTime",c),d=f(b,10,1E3,"r","decayTime",c),j=
f(b,o,1,"lv","level");b.table=[o,[j,e],[o,d]];return new i(a)});h.register("adsr",function(a){g(a[0])||a.unshift({});var b=a[0],e=f(b,10,10,"a","attackTime",c),d=f(b,10,300,"d","decayTime",c),j=f(b,o,0.5,"s","sustainLevel"),h=f(b,10,1E3,"r","decayTime",c),k=f(b,o,1,"lv","level");b.table=[o,[k,e],[j,d],[o,h]];b.releaseNode=3;return new i(a)});h.register("adshr",function(a){g(a[0])||a.unshift({});var b=a[0],e=f(b,10,10,"a","attackTime",c),d=f(b,10,300,"d","decayTime",c),j=f(b,o,0.5,"s","sustainLevel"),
h=f(b,10,500,"h","holdTime",c),k=f(b,10,1E3,"r","decayTime",c),r=f(b,o,1,"lv","level");b.table=[o,[r,e],[j,d],[j,h],[o,k]];return new i(a)});h.register("asr",function(a){g(a[0])||a.unshift({});var b=a[0],e=f(b,10,10,"a","attackTime",c),d=f(b,o,0.5,"s","sustainLevel"),j=f(b,10,1E3,"r","releaseTime",c);b.table=[o,[d,e],[o,j]];b.releaseNode=2;return new i(a)});h.register("dadsr",function(a){g(a[0])||a.unshift({});var b=a[0],e=f(b,10,100,"dl","delayTime",c),d=f(b,10,10,"a","attackTime",c),j=f(b,10,300,
"d","decayTime",c),h=f(b,o,0.5,"s","sustainLevel"),k=f(b,10,1E3,"r","relaseTime",c),r=f(b,o,1,"lv","level");b.table=[o,[o,e],[r,d],[h,j],[o,k]];b.releaseNode=4;return new i(a)});h.register("ahdsfr",function(a){g(a[0])||a.unshift({});var b=a[0],e=f(b,10,10,"a","attackTime",c),d=f(b,10,10,"h","holdTime",c),j=f(b,10,300,"d","decayTime",c),h=f(b,o,0.5,"s","sustainLevel"),k=f(b,10,5E3,"f","fadeTime",c),r=f(b,10,1E3,"r","relaseTime",c),v=f(b,o,1,"lv","level");b.table=[o,[v,e],[v,d],[h,j],[o,k],[o,r]];b.releaseNode=
5;return new i(a)});h.register("linen",function(a){g(a[0])||a.unshift({});var b=a[0],e=f(b,10,10,"a","attackTime",c),d=f(b,10,1E3,"s","sustainTime",c),j=f(b,10,1E3,"r","releaseTime",c),h=f(b,o,1,"lv","level");b.table=[o,[h,e],[h,d],[o,j]];return new i(a)});h.register("env.tri",function(a){g(a[0])||a.unshift({});var b=a[0],e=f(b,20,1E3,"dur","duration",c),d=f(b,o,1,"lv","level"),e=0.5*e;b.table=[o,[d,e],[o,e]];return new i(a)});h.register("env.cutoff",function(a){g(a[0])||a.unshift({});var b=a[0],
e=f(b,10,100,"r","relaseTime",c),d=f(b,o,1,"lv","level");b.table=[d,[o,e]];return new i(a)})})(timbre);
(function(k){function i(a){k.Object.call(this,2,a);f.fixAR(this);a=this._;a.biquads=Array(7);a.plotBefore=g;a.plotRange=[-18,18];a.plotFlush=!0}var f=k.fn,h=k.modules.FFT,c=k.modules.Biquad,b={hpf:0,lf:1,lmf:2,mf:3,hmf:4,hf:5,lpf:6};f.extend(i);var g=function(a,b,e,d,c){a.lineWidth=1;a.strokeStyle="rgb(192, 192, 192)";for(var g=0.5*this._.samplerate,f=1;10>=f;++f)for(var h=1;4>=h;h++){var i=f*Math.pow(10,h);20>=i||g<=i||(a.beginPath(),i=Math.log(i/20)/Math.log(g/20),i=(i*d+b|0)+0.5,a.moveTo(i,e),
a.lineTo(i,e+c),a.stroke())}c/=6;for(f=1;6>f;f++)a.beginPath(),g=(e+f*c|0)+0.5,a.moveTo(b,g),a.lineTo(b+d,g),a.stroke()},d=i.prototype;Object.defineProperties(d,{params:{set:function(a){if("object"===typeof a)for(var b=Object.keys(a),e=0,d=b.length;e<d;++e){var c=a[b[e]];Array.isArray(c)?this.setParams(b[e],c[0],c[1],c[2]):this.setParams(b[e])}}}});d.setParams=function(a,e,d,g){var f=this._;"string"===typeof a&&(a=b[a]);if(0<=a&&a<f.biquads.length){a|=0;if("number"===typeof e&&"number"===typeof d){"number"!==
typeof g&&(g=0);var h=f.biquads[a];if(!h)switch(h=f.biquads[a]=new c(f.samplerate),a){case 0:h.setType("highpass");break;case f.biquads.length-1:h.setType("lowpass");break;default:h.setType("peaking")}h.setParams(e,d,g)}else f.biquads[a]=void 0;f.plotFlush=!0}return this};d.getParams=function(a){if(a=this._.biquads[a|0])return{freq:a.frequency,Q:a.Q,gain:a.gain}};d.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;f.inputSignalAR(this);if(!b.bypassed)for(var a=this.cells[1],e=this.cells[2],
b=b.biquads,d=0,c=b.length;d<c;++d)b[d]&&b[d].process(a,e);f.outputSignalAR(this)}return this};var a=new h(2048),e=k.Object.prototype.plot;d.plot=function(b){if(this._.plotFlush){var d=this._,g=new Float32Array(a.length);g[0]=1;for(var f=0,h=d.biquads.length;f<h;++f){var i=this.getParams(f);if(i){var k=new c(d.samplerate);0===f?k.setType("highpass"):f===h-1?k.setType("lowpass"):k.setType("peaking");k.setParams(i.freq,i.Q,i.gain);k.process(g,g)}}a.forward(g);var g=new Float32Array(512),d=0.5*d.samplerate,
h=new Float32Array(512),p;a.getFrequencyData(h);for(f=0;512>f;++f)i=20*Math.pow(d/20,f/512),k=i/(d/h.length),i=k|0,k-=i,0===i?i=h[i]:(p=h[i-1],i=h[i],i=(1-k)*p+k*i),g[f]=i;this._.plotData=g;this._.plotFlush=null}return e.call(this,b)};f.register("eq",i)})(timbre);
(function(k){function i(b){k.Object.call(this,2,b);f.listener(this);f.fixAR(this);this.real=new k.ChannelObject(this);this.imag=new k.ChannelObject(this);this.cells[3]=this.real.cell;this.cells[4]=this.imag.cell;b=this._;b.fft=new h(2*b.cellsize);b.fftCell=new f.SignalArray(b.fft.length);b.prevCell=new f.SignalArray(b.cellsize);b.freqs=new f.SignalArray(b.fft.length>>1);b.plotFlush=!0;b.plotRange=[0,32];b.plotBarStyle=!0}var f=k.fn,h=k.modules.FFT;f.extend(i);var c=i.prototype;Object.defineProperties(c,
{window:{set:function(b){this._.fft.setWindow(b)},get:function(){return this._.fft.windowName}},spectrum:{get:function(){return this._.fft.getFrequencyData(this._.freqs)}}});c.process=function(b){var d=this._;if(this.tickID!==b){this.tickID=b;f.inputSignalAR(this);f.outputSignalAR(this);var b=this.cells[0],a=d.cellsize;d.fftCell.set(d.prevCell);d.fftCell.set(b,a);d.fft.forward(d.fftCell);d.prevCell.set(b);d.plotFlush=!0;this.cells[3].set(d.fft.real.subarray(0,a));this.cells[4].set(d.fft.imag.subarray(0,
a))}return this};var b=k.Object.prototype.plot;c.plot=function(c){this._.plotFlush&&(this._.plotData=this.spectrum,this._.plotFlush=null);return b.call(this,c)};f.register("fft",i)})(timbre);
(function(k){function i(c){k.Object.call(this,1,c);f.fixAR(this);c=this._;c.freq=k(440);c.reg=32768;c.shortFlag=!1;c.phase=0;c.lastValue=0}var f=k.fn;f.extend(i);var h=i.prototype;Object.defineProperties(h,{shortFlag:{set:function(c){this._.shortFlag=!!c},get:function(){return this._.shortFlag}},freq:{set:function(c){this._.freq=k(c)},get:function(){return this._.freq}}});h.process=function(c){var b=this._,g=this.cells[0];if(this.tickID!==c){this.tickID=c;var d=b.lastValue,a=b.phase,c=b.freq.process(c).cells[0][0]/
b.samplerate,e=b.reg,f=b.mul,h=b.add,i,k;if(b.shortFlag){i=0;for(k=g.length;i<k;++i)1<=a&&(e>>=1,e|=((e^e>>6)&1)<<15,d=(e&1)-0.5,a-=1),g[i]=d*f+h,a+=c}else{i=0;for(k=g.length;i<k;++i)1<=a&&(e>>=1,e|=((e^e>>1)&1)<<15,d=(e&1)-0.5,a-=1),g[i]=d*f+h,a+=c}b.reg=e;b.phase=a;b.lastValue=d}return this};f.register("fnoise",i)})(timbre);
(function(k){function i(b){k.Object.call(this,2,b);f.fixAR(this);this._.selected=0;this._.outputs=[]}var f=k.fn,h=function(){function b(b){k.Object.call(this,2,[]);f.fixAR(this);this._.parent=b}f.extend(b);b.prototype.process=function(b){this.tickID!==b&&(this.tickID=b,this._.parent.process(b));return this};return b}();f.extend(i);var c=i.prototype;Object.defineProperties(c,{selected:{set:function(b){var c=this._;if("number"===typeof b){c.selected=b;for(var b=c.outputs,c=0,d=b.length;c<d;++c)b[c]&&
(b[c].cells[0].set(f.emptycell),b[c].cells[1].set(f.emptycell),b[c].cells[2].set(f.emptycell))}},get:function(){return this._.selected}}});c.at=function(b){var c=this._,d=c.outputs[b];d||(c.outputs[b]=d=new h(this));return d};c.process=function(b){var c=this._;if(this.tickID!==b&&(this.tickID=b,f.inputSignalAR(this),f.outputSignalAR(this),b=c.outputs[c.selected]))b.cells[0].set(this.cells[0]),b.cells[1].set(this.cells[1]),b.cells[2].set(this.cells[2]);return this};f.register("gate",i)})(timbre);
(function(k){function i(b){k.Object.call(this,1,b);f.fixAR(this);b=this._;b.fft=new h(2*b.cellsize);b.fftCell=new f.SignalArray(this._.fft.length);b.realBuffer=new f.SignalArray(this._.fft.length);b.imagBuffer=new f.SignalArray(this._.fft.length)}var f=k.fn,h=k.modules.FFT;f.extend(i);var c=i.prototype;Object.defineProperties(c,{real:{set:function(b){this._.real=k(b)},get:function(){return this._.real}},imag:{set:function(b){this._.imag=k(b)},get:function(){return this._.imag}}});c.process=function(b){var c=
this._;if(this.tickID!==b&&(this.tickID=b,c.real&&c.imag)){var d=this.cells[0],a=c.realBuffer,e=c.imagBuffer,j=c.real.process(b).cells[0],b=c.imag.process(b).cells[0];a.set(j);e.set(b);d.set(c.fft.inverse(a,e).subarray(0,c.cellsize));f.outputSignalAR(this)}return this};f.register("ifft",i)})(timbre);
(function(k){function i(b){k.Object.call(this,1,b);f.timer(this);f.fixKR(this);b=this._;b.interval=k(1E3);b.count=0;b.delay=0;b.timeout=Infinity;b.currentTime=0;b.delaySamples=0;b.countSamples=0;b.onended=f.make_onended(this);this.on("start",c)}var f=k.fn,h=k.timevalue;f.extend(i);var c=function(){var b=this._;this.playbackState=f.PLAYING_STATE;b.delaySamples=b.samplerate*0.001*b.delay|0;b.countSamples=b.count=b.currentTime=0};Object.defineProperty(c,"unremovable",{value:!0,writable:!1});var b=i.prototype;
Object.defineProperties(b,{interval:{set:function(b){"string"===typeof b&&(b=h(b),0>=b&&(b=0));this._.interval=k(b)},get:function(){return this._.interval}},delay:{set:function(b){"string"===typeof b&&(b=h(b));"number"===typeof b&&0<=b&&(this._.delay=b,this._.delaySamples=this._.samplerate*0.001*b|0)},get:function(){return this._.delay}},count:{set:function(b){"number"===typeof b&&(this._.count=b)},get:function(){return this._.count}},timeout:{set:function(b){"string"===typeof b&&(b=h(b));"number"===
typeof b&&0<=b&&(this._.timeout=b)},get:function(){return this._.timeout}},currentTime:{get:function(){return this._.currentTime}}});b.bang=function(){var b=this._;this.playbackState=f.PLAYING_STATE;b.delaySamples=b.samplerate*0.001*b.delay|0;b.countSamples=b.count=b.currentTime=0;b.emit("bang");return this};b.process=function(b){var d=this.cells[0],a=this._;if(this.tickID!==b){this.tickID=b;0<a.delaySamples&&(a.delaySamples-=d.length);b=a.interval.process(b).cells[0][0];if(0>=a.delaySamples&&(a.countSamples-=
d.length,0>=a.countSamples)){a.countSamples+=0.001*a.samplerate*b|0;for(var b=this.nodes,e=a.count,c=e*a.mul+a.add,h=0,i=d.length;h<i;++h)d[h]=c;d=0;for(c=b.length;d<c;++d)b[d].bang(e);a.count+=1}a.currentTime+=f.currentTimeIncr;a.currentTime>=a.timeout&&f.nextTick(a.onended)}return this};f.register("interval",i)})(timbre);
(function(k){function i(b){k.Object.call(this,1,b);f.fixAR(this);var b=this._,c=Math.ceil(Math.log(b.samplerate)*Math.LOG2E);b.buffersize=1<<c;b.buffermask=b.buffersize-1;b.buffer=new f.SignalArray(b.buffersize);b.time=0;b.readIndex=0;b.writeIndex=0}var f=k.fn,h=k.timevalue;f.extend(i);var c=i.prototype;Object.defineProperties(c,{time:{set:function(b){"string"===typeof b&&(b=h(b));if("number"===typeof b&&0<b){var c=this._;c.time=b;b=0.001*b*c.samplerate|0;b>c.buffermask&&(b=c.buffermask);c.writeIndex=
c.readIndex+b&c.buffermask}},get:function(){return this._.time}}});c.process=function(b){var c=this._;if(this.tickID!==b){this.tickID=b;f.inputSignalAR(this);var b=this.cells[0],d=c.buffer,a=c.buffermask,e=c.readIndex,j=c.writeIndex,h,i=b.length;for(h=0;h<i;++h)d[j]=b[h],b[h]=d[e],e+=1,j=j+1&a;c.readIndex=e&a;c.writeIndex=j;f.outputSignalAR(this)}return this};f.register("lag",i)})(timbre);
(function(k){function i(b){k.Object.call(this,1,b);b=this._;b.input=0;b.value=0;b.prev=null;b.ar=!1;b.map=h}var f=k.fn;f.extend(i);var h=function(b){return b},c=i.prototype;Object.defineProperties(c,{input:{set:function(b){"number"===typeof b&&(this._.input=b)},get:function(){return this._.input}},map:{set:function(b){"function"===typeof b&&(this._.map=b)},get:function(){return this._.map}}});c.bang=function(){this._.prev=null;this._.emit("bang");return this};c.at=function(b){return this._.map?this._.map(b):
0};c.process=function(b){var c=this.cells[0],d=this._;if(this.tickID!==b){this.tickID=b;var a=this.nodes.length,b=c.length;if(d.ar&&a){f.inputSignalAR(this);var e=d.map;if(e)for(a=0;a<b;++a)c[a]=e(c[a]);d.value=c[b-1];f.outputSignalAR(this)}else{a=a?f.inputSignalKR(this):d.input;d.map&&d.prev!==a&&(d.prev=a,d.value=d.map(a));d=d.value*d.mul+d.add;for(a=0;a<b;++a)c[a]=d}}return this};f.register("map",i)})(timbre);
(function(k){function i(f){k.Object.call(this,1,f)}var f=k.fn;f.extend(i);i.prototype.process=function(h){var c=this.cells[0],b=this._;if(this.tickID!==h){this.tickID=h;var g=this.nodes,d=g.length,a,e=c.length,j,i;if(b.ar){if(0<g.length){j=g[0].process(h).cells[0];c.set(j);for(b=1;b<d;++b){j=g[b].process(h).cells[0];for(a=0;a<e;++a)i=j[a],c[a]<i&&(c[a]=i)}}else for(a=0;a<e;++a)c[a]=0;f.outputSignalAR(this)}else{if(0<g.length){j=g[0].process(h).cells[0][0];for(b=1;b<d;++b)i=g[b].process(h).cells[0][0],
j<i&&(j=i)}else j=0;c[0]=j;f.outputSignalKR(this)}}return this};f.register("max",i)})(timbre);
(function(k){function i(a){k.Object.call(this,2,a);f.fixAR(this);a=this._;a.src=a.func=null;a.bufferL=new f.SignalArray(h);a.bufferR=new f.SignalArray(h);a.readIndex=0;a.writeIndex=0;a.totalRead=0;a.totalWrite=0}if("browser"===k.envtype){var f=k.fn,h=4096,c=h-1;f.extend(i);var b=i.prototype;b.listen=function(a){var b=g[k.env];b&&(b.set.call(this,a),b.listen.call(this))};b.unlisten=function(){var a=g[k.env];a&&a.unlisten.call(this);this.cells[0].set(f.emptycell);this.cells[1].set(f.emptycell);this.cells[2].set(f.emptycell);
for(var b=this._,a=b.bufferL,b=b.bufferR,d=0,c=a.length;d<c;++d)a[d]=b[d]=0};b.process=function(a){var b=this._;if(null===b.src)return this;if(this.tickID!==a){this.tickID=a;a=b.cellsize;if(b.totalWrite>b.totalRead+a){var d=b.readIndex,g=d+a;this.cells[1].set(b.bufferL.subarray(d,g));this.cells[2].set(b.bufferR.subarray(d,g));b.readIndex=g&c;b.totalRead+=a}f.outputSignalAR(this)}return this};var g={webkit:{set:function(a){var b=this._;a instanceof HTMLMediaElement&&(b.src=f._audioContext.createMediaElementSource(a))},
listen:function(){var a=this._,b=f._audioContext;a.gain=b.createGainNode();a.gain.gain.value=0;a.node=b.createJavaScriptNode(1024,2,2);a.node.onaudioprocess=d(this);a.src.connect(a.node);a.node.connect(a.gain);a.gain.connect(b.destination)},unlisten:function(){var a=this._;a.src&&a.src.disconnect();a.gain&&a.gain.disconnect();a.node&&a.node.disconnect()}}},d=function(a){return function(b){var d=a._,b=b.inputBuffer,f=b.length,g=d.writeIndex;d.bufferL.set(b.getChannelData(0),g);d.bufferR.set(b.getChannelData(1),
g);d.writeIndex=g+f&c;d.totalWrite+=f}};g.moz={set:function(a){var b=this._;a instanceof HTMLAudioElement&&(b.src=a,b.istep=b.samplerate/a.mozSampleRate)},listen:function(){var a=this._,b=a.bufferL,d=a.bufferR,f=0,g=0;2===a.src.mozChannels?(a.x=0,a.func=function(h){var i=a.writeIndex,k=a.totalWrite,h=h.frameBuffer,m,p=a.istep,q,r=h.length;m=a.x;for(q=0;q<r;q+=2){for(m+=p;0<m;)b[i]=0.5*(h[q]+f),d[i]=0.5*(h[q+1]+g),i=i+1&c,++k,m-=1;f=h[q];g=h[q+1]}a.x=m;a.writeIndex=i;a.totalWrite=k}):(a.x=0,a.func=
function(g){var h=a.writeIndex,i=a.totalWrite,g=g.frameBuffer,k,l=a.istep,q,r=g.length;k=a.x;for(q=0;q<r;++q){for(k+=l;0<=k;)b[h]=d[h]=0.5*(g[q]+f),h=h+1&c,++i,k-=1;f=g[q]}a.x=k;a.writeIndex=h;a.totalWrite=i});a.src.addEventListener("MozAudioAvailable",a.func)},unlisten:function(){var a=this._;a.func&&(a.src.removeEventListener("MozAudioAvailable",a.func),a.func=null)}};f.register("mediastream",i)}})(timbre);
(function(k){function i(c){k.Object.call(this,1,c);c=this._;c.midi=0;c.value=0;c.prev=null;c.a4=440;c.ar=!1}var f=k.fn;f.extend(i);var h=i.prototype;Object.defineProperties(h,{midi:{set:function(c){"number"===typeof c&&(this._.midi=c)},get:function(){return this._.midi}},a4:{set:function(c){"number"===typeof c&&(this._.a4=c,this._.prev=null)},get:function(){return this._.a4}}});h.bang=function(){this._.prev=null;this._.emit("bang");return this};h.at=function(c){return this._.a4*Math.pow(2,(c-69)/
12)};h.process=function(c){var b=this._;if(this.tickID!==c){this.tickID=c;var c=this.cells[0],g=this.nodes.length,d=c.length;if(b.ar&&g){f.inputSignalAR(this);for(var a=b.a4,g=0;g<d;++g)c[g]=a*Math.pow(2,(c[g]-69)/12);b.value=c[d-1];f.outputSignalAR(this)}else d=g?f.inputSignalKR(this):b.midi,b.prev!==d&&(b.prev=d,b.value=b.a4*Math.pow(2,(d-69)/12)),c[0]=b.value,f.outputSignalKR(this)}return this};f.register("midicps",i)})(timbre);
(function(k){function i(c){k.Object.call(this,1,c);c=this._;c.midi=0;c.value=0;c.prev=null;c.range=12;c.ar=!1}var f=k.fn;f.extend(i);var h=i.prototype;Object.defineProperties(h,{midi:{set:function(c){"number"===typeof c&&(this._.midi=c)},get:function(){return this._.midi}},range:{set:function(c){"number"===typeof c&&0<c&&(this._.range=c)},get:function(){return this._.range}}});h.bang=function(){this._.prev=null;this._.emit("bang");return this};h.at=function(c){return Math.pow(2,c/this._.range)};h.process=
function(c){var b=this.cells[0],g=this._;if(this.tickID!==c){this.tickID=c;var d=this.nodes.length,c=b.length;if(g.ar&&d){f.inputSignalAR(this);for(var a=g.range,d=0;d<c;++d)b[d]=Math.pow(2,b[d]/a);g.value=b[c-1];f.outputSignalAR(this)}else{d=this.nodes.length?f.inputSignalKR(this):g.midi;g.prev!==d&&(g.prev=d,g.value=Math.pow(2,d/g.range));g=g.value*g.mul+g.add;for(d=0;d<c;++d)b[d]=g}}return this};f.register("midiratio",i)})(timbre);
(function(k){function i(f){k.Object.call(this,1,f)}var f=k.fn;f.extend(i);i.prototype.process=function(h){var c=this.cells[0],b=this._;if(this.tickID!==h){this.tickID=h;var g=this.nodes,d=g.length,a,e=c.length,j,i;if(b.ar){if(0<g.length){j=g[0].process(h).cells[0];c.set(j);for(b=1;b<d;++b){j=g[b].process(h).cells[0];for(a=0;a<e;++a)i=j[a],c[a]>i&&(c[a]=i)}}else for(a=0;a<e;++a)c[a]=0;f.outputSignalAR(this)}else{if(0<g.length){j=g[0].process(h).cells[0][0];for(b=1;b<d;++b)i=g[b].process(h).cells[0][0],
j>i&&(j=i)}else j=0;c[0]=j;f.outputSignalKR(this)}}return this};f.register("min",i)})(timbre);
(function(k){function i(a){k.Object.call(this,0,a);f.timer(this);f.fixKR(this);a=this._;a.mml="";a.status={t:120,l:4,o:4,v:12,q:6,dot:0,tie:!1};a.commands=[];a.index=0;a.queue=[];a.currentTime=0;a.queueTime=0;a.segnoIndex=-1;a.loopStack=[];a.prevNote=0;a.remain=Infinity;a.onended=f.make_onended(this);this.on("start",h)}var f=k.fn;f.extend(i);var h=function(){var a=this._;this.playbackState=f.PLAYING_STATE;a.commands=g(a.mml);a.index=0;a.queue=[];a.currentTime=0;a.queueTime=0;a.segnoIndex=-1;a.loopStack=
[];a.prevNote=0;a.remain=Infinity;b(this)};Object.defineProperty(h,"unremoved",{value:!0,writable:!1});var c=i.prototype;Object.defineProperties(c,{mml:{set:function(a){var b=this._;"string"===typeof a&&(b.mml=a)},get:function(){return this._.mml}},currentTime:{get:function(){return this._.currentTime}}});c.on=c.addListener=function(a,b){"mml"===a&&(a="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."));this._.events.on(a,b);return this};c.once=function(a,
b){"mml"===a&&(a="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."));this._.events.once(a,b);return this};c.off=c.removeListener=function(a,b){"mml"===a&&(a="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."));this._.events.off(a,b);return this};c.removeAllListeners=function(a){"mml"===a&&(console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."),a="data");this._.events.removeAllListeners(a);
return this};c.listeners=function(a){"mml"===a&&(console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."),a="data");return this._.events.listeners(a)};c.process=function(a){var e=this._;if(this.tickID!==a){this.tickID=a;var a=this.nodes,d=e.queue,c,g,h;if(d.length)for(;d[0][0]<=e.currentTime;){var i=e.queue.shift();if(i[1]){g=0;for(h=a.length;g<h;++g)c=a[g],c.noteOn?c.noteOn(i[1],i[3]):c.bang();e.remain=i[4];e.emit("data","noteOn",{noteNum:i[1],velocity:i[3]});
b(this)}else{g=0;for(h=a.length;g<h;++g)c=a[g],c.noteOff?c.noteOff(i[2],i[3]):c.release&&c.release();e.emit("data","noteOff",{noteNum:i[2],velocity:i[3]})}if(0===d.length)break}e.remain-=f.currentTimeIncr;0===d.length&&0>=e.remain&&f.nextTick(e.onended);e.currentTime+=f.currentTimeIncr}return this};var b=function(a){var a=a._,b,d=a.commands,c=a.queue,f=a.index,g=a.status,h=a.queueTime,i=a.loopStack,k,p,q,r,v;r=[];a:for(;;){if(d.length<=f)if(0<=a.segnoIndex)f=a.segnoIndex;else break;b=d[f++];switch(b.name){case "n":k=
g.t||120;null!==b.len?(p=b.len,q=b.dot||0):(p=g.l,q=b.dot||g.dot);k=1E3*60/k*(4/p);k*=[1,1.5,1.75,1.875][q]||1;q=g.v<<3;if(g.tie){for(b=c.length;b--;)if(c[b][2]){c.splice(b,1);break}b=a.prevNote}else b=a.prevNote=b.val+12*(g.o+1),c.push([h,b,null,q,k]);if(0<p){p=g.q/8;if(1>p){p=h+k*p;c.push([p,null,b,q]);b=0;for(v=r.length;b<v;++b)c.push([p,null,r[b],q])}r=[];h+=k;if(!g.tie)break a}else r.push(b);g.tie=!1;break;case "r":k=g.t||120;null!==b.len?(p=b.len,q=b.dot||0):(p=g.l,q=b.dot||g.dot);0<p&&(k=1E3*
60/k*(4/p),k*=[1,1.5,1.75,1.875][q]||1,h+=k);break;case "l":g.l=b.val;g.dot=b.dot;break;case "o":g.o=b.val;break;case "<":9>g.o&&(g.o+=1);break;case ">":0<g.o&&(g.o-=1);break;case "v":g.v=b.val;break;case "(":15>g.v&&(g.v+=1);break;case ")":0<g.v&&(g.v-=1);break;case "q":g.q=b.val;break;case "&":g.tie=!0;break;case "$":a.segnoIndex=f;break;case "[":i.push([f,null,null]);break;case "|":if((k=i[i.length-1])&&1===k[1])i.pop(),f=k[2];break;case "]":if(k=i[i.length-1])null===k[1]&&(k[1]=b.count,k[2]=f),
k[1]-=1,0===k[1]?i.pop():f=k[0];break;case "t":g.t=null===b.val?120:b.val}}a.index=f;a.queueTime=h},g=function(a){var b,c,f,g,h,i,k,m=Array(a.length),p=[];h=0;for(i=d.length;h<i;++h){b=d[h];for(c=b.re;f=c.exec(a);){if(!m[f.index]){g=0;for(k=f[0].length;g<k;++g)m[f.index+g]=!0;if(g=b.func?b.func(f):{name:f[0]})g.index=f.index,g.origin=f[0],p.push(g)}for(;c.lastIndex<a.length&&m[c.lastIndex];)++c.lastIndex}}p.sort(function(a,b){return a.index-b.index});return p},d=[{re:/([cdefgab])([\-+]?)(\d*)(\.*)/g,
func:function(a){return{name:"n",val:{c:0,d:2,e:4,f:5,g:7,a:9,b:11}[a[1]]+({"-":-1,"+":1}[a[2]]||0),len:""===a[3]?null:Math.min(a[3]|0,64),dot:a[4].length}}},{re:/r(\d*)(\.*)/g,func:function(a){return{name:"r",len:""===a[1]?null:Math.max(1,Math.min(a[1]|0,64)),dot:a[2].length}}},{re:/&/g},{re:/l(\d*)(\.*)/g,func:function(a){return{name:"l",val:""===a[1]?4:Math.min(a[1]|0,64),dot:a[2].length}}},{re:/o([0-9])/g,func:function(a){return{name:"o",val:""===a[1]?4:a[1]|0}}},{re:/[<>]/g},{re:/v(\d*)/g,func:function(a){return{name:"v",
val:""===a[1]?12:Math.min(a[1]|0,15)}}},{re:/[()]/g},{re:/q([0-8])/g,func:function(a){return{name:"q",val:""===a[1]?6:Math.min(a[1]|0,8)}}},{re:/\[/g},{re:/\|/g},{re:/\](\d*)/g,func:function(a){return{name:"]",count:a[1]|0||2}}},{re:/t(\d*)/g,func:function(a){return{name:"t",val:""===a[1]?null:Math.max(5,Math.min(a[1]|0,300))}}},{re:/\$/g}];f.register("mml",i)})(timbre);
(function(k){function i(f){k.Object.call(this,1,f)}var f=k.fn;f.extend(i);i.prototype.process=function(h){var c=this._;this.tickID!==h&&(this.tickID=h,c.ar?(f.inputSignalAR(this),f.outputSignalAR(this)):(this.cells[0][0]=f.inputSignalKR(this),f.outputSignalKR(this)));return this};f.register("mono",i)})(timbre);
(function(k){function i(f){k.Object.call(this,2,f)}var f=k.fn;f.extend(i);i.prototype.process=function(h){var c=this._;if(this.tickID!==h){this.tickID=h;var b=this.nodes,g=this.cells[0],d=this.cells[1],a=this.cells[2],e=b.length,j=g.length,i,k;if(c.ar){if(0<b.length){b[0].process(h);i=b[0].cells[1];k=b[0].cells[2];d.set(i);a.set(k);for(c=1;c<e;++c){b[c].process(h);i=b[c].cells[1];k=b[c].cells[2];for(g=0;g<j;++g)d[g]*=i[g],a[g]*=k[g]}}else for(g=0;g<j;++g)d[g]=a[g]=0;f.outputSignalAR(this)}else{if(0<
b.length){d=b[0].process(h).cells[0][0];for(c=1;c<e;++c)d*=b[c].process(h).cells[0][0]}else d=0;g[0]=d;f.outputSignalKR(this)}}return this};f.register("*",i)})(timbre);
(function(k){function i(c){k.Object.call(this,1,c);c=this._;c.defaultValue=0;c.index=0;c.dict={};c.ar=!1}var f=k.fn;f.extend(i);var h=i.prototype;Object.defineProperties(h,{dict:{set:function(c){if("object"===typeof c)this._.dict=c;else if("function"===typeof c){for(var b={},f=0;128>f;++f)b[f]=c(f);this._.dict=b}},get:function(){return this._.dict}},defaultValue:{set:function(c){"number"===typeof c&&(this._.defaultValue=c)},get:function(){return this._.defaultValue}},index:{set:function(c){"number"===
typeof c&&(this._.index=c)},get:function(){return this._.index}}});h.at=function(c){var b=this._;return(b.dict[c|0]||b.defaultValue)*b.mul+b.add};h.clear=function(){this._.dict={};return this};h.process=function(c){var b=this.cells[0],g=this._;if(this.tickID!==c){this.tickID=c;var d=this.nodes.length,a;a=g.dict;var e=g.defaultValue,j=g.mul,h=g.add,c=b.length;if(g.ar&&d){f.inputSignalAR(this);for(g=0;g<c;++g)d=b[g],d=0>d?d-0.5|0:d+0.5|0,b[g]=(a[d]||e)*j+h;f.outputSignalAR(this)}else{d=this.nodes.length?
f.inputSignalKR(this):g.index;a=(a[0>d?d-0.5|0:d+0.5|0]||e)*j+h;for(g=0;g<c;++g)b[g]=a}}return this};f.register("ndict",i)})(timbre);(function(k){function i(f){k.Object.call(this,1,f)}var f=k.fn;f.extend(i);i.prototype.process=function(f){var c=this.cells[0],b=this._;if(this.tickID!==f){this.tickID=f;var f=b.mul,g=b.add,d;if(b.ar){b=0;for(d=c.length;b<d;++b)c[b]=(2*Math.random()-1)*f+g}else{f=(2*Math.random()+1)*f+g;b=0;for(d=c.length;b<d;++b)c[b]=f}}return this};f.register("noise",i)})(timbre);
(function(k){function i(a){k.Object.call(this,2,a);a=this._;a.freq=k(440);a.phase=k(0);a.osc=new c(a.samplerate);a.tmp=new f.SignalArray(a.cellsize);a.osc.step=a.cellsize;this.once("init",b)}var f=k.fn,h=k.timevalue,c=k.modules.Oscillator;f.extend(i);var b=function(){var a=this._;this.wave||(this.wave="sin");a.plotData=a.osc.wave;a.plotLineWidth=2;a.plotCyclic=!0;a.plotBefore=d},g=i.prototype;Object.defineProperties(g,{wave:{set:function(a){this._.osc.setWave(a)},get:function(){return this._.osc.wave}},
freq:{set:function(a){"string"===typeof a&&(a=h(a),a=0>=a?0:1E3/a);this._.freq=k(a)},get:function(){return this._.freq}},phase:{set:function(a){this._.phase=k(a);this._.osc.feedback=!1},get:function(){return this._.phase}},fb:{set:function(a){this._.phase=k(a);this._.osc.feedback=!0},get:function(){return this._.phase}}});g.bang=function(){this._.osc.reset();this._.emit("bang");return this};g.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;var d=this.cells[1],c=this.cells[2],g,
h=b.cellsize;if(this.nodes.length)f.inputSignalAR(this);else for(g=0;g<h;++g)d[g]=c[g]=1;g=b.osc;var i=b.freq.process(a).cells[0],k=b.phase.process(a).cells[0];g.frequency=i[0];g.phase=k[0];if(b.ar){a=b.tmp;b.freq.isAr?b.phase.isAr?g.processWithFreqAndPhaseArray(a,i,k):g.processWithFreqArray(a,i):b.phase.isAr?g.processWithPhaseArray(a,k):g.process(a);for(g=0;g<h;++g)d[g]*=a[g],c[g]*=a[g]}else{b=g.next();for(g=0;g<h;++g)d[g]*=b,c[g]*=b}f.outputSignalAR(this)}return this};var d;"browser"===k.envtype&&
(d=function(a,b,d,c,g){g=(g>>1)+0.5;a.strokeStyle="#ccc";a.lineWidth=1;a.beginPath();a.moveTo(b,g+d);a.lineTo(b+c,g+d);a.stroke()});f.register("osc",i);f.register("sin",function(a){return(new i(a)).set("wave","sin")});f.register("cos",function(a){return(new i(a)).set("wave","cos")});f.register("pulse",function(a){return(new i(a)).set("wave","pulse")});f.register("tri",function(a){return(new i(a)).set("wave","tri")});f.register("saw",function(a){return(new i(a)).set("wave","saw")});f.register("fami",
function(a){return(new i(a)).set("wave","fami")});f.register("konami",function(a){return(new i(a)).set("wave","konami")});f.register("+sin",function(a){return(new i(a)).set("wave","+sin").kr()});f.register("+pulse",function(a){return(new i(a)).set("wave","+pulse").kr()});f.register("+tri",function(a){return(new i(a)).set("wave","+tri").kr()});f.register("+saw",function(a){return(new i(a)).set("wave","+saw").kr()});f.alias("square","pulse")})(timbre);
(function(k){function i(b){k.Object.call(this,2,b);f.fixAR(this);b=this._;b.pos=k(0);b.panL=0.7071067811865475;b.panR=0.7071067811865475}var f=k.fn;f.extend(i);var h=function(){for(var b=new Float32Array(257),d=0;256>d;++d)b[d]=Math.sin(0.5*Math.PI*(d/256));b[256]=1;return b}(),c=function(){for(var b=new Float32Array(257),d=0;256>d;++d)b[d]=Math.cos(0.5*Math.PI*(d/256));b[256]=0;return b}(),b=i.prototype;Object.defineProperties(b,{pos:{set:function(b){this._.pos=k(b)},get:function(){return this._.pos}}});
b.process=function(b){var d=this._;if(this.tickID!==b){this.tickID=b;var a=d.pos.process(b).cells[0][0];if(d.prevPos!==a){var e=128*(a+1)|0;d.panL=c[e];d.panR=h[e];d.prevPos=a}var j=this.nodes,a=this.cells[1],e=this.cells[2],i,k=j.length,n,s=a.length,t;if(k){t=j[0].process(b).cells[0];for(n=0;n<s;++n)a[n]=e[n]=t[n];for(i=1;i<k;++i){t=j[i].process(b).cells[0];for(n=0;n<s;++n)a[n]=e[n]+=t[n]}b=d.panL;d=d.panR;for(n=0;n<s;++n)a[n]*=b,e[n]*=d}else a.set(f.emptycell),e.set(f.emptycell);f.outputSignalAR(this)}return this};
f.register("pan",i)})(timbre);
(function(k){function i(a){k.Object.call(this,2,a);a=this._;a.value=0;a.env=new b(a.samplerate);a.env.step=a.cellsize;a.curve="lin";a.counter=0;a.ar=!1;a.onended=f.make_onended(this);this.on("ar",g)}var f=k.fn,h=k.timevalue,c=k.modules.Envelope,b=k.modules.EnvelopeValue;f.extend(i);var g=function(a){this._.env.step=a?1:this._.cellsize},d=i.prototype;Object.defineProperties(d,{value:{set:function(a){"number"===typeof a&&(this._.env.value=a)},get:function(){return this._.env.value}}});d.to=function(a,
b,d){var f=this._,g=f.env;"string"===typeof b?b=h(b):"undefined"===typeof b&&(b=0);if("undefined"===typeof d)f.counter=g.setNext(a,b,c.CurveTypeLin),f.curve="lin";else{var i=c.CurveTypeDict[d];f.counter="undefined"===typeof i?g.setNext(a,b,c.CurveTypeCurve,d):g.setNext(a,b,i);f.curve=d}f.plotFlush=!0;return this};d.setAt=function(a,b){var d=this._;this.to(d.env.value,b,"set");d.atValue=a;return this};d.linTo=function(a,b){return this.to(a,b,"lin")};d.expTo=function(a,b){return this.to(a,b,"exp")};
d.sinTo=function(a,b){return this.to(a,b,"sin")};d.welTo=function(a,b){return this.to(a,b,"wel")};d.sqrTo=function(a,b){return this.to(a,b,"sqr")};d.cubTo=function(a,b){return this.to(a,b,"cub")};d.cancel=function(){var a=this._;a.counter=a.env.setNext(a.env.value,0,c.CurveTypeSet);return this};d.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;var a=this.cells[1],d=this.cells[2],g,h=b.cellsize,i=b.env,k=b.counter,m;if(this.nodes.length)f.inputSignalAR(this);else for(g=0;g<h;++g)a[g]=
d[g]=1;0>=k&&("set"===b.curve?i.setNext(b.atValue,0,c.CurveTypeSet):i.setNext(i.value,0,c.CurveTypeSet),f.nextTick(b.onended),b.counter=Infinity);if(b.ar){for(g=0;g<h;++g)m=i.next(),a[g]*=m,d[g]*=m;b.counter-=b.cellsize}else{m=i.next();for(g=0;g<h;++g)a[g]*=m,d[g]*=m;b.counter-=1}f.outputSignalAR(this);b.value=m}return this};var a=k.Object.prototype.plot;d.plot=function(d){var f=this._;if(f.plotFlush){var g=new b(128),h=new Float32Array(128),i,k;if("set"===f.curve){i=100;for(k=h.length;i<k;++i)h[i]=
1}else{i=c.CurveTypeDict[f.curve];"undefined"===typeof i?g.setNext(1,1E3,c.CurveTypeCurve,f.curve):g.setNext(1,1E3,i);i=0;for(k=h.length;i<k;++i)h[i]=g.next()}f.plotData=h;f.plotRange=[0,1];f.plotFlush=null}return a.call(this,d)};f.register("param",i)})(timbre);
(function(k){function i(b){k.Object.call(this,2,b);f.fixAR(this);b=this._;b.freq=k("sin",{freq:1,add:1E3,mul:250}).kr();b.Q=k(1);b.allpass=[];this.steps=2}var f=k.fn,h=k.modules.Biquad;f.extend(i);var c=i.prototype;Object.defineProperties(c,{freq:{set:function(b){this._.freq=b},get:function(){return this._.freq}},Q:{set:function(b){this._.Q=k(b)},get:function(){return this._.Q}},steps:{set:function(b){if("number"===typeof b){b|=0;if(2===b||4===b||8===b||12===b){var c=this._.allpass;if(c.length<b)for(var d=
c.length;d<b;++d)c[d]=new h(this._.samplerate),c[d].setType("allpass")}this._.steps=b}},get:function(){return this._.steps}}});c.process=function(b){var c=this._;if(this.tickID!==b){this.tickID=b;f.inputSignalAR(this);if(!c.bypassed){var d=this.cells[1],a=this.cells[2],e=c.freq.process(b).cells[0][0],b=c.Q.process(b).cells[0][0],j=c.steps,h;for(h=0;h<j;h+=2)c.allpass[h].setParams(e,b,0),c.allpass[h].process(d,a),c.allpass[h+1].setParams(e,b,0),c.allpass[h+1].process(d,a)}f.outputSignalAR(this)}return this};
f.register("phaser",i)})(timbre);
(function(k){function i(h){k.Object.call(this,1,h);f.fixAR(this);for(var h=new Uint8Array(5),c=0;5>c;++c)h[c]=(1073741824*Math.random()|0)%25;this._.whites=h;this._.key=0}var f=k.fn;f.extend(i);i.prototype.process=function(f){var c=this.cells[0],b=this._;if(this.tickID!==f){this.tickID=f;var g,d,a=b.key,e=b.whites,j=b.mul,i=b.add,k,n,f=0;for(g=c.length;f<g;++f){d=a++;31<a&&(a=0);n=d^a;for(d=k=0;5>d;++d)n&1<<d&&(e[d]=(1073741824*Math.random()|0)%25),k+=e[d];c[f]=(0.01666666*k-1)*j+i}b.key=a}return this};
f.register("pink",i)})(timbre);
(function(k){function i(c){k.Object.call(this,1,c);this._.freq=440;this._.buffer=null;this._.readIndex=0;this._.writeIndex=0}var f=k.fn;f.extend(i);var h=i.prototype;Object.defineProperties(h,{freq:{set:function(c){"number"===typeof c&&(0>c&&(c=0),this._.freq=c)},get:function(){return this._.freq}}});h.bang=function(){for(var c=this._,b=c.samplerate/c.freq+0.5|0,g=c.buffer=new f.SignalArray(b<<1),d=0;d<b;++d)g[d]=2*Math.random()-1;c.readIndex=0;c.writeIndex=b;c.emit("bang");return this};h.process=
function(c){var b=this.cells[0],f=this._;if(this.tickID!==c&&(this.tickID=c,c=f.buffer)){var d=c.length,a=f.readIndex,e=f.writeIndex,j=f.mul,h=f.add,i,k,s=b.length;for(k=0;k<s;++k)i=c[a++],a>=d&&(a=0),i=0.5*(i+c[a]),c[e++]=i,e>=d&&(e=0),b[k]=i*j+h;f.readIndex=a;f.writeIndex=e}return this};f.register("pluck",i)})(timbre);
(function(k){function i(d){k.Object.call(this,1,d);f.listener(this);f.fixAR(this);d=this._;d.timeout=5E3;d.status=c;d.writeIndex=0;d.writeIndexIncr=1;d.currentTime=0;d.currentTimeIncr=1E3/d.samplerate;d.onended=b(this)}var f=k.fn,h=k.timevalue,c=0;f.extend(i);var b=function(b){return function(){var a=b._,e=new f.SignalArray(a.buffer.subarray(0,a.writeIndex|0));a.status=c;a.writeIndex=0;a.currentTime=0;a.emit("ended",{buffer:e,samplerate:a.samplerate})}},g=i.prototype;Object.defineProperties(g,{timeout:{set:function(b){"string"===
typeof b&&(b=h(b));"number"===typeof b&&0<b&&(this._.timeout=b)},get:function(){return this._.timeout}},samplerate:{set:function(b){"number"===typeof b&&(0<b&&b<=this._.samplerate)&&(this._.samplerate=b)},get:function(){return this._.samplerate}},currentTime:{get:function(){return this._.currentTime}}});g.start=function(){var b=this._,a;if(b.status===c){a=0.01*b.timeout*b.samplerate|0;if(!b.buffer||b.buffer.length<a)b.buffer=new f.SignalArray(a);b.writeIndex=0;b.writeIndexIncr=b.samplerate/k.samplerate;
b.currentTime=0;b.status=1;b.emit("start");this.listen()}return this};g.stop=function(){var b=this._;1===b.status&&(b.status=c,b.emit("stop"),f.nextTick(b.onended),this.unlisten());return this};g.bang=function(){this._.status===c?this.srart():1===this._.status&&this.stop();this._.emit("bang");return this};g.process=function(b){var a=this._,e=this.cells[0];if(this.tickID!==b){this.tickID=b;f.inputSignalAR(this);if(1===a.status){for(var c=e.length,g=a.buffer,h=a.timeout,i=a.writeIndex,k=a.writeIndexIncr,
t=a.currentTime,m=a.currentTimeIncr,b=0;b<c;++b)g[i|0]=e[b],i+=k,t+=m,h<=t&&f.nextTick(a.onended);a.writeIndex=i;a.currentTime=t}f.outputSignalAR(this)}return this};f.register("record",i);f.alias("rec","record")})(timbre);
(function(k){function i(b){k.Object.call(this,2,b);f.fixAR(this);this._.reverb=new h(this._.samplerate,this._.cellsize)}var f=k.fn,h=k.modules.Reverb;f.extend(i);var c=i.prototype;Object.defineProperties(c,{room:{set:function(b){"number"===typeof b&&this._.reverb.setRoomSize(1<b?1:0>b?0:b)},get:function(){return this._.reverb.roomsize}},damp:{set:function(b){"number"===typeof b&&this._.reverb.setDamp(1<b?1:0>b?0:b)},get:function(){return this._.reverb.damp}},mix:{set:function(b){"number"===typeof b&&
(this._.reverb.wet=1<b?1:0>b?0:b)},get:function(){return this._.reverb.wet}}});c.process=function(b){var c=this._;this.tickID!==b&&(this.tickID=b,f.inputSignalAR(this),c.bypassed||c.reverb.process(this.cells[1],this.cells[2]),f.outputSignalAR(this));return this};f.register("reverb",i)})(timbre);
(function(k){function i(b){k.Object.call(this,0,b);f.timer(this);f.fixKR(this);b=this._;b.queue=[];b.currentTime=0;b.maxRemain=1E3}var f=k.fn,h=k.timevalue;f.extend(i);var c=i.prototype;Object.defineProperties(c,{queue:{get:function(){return this._.queue}},remain:{get:function(){return this._.queue.length}},maxRemain:{set:function(b){"number"===typeof b&&0<b&&(this._.maxRemain=b)},get:function(){return this._.maxRemain}},isEmpty:{get:function(){return 0===this._.queue.length}},currentTime:{get:function(){return this._.currentTime}}});
c.sched=function(b,c){"string"===typeof b&&(b=h(b));"number"===typeof b&&this.schedAbs(this._.currentTime+b,c);return this};c.schedAbs=function(b,c){"string"===typeof b&&(b=h(b));if("number"===typeof b){var d=this._,a=d.queue;if(a.length>=d.maxRemain)return this;for(d=a.length;d--&&!(a[d][0]<b););a.splice(d+1,0,[b,k(c)])}return this};c.advance=function(b){"string"===typeof b&&(b=h(b));"number"===typeof b&&(this._.currentTime+=b);return this};c.clear=function(){this._.queue.splice(0);return this};
c.process=function(b){var c=this._;if(this.tickID!==b){this.tickID=b;var b=null,d=c.queue;if(d.length)for(;d[0][0]<c.currentTime;)if(c.queue.shift()[1].bang(),b="sched",0===d.length){b="empty";break}c.currentTime+=f.currentTimeIncr;b&&c.emit(b)}return this};f.register("schedule",i);f.alias("sche","schedule")})(timbre);
(function(k){function i(b){k.Object.call(this,2,b);f.listener(this);f.fixAR(this);b=this._;b.samples=0;b.writeIndex=0;b.plotFlush=!0;this.once("init",c)}var f=k.fn,h=k.timevalue;f.extend(i);var c=function(){this._.buffer||(this.size=1024);this._.interval||(this.interval=1E3)},b=i.prototype;Object.defineProperties(b,{size:{set:function(b){var a=this._;!a.buffer&&"number"===typeof b&&(a.buffer=new f.SignalArray(64>b?64:2048<b?2048:b),a.reservedinterval&&(this.interval=a.reservedinterval,a.reservedinterval=
null))},get:function(){return this._.buffer.length}},interval:{set:function(b){var a=this._;"string"===typeof b&&(b=h(b));"number"===typeof b&&0<b&&(a.buffer?(a.interval=b,a.samplesIncr=0.001*b*a.samplerate/a.buffer.length,1>a.samplesIncr&&(a.samplesIncr=1)):a.reservedinterval=b)},get:function(){return this._.interval}}});b.bang=function(){for(var b=this._,a=b.buffer,e=0,c=a.length;e<c;++e)a[e]=0;b.samples=0;b.writeIndex=0;this._.emit("bang");return this};b.process=function(b){var a=this._;if(this.tickID!==
b){this.tickID=b;f.inputSignalAR(this);f.outputSignalAR(this);var b=this.cells[0],e,c=a.cellsize,g=a.samples,h=a.samplesIncr,i=a.buffer,k=a.writeIndex,t=!1,m=i.length;for(e=0;e<c;++e)0>=g&&(i[k++]=b[e],k>=m&&(k=0),t=a.plotFlush=!0,g+=h),--g;a.samples=g;a.writeIndex=k;t&&this._.emit("data")}return this};var g=k.Object.prototype.plot;b.plot=function(b){var a=this._;if(a.plotFlush){for(var e=a.buffer,c=e.length-1,f=new Float32Array(e.length),h=a.writeIndex,i=0,k=e.length;i<k;i++)f[i]=e[++h&c];a.plotData=
f;a.plotFlush=null}return g.call(this,b)};f.register("scope",i)})(timbre);
(function(k){function i(d){k.Object.call(this,2,d);c.fixAR(this);d=this._;d.numberOfInputs=0;d.numberOfOutputs=0;d.bufferSize=0;d.bufferMask=0;d.duration=0;d.inputBufferL=null;d.inputBufferR=null;d.outputBufferL=null;d.outputBufferR=null;d.onaudioprocess=null;d.index=0;this.once("init",b)}function f(b,a){this.samplerate=b._.samplerate;this.length=b._.bufferSize;this.duration=b._.duration;this.numberOfChannels=a.length;this.getChannelData=function(b){return a[b]}}function h(b){var a=b._;this.node=
b;this.playbackTime=k.currentTime;this.inputBuffer=2===a.numberOfInputs?new f(b,[a.inputBufferL,a.inputBufferR]):new f(b,[a.inputBufferL]);this.outputBuffer=2===a.numberOfOutputs?new f(b,[a.outputBufferL,a.outputBufferR]):new f(b,[a.outputBufferL])}var c=k.fn;c.extend(i);var b=function(){var b=this._;0===b.numberOfInputs&&(this.numberOfInputs=1);0===b.numberOfOutputs&&(this.numberOfOutputs=1);0===b.bufferSize&&(this.bufferSize=1024)},g=i.prototype;Object.defineProperties(g,{numberOfInputs:{set:function(b){var a=
this._;0===a.numberOfInputs&&(a.numberOfInputs=2===b?2:1)},get:function(){return this._.numberOfInputs}},numberOfOutputs:{set:function(b){var a=this._;0===a.numberOfOutputs&&(a.numberOfOutputs=2===b?2:1)},get:function(){return this._.numberOfOutputs}},bufferSize:{set:function(b){var a=this._;0===a.bufferSize&&-1!==[256,512,1024,2048,4096,8192,16384].indexOf(b)&&(a.bufferSize=b,a.bufferMask=b-1,a.duration=b/a.samplerate,a.inputBufferL=new c.SignalArray(b),a.inputBufferR=new c.SignalArray(b),a.outputBufferL=
new c.SignalArray(b),a.outputBufferR=new c.SignalArray(b))},get:function(){return this._.bufferSize}},onaudioprocess:{set:function(b){"function"===typeof b&&(this._.onaudioprocess=b)},get:function(){return this._.onaudioprocess}}});g.process=function(b){var a=this._;if(this.tickID!==b){this.tickID=b;var b=a.cellsize,e=a.bufferMask,f=a.index,g=f+b,i,k=this.cells[1],s=this.cells[2];c.inputSignalAR(this);if(2===a.numberOfInputs)a.inputBufferL.set(k,f),a.inputBufferR.set(s,f);else{i=a.inputBufferL;for(var t=
0;t<b;t++)i[f+t]=0.5*(k[t]+s[t])}k.set(a.outputBufferL.subarray(f,g));s.set(a.outputBufferR.subarray(f,g));a.index=g&e;0===a.index&&a.onaudioprocess&&(a.onaudioprocess(new h(this)),1===a.numberOfOutputs&&a.outputBufferR.set(a.outputBufferL));c.outputSignalAR(this)}return this};c.register("script",i)})(timbre);
(function(k){function i(c){k.Object.call(this,2,c);this._.selected=0;this._.background=!1}var f=k.fn;f.extend(i);var h=i.prototype;Object.defineProperties(h,{selected:{set:function(c){"number"===typeof c&&(this._.selected=c,this.cells[1].set(f.emptycell),this.cells[2].set(f.emptycell))},get:function(){return this._.selected}},background:{set:function(c){this._.background=!!c},get:function(){return this._.background}}});h.process=function(c){var b=this._;if(this.tickID!==c){this.tickID=c;var g=this.nodes,
d,a=g.length;if(b.background)for(d=0;d<a;++d)g[d].process(c);if(g=g[b.selected])b.background||g.process(c),this.cells[1].set(g.cells[1]),this.cells[2].set(g.cells[2]);f.outputSignalAR(this)}return this};f.register("selector",i)})(timbre);
(function(k){function i(a){k.Object.call(this,2,a);f.listener(this);f.fixAR(this);a=this._;a.status=b;a.samples=0;a.samplesIncr=0;a.writeIndex=0;a.plotFlush=!0;a.plotRange=[0,32];a.plotBarStyle=!0;this.once("init",g)}var f=k.fn,h=k.timevalue,c=k.modules.FFT,b=0;f.extend(i);var g=function(){var a=this._;a.fft||(this.size=512);a.interval||(this.interval=500)},d=i.prototype;Object.defineProperties(d,{size:{set:function(a){var b=this._;if(!b.fft&&"number"===typeof a&&(b.fft=new c(256>a?256:2048<a?2048:
a),b.buffer=new f.SignalArray(b.fft.length),b.freqs=new f.SignalArray(b.fft.length>>1),b.reservedwindow&&(b.fft.setWindow(b.reservedwindow),b.reservedwindow=null),b.reservedinterval))this.interval=b.reservedinterval,b.reservedinterval=null},get:function(){return this._.buffer.length}},window:{set:function(a){this._.fft.setWindow(a)},get:function(){return this._.fft.windowName}},interval:{set:function(a){var b=this._;"string"===typeof a&&(a=h(a));"number"===typeof a&&0<a&&(b.buffer?(b.interval=a,b.samplesIncr=
0.001*a*b.samplerate,b.samplesIncr<b.buffer.length&&(b.samplesIncr=b.buffer.length,b.interval=1E3*b.samplesIncr/b.samplerate)):b.reservedinterval=a)},get:function(){return this._.interval}},spectrum:{get:function(){return this._.fft.getFrequencyData(this._.freqs)}},real:{get:function(){return this._.fft.real}},imag:{get:function(){return this._.fft.imag}}});d.bang=function(){this._.samples=0;this._.writeIndex=0;this._.emit("bang");return this};d.process=function(a){var c=this._;if(this.tickID!==a){this.tickID=
a;f.inputSignalAR(this);f.outputSignalAR(this);var a=this.cells[0],d,g=a.length,h=c.status,i=c.samples,k=c.samplesIncr,m=c.writeIndex,p=c.buffer,q=p.length,r;for(d=0;d<g;++d)0>=i&&h===b&&(h=1,m=0,i+=k),1===h&&(p[m++]=a[d],q<=m&&(c.fft.forward(p),r=c.plotFlush=!0,h=b)),--i;c.samples=i;c.status=h;c.writeIndex=m;r&&this._.emit("data")}return this};var a=k.Object.prototype.plot;d.plot=function(b){this._.plotFlush&&(this._.plotData=this.spectrum,this._.plotFlush=null);return a.call(this,b)};f.register("spectrum",
i)})(timbre);
(function(k){function i(f){k.Object.call(this,2,f);this._.ar=!1}var f=k.fn;f.extend(i);i.prototype.process=function(h){var c=this._;if(this.tickID!==h){this.tickID=h;var b=this.nodes,g=this.cells[0],d=this.cells[1],a=this.cells[2],e,j=b.length,i=g.length,k;if(c.ar){if(0<b.length){b[0].process(h);c=b[0].cells[1];k=b[0].cells[2];d.set(c);a.set(k);for(e=1;e<j;++e){b[e].process(h);c=b[e].cells[1];k=b[e].cells[2];for(g=0;g<i;++g)d[g]-=c[g],a[g]-=k[g]}}else for(g=0;g<i;++g)d[g]=a[e]=0;f.outputSignalAR(this)}else{if(0<b.length){d=
b[0].process(h).cells[0][0];for(e=1;e<j;++e)d-=b[e].process(h).cells[0][0]}else d=0;g[0]=d;f.outputSignalKR(this)}}return this};f.register("-",i)})(timbre);
(function(k){function i(a){k.Object.call(this,2,a);f.fixAR(this);a=this._;this.playbackState=f.FINISHED_STATE;a.poly=4;a.genList=[];a.genDict={};a.synthdef=null;a.remGen=b(this);a.onended=f.make_onended(this)}var f=k.fn;f.extend(i);var h=i.prototype;Object.defineProperties(h,{def:{set:function(a){"function"===typeof a&&(this._.synthdef=a)},get:function(){return this._.synthdef}},poly:{set:function(a){"number"===typeof a&&(0<a&&64>=a)&&(this._.poly=a)},get:function(){return this._.poly}}});var c=function(a,
b){return function(){a._.remGen(b.gen)}},b=function(a){return function(b){var c=a._,d=c.genList.indexOf(b);-1!==d&&c.genList.splice(d,1);c.genDict[b.noteNum]=null}},g=function(a,b,d,g){d|=0;0>=d?this.noteOff(this,a):127<d&&(d=127);var h=this._,i=h.genList,t=h.genDict,m=t[a];m&&h.remGen(m);b={freq:b,noteNum:a,velocity:d};if(g)for(var p in g)b[p]=g[p];b.doneAction=c(this,b);m=this._.synthdef.call(this,b);m instanceof k.Object&&(m.noteNum=a,i.push(m),t[a]=b.gen=m,this.playbackState=f.PLAYING_STATE,i.length>
h.poly&&h.remGen(i[0]))},d=function(){for(var a=new Float32Array(128),b=0;128>b;++b)a[b]=440*Math.pow(2,1*(b-69)/12);return a}();h.noteOn=function(a,b,c){var f=d[a]||440*Math.pow(2,(a-69)/12);g.call(this,a+0.5|0,f,b,c);return this};h.noteOff=function(a){(a=this._.genDict[a])&&a.release&&a.release();return this};h.noteOnWithFreq=function(a,b,c){var d=0<a?12*Math.log(1*a/440)*Math.LOG2E+69:0;g.call(this,d+0.5|0,a,b,c);return this};h.noteOffWithFreq=function(a){return this.noteOff((0<a?12*Math.log(1*
a/440)*Math.LOG2E+69:0)+0.5|0)};h.allNoteOff=function(){for(var a=this._.genList,b=0,c=a.length;b<c;++b)a[b].release&&a[b].release()};h.allSoundOff=function(){for(var a=this._,b=a.genList,a=a.genDict;b.length;)delete a[b.shift().noteNum]};h.process=function(a){var b=this.cells[0],c=this._;if(this.tickID!==a){this.tickID=a;if(this.playbackState===f.PLAYING_STATE){var d=c.genList,g,h=this.cells[1],i=this.cells[2],k,b=b.length,p,q;if(d.length){g=d[0];g.process(a);h.set(g.cells[1]);i.set(g.cells[2]);
c=1;for(k=d.length;c<k;++c){g=d[c];g.process(a);p=g.cells[1];q=g.cells[2];for(g=0;g<b;++g)h[g]+=p[g],i[g]+=q[g]}}else f.nextTick(c.onended)}f.outputSignalAR(this)}return this};f.register("SynthDef",i);var a={set:function(a){f.isDictionary(a)?"string"===typeof a.type&&(this._.env=a):a instanceof k.Object&&(this._.env=a)},get:function(){return this._.env}};f.register("OscGen",function(){var b={set:function(a){"string"===typeof a&&(this._.wave=a)},get:function(){return this._.wave}},c=function(a){var b=
this._,c,d;c=b.env||{};d=c.type||"perc";b=k("osc",{wave:b.wave,freq:a.freq,mul:a.velocity/128});c instanceof k.Object?"function"===typeof c.clone&&(b=c.clone().append(b)):b=k(d,c,b);b.on("ended",a.doneAction).bang();return b};return function(d){d=new i(d);d._.wave="sin";Object.defineProperties(d,{env:a,wave:b});d.def=c;return d}}());f.register("PluckGen",function(){var b=function(a){var b,c,d;c=this._.env||{};d=c.type||"perc";b=k("pluck",{freq:a.freq,mul:a.velocity/128}).bang();c instanceof k.Object?
"function"===typeof c.clone&&(b=c.clone().append(b)):b=k(d,c,b);b.on("ended",a.doneAction).bang();return b};return function(c){c=new i(c);Object.defineProperties(c,{env:a});c.def=b;return c}}())})(timbre);
(function(k){function i(a){k.Object.call(this,2,a);f.fixAR(this);a=this._;a.isLooped=!1;a.onended=f.make_onended(this,0)}var f=k.fn,h=k.modules.Scissor,c=h.Tape,b=h.TapeStream,g=f.isSignalArray;f.extend(i);var d=i.prototype;Object.defineProperties(d,{tape:{set:function(a){a instanceof c?(this.playbackState=f.PLAYING_STATE,this._.tape=a,this._.tapeStream=new b(a,this._.samplerate)):"object"===typeof a&&(Array.isArray(a.buffer)&&g(a.buffer[0]))&&(this.playbackState=f.PLAYING_STATE,this._.tape=new h(a),
this._.tapeStream=new b(a,this._.samplerate))},get:function(){return this._.tape}},isLooped:{get:function(){return this._.isLooped}}});d.loop=function(a){this._.isLooped=!!a;this._.tapeStream&&(this._.tapeStream.isLooped=this._.isLooped);return this};d.bang=function(){this.playbackState=f.PLAYING_STATE;this._.tapeStream&&this._.tapeStream.reset();this._.emit("bang");return this};d.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;if(a=b.tapeStream){var c=this.cells[1],d=this.cells[2],
g=a.fetch(c.length);c.set(g[0]);d.set(g[1]);this.playbackState===f.PLAYING_STATE&&a.isEnded&&f.nextTick(b.onended)}f.outputSignalAR(this)}return this};f.register("tape",i)})(timbre);
(function(k){function i(d){k.Object.call(this,0,d);f.timer(this);f.fixKR(this);d=this._;this.playbackState=f.FINISHED_STATE;d.currentTime=0;d.samplesMax=0;d.samples=0;d.onended=f.make_onended(this);this.once("init",c);this.on("start",b)}var f=k.fn,h=k.timevalue;f.extend(i);var c=function(){this._.timeout||(this.timeout=1E3)},b=function(){this.playbackState=f.PLAYING_STATE};Object.defineProperty(b,"unremovable",{value:!0,writable:!1});var g=i.prototype;Object.defineProperties(g,{timeout:{set:function(b){var a=
this._;"string"===typeof b&&(b=h(b));"number"===typeof b&&0<=b&&(this.playbackState=f.PLAYING_STATE,a.timeout=b,a.samplesMax=a.samplerate*0.001*b|0,a.samples=a.samplesMax)},get:function(){return this._.timeout}},currentTime:{get:function(){return this._.currentTime}}});g.bang=function(){var b=this._;this.playbackState=f.PLAYING_STATE;b.samples=b.samplesMax;b.currentTime=0;b.emit("bang");return this};g.process=function(b){var a=this.cells[0],c=this._;if(this.tickID!==b){this.tickID=b;0<c.samples&&
(c.samples-=a.length);if(0>=c.samples){for(var b=this.nodes,a=0,g=b.length;a<g;++a)b[a].bang();f.nextTick(c.onended)}c.currentTime+=f.currentTimeIncr}return this};f.register("timeout",i)})(timbre);
(function(k){function i(c){k.Object.call(this,1,c);f.fixAR(this);this._.curve=null}var f=k.fn;f.extend(i);var h=i.prototype;Object.defineProperties(h,{curve:{set:function(c){f.isSignalArray(c)&&(this._.curve=c)},get:function(){return this._.curve}}});h.process=function(c){var b=this._;if(this.tickID!==c){this.tickID=c;f.inputSignalAR(this);if(b.curve){var c=this.cells[0],g=b.curve,d=g.length,a,e=b.cellsize;for(a=0;a<e;++a)b=0.5*(c[a]+1)*d+0.5|0,0>b?b=0:b>=d-1&&(b=d-1),c[a]=g[b]}f.outputSignalAR(this)}return this};
f.register("waveshaper",i)})(timbre);
(function(k){function i(b){k.Object.call(this,1,b);b=this._;b.inMin=0;b.inMax=1;b.outMin=0;b.outMax=1;b.ar=!1;this.once("init",h)}var f=k.fn;f.extend(i);var h=function(){this._.warp||(this.warp="linlin")},c=i.prototype;Object.defineProperties(c,{inMin:{set:function(b){"number"===typeof b&&(this._.inMin=b)},get:function(){return this._.inMin}},inMax:{set:function(b){"number"===typeof b&&(this._.inMax=b)},get:function(){return this._.inMax}},outMin:{set:function(b){"number"===typeof b&&(this._.outMin=
b)},get:function(){return this._.outMin}},outMax:{set:function(b){"number"===typeof b&&(this._.outMax=b)},get:function(){return this._.outMax}},warp:{set:function(c){if("string"===typeof c){var d=b[c];d&&(this._.warp=d,this._.warpName=c)}},get:function(){return this._.warpName}}});c.process=function(b){var c=this._,a=this.cells[0];if(this.tickID!==b){this.tickID=b;var e=c.inMin,h=c.inMax,i=c.outMin,k=c.outMax,n=c.warp,s=this.nodes.length,t=c.mul,m=c.add,b=a.length;if(c.ar&&s){f.inputSignalAR(this);
for(c=0;c<b;++c)a[c]=n(a[c],e,h,i,k)*t+m;f.outputSignalAR(this)}else{c=this.nodes.length?f.inputSignalKR(this):0;e=n(c,e,h,i,k)*t+m;for(c=0;c<b;++c)a[c]=e}}return this};var b={linlin:function(b,c,a,e,f){return b<c?e:b>a?f:a===c?e:(b-c)/(a-c)*(f-e)+e},linexp:function(b,c,a,e,f){return b<c?e:b>a?f:0===e?0:a===c?f:Math.pow(f/e,(b-c)/(a-c))*e},explin:function(b,c,a,e,f){return b<c?e:b>a?f:0===c?f:Math.log(b/c)/Math.log(a/c)*(f-e)+e},expexp:function(b,c,a,e,f){return b<c?e:b>a?f:0===c||0===e?0:Math.pow(f/
e,Math.log(b/c)/Math.log(a/c))*e}};f.register("zmap",i)})(timbre);
