(function(h){var i=Array.prototype.slice,f=Array.isArray,j=function(a){return"object"===typeof a&&a.constructor===Object},d=0,b=null,g={},a={},e="undefined"!==typeof module&&module.exports?"node":"undefined"!==typeof window?"browser":"unknown",c;c="browser"===e&&/(iPhone|iPad|iPod|Android)/i.test(navigator.userAgent)?!0:!1;var l={},k=function(){var c=i.call(arguments),e=c[0],b;switch(typeof e){case "string":g[e]?b=new g[e](c.slice(1)):a[e]?b=a[e](c.slice(1)):console.warn('T("'+e+'") is not defined.');
break;case "number":b=new B(c);break;case "boolean":b=new z(c);break;case "function":b=new E(c);break;case "object":if(null!==e){if(e instanceof w)return e;if(e.context instanceof w)return e.context;e.constructor===Object?b=new x(c):f(e)&&(b=new y(c))}}b===h?(b=new B([0]),b._.isUndefined=!0):b._.isUndefined=!1;b.isStereo===h&&Object.defineProperty(b,"isStereo",{value:!1,writable:!1});b._.originkey=e;for(var c=b._,e=b._.meta,l,k,d=b;null!==d&&d.constructor!==Object;){l=Object.getOwnPropertyNames(d);
for(var m=l.length;m--;)if(!e[l[m]])if(/^(constructor$|process$|_)/.test(l[m]))e[l[m]]="ignore";else if(k=Object.getOwnPropertyDescriptor(d,l[m]),"function"===typeof k.value)e[l[m]]="function";else if(k.get||k.set)e[l[m]]="property";d=Object.getPrototypeOf(d)}c.meta=e;b._.emit("init");return b}.bind(null),m=k.fn={},t=k.modules={};(function(){var c={};t.ready=function(a,e){c[a]=e};t.ready.done=function(a,e){var b=c[a];b&&b(e);delete c[a]}})();Object.defineProperties(k,{version:{get:function(){return"13.02.06"}},
envtype:{get:function(){return e}},envmobile:{get:function(){return c}},env:{get:function(){return b.impl.env}},samplerate:{get:function(){return b.samplerate}},channels:{get:function(){return b.channels}},cellsize:{get:function(){return b.cellsize}},currentTime:{get:function(){return b.currentTime}},isPlaying:{get:function(){return 1===b.status}},isRecording:{get:function(){return 2===b.status}},amp:{set:function(c){"number"===typeof c&&(b.amp=c)},get:function(){return b.amp}}});k.bind=function(c,
a){b.bind(c,a);return k};k.setup=function(c){b.setup(c);return k};k.play=function(){b.play();return k};k.pause=function(){b.pause();return k};k.reset=function(){b.reset();b.events.emit("reset");return k};k.on=function(c,a){b.on(c,a);return k};k.addListener=k.on;k.once=function(c,a){b.once(c,a);return k};k.off=function(c,a){b.removeListener(c,a);return k};k.removeListener=k.off;k.removeAllListeners=function(c){b.removeAllListeners(c);return k};k.listeners=function(c){return b.listeners(c)};k.rec=function(){return b.rec.apply(b,
arguments)};k.use=function(c){f(l[c])&&l[c].forEach(function(c){c()});return this};k.timevalue=function(c){var a;if(a=/^(\d+(?:\.\d+)?)Hz$/i.exec(c))return 0===+a[1]?0:1E3/+a[1];if(a=/^bpm(\d+(?:\.\d+)?)?\s*(?:l(\d+))?(\.*)$/i.exec(c)){c=a[1];if(c===h)c=120;else if(c=+a[1],5>c||300<c)c=120;var e=a[2]?a[2]|0:4;return 0===c||0===e?0:a=1E3*(60/c*(4/e))*([1,1.5,1.75,1.875][(a[3]||"").length]||1)}if(a=/^bpm(\d+(?:\.\d+)?)?\s*(\d+)\.(\d+)\.(\d+)$/i.exec(c)){c=a[1];if(c===h)c=120;else if(c=+a[1],5>c||300<
c)c=120;a=1920*(a[2]|0)+480*(a[3]|0)+(a[4]|0);return 1E3*60/c*(a/480)}if(a=/^(\d+(?:\.\d+)?)secs?$/i.exec(c))return 1E3*+a[1];if(a=/^(\d+(?:\.\d+)?)mins?$/i.exec(c))return 6E4*+a[1];if(a=/^(?:([0-5]?[0-9]):)?(?:([0-5]?[0-9]):)(?:([0-5]?[0-9]))(?:\.([0-9]{1,3}))?$/.exec(c))return c=3600*(a[1]|0)+60*(a[2]|0)+(a[3]|0),c=1E3*c+(((a[4]||"")+"00").substr(0,3)|0);if(a=/^bpm(\d+(?:\.\d+)?)?\s*(?:(\d+)ticks)?$/i.exec(c)){c=a[1];if(c===h)c=120;else if(c=+a[1],5>c||300<c)c=120;a=a[2]?a[2]|0:480;return 0===c?
0:1E3*60/c*(a/480)}return(a=/^(\d+)samples(?:\/(\d+)Hz)?$/i.exec(c))?(c=a[2]?a[2]|0:k.samplerate,0===c?0:1E3*((a[1]|0)/c)):(a=/^(\d+)(?:ms)?$/i.exec(c))?a[1]|0:0};m.use=function(c,a){f(l[c])?l[c].push(a):l[c]=[a]};m.isDictionary=j;var s=function(){return this};m.nop=s;var r=function(c,a){function e(){this.constructor=c}var a=a||w,b;for(b in a)a.hasOwnProperty(b)&&(c[b]=a[b]);e.prototype=a.prototype;c.prototype=new e;c.__super__=a.prototype;return c};m.extend=r;var n=function(c,a){for(var e=c&&c.prototype;e;){if(e===
a.prototype)return!0;e=Object.getPrototypeOf(e)}return!1};m.constructorof=n;m.register=function(c,e){n(e,w)?g[c]=e:a[c]=e};m.alias=function(c,e){g[e]?g[c]=g[e]:a[e]&&(a[c]=a[e])};m.getClass=function(c){return g[c]};m.nextTick=function(c){b.nextTick(c);return k};var o=function(c){c._.ar=!0;c._.aronly=!0};m.fixAR=o;var p=function(c){c._.ar=!1;c._.kronly=!0};m.fixKR=p;var q=function(){var c=this._,c=c.value*c.mul+c.add;isNaN(c)&&(c=0);for(var a=this.cell,e=a.length;e--;)a[e]=c};Object.defineProperty(q,
"unremovable",{value:!0,writable:!1});m.changeWithValue=q;var u=function(c){c.L=new A(c);c.R=new A(c);c.cellL=c.L.cell;c.cellR=c.R.cell;Object.defineProperty(c,"isStereo",{value:!0,writable:!1})};m.stereo=u;var v=function(){var c=function(){b.nextTick(a.bind(this));return this},a=function(){-1===b.timers.indexOf(this)&&(b.timers.push(this),b.events.emit("addObject"),this._.emit("start"))},e=function(){b.nextTick(l.bind(this));return this},l=function(){var c=b.timers.indexOf(this);-1!==c&&(b.timers.splice(c,
1),this._.emit("stop"),b.events.emit("removeObject"))};return function(a){a.start=c;a.stop=e;return a}}();m.timer=v;v=function(){var c=function(){arguments.length&&this.append.apply(this,arguments);this.inputs.length&&b.nextTick(a.bind(this));return this},a=function(){-1===b.listeners.indexOf(this)&&(b.listeners.push(this),b.events.emit("addObject"),this._.emit("listen"))},e=function(){arguments.length&&this.remove.apply(this,arguments);this.inputs.length||b.nextTick(l.bind(this));return this},l=
function(){var c=b.listeners.indexOf(this);-1!==c&&(b.listeners.splice(c,1),this._.emit("unlisten"),b.events.emit("removeObject"))};return function(a){a.listen=c;a.unlisten=e;return a}}();m.listener=v;m.onended=function(c,a){var e=c.cell,b,l;c.isStereo?(b=c.cellL,l=c.cellR):b=l=e;if("number"===typeof a)for(var k=e.length;k--;)b[k]=l[k]=e[k]=a;c._.isEnded=!0;c._.emit("ended")};m.inputSignalAR=function(c){var a=c.cell,e=c.inputs,b=e.length,l,k=a.length,g=c.tickID,d;for(l=k;l;)l-=8,a[l]=a[l+1]=a[l+2]=
a[l+3]=a[l+4]=a[l+5]=a[l+6]=a[l+7]=0;for(c=0;c<b;++c){d=e[c].process(g);for(l=k;l;)l-=8,a[l]+=d[l],a[l+1]+=d[l+1],a[l+2]+=d[l+2],a[l+3]+=d[l+3],a[l+4]+=d[l+4],a[l+5]+=d[l+5],a[l+6]+=d[l+6],a[l+7]+=d[l+7]}};m.inputSignalKR=function(c){for(var a=c.inputs,e=a.length,b=c.tickID,l=0,c=0;c<e;++c)l+=a[c].process(b)[0];return l};m.outputSignalAR=function(c){var a=c._.mul,e=c._.add;if(1!==a||0!==e)for(var c=c.cell,b=c.length;b;)b-=8,c[b]=c[b]*a+e,c[b+1]=c[b+1]*a+e,c[b+2]=c[b+2]*a+e,c[b+3]=c[b+3]*a+e,c[b+4]=
c[b+4]*a+e,c[b+5]=c[b+5]*a+e,c[b+6]=c[b+6]*a+e,c[b+7]=c[b+7]*a+e};m.outputSignalKR=function(c){for(var a=c.cell,c=a[0]*c._.mul+c._.add,e=a.length;e;)e-=8,a[e]=a[e+1]=a[e+2]=a[e+3]=a[e+4]=a[e+5]=a[e+6]=a[e+7]=c};m.fix_iOS6_1_problem=function(c){b.fix_iOS6_1_problem(c)};var w=function(){function c(a){this._={};this._.events=new t.EventEmitter(this);this._.emit=this._.events.emit.bind(this._.events);if(j(a[0])){var e=a.shift();this.once("init",function(){this.set(e)})}this.tickID=-1;this.cell=new Float32Array(b.cellsize);
this.inputs=a.map(k);this._.ar=!0;this._.mul=1;this._.add=0;this._.dac=null;this._.bypassed=!1;this._.meta={}}var a=c.prototype;Object.defineProperties(a,{isUndefined:{get:function(){return this._.isUndefined}},isAr:{get:function(){return this._.ar}},isKr:{get:function(){return!this._.ar}},isBypassed:{get:function(){return this._.bypassed}},mul:{set:function(c){"number"===typeof c&&(this._.mul=c,this._.emit("setMul",c))},get:function(){return this._.mul}},add:{set:function(c){"number"===typeof c&&
(this._.add=c,this._.emit("setAdd",c))},get:function(){return this._.add}},dac:{set:function(c){var a=this._;c instanceof C&&a.dac!==c&&(a.dac&&a.dac.remove(this),c.append(this))},get:function(){return this._.dac}}});a.toString=function(){return this.constructor.name};a.valueOf=function(){b.tickID!==this.tickID&&this.process(b.tickID);return this.cell[0]};a.append=function(){if(0<arguments.length){var c=i.call(arguments).map(k);this.inputs=this.inputs.concat(c);this._.emit("append",c)}return this};
a.appendTo=function(c){c.append(this);return this};a.remove=function(){if(0<arguments.length){for(var c,a=this.inputs,e=[],b=0,l=arguments.length;b<l;++b)if(-1!==(c=a.indexOf(arguments[b])))e.push(a[c]),a.splice(c,1);0<e.length&&this._.emit("remove",e)}return this};a.removeFrom=function(c){c.remove(this);return this};a.removeAll=function(){var c=this.inputs.slice();this.inputs=[];0<c.length&&this._.emit("remove",c);return this};a.removeAtIndex=function(c){var a=this.inputs[c];a&&(this.inputs.splice(c,
1),this._.emit("remove",[a]));return this};a.on=a.addListener=function(c,a){this._.events.on(c,a);return this};a.once=function(c,a){this._.events.once(c,a);return this};a.off=a.removeListener=function(c,a){this._.events.removeListener(c,a);return this};a.removeAllListeners=function(c){this._.events.removeAllListeners(c);return this};a.listeners=function(c){return this._.events.listeners(c)};a.set=function(c,a){var e,b,l=this._.meta;switch(typeof c){case "string":switch(l[c]){case "property":this[c]=
a;break;case "function":this[c](a);break;default:for(e=this;null!==e;){if(b=Object.getOwnPropertyDescriptor(e,c))if("function"===typeof b.value)l[c]="function",this[c](a);else if(b.get||b.set)l[c]="property",this[c]=a;e=Object.getPrototypeOf(e)}}break;case "object":for(e in c)this.set(e,c[e])}return this};a.get=function(c){if("property"===this._.meta[c])return this[c]};a.bang=function(){this._.emit.apply(this,["bang"].concat(i.call(arguments)));return this};a.process=function(){return this.cell};
a.bypass=function(){this._.bypassed=0===arguments.length?!0:!!arguments[0];return this};a.play=function(){var c=this._.dac,a=!1;null===c?(c=this._.dac=new C(this),a=!0):-1===c.inputs.indexOf(this)&&(c.append(this),a=!0);c.play();a&&this._.emit.apply(this,["play"].concat(i.call(arguments)));return this};a.pause=function(){var c=this._.dac;c&&(-1!==c.inputs.indexOf(this)&&(this._.dac=null,c.remove(this),this._.emit("pause")),0===c.inputs.length&&c.pause());return this};a.start=a.stop=a.listen=a.unlisten=
function(){return this};a.ar=function(){0===arguments.length||arguments[0]?this._.kronly||(this._.ar=!0,this._.emit("ar",!0)):this.kr(!0);return this};a.kr=function(){0===arguments.length||arguments[0]?this._.aronly||(this._.ar=!1,this._.emit("ar",!1)):this.ar(!0);return this};a.plot="browser"===e?function(c){var a=this._,e=c.target;if(!e)return this;var b=c.width||e.width||320,l=c.height||e.height||240,k=(c.x||0)+0.5,g=c.y||0,e=e.getContext("2d"),d;d=c.foreground!==h?c.foreground:a.plotForeground||
"rgb(  0, 128, 255)";var m;m=c.background!==h?c.background:a.plotBackground||"rgb(255, 255, 255)";var t=c.lineWidth||a.plotLineWidth||1,f=!!a.plotCyclic,s=a.plotData||this.cell,j=c.range||a.plotRange||[-1.2,1.2],i=j[0],j=l/(j[1]-i),r=b/s.length,n,o=s.length;e.save();e.rect(k,g,b,l);null!==m&&(e.fillStyle=m,e.fillRect(k,g,b,l));a.plotBefore&&a.plotBefore.call(this,e,k,g,b,l);if(a.plotBarStyle){e.fillStyle=d;for(m=d=0;m<o;++m)f=(s[m]-i)*j,n=l-f,e.fillRect(d+k,n+g,r,f),d+=r}else{e.strokeStyle=d;e.lineWidth=
t;e.beginPath();d=0;t=l-(s[0]-i)*j;e.moveTo(d+k,t+g);for(m=1;m<o;++m)d+=r,n=l-(s[m]-i)*j,e.lineTo(d+k,n+g);f?e.lineTo(d+r+k,t+g):e.lineTo(d+r+k,n+g);e.stroke()}a.plotAfter&&a.plotAfter.call(this,e,k,g,b,l);if(c=c.border||a.plotBorder)e.strokeStyle="string"===typeof c?c:"#000",e.lineWidth=1,e.strokeRect(k,g,b,l);e.restore();return this}:s;return c}();k.Object=w;var A=function(){function c(a){k.Object.call(this,[]);o(this);this._.parent=a}r(c);c.prototype.process=function(c){this.tickID!==c&&(this.tickID=
c,this._.parent.process(c));return this.cell};return c}();k.ChannelObject=A;var B=function(){function c(a){w.call(this,[]);p(this);this.value=a[0];if(j(a[1])){var e=a[1];this.once("init",function(){this.set(e)})}this.on("setAdd",q);this.on("setMul",q)}r(c);Object.defineProperties(c.prototype,{value:{set:function(c){"number"===typeof c&&(this._.value=isNaN(c)?0:c,q.call(this))},get:function(){return this._.value}}});return c}(),z=function(){function c(a){w.call(this,[]);p(this);this.value=a[0];if(j(a[1])){var e=
a[1];this.once("init",function(){this.set(e)})}this.on("setAdd",q);this.on("setMul",q)}r(c);Object.defineProperties(c.prototype,{value:{set:function(c){this._.value=c?1:0;q.call(this)},get:function(){return!!this._.value}}});return c}(),E=function(){function c(a){w.call(this,[]);p(this);this.func=a[0];this._.value=0;if(j(a[1])){var e=a[1];this.once("init",function(){this.set(e)})}this.on("setAdd",q);this.on("setMul",q)}r(c);var a=c.prototype;Object.defineProperties(a,{func:{set:function(c){"function"===
typeof c&&(this._.func=c)},get:function(){return this._.func}},args:{set:function(c){this._.args=f(c)?c:[c]},get:function(){return this._.args}}});a.bang=function(){var c=this._,a=i.call(arguments).concat(c.args),a=c.func.apply(this,a);"number"===typeof a&&(c.value=a,q.call(this));this._.emit("bang");return this};return c}(),y=function(){function c(a){w.call(this,[]);p(this);if(j(a[1])){var e=a[1];this.once("init",function(){this.set(e)})}}r(c);Object.defineProperties(c.prototype,{});return c}(),
x=function(){function c(a){w.call(this,[]);p(this);if(j(a[1])){var e=a[1];this.once("init",function(){this.set(e)})}}r(c);Object.defineProperties(c.prototype,{});return c}(),C=function(){function c(e){w.call(this,[]);e instanceof w&&this.inputs.push(e);u(this);this._.isPlaying=!1;this.on("append",a)}r(c);var a=function(c){for(var a=c.length;a--;)c[a]._.dac=this};Object.defineProperty(a,"unremovable",{value:!0,writable:!1});var e=c.prototype;Object.defineProperties(e,{dac:{get:s},isPlaying:{get:function(){return this._.isPlaying}}});
e.play=function(){b.nextTick(l.bind(this));return this};var l=function(){-1===b.inlets.indexOf(this)&&(b.inlets.push(this),b.events.emit("addObject"),this._.isPlaying=!0,this._.emit("play"))};e.pause=function(){b.nextTick(k.bind(this));return this};var k=function(){var c=b.inlets.indexOf(this);-1!==c&&(b.inlets.splice(c,1),this._.isPlaying=!1,this._.emit("pause"),b.events.emit("removeObject"))};e.process=function(c){var a=this._,e=this.cell,b=this.cellL,l=this.cellR,k=this.inputs,g,d=k.length,m,t=
e.length,f=a.add,a=a.mul,s,h;if(this.tickID!==c){this.tickID=c;for(m=t;m--;)b[m]=l[m]=e[m]=0;for(g=0;g<d;++g){m=k[g];m.process(c);m.isStereo?(s=m.cellL,h=m.cellR):s=h=m.cell;for(m=t;m--;)b[m]+=s[m],l[m]+=h[m]}for(m=t;m--;)c=b[m]=b[m]*a+f,c+=l[m]=l[m]*a+f,e[m]=0.5*c}return e};return c}(),v=function(){function c(){this._={};this.context=this;this.tickID=0;this.impl=null;this.amp=0.8;this.status=d;this.samplerate=44100;this.channels=2;this.cellsize=128;this.streammsec=20;this.currentTimeIncr=this.currentTime=
this.streamsize=0;this.nextTicks=[];this.inlets=[];this.timers=[];this.listeners=[];this._.deferred=null;this.recStart=0;this.recBuffers=null;t.ready("events",function(){this.events=new t.EventEmitter(this);this.reset()}.bind(this))}var a=[8E3,11025,12E3,16E3,22050,24E3,32E3,44100,48E3],e=[32,64,128,256],b=c.prototype;b.bind=function(c,a){if("function"===typeof c){var e=new c(this,a);"function"===typeof e.play&&"function"===typeof e.pause&&(this.impl=e,this.impl.defaultSamplerate&&(this.samplerate=
this.impl.defaultSamplerate))}return this};b.setup=function(c){if("object"===typeof c&&(-1!==a.indexOf(c.samplerate)&&(this.samplerate=c.samplerate<=this.impl.maxSamplerate?c.samplerate:this.impl.maxSamplerate),-1!==e.indexOf(c.cellsize)))this.cellsize=c.cellsize;return this};b.getAdjustSamples=function(c){c=c||this.samplerate;c=Math.ceil(Math.log(this.streammsec/1E3*c)*Math.LOG2E);return 1<<(8>c?8:14<c?14:c)};b.play=function(){this.status===d&&(this.status=1,this.currentTimeIncr=1E3*this.cellsize/
this.samplerate,this.streamsize=this.getAdjustSamples(),this.strmL=new Float32Array(this.streamsize),this.strmR=new Float32Array(this.streamsize),this.impl.play(),this.events.emit("play"));return this};b.pause=function(){1===this.status&&(this.status=d,this.impl.pause(),this.events.emit("pause"));return this};b.reset=function(c){c&&(this._.events=null);this.currentTime=0;this.nextTicks=[];this.inlets=[];this.timers=[];this.listeners=[];this.events.on("addObject",function(){this.status===d&&(this.inlets.length>
0||this.timers.length>0||this.listeners.length>0)&&this.play()});this.events.on("removeObject",function(){this.status===1&&this.inlets.length===0&&(this.timers.length===0&&this.listeners.length===0)&&this.pause()});return this};b.process=function(){var c=this.tickID,a=this.strmL,e=this.strmR,b=this.amp,k,g,m,d=this.streamsize,t=0,f,s,h,j=this.cellsize,i=this.streamsize/this.cellsize,r=this.timers,n=this.inlets,o=this.listeners,u=this.currentTimeIncr;for(m=d;m--;)a[m]=e[m]=0;for(;i--;){++c;f=0;for(s=
r.length;f<s;++f)r[f].process(c);f=0;for(s=n.length;f<s;++f){k=n[f];k.process(c);g=k.cellL;k=k.cellR;h=0;for(m=t;h<j;++h,++m)a[m]+=g[h],e[m]+=k[h]}t=m;f=0;for(s=o.length;f<s;++f)o[f].process(c);this.currentTime+=u;g=this.nextTicks.splice(0);f=0;for(s=g.length;f<s;++f)g[f].call(null)}for(m=d;m--;)k=a[m]*b,k=-1>k?-1:1<k?1:k,a[m]=k,k=e[m]*b,k=-1>k?-1:1<k?1:k,e[m]=k;this.tickID=c;c=this.currentTime;if(2===this.status){if(2===this.recCh)this.recBuffers.push(new Float32Array(a)),this.recBuffers.push(new Float32Array(e));
else{b=new Float32Array(a.length);for(m=b.length;m--;)b[m]=0.5*(a[m]+e[m]);this.recBuffers.push(b)}c>=this.maxDuration?this._.deferred.sub.reject():c>=this.recDuration?this._.deferred.sub.resolve():20<+new Date-this.recStart?setTimeout(l.bind(this),10):this.process()}};var l=function(){this.recStart=+new Date;this.process()};b.nextTick=function(c){this.status===d?c():this.nextTicks.push(c)};b.rec=function(){m.fix_iOS6_1_problem(!0);var c=new t.Deferred(this);if(this._.deferred)return console.warn("rec deferred is exists??"),
c.reject().promise();if(this.status!==d)return console.log("status is not none",this.status),c.reject().promise();var a=0,e=arguments,b=j(e[a])?e[a++]:{},a=e[a];if("function"!==typeof a)return console.warn("no function"),c.reject().promise();this._.deferred=c;this.status=2;this.reset();var g=new C,f=new t.Deferred(this);f.then(k,function(){m.fix_iOS6_1_problem(!1);k.call(this,!0)}.bind(this));this._.deferred.sub=f;this.savedSamplerate=this.samplerate;this.samplerate=b.samplerate||this.samplerate;
this.recDuration=b.recDuration||Infinity;this.maxDuration=b.maxDuration||6E5;this.recCh=b.ch||1;2!==this.recCh&&(this.recCh=1);this.recBuffers=[];this.currentTimeIncr=1E3*this.cellsize/this.samplerate;this.streamsize=this.getAdjustSamples();this.strmL=new Float32Array(this.streamsize);this.strmR=new Float32Array(this.streamsize);this.inlets.push(g);a({done:function(){f.resolve.apply(f,i.call(arguments))},send:function(){g.append.apply(g,arguments)}});setTimeout(l.bind(this),10);return c.promise()};
var k=function(){this.status=d;this.reset();var c=this.recBuffers,a=this.samplerate,e=this.streamsize,b;this.samplerate=this.savedSamplerate;b=Infinity!==this.recDuration?0.001*this.recDuration*a|0:(c.length>>this.recCh-1)*e;var l=b/e|0,k=0,g=0,m=b;if(2===this.recCh){var f=new Float32Array(b),t=new Float32Array(b);for(b=0;b<l;++b)if(f.set(c[k++],g),t.set(c[k++],g),g+=e,m-=e,0<m&&m<e){f.set(c[k++].subarray(0,m),g);t.set(c[k++].subarray(0,m),g);break}c={L:{buffer:f,samplerate:a},R:{buffer:t,samplerate:a},
samplerate:a}}else{f=new Float32Array(b);for(b=0;b<l;++b)if(f.set(c[k++],g),g+=e,m-=e,0<m&&m<e){f.set(c[k++].subarray(0,m),g);break}c={buffer:f,samplerate:a}}this._.deferred.resolve.apply(this._.deferred,[].concat.apply([c],arguments));this._.deferred=null};b.on=function(c,a){this.events.on(c,a)};b.addListener=b.on;b.once=function(c,a){this.events.once(c,a)};b.removeListener=function(c,a){this.events.removeListener(c,a)};b.removeAllListeners=function(c){this.events.removeListeners(c)};b.listeners=
function(c){return this.events.listeners(c)};b.fix_iOS6_1_problem=function(c){this.impl.fix_iOS6_1_problem&&this.impl.fix_iOS6_1_problem(c)};return c}(),F=null,F="undefined"!==typeof webkitAudioContext?function(a){var e=new webkitAudioContext,b,l;m._audioContext=e;this.defaultSamplerate=this.maxSamplerate=e.sampleRate;this.env="webkit";var k=navigator.userAgent;k.match(/linux/i)?a.streammsec*=8:k.match(/win(dows)?\s*(nt 5\.1|xp)/i)&&(a.streammsec*=4);this.play=function(){var c,k=a.getAdjustSamples(e.sampleRate),
g,m,d;if(a.samplerate===e.sampleRate)c=function(c){var e=a.strmL,b=a.strmR,l=c.outputBuffer.getChannelData(0),c=c.outputBuffer.getChannelData(1),k=l.length;for(a.process();k--;){l[k]=e[k];c[k]=b[k]}};else{m=g=a.streamsize;d=a.samplerate/e.sampleRate;c=function(c){var e=a.strmL,b=a.strmR,l=c.outputBuffer.getChannelData(0),c=c.outputBuffer.getChannelData(1),k,f=l.length;for(k=0;k<f;++k){if(m>=g){a.process();m=m-g}l[k]=e[m|0];c[k]=b[m|0];m=m+d}}}b=e.createBufferSource();l=e.createJavaScriptNode(k,2,
a.channels);l.onaudioprocess=c;b.noteOn(0);b.connect(l);l.connect(e.destination)};this.pause=function(){b.disconnect();l.disconnect()};if(c){var g=0,d=e.createBufferSource();this.fix_iOS6_1_problem=function(c){g=g+(c?1:-1);if(g===1){d.noteOn(0);d.connect(e.destination)}else g===0&&d.disconnect()}}}:"function"===typeof Audio&&"function"===typeof(new Audio).mozSetup?function(a){var e=function(){var c=new Blob(["var t=0;onmessage=function(e){if(t)t=clearInterval(t),0;if(typeof e.data=='number'&&e.data>0)t=setInterval(function(){postMessage(0);},e.data);};"],
{type:"text/javascript"}),c=URL.createObjectURL(c);return new Worker(c)}();this.maxSamplerate=48E3;this.defaultSamplerate=44100;this.env="moz";this.play=function(){var b=new Audio,l=new Float32Array(a.streamsize*a.channels),k=a.streammsec,g=0,m=a.streamsize<<4;-1!==navigator.userAgent.toLowerCase().indexOf("linux")?(k=1E3*(a.streamsize/a.samplerate),g=-Infinity):c&&(k=1E3*(a.streamsize/a.samplerate),b.mozCurrentSampleOffset=function(){return Infinity});b.mozSetup(a.channels,a.samplerate);e.onmessage=
function(){var c=b.mozCurrentSampleOffset();if(!(g>c+m)){var c=a.strmL,e=a.strmR,k=l.length,d=c.length;for(a.process();d--;){l[--k]=e[d];l[--k]=c[d]}g=g+b.mozWriteAudio(l)}};e.postMessage(k)};this.pause=function(){e.postMessage(0)}}:function(){this.maxSamplerate=48E3;this.defaultSamplerate=8E3;this.env="nop";this.pause=this.play=s},b=(new v).bind(F),D=k;"node"===e?module.exports=global.timbre=D:"browser"===e&&("undefined"===typeof window.Float32Array&&(window.Float32Array=Array),D.noConflict=function(){var c=
window.timbre,a=window.T;return function(e){if(window.T===D)window.T=a;if(e&&window.timbre===D)window.timbre=c;return D}}(),window.timbre=window.T=D)})();
(function(h){function i(f){var d=Math.ceil(Math.log(1.5*h.samplerate)*Math.LOG2E);this.cell=new Float32Array(h.cellsize);this.time=125;this.feedback=0.25;this.buffer=new Float32Array(1<<d);this.mask=(1<<d)-1;this.wet=0.45;this.readIndex=0;this.writeIndex=this.time/1E3*h.samplerate|0;f&&this.setParams(f)}var f=i.prototype;f.setParams=function(f){f.time&&(this.time=f.time,this.writeIndex=this.readIndex+(0.001*this.time*h.samplerate|0));f.feedback&&(this.feedback=f.feedback);f.wet&&(this.wet=f.wet);
return this};f.process=function(f,d){var b,g,a,e,c,l,k,m,t,s;b=this.cell;g=this.buffer;a=this.writeIndex;e=this.readIndex;c=this.feedback;k=this.wet;m=1-this.wet;t=0;for(s=b.length;t<s;++t)l=g[e],g[a]=f[t]-l*c,b[t]=f[t]*m+l*k,a+=1,e+=1;if(d)for(;t--;)f[t]=b[t];this.writeIndex=a&this.mask;this.readIndex=e&this.mask;return b};h.modules.EfxDelay=i})(timbre);
(function(h){function i(d){this.samplerate=d||44100;this.frequency=340;this.Q=1;this.b0=this.b1=this.b2=this.a1=this.a2=this.x1=this.x2=this.y1=this.y2=this.gain=0;this.setType("lpf")}var f=i.prototype;f.process=function(d){for(var b,g,a=this.x1,e=this.x2,c=this.y1,l=this.y2,k=this.b0,m=this.b1,f=this.b2,s=this.a1,h=this.a2,j=0,i=d.length;j<i;++j)b=d[j],g=k*b+m*a+f*e-s*c-h*l,d[j]=-1>g?-1:1<g?1:g,e=a,a=b,l=c,c=g;if(0<a&&1.0E-4>a||0>a&&-1.0E-4<a)a=0;if(0<c&&1.0E-4>c||0>c&&-1.0E-4<c)c=0;this.x1=a;this.x2=
e;this.y1=c;this.y2=l};f.setType=function(d){var b;if(b=j[d])this.type=d,b.call(this,this.frequency,this.Q,this.gain)};f.setParams=function(d,b,g){this.frequency=d;this.Q=b;this.gain=g;var a=j[this.type];a&&a.call(this,d,b,g);return this};var j={lowpass:function(d,b){d/=0.5*this.samplerate;if(1<=d)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else if(0>=d)this.b0=this.b1=this.b2=this.a1=this.a2=0;else{var g=Math.pow(10,0.05*(0>b?0:b)),a=Math.sqrt(0.5*(4-Math.sqrt(16-16/(g*g)))),g=Math.PI*d,a=0.5*a*
Math.sin(g),a=0.5*(1-a)/(1+a),g=(0.5+a)*Math.cos(g),e=0.25*(0.5+a-g);this.b0=2*e;this.b1=4*e;this.b2=this.b0;this.a1=2*-g;this.a2=2*a}},highpass:function(d,b){d/=0.5*this.samplerate;if(1<=d)this.b0=this.b1=this.b2=this.a1=this.a2=0;else if(0>=d)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else{var g=Math.pow(10,0.05*(0>b?0:b)),a=Math.sqrt((4-Math.sqrt(16-16/(g*g)))/2),g=Math.PI*d,a=0.5*a*Math.sin(g),a=0.5*(1-a)/(1+a),g=(0.5+a)*Math.cos(g),e=0.25*(0.5+a+g);this.b0=2*e;this.b1=-4*e;this.b2=this.b0;this.a1=
2*-g;this.a2=2*a}},bandpass:function(d,b){d/=0.5*this.samplerate;if(0<d&&1>d)if(0<b){var g=Math.PI*d,a=Math.sin(g)/(2*b),g=Math.cos(g),e=1/(1+a);this.b0=a*e;this.b1=0;this.b2=-a*e;this.a1=-2*g*e;this.a2=(1-a)*e}else this.b0=this.b1=this.b2=this.a1=this.a2=0;else this.b0=this.b1=this.b2=this.a1=this.a2=0},lowshelf:function(d,b,g){d/=0.5*this.samplerate;b=Math.pow(10,g/40);if(1<=d)this.b0=b*b,this.b1=this.b2=this.a1=this.a2=0;else if(0>=d)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else{var d=Math.PI*
d,g=0.5*Math.sin(d)*Math.sqrt(0*(b+1/b)+2),d=Math.cos(d),g=2*Math.sqrt(b)*g,a=b+1,e=b-1,c=1/(a+e*d+g);this.b0=b*(a-e*d+g)*c;this.b1=2*b*(e-a*d)*c;this.b2=b*(a-e*d-g)*c;this.a1=-2*(e+a*d)*c;this.a2=(a+e*d-g)*c}},highshelf:function(d,b,g){d/=0.5*this.samplerate;b=Math.pow(10,g/40);if(1<=d)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else if(0>=d)this.b0=b*b,this.b1=this.b2=this.a1=this.a2=0;else{var d=Math.PI*d,g=0.5*Math.sin(d)*Math.sqrt(0*(b+1/b)+2),d=Math.cos(d),g=2*Math.sqrt(b)*g,a=b+1,e=b-1,c=1/
(a-e*d+g);this.b0=b*(a+e*d+g)*c;this.b1=-2*b*(e+a*d)*c;this.b2=b*(a+e*d-g)*c;this.a1=2*(e-a*d)*c;this.a2=(a-e*d-g)*c}},peaking:function(d,b,g){d/=0.5*this.samplerate;if(0<d&&1>d)if(g=Math.pow(10,g/40),0<b){var d=Math.PI*d,b=Math.sin(d)/(2*b),d=Math.cos(d),a=1/(1+b/g);this.b0=(1+b*g)*a;this.b1=-2*d*a;this.b2=(1-b*g)*a;this.a1=this.b1;this.a2=(1-b/g)*a}else this.b0=g*g,this.b1=this.b2=this.a1=this.a2=0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0},notch:function(d,b){d/=0.5*this.samplerate;if(0<
d&&1>d)if(0<b){var g=Math.PI*d,a=Math.sin(g)/(2*b),g=Math.cos(g),e=1/(1+a);this.b0=e;this.b1=-2*g*e;this.b2=e;this.a1=this.b1;this.a2=(1-a)*e}else this.b0=this.b1=this.b2=this.a1=this.a2=0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0},allpass:function(d,b){d/=0.5*this.samplerate;if(0<d&&1>d)if(0<b){var g=Math.PI*d,a=Math.sin(g)/(2*b),g=Math.cos(g),e=1/(1+a);this.b0=(1-a)*e;this.b1=-2*g*e;this.b2=(1+a)*e;this.a1=this.b1;this.a2=this.b0}else this.b0=-1,this.b1=this.b2=this.a1=this.a2=0;else this.b0=
1,this.b1=this.b2=this.a1=this.a2=0}};j.lpf=j.lowpass;j.hpf=j.highpass;j.bpf=j.bandpass;j.bef=j.notch;j.brf=j.notch;j.apf=j.allpass;h.modules.Biquad=i})(timbre);
(function(h){function i(d){this.samplerate=d;d=Math.round(Math.log(0.1*d)*Math.LOG2E);this.buffer=new Float32Array(1<<d);this._wave=this.wave=null;this.writeIndex=this.buffer.length>>1;this.readIndex=0;this.delayTime=20;this.rate=4;this.depth=20;this.feedback=0.2;this.wet=0.5;this.phaseIncr=this.phase=0;this.phaseStep=4;this.setWaveType("sin");this.setDelayTime(this.delayTime);this.setRate(this.rate)}var f=i.prototype,j=[];j[0]=function(){for(var d=new Float32Array(256),b=256;b--;)d[b]=Math.sin(2*
Math.PI*(b/256));return d}();j[1]=function(){for(var d=new Float32Array(256),b,g=256;g--;)b=g/256-0.25,d[g]=1-4*Math.abs(Math.round(b)-b);return d}();f.setWaveType=function(d){"sin"===d?(this.wave=d,this._wave=j[0]):"tri"===d&&(this.wave=d,this._wave=j[1])};f.setDelayTime=function(d){this.delayTime=d;for(d=this.writeIndex-(0.001*d*this.samplerate|0);0>d;)d+=this.buffer.length;this.readIndex=d};f.setRate=function(d){this.rate=d;this.phaseIncr=256*this.rate/this.samplerate*this.phaseStep};f.process=
function(d){var b=this.buffer,g=b.length,a=g-1,e=this._wave,c=this.phase,l=this.phaseIncr,k=this.writeIndex,m=this.readIndex,f=this.depth,s=this.feedback,h,j,i=this.wet,p=1-i,q,u=d.length,v,w=this.phaseStep;for(q=0;q<u;){j=e[c|0]*f;for(c+=l;256<c;)c-=256;for(v=0;v<w;++v,++q)h=m+g+j&a,h=b[h],b[k]=d[q]-h*s,d[q]=d[q]*p+h*i,k=k+1&a,m=m+1&a}this.phase=c;this.writeIndex=k;this.readIndex=m;return d};h.modules.Chorus=i})(timbre);
(function(h){function i(b){this.samplerate=b||44100;this.preDelayReadIndex=this.lastPreDelayFrames=0;this.preDelayWriteIndex=d;this.K=this.ykneeThresholdDb=this.kneeThresholdDb=this.kneeThreshold=this.dbKnee=this.dbThreshold=this.linearThreshold=this.slope=this.ratio=-1;this.attackTime=0.003;this.releaseTime=0.25;this.preDelayTime=0.006;this.dbPostGain=0;this.effectBlend=1;this.releaseZone1=0.09;this.releaseZone2=0.16;this.releaseZone3=0.42;this.releaseZone4=0.98;this.detectorAverage=0;this.meteringGain=
this.compressorGain=1;this.preDelayBuffer=new Float32Array(f);this.preDelayReadIndex=0;this.preDelayWriteIndex=d;this.maxAttackCompressionDiffDb=-1;this.meteringReleaseK=1-Math.exp(-1/(0.325*this.samplerate));this.setAttackTime(this.attackTime);this.setReleaseTime(this.releaseTime);this.setParams(-24,30,12)}var f=1024,j=f-1,d=256,b=i.prototype;b.setAttackTime=function(b){this.attackTime=Math.max(0.001,b);this._attackFrames=this.attackTime*this.samplerate};b.setReleaseTime=function(b){this.releaseTime=
Math.max(0.001,b);var a=this.releaseTime*this.samplerate;this._satReleaseFrames=0.0025*this.samplerate;var b=a*this.releaseZone1,e=a*this.releaseZone2,c=a*this.releaseZone3,a=a*this.releaseZone4;this._kA=0.9999999999999998*b+1.8432219684323923E-16*e-1.9373394351676423E-16*c+8.824516011816245E-18*a;this._kB=-1.5788320352845888*b+2.3305837032074286*e-0.9141194204840429*c+0.1623677525612032*a;this._kC=0.5334142869106424*b-1.272736789213631*e+0.9258856042207512*c-0.18656310191776226*a;this._kD=0.08783463138207234*
b-0.1694162967925622*e+0.08588057951595272*c-0.00429891410546283*a;this._kE=-0.042416883008123074*b+0.1115693827987602*e-0.09764676325265872*c+0.028494263462021576*a};b.setPreDelayTime=function(b){b*=this.samplerate;b>f-1&&(b=f-1);if(this.lastPreDelayFrames!==b){this.lastPreDelayFrames=b;for(var a=this.preDelayBuffer.length;a--;)this.preDelayBuffer[a]=0;this.preDelayReadIndex=0;this.preDelayWriteIndex=b}};b.setParams=function(b,a,e){this._k=this.updateStaticCurveParameters(b,a,e);b=1/this.saturate(1,
this._k);b=Math.pow(b,0.6);this._masterLinearGain=Math.pow(10,0.05*this.dbPostGain)*b};b.kneeCurve=function(b,a){return b<this.linearThreshold?b:this.linearThreshold+(1-Math.exp(-a*(b-this.linearThreshold)))/a};b.saturate=function(b,a){var e;b<this.kneeThreshold?e=this.kneeCurve(b,a):(e=this.ykneeThresholdDb+this.slope*((b?20*Math.log(b)*Math.LOG10E:-1E3)-this.kneeThresholdDb),e=Math.pow(10,0.05*e));return e};b.slopeAt=function(b,a){if(b<this.linearThreshold)return 1;var e=1.001*b,c=b?20*Math.log(b)*
Math.LOG10E:-1E3,l=e?20*Math.log(e)*Math.LOG10E:-1E3,k=this.kneeCurve(b,a),e=this.kneeCurve(e,a),k=k?20*Math.log(k)*Math.LOG10E:-1E3;return((e?20*Math.log(e)*Math.LOG10E:-1E3)-k)/(l-c)};b.kAtSlope=function(b){for(var a=Math.pow(10,0.05*(this.dbThreshold+this.dbKnee)),e=0.1,c=1E4,l=5,k=0;15>k;++k)this.slopeAt(a,l)<b?c=l:e=l,l=Math.sqrt(e*c);return l};b.updateStaticCurveParameters=function(b,a,e){this.dbThreshold=b;this.linearThreshold=Math.pow(10,0.05*b);this.dbKnee=a;this.ratio=e;this.slope=1/this.ratio;
e=this.kAtSlope(1/this.ratio);this.kneeThresholdDb=b+a;this.kneeThreshold=Math.pow(10,0.05*this.kneeThresholdDb);this.ykneeThresholdDb=(b=this.kneeCurve(this.kneeThreshold,e))?20*Math.log(b)*Math.LOG10E:-1E3;return this.K=e};b.process=function(b){for(var a=1-this.effectBlend,e=this.effectBlend,c=this._k,l=this._masterLinearGain,k=this._satReleaseFrame,m=this._kA,d=this._kB,f=this._kC,h=this._kD,i=this._kE,o=b.length/64,p=0,q=0;q<o;++q){var u=Math.asin(this.detectorAverage)/(0.5*Math.PI),v;v=u>this.compressorGain;
var w=this.compressorGain/u,w=w?20*Math.log(w)*Math.LOG10E:-1E3;if(v)this.maxAttackCompressionDiffDb=-1,w=Math.max(-12,w),w=Math.min(0,w),w=0.25*(w+12),v=w*w,v=Math.pow(10,0.05*(5/(m+d*w+f*v+h*v*w+i*v*v)));else{if(-1===this.maxAttackCompressionDiffDb||this.maxAttackCompressionDiffDb<w)this.maxAttackCompressionDiffDb=w;w=0.25/Math.max(0.5,this.maxAttackCompressionDiffDb);v=1-Math.pow(w,1/this._attackFrames)}for(var w=this.preDelayReadIndex,A=this.preDelayWriteIndex,B=this.detectorAverage,z=this.compressorGain,
E=64;E--;){var y=0,x=this.preDelayBuffer,C=b[p];x[A]=C;x=0<C?C:-C;y<x&&(y=x);y=0<y?y:-y;x=this.saturate(y,c);x=(y=1.0E-4>=y?1:x/y)?-20*Math.log(y)*Math.LOG10E:1E3;x=Math.max(2,x);x=Math.pow(10,0.05*(x/k))-1;B+=(y-B)*(y>B?x:1);B=Math.min(1,B);1>v?z+=(u-z)*v:(z*=v,z=Math.min(1,z));x=Math.sin(0.5*Math.PI*z);y=a+e*l*x;x=20*Math.log(x)*Math.LOG10E;this.meteringGain=x<this.meteringGain?x:this.meteringGain+(x-this.meteringGain)*this.meteringReleaseK;x=this.preDelayBuffer;b[p]=x[w]*y;p++;w=w+1&j;A=A+1&j}this.preDelayReadIndex=
w;this.preDelayWriteIndex=A;this.detectorAverage=1.0E-6>B?1.0E-6:B;this.compressorGain=1.0E-6>z?1.0E-6:z}};b.reset=function(){this.detectorAverage=0;this.meteringGain=this.compressorGain=1;for(var b=this.preDelayBuffer.length;b--;)this.preDelayBuffer[b]=0;this.preDelayReadIndex=0;this.preDelayWriteIndex=d;this.maxAttackCompressionDiffDb=-1};h.modules.Compressor=i})(timbre);
(function(h){function i(){}i.prototype.decode=function(f,h,d){if("string"===typeof f){if(/\.wav$/.test(f))return i.wav_decode(f,h,d);if(i.ogg_decode&&/\.ogg$/.test(f))return i.ogg_decode(f,h,d);if(i.mp3_decode&&/\.mp3$/.test(f))return i.mp3_decode(f,h,d)}if(i.webkit_decode)return i.webkit_decode(f,h,d);if(i.moz_decode)return i.moz_decode(f,h,d);h(!1)};h.modules.Decoder=i;i.getBinaryWithPath="browser"===h.envtype?function(f,j){h.fn.fix_iOS6_1_problem(!0);var d=new XMLHttpRequest;d.open("GET",f,!0);
d.responseType="arraybuffer";d.onload=function(){200===d.status?j(new Uint8Array(d.response)):j(d.status+" "+d.statusText);h.fn.fix_iOS6_1_problem(!1)};d.send()}:function(f,h){h("no support")};i.wav_decode=function(f,h,d){i.getBinaryWithPath(f,function(b){if(82!==b[0]||(73!==b[1]||70!==b[2]||70!==b[3])||b[4]+(b[5]<<8)+(b[6]<<16)+(b[7]<<24)+8!==b.length||87!==b[8]||65!==b[9]||86!==b[10]||69!==b[11]||102!==b[12]||109!==b[13]||116!==b[14]||32!==b[15])return h(!1);var g=b[22]+(b[23]<<8),a=b[24]+(b[25]<<
8)+(b[26]<<16)+(b[27]<<24),e=b[34]+(b[35]<<8);if(100!==b[36]||97!==b[37]||116!==b[38]||97!==b[39])return h(!1);var c=b[40]+(b[41]<<8)+(b[42]<<16)+(b[43]<<24),l=(c/g>>1)/a;if(c>b.length-44)return h(!1);c=new Float32Array(l*a|0);h({samplerate:a,buffer:c,duration:l});if(8===e)b=new Int8Array(b.buffer,44);else if(16===e)b=new Int16Array(b.buffer,44);else if(32===e)b=new Int32Array(b.buffer,44);else if(24===e){for(var b=new Uint8Array(b.buffer,44),k,m,f,a=new Int32Array(b.length/3),l=0,s=b.length,i=0;l<
s;)k=b[l++],m=b[l++],f=b[l++],k=k+(m<<8)+(f<<16),k=k&8388608?-((k^16777215)+1):k,a[i++]=k;b=a}if(2===g){g=b;b=new g.constructor(g.length>>1);a=g.length;l=b.length;a%2&&(a-=1,l|=0);for(;l;)b[--l]=0.5*(g[--a]+g[--a])}e=1/((1<<e-1)-1);for(g=c.length;g--;)c[g]=b[g]*e;d()})};i.webkit_decode=function(){if("undefined"!==typeof webkitAudioContext){var f=h.fn._audioContext,j=function(d,b,g){var a;if("string"===typeof d)return g(!1);try{a=f.createBuffer(d.buffer,!0)}catch(e){return b(!1)}d=f.sampleRate;a=a.getChannelData(0);
b({samplerate:d,buffer:a,duration:a.length/d});g()};return function(d,b,g){if(d instanceof File){var a=new FileReader;a.onload=function(a){j(new Uint8Array(a.target.result),b,g)};a.readAsArrayBuffer(d)}else i.getBinaryWithPath(d,function(a){j(a,b,g)})}}}();i.moz_decode=function(){if("function"===typeof Audio&&"function"===typeof(new Audio).mozSetup)return function(f,h,d){var b,g,a,e=0,c=new Audio(f);c.volume=0;c.speed=4;c.addEventListener("loadedmetadata",function(){b=c.mozSampleRate;g=c.duration;
a=new Float32Array(c.duration*b|0);2===c.mozChannels?c.addEventListener("MozAudioAvailable",function(c){for(var c=c.frameBuffer,b=0,g=c.length;b<g;b+=2)a[e++]=0.5*(c[b]+c[b+1])},!1):c.addEventListener("MozAudioAvailable",function(c){for(var c=c.frameBuffer,b=0,g=c.length;b<g;++b)a[e++]=c[b]},!1);c.play();setTimeout(function(){h({samplerate:b,buffer:a,duration:g})},1E3)},!1);c.addEventListener("ended",function(){d()},!1);c.load()}}()})(timbre);
(function(h){function i(a){this.context=a.context;this.then=a.then;this.done=a.done.bind(a);this.fail=a.fail.bind(a);this.pipe=a.pipe.bind(a);this.always=a.always.bind(a);this.promise=a.promise.bind(a);this.isResolved=a.isResolved.bind(a);this.isRejected=a.isRejected.bind(a)}function f(a){this.context=a||this;this._state="pending";this._doneList=[];this._failList=[];this._promise=new i(this)}var j=[].slice,d=function(a){return a&&"function"===typeof a.promise},b=f.prototype,g=function(a,e,c,b){if("pending"===
this._state){this._state=a;for(var a=0,k=e.length;a<k;++a)e[a].apply(c,b);this._doneList=this._failList=null}};b.resolve=function(){var a=j.call(arguments,0);g.call(this,"resolved",this._doneList,this.context||this,a);return this};b.resolveWith=function(a){var e=j.call(arguments,1);g.call(this,"resolved",this._doneList,a,e);return this};b.reject=function(){var a=j.call(arguments,0);g.call(this,"rejected",this._failList,this.context||this,a);return this};b.rejectWith=function(a){var e=j.call(arguments,
1);g.call(this,"rejected",this._failList,a,e);return this};b.promise=function(){return this._promise};b.done=function(){for(var a=j.call(arguments),e="resolved"===this._state,c="pending"===this._state,b=this._doneList,k=0,g=a.length;k<g;++k)if("function"===typeof a[k])if(e)a[k]();else c&&b.push(a[k]);return this};b.fail=function(){for(var a=j.call(arguments),e="rejected"===this._state,c="pending"===this._state,b=this._failList,k=0,g=a.length;k<g;++k)if("function"===typeof a[k])if(e)a[k]();else c&&
b.push(a[k]);return this};b.always=function(){this.done.apply(this,arguments);this.fail.apply(this,arguments);return this};b.then=function(a,e){return this.done(a).fail(e)};b.pipe=function(a,e){var c=new f(this.context);this.done(function(){var e=a.apply(this.context,arguments);d(e)?e.then(function(){var a=j.call(arguments);c.resolveWith.apply(c,[e].concat(a))}):c.resolveWith(this,e)}.bind(this));this.fail(function(){if("function"===typeof e){var a=e.apply(this.context,arguments);d(a)&&a.fail(function(){var e=
j.call(arguments);c.rejectWith.apply(c,[a].concat(e))})}else c.reject.apply(c,arguments)}.bind(this));return c.promise()};b.isResolved=function(){return"resolved"===this._state};b.isRejected=function(){return"rejected"===this._state};b.state=function(){return this._state};f.when=function(a){var e=0,c=j.call(arguments),b=c.length,k=b;1===b&&!d(a)&&(k=0);var g=1===k?a:new f,t=function(c,a){return function(e){a[c]=1<arguments.length?j.call(arguments):e;--k||g.resolve.apply(g,a)}};if(1<b)for(var s=Array(b);e<
b;++e)c[e]&&d(c[e])?c[e].promise().done(t(e,s)).fail(g.reject.bind(g)):(s[e]=c[e],--k);k||g.resolve.apply(g,c);return g.promise()};h.modules.Deferred=f})(timbre);
(function(h){function i(c){this.samplerate=c||44100;this.value=j;this.status=m;this.curve="linear";this.step=1;this.emit=this.loopNode=this.releaseNode=null;this._envValue=new f(c);this._table=[];this._initValue=j;this._curveValue=0;this._defaultCurveType=b;this._counter=this._index=0}function f(c){this.samplerate=c;this.value=j;this.step=1;this._curveType=b;this._y2=this._y1=this._b1=this._a2=this._grow=this._curveValue=0}var j=i.ZERO=1.0E-6,d=i.CurveTypeSet=0,b=i.CurveTypeLin=1,g=i.CurveTypeExp=
2,a=i.CurveTypeSin=3,e=i.CurveTypeWel=4,c=i.CurveTypeCurve=5,l=i.CurveTypeSqr=6,k=i.CurveTypeCub=7,m=i.StatusWait=0,t=i.StatusGate=1,s=i.StatusSustain=2,r=i.StatusRelease=3,n=i.StatusEnd=4,o={set:d,lin:b,linear:b,exp:g,exponential:g,sin:a,sine:a,wel:e,welch:e,sqr:l,squared:l,cub:k,cubed:k};i.CurveTypeDict=o;var p=i.prototype;p.clone=function(){var c=new i(this.samplerate);c._table=this._table;c._initValue=this._initValue;c.setCurve(this.curve);null!==this.releaseNode&&c.setReleaseNode(this.releaseNode+
1);null!==this.loopNode&&c.setLoopNode(this.loopNode+1);c.setStep(this.step);c.reset();return c};p.setTable=function(c){this._initValue=c[0];this._table=c.slice(1);this.value=this._envValue.value=this._initValue;this._counter=this._index=0;this.status=m};p.setCurve=function(a){"number"===typeof a?(this._defaultCurveType=c,this._curveValue=a):this._defaultCurveType=o[a]||null;this.curve=a};p.setReleaseNode=function(c){"number"===typeof c&&0<c&&(this.releaseNode=c-1)};p.setLoopNode=function(c){"number"===
typeof c&&0<c&&(this.loopNode=c-1)};p.setStep=function(c){this.step=this._envValue.step=c};p.reset=function(){this.value=this._envValue.value=this._initValue;this._counter=this._index=0;this.status=m};p.release=function(){null!==this.releaseNode&&(this._counter=0,this.status=r)};p.getInfo=function(c){var a=this._table,e,b,l=0,k=Infinity,g=Infinity,m=!1;e=0;for(b=a.length;e<b;++e){this.loopNode===e&&(k=l);this.releaseNode===e&&(g=l=l<c?l+c:c);var d=a[e];Array.isArray(d)&&(l+=d[1])}Infinity!==k&&Infinity===
g&&(l+=c,m=!0);return{totalDuration:l,loopBeginTime:k,releaseBeginTime:g,isEndlessLoop:m}};p.calcStatus=function(){var a=this.status,e=this._table,l=this._index,k=this._counter,g=this._curveValue,m=this._defaultCurveType,d=this.loopNode,f=this.releaseNode,h=this._envValue,i,j,o=null;switch(a){case t:case r:for(;0>=k;)l>=e.length?a===t&&null!==d?l=d:(a=n,k=Infinity,o="ended"):a===t&&l===f?null!==d&&d<f?l=d:(a=s,k=Infinity,o="sustained"):(i=e[l++],k=i[0],j=null===i[2]?m:i[2],j===c&&(g=i[3],0.001>Math.abs(g)&&
(j=b)),i=i[1],k=h.setNext(k,i,j,g))}this.status=a;this.emit=o;this._index=l;this._counter=k;return a};p.next=function(){this.calcStatus()&1&&(this.value=this._envValue.next()||j);this._counter-=1;return this.value};p.process=function(c){var a=this._envValue,e,b=c.length;if(this.calcStatus()&1)for(e=0;e<b;++e)c[e]=a.next()||j;else{a=this.value||j;for(e=0;e<b;++e)c[e]=a}this.value=c[b-1];this._counter-=c.length};f.prototype.setNext=function(m,f,t,s){var h=this.value,i,j,r,n,o,f=0.001*f*this.samplerate/
this.step|0;1>f&&(f=1,t=d);switch(t){case d:this.value=m;break;case b:i=(m-h)/f;break;case g:i=0!==h?Math.pow(m/h,1/f):0;break;case a:s=Math.PI/f;j=0.5*(m+h);r=2*Math.cos(s);n=0.5*(m-h);o=n*Math.sin(0.5*Math.PI-s);break;case e:s=0.5*Math.PI/f;r=2*Math.cos(s);m>=h?(j=h,n=0,o=-Math.sin(s)*(m-h)):(j=m,n=h-m,o=Math.cos(s)*(h-m));break;case c:m=(m-h)/(1-Math.exp(s));j=h+m;r=m;i=Math.exp(s/f);break;case l:n=Math.sqrt(h);o=Math.sqrt(m);i=(o-n)/f;break;case k:n=Math.pow(h,0.33333333),o=Math.pow(m,0.33333333),
i=(o-n)/f}this.next=q[t];this._grow=i;this._a2=j;this._b1=r;this._y1=n;this._y2=o;return f};var q=[];q[d]=function(){return this.value};q[b]=function(){return this.value+=this._grow};q[g]=function(){return this.value*=this._grow};q[a]=function(){var c=this._b1*this._y1-this._y2;this.value=this._a2-c;this._y2=this._y1;this._y1=c;return this.value};q[e]=function(){var c=this._b1*this._y1-this._y2;this.value=this._a2+c;this._y2=this._y1;this._y1=c;return this.value};q[c]=function(){this._b1*=this._grow;
return this.value=this._a2-this._b1};q[l]=function(){this._y1+=this._grow;return this.value=this._y1*this._y1};q[k]=function(){this._y1+=this._grow;return this.value=this._y1*this._y1*this._y1};f.prototype.next=q[d];h.modules.Envelope=i;h.modules.EnvelopeValue=f})(timbre);
(function(h){function i(b){this.context=b;this._||(this._={})}var f=Array.isArray,j=[].slice,d=i.prototype;d.emit=function(b){var g=this._;if(!g.events)return!1;var a=g.events[b];if(!a)return!1;if("function"===typeof a){switch(arguments.length){case 1:a.call(this.context);break;case 2:a.call(this.context,arguments[1]);break;case 3:a.call(this.context,arguments[1],arguments[2]);break;default:g=j.call(arguments,1),a.apply(this.context,g)}return!0}if(f(a)){for(var g=j.call(arguments,1),a=a.slice(),e=
0,c=a.length;e<c;++e)a[e]instanceof h.Object?a[e].bang.apply(a[e],g):a[e].apply(this.context,g);return!0}if(a instanceof h.Object)g=j.call(arguments,1),a.bang.apply(a,g);else return!1};d.addListener=function(b,g){if("function"!==typeof g&&!(g instanceof h.Object))throw Error("addListener takes instances of Function or timbre.Object");var a=this._;a.events||(a.events={});a.events[b]?f(a.events[b])?a.events[b].push(g):a.events[b]=[a.events[b],g]:a.events[b]=g;return this};d.on=d.addListener;d.once=
function(b,g){var a=this,e;if("function"===typeof g)e=function(){a.removeListener(b,e);g.apply(a.context,arguments)};else if(g instanceof h.Object)e=function(){a.removeListener(b,e);g.bang.apply(g,arguments)};else throw Error("once takes instances of Function or timbre.Object");e.listener=g;a.on(b,e);return this};d.removeListener=function(b,g){if("function"!==typeof g&&!(g instanceof h.Object))throw Error("removeListener takes instances of Function or timbre.Object");var a=this._;if(!a.events||!a.events[b])return this;
var e=a.events[b];if(f(e)){for(var c=-1,l=0,k=e.length;l<k;++l)if(e[l]===g||e[l].listener&&e[l].listener===g){c=l;break}if(0>c)return this;e.splice(c,1);0===e.length&&(a.events[b]=null)}else if(e===g||e.listener&&e.listener===g)a.events[b]=null;return this};d.removeAllListeners=function(b){var g=this._;if(!g.events)return this;var a=!1,e=g.events[b];if(f(e))for(var c=e.length;c--;){var l=e[c];l.unremovable?a=!0:this.removeListener(b,l)}else e&&(e.unremovable?a=!0:this.removeListener(b,e));a||(g.events[b]=
null);return this};d.listeners=function(b){var g=this._;if(!g.events||!g.events[b])return[];g=g.events[b];if(!f(g))return g.unremovable?[]:[g];for(var g=g.slice(),b=[],a=0,e=g.length;a<e;++a)g[a].unremovable||b.push(g[a]);return b};h.modules.EventEmitter=i;h.modules.ready.done("events")})(timbre);
(function(h){function i(b){this.length=b=1<<Math.ceil(Math.log("number"===typeof b?b:512)*Math.LOG2E);this.buffer=new Float32Array(b);this.real=new Float32Array(b);this.imag=new Float32Array(b);this._real=new Float32Array(b);this._imag=new Float32Array(b);this.spectrum=new Float32Array(b>>1);b=j.get(b);this._bitrev=b.bitrev;this._sintable=b.sintable;this._costable=b.costable}var f=i.prototype;f.setWindow=function(b){if("string"===typeof b){var g=/([A-Za-z]+)(?:\(([01]\.?\d*)\))?/.exec(b);if(null!==
g){var a=g[1].toLowerCase(),g=void 0!==g[2]?+g[2]:0.25;if(a=d[a]){this._window||(this._window=new Float32Array(this.length));for(var e=this._window,c=0,l=this.length,g=0>g?0:1<g?1:g;c<l;++c)e[c]=a(c,l,g);this.windowName=b}}}};f.forward=function(b){var g=this.buffer,a=this.real,e=this.imag,c=this._window,l=this._bitrev,k=this._sintable,m=this._costable,d=g.length,f,h,i,j,p,q,u;if(c)for(f=d;f--;)g[f]=b[f]*c[f];else for(f=d;f--;)g[f]=b[f];for(f=d;f--;)a[f]=g[l[f]],e[f]=0;for(g=1;g<d;g=c){l=0;c=g+g;h=
d/c;for(b=0;b<g;b++){i=m[l];j=k[l];for(f=b;f<d;f+=c)p=f+g,q=j*e[p]+i*a[p],u=i*e[p]-j*a[p],a[p]=a[f]-q,a[f]+=q,e[p]=e[f]-u,e[f]+=u;l+=h}}if(!this.noSpectrum){k=this.spectrum;m=0;for(f=d;f--;)d=a[f],b=e[f],d=Math.sqrt(d*d+b*b),k[f]=d,m<d&&(m=d);this.peak=m}return{real:a,imag:e}};f.inverse=function(b,g){var a=this.buffer,e=this._real,c=this._imag,l=this._bitrev,k=this._sintable,m=this._costable,d=a.length,f,h,i,j,p,q,u,v,w,A;for(f=d;f--;)h=l[f],e[f]=+b[h],c[f]=-g[h];for(l=1;l<d;l=i){j=0;i=l+l;p=d/i;
for(h=0;h<l;h++){q=m[j];u=k[j];for(f=h;f<d;f+=i)v=f+l,w=u*c[v]+q*e[v],A=q*c[v]-u*e[v],e[v]=e[f]-w,e[f]+=w,c[v]=c[f]-A,c[f]+=A;j+=p}}for(f=d;f--;)a[f]=e[f]/d;return a};var j={get:function(b){var g;if(!(g=j[b])){var a,e,c,l;g=new Int16Array(b);l=b>>1;for(a=e=0;;){g[a]=e;if(++a>=b)break;for(c=l;c<=e;)e-=c,c>>=1;e+=c}e=Math.floor(Math.log(b)/Math.LN2);a=new Float32Array((1<<e)-1);c=new Float32Array((1<<e)-1);l=2*Math.PI;for(e=a.length;e--;)a[e]=Math.sin(l*(e/b)),c[e]=Math.cos(l*(e/b));g=j[b]={bitrev:g,
sintable:a,costable:c}}return g}},d=function(){var b=Math.PI,g=2*Math.PI,a=Math.abs,e=Math.pow,c=Math.cos,l=Math.sin,k=Math.E;return{rectangular:function(){return 1},hann:function(a,e){return 0.5*(1-c(g*a/(e-1)))},hamming:function(a,e){return 0.54-0.46*c(g*a/(e-1))},tukery:function(a,e,l){return a<l*(e-1)/2?0.5*(1+c(b*(2*a/(l*(e-1))-1))):(e-1)*(1-l/2)<a?0.5*(1+c(b*(2*a/(l*(e-1))-2/l+1))):1},cosine:function(c,a){return l(b*c/(a-1))},lanczos:function(c,a){return l(b*(2*c/(a-1)-1))/(b*(2*c/(a-1)-1))},
triangular:function(c,e){return 2/(e+1)*((e+1)/2-a(c-(e-1)/2))},bartlett:function(c,e){return 2/(e-1)*((e-1)/2-a(c-(e-1)/2))},gaussian:function(c,a,b){return e(k,-0.5*e((c-(a-1)/2)/(b*(a-1)/2),2))},bartlettHann:function(e,b){return 0.62-0.48*a(e/(b-1)-0.5)-0.38*c(g*e/(b-1))},blackman:function(a,e,l){var k=l/2;return(1-l)/2-0.5*c(g*a/(e-1))+k*c(4*b*a/(e-1))}}}();h.modules.FFT=i})(timbre);
(function(h){function i(a){this.samplerate=a||44100;this.wave=null;this.step=1;this.phase=this.value=this.frequency=0;this.feedback=!1;this._lastouts=this._x=0;this._coeff=f/this.samplerate;this._radtoinc=f/(2*Math.PI)}var f=1024,j=f-1,d=i.prototype;d.setWave=function(a){var e,c,l=this.wave;this.wave||(this.wave=new Float32Array(f+1));if("function"===typeof a)for(e=0;e<f;++e)l[e]=a(e/f);else if(a instanceof Float32Array)if(a.length===l.length)l.set(a);else{c=a.length/f;for(e=0;e<f;++e)l[e]=a[e*c|
0]}else"string"===typeof a&&void 0!==(c=b(a))&&this.wave.set(c);this.wave[f]=this.wave[0]};d.reset=function(){this._x=0};d.next=function(){var a=this._x;this.value=this.wave[(a+this.phase*this._radtoinc|0)&j];for(a+=this.frequency*this._coeff*this.step;a>f;)a-=f;this._x=a;return this.value};d.process=function(a){var e=this.wave,c=this._radtoinc,b,k=this._x,g,d,h=this.frequency*this._coeff,i,n=this.step;if(this.feedback){g=this._lastouts;c*=this.phase;for(i=0;i<n;++i)b=k+g*c,g=b|0,b-=g,g&=j,d=e[g],
g=e[g+1],a[i]=g=d+b*(g-d),k+=h;this._lastouts=g}else{c*=this.phase;for(i=0;i<n;++i)b=k+c,g=b|0,b-=g,g&=j,d=e[g],g=e[g+1],a[i]=d+b*(g-d),k+=h}for(;k>f;)k-=f;this._x=k;this.value=a[a.length-1]};d.processWithFreqArray=function(a,e){var c=this.wave,b=this._radtoinc,k,g=this._x,d,h,i=this._coeff,n,o=this.step;if(this.feedback){d=this._lastouts;b*=this.phase;for(n=0;n<o;++n)k=g+d*b,d=k|0,k-=d,d&=j,h=c[d],d=c[d+1],a[n]=d=h+k*(d-h),g+=e[n]*i;this._lastouts=d}else{b=this.phase*this._radtoinc;for(n=0;n<o;++n)k=
g+b,d=k|0,k-=d,d&=j,h=c[d],d=c[d+1],a[n]=h+k*(d-h),g+=e[n]*i}for(;g>f;)g-=f;this._x=g;this.value=a[a.length-1]};d.processWithPhaseArray=function(a,e){var c=this.wave,b=this._radtoinc,k,g=this._x,d,h,i=this.frequency*this._coeff,n,o=this.step;if(this.feedback){d=this._lastouts;b*=this.phase;for(n=0;n<o;++n)k=g+d*b,d=k|0,k-=d,d&=j,h=c[d],d=c[d+1],a[n]=d=h+k*(d-h),g+=i;this._lastouts=d}else for(n=0;n<o;++n)k=g+e[n]*b,d=k|0,k-=d,d&=j,h=c[d],d=c[d+1],a[n]=h+k*(d-h),g+=i;for(;g>f;)g-=f;this._x=g;this.value=
a[a.length-1]};d.processWithFreqAndPhaseArray=function(a,e,c){var b=this.wave,k=this._radtoinc,g,d=this._x,h,i,n=this._coeff,o,p=this.step;if(this.feedback){c=this._lastouts;k*=this.phase;for(o=0;o<p;++o)g=d+c*k,h=g|0,g-=h,h&=j,i=b[h],h=b[h+1],a[o]=c=i+g*(h-i),d+=e[o]*n;this._lastouts=c}else for(o=0;o<p;++o)g=d+c[o]*f,h=g|0,g-=h,h&=j,i=b[h],h=b[h+1],a[o]=i+g*(h-i),d+=e[o]*n;for(;d>f;)d-=f;this._x=d;this.value=a[a.length-1]};var b=function(a){var e=g[a];if(void 0!==e)return"function"===typeof e&&(e=
e()),e;var c;c=/^([\-+]?)(\w+)(?:\((@[0-7])?:?(\d+)?\))?$/.exec(a);if(null!==c){var e=c[1],b=c[3],k=c[4];c=g[c[2]];var d,f;if(void 0===c)e=void 0;else{"function"===typeof c&&(c=c());switch(b){case "@1":for(d=512;1024>d;++d)c[d]=0;break;case "@2":for(d=512;1024>d;++d)c[d]=Math.abs(c[d]);break;case "@3":for(d=256;512>d;++d)c[d]=0;for(d=512;768>d;++d)c[d]=Math.abs(c[d]);for(d=768;1024>d;++d)c[d]=0;break;case "@4":b=new Float32Array(1024);for(d=0;512>d;++d)b[d]=c[d<<1];c=b;break;case "@5":b=new Float32Array(1024);
for(d=0;512>d;++d)b[d]=Math.abs(c[d<<1]);c=b}if(void 0!==k&&50!==k){k*=0.01;k=0>k?0:1<k?1:k;b=new Float32Array(1024);k=1024*k|0;for(d=0;d<k;++d)b[d]=c[512*(d/k)|0];f=1024-k;for(k=0;1024>d;++d,++k)b[d]=c[512*(k/f)+512|0];c=b}if("+"===e)for(d=1024;d--;)c[d]=0.5*c[d]+0.5;else if("-"===e)for(d=1024;d--;)c[d]*=-1;e=c}if(void 0!==e)return g[a]=e}c=/^wavb\(((?:[0-9a-fA-F][0-9a-fA-F])+)\)$/.exec(a);if(null!==c){a=c[1];e=new Float32Array(1024);c=a.length>>1;if(-1!==[2,4,8,16,32,64,128,256,512,1024].indexOf(c))for(d=
b=0;b<c;++b){k=parseInt(a.substr(2*b,2),16);k=k&128?(k-256)/128:k/127;for(f=1024/c;f--;)e[d++]=k}return e}c=/^wavc\(([0-9a-fA-F]{8})\)$/.exec(a);if(null!==c){e=c[1];a=new Float32Array(1024);if(8===e.length){b=parseInt(e,16);c=new Float32Array(8);c[0]=1;for(e=0;7>e;++e)c[e+1]=0.0625*(b&15),b>>=4;for(e=0;8>e;++e){d=0;k=(e+1)/1024;for(b=0;1024>b;++b)a[b]+=Math.sin(2*Math.PI*d)*c[e],d+=k}c=0;for(e=1024;e--;)if(c<(b=Math.abs(a[e])))c=b;if(0<c)for(e=1024;e--;)a[e]/=c}return a}};i.getWavetable=b;i.setWavetable=
function(a,e){var c,b=new Float32Array(1024),d;if("function"===typeof e)for(d=0;1024>d;++d)b[d]=e(d/1024);else if(e instanceof Float32Array)if(e.length===b.length)b.set(e);else{c=e.length/1024;for(d=0;1024>d;++d)b[d]=e[d*c|0]}g[a]=b};var g={sin:function(){for(var a=new Float32Array(1024),e=1024;e--;)a[e]=Math.sin(2*Math.PI*(e/1024));return a},cos:function(){for(var a=new Float32Array(1024),e=1024;e--;)a[e]=Math.cos(2*Math.PI*(e/1024));return a},pulse:function(){for(var a=new Float32Array(1024),e=
1024;e--;)a[e]=512>e?1:-1;return a},tri:function(){for(var a=new Float32Array(1024),e,c=1024;c--;)e=c/1024-0.25,a[c]=1-4*Math.abs(Math.round(e)-e);return a},saw:function(){for(var a=new Float32Array(1024),e,c=1024;c--;)e=c/1024,a[c]=2*(e-Math.round(e));return a},fami:function(){for(var a=[0,0.125,0.25,0.375,0.5,0.625,0.75,0.875,0.875,0.75,0.625,0.5,0.375,0.25,0.125,0,-0.125,-0.25,-0.375,-0.5,-0.625,-0.75,-0.875,-1,-1,-0.875,-0.75,-0.625,-0.5,-0.375,-0.25,-0.125],e=new Float32Array(1024),c=1024;c--;)e[c]=
a[c/1024*a.length|0];return e},konami:function(){for(var a=[-0.625,-0.875,-0.125,0.75,0.5,0.125,0.5,0.75,0.25,-0.125,0.5,0.875,0.625,0,0.25,0.375,-0.125,-0.75,0,0.625,0.125,-0.5,-0.375,-0.125,-0.75,-1,-0.625,0,-0.375,-0.875,-0.625,-0.25],e=new Float32Array(1024),c=1024;c--;)e[c]=a[c/1024*a.length|0];return e}};h.modules.Oscillator=i})(timbre);
(function(h){function i(a,e){this.samplerate=a;var c,l=a/44100;c=d.length;this.comb=Array(c);for(this.combout=Array(c);c--;)this.comb[c]=new f(d[c]*l),this.combout[c]=new Float32Array(e);c=b.length;for(this.allpass=Array(c);c--;)this.allpass[c]=new j(b[c]*l);this.output=new Float32Array(e);this.damp=0;this.wet=0.33;this.setRoomSize(0.5);this.setDamp(0.5)}function f(a){this.buffer=new Float32Array(a|0);this.buffersize=this.buffer.length;this.damp=this.filterstore=this.feedback=this.bufidx=0}function j(a){this.buffer=
new Float32Array(a|0);this.buffersize=this.buffer.length;this.bufidx=0}var d=[1116,1188,1277,1356,1422,1491,1557,1617],b=[225,556,441,341],g=i.prototype;g.setRoomSize=function(a){var e=this.comb;this.roomsize=a;e[0].feedback=e[1].feedback=e[2].feedback=e[3].feedback=e[4].feedback=e[5].feedback=e[6].feedback=e[7].feedback=0.28*a+0.7};g.setDamp=function(a){var e=this.comb;this.damp=a;e[0].damp=e[1].damp=e[2].damp=e[3].damp=e[4].damp=e[5].damp=e[6].damp=e[7].damp=0.4*a};g.process=function(a){var e=this.comb,
c=this.combout,b=this.allpass,d=this.output,g=this.wet,f=1-g,h=a.length;e[0].process(a,c[0]);e[1].process(a,c[1]);e[2].process(a,c[2]);e[3].process(a,c[3]);e[4].process(a,c[4]);e[5].process(a,c[5]);e[6].process(a,c[6]);e[7].process(a,c[7]);for(e=h;e--;)d[e]=c[0][e]+c[1][e]+c[2][e]+c[3][e]+c[4][e]+c[5][e]+c[6][e]+c[7][e];b[0].process(d,d);b[1].process(d,d);b[2].process(d,d);b[3].process(d,d);for(e=h;e--;)a[e]=d[e]*g+a[e]*f};f.prototype.process=function(a,e){var c,b,d=this.buffer,g=this.buffersize,
f=this.bufidx,h=this.filterstore,i=this.feedback,j=this.damp,o=1-j,p,q=a.length;for(p=0;p<q;++p)c=0.015*a[p],b=d[f],h=b*o+h*j,d[f]=c+h*i,++f>=g&&(f=0),e[p]=b;this.bufidx=f;this.filterstore=h};j.prototype.process=function(a,e){var c,b,d,g=this.buffer,f=this.buffersize,h=this.bufidx,i,j=a.length;for(i=0;i<j;++i)c=a[i],d=g[h],b=-c+d,g[h]=c+0.5*d,++h>=f&&(h=0),e[i]=b;this.bufidx=h};h.modules.Reverb=i})(timbre);
(function(h){function i(a){return new f(a)}function f(a){this.fragments=[];a&&this.fragments.push(new j(a,0,a.buffer.length/(a.samplerate||44100)))}function j(a,e,c,b,d,f,h){a||(a=g);this.buffer=a.buffer;this.samplerate=a.samplerate||44100;this.start=e;this._duration=c;this.reverse=b||!1;this.pitch=d||100;this.stretch=f||!1;this.pan=h||50}function d(a,e){this.tape=a;this.fragments=a.fragments;this.samplerate=e||44100;this.isEnded=!1;this.buffer=null;this.bufferEndIndex=this.bufferBeginIndex=this.bufferIndexIncr=
this.bufferIndex=0;this.fragment=null;this.fragmentIndex=0;this.panR=this.panL=0.7071067811865475}var b=new Float32Array(60),g={buffer:b,samplerate:1};i.silence=function(a){return(new i(g)).slice(0,1).fill(a)};i.join=function(a){for(var e=new f,c=0;c<a.length;c++)a[c]instanceof f&&e.add_fragments(a[c].fragments);return e};i.Tape=f;f.prototype.add_fragment=function(a){this.fragments.push(a);return this};f.prototype.add_fragments=function(a){for(var e=0;e<a.length;e++)this.fragments.push(a[e]);return this};
f.prototype.duration=function(){for(var a=0,e=0;e<this.fragments.length;e++)a+=this.fragments[e].duration();return a};f.prototype.slice=function(a,e){var c=this.duration();a+e>c&&(e=c-a);for(var c=new f,b=a,d=e,g=0;g<this.fragments.length;g++){var d=this.fragments[g].create(b,d),h=d[0],b=d[1],d=d[2];h&&c.add_fragment(h);if(0===d)break}return c};f.prototype.cut=f.prototype.slice;f.prototype.concat=function(a){var e=new f;e.add_fragments(this.fragments);e.add_fragments(a.fragments);return e};f.prototype.loop=
function(a){var e,c=[];for(e=0;e<this.fragments.length;e++)c.push(this.fragments[e].clone());var b=new f;for(e=0;e<a;e++)b.add_fragments(c);return b};f.prototype.times=f.prototype.loop;f.prototype.split=function(a){for(var e=this.duration()/a,c=[],b=0;b<a;b++)c.push(this.slice(b*e,e));return c};f.prototype.fill=function(a){var e=this.duration();if(0===e)throw"EmptyFragment";var c=a%e;return this.loop(a/e|0).plus(this.slice(0,c))};f.prototype.replace=function(a,e,c){var b=new f,e=a+e,b=b.plus(this.slice(0,
a)),d=b.duration();d<a&&(b=b.plus(i.silence(a-d)));b=b.plus(c);a=this.duration();a>e&&(b=b.plus(this.slice(e,a-e)));return b};f.prototype.reverse=function(){for(var a=new f,e=this.fragments.length;e--;){var c=this.fragments[e].clone();c.reverse=!c.isReversed();a.add_fragment(c)}return a};f.prototype.pitch=function(a,e){for(var c=new f,e=e||!1,b=0;b<this.fragments.length;b++){var d=this.fragments[b].clone();d.pitch*=0.01*a;d.stretch=e;c.add_fragment(d)}return c};f.prototype.stretch=function(a){return this.pitch(100*
(1/(0.01*a)),!0)};f.prototype.pan=function(a){for(var e=new f,c=0;c<this.fragments.length;c++){var b=this.fragments[c].clone();b.pan=a;e.add_fragment(b)}return e};f.prototype.silence=function(){return i.silence(this.duration())};f.prototype.join=function(a){for(var e=new f,c=0;c<a.length;c++)a[c]instanceof f&&e.add_fragments(a[c].fragments);return e};j.prototype.duration=function(){return this._duration*(100/this.pitch)};j.prototype.original_duration=function(){return this._duration};j.prototype.isReversed=
function(){return this.reverse};j.prototype.isStretched=function(){return this.stretched};j.prototype.create=function(a,e){var c=this.duration();if(a>=c)return[null,a-c,e];a+e>=c?(c-=a,e-=c):(c=e,e=0);var b=this.clone();b.start=this.start+0.01*a*this.pitch;b._duration=0.01*c*this.pitch;b.reverse=!1;return[b,0,e]};j.prototype.clone=function(){var a=new j;a.buffer=this.buffer;a.samplerate=this.samplerate;a.start=this.start;a._duration=this._duration;a.reverse=this.reverse;a.pitch=this.pitch;a.stretch=
this.stretch;a.pan=this.pan;return a};i.Fragment=j;i.TapeStream=d;d.prototype.reset=function(){this.isEnded=!1;this.buffer=null;this.bufferEndIndex=this.bufferBeginIndex=this.bufferIndexIncr=this.bufferIndex=0;this.fragment=null;this.fragmentIndex=0;this.panR=this.panL=0.7071067811865475;this.isLooped=!1;return this};d.prototype.fetch=function(a){var e=new Float32Array(a),c=new Float32Array(a),d=this.fragments;if(0===d.length)return[e,c];for(var g=100*this.samplerate,f=this.buffer,h=this.bufferIndex,
i=this.bufferIndexIncr,j=this.bufferBeginIndex,n=this.bufferEndIndex,o=this.fragment,p=this.fragmentIndex,q=this.panL,u=this.panR,v=0;v<a;v++){for(;!f||h<j||h>=n;)if(!o||p<d.length)o=d[p++],f=o.buffer,i=o.samplerate/g*o.pitch,j=o.start*o.samplerate,n=j+o.original_duration()*o.samplerate,q=Math.cos(0.005*Math.PI*o.pan),u=Math.sin(0.005*Math.PI*o.pan),o.reverse?(i*=-1,h=n+i):h=j;else if(this.isLooped)f=null,n=j=i=h=0,o=null,p=0;else{this.isEnded=!0;f=b;h=i=0;break}e[v]=f[h|0]*q;c[v]=f[h|0]*u;h+=i}this.buffer=
f;this.bufferIndex=h;this.bufferIndexIncr=i;this.bufferBeginIndex=j;this.bufferEndIndex=n;this.fragment=o;this.fragmentIndex=p;this.panL=q;this.panR=u;return[e,c]};h.modules.Scissor=i})(timbre);(function(h){function i(f){h.Object.call(this,f)}var f=h.fn;f.extend(i);i.prototype.process=function(h){var d=this.cell,b=this._;this.tickID!==h&&(this.tickID=h,b.ar?(f.inputSignalAR(this),f.outputSignalAR(this)):(d[0]=f.inputSignalKR(this),f.outputSignalKR(this)));return d};f.register("+",i)})(timbre);
(function(h){var i=h.fn,f=h.modules;i.register("audio",function(b){b=new (i.getClass("buffer"))(b);b._.isLoaded=!1;b._.isEnded=!0;Object.defineProperties(b,{isLoaded:{get:function(){return this._.isLoaded}}});b.load=j;b.loadthis=d;return b});var j=function(b){var d=this,a=this._,e=new f.Deferred(this),c=arguments,l=1;e.done(function(){this._.emit("done")}.bind(this));"function"===typeof c[l]&&(e.done(c[l++]),"function"===typeof c[l]&&e.fail(c[l++]));a.loadedTime=0;(new f.Decoder).decode(b,function(c,
a){var b=d._;if(c){b.samplerate=c.samplerate;b.buffer=c.buffer;b.phase=0;b.phaseIncr=c.samplerate/h.samplerate;b.duration=c.duration*1E3;b.isEnded=false;b.currentTime=0;if(b.isReversed){b.phaseIncr=b.phaseIncr*-1;b.phase=c.buffer.length+b.phaseIncr}d._.emit("loadedmetadata")}else e.reject(a)},function(){d._.isLoaded=true;d._.plotFlush=true;d._.emit("loadeddata");e.resolveWith(d)});return e.promise()},d=function(){j.apply(this,arguments);return this}})(timbre);
(function(h){function i(c){h.Object.call(this,c);f.fixAR(this);c=this._;c.biquad=new d(h.samplerate);c.freq=h(340);c.band=h(1);c.gain=h(0);c.plotBefore=b;c.plotRange=[-18,18];c.plotFlush=!0}var f=h.fn,j=h.modules.FFT,d=h.modules.Biquad;f.extend(i);var b=function(c,a,e,b,d){c.lineWidth=1;c.strokeStyle="rgb(192, 192, 192)";for(var g=0.5*h.samplerate,f=1;10>=f;++f)for(var i=1;4>=i;i++){var j=f*Math.pow(10,i);20>=j||g<=j||(c.beginPath(),j=Math.log(j/20)/Math.log(g/20),j=(j*b+a|0)+0.5,c.moveTo(j,e),c.lineTo(j,
e+d),c.stroke())}d/=6;for(f=1;6>f;f++)c.beginPath(),g=(e+f*d|0)+0.5,c.moveTo(a,g),c.lineTo(a+b,g),c.stroke()},g=i.prototype;Object.defineProperties(g,{type:{set:function(c){var a=this._;c!==a.biquad.type&&(a.biquad.setType(c),a.plotFlush=!0)},get:function(){return this._.biquad.type}},freq:{set:function(c){this._.freq=h(c)},get:function(){return this._.freq}},cutoff:{set:function(c){this._.freq=h(c)},get:function(){return this._.freq}},res:{set:function(c){this._.band=h(c)},get:function(){return this._.band}},
Q:{set:function(c){this._.band=h(c)},get:function(){return this._.band}},band:{set:function(c){this._.band=h(c)},get:function(){return this._.band}},gain:{set:function(c){this._.gain=h(c)},get:function(){return this._.gain}}});g.process=function(c){var a=this._,e=this.cell;if(this.tickID!==c){this.tickID=c;f.inputSignalAR(this);var b=!1,d=a.freq.process(c)[0];a.prevFreq!==d&&(a.prevFreq=d,b=!0);var g=a.band.process(c)[0];a.prevband!==g&&(a.prevband=g,b=!0);c=a.gain.process(c)[0];a.prevGain!==c&&(a.prevGain=
c,b=!0);b&&(a.biquad.setParams(d,g,c),a.plotFlush=!0);a.bypassed||a.biquad.process(e);f.outputSignalAR(this)}return e};var a=new j(2048),e=h.Object.prototype.plot;g.plot=function(c){if(this._.plotFlush){var b=new d(h.samplerate);b.setType(this.type);b.setParams(this.freq.valueOf(),this.band.valueOf(),this.gain.valueOf());var g=new Float32Array(a.length);g[0]=1;b.process(g);a.forward(g);var b=new Float32Array(512),g=0.5*h.samplerate,f=a.spectrum,i,j,r,n;for(i=0;512>i;++i)r=20*Math.pow(g/20,i/512),
j=r/(g/f.length),r=j|0,j-=r,0===r?r=f[r]:(n=f[r-1],r=f[r],r=(1-j)*n+j*r),b[i]=20*Math.log(r)*Math.LOG10E;this._.plotData=b;this._.plotFlush=null}return e.call(this,c)};f.register("biquad",i);f.register("lowpass",function(c){return(new i(c)).set("type","lowpass")});f.register("highpass",function(c){return(new i(c)).set("type","highpass")});f.register("bandpass",function(c){return(new i(c)).set("type","bandpass")});f.register("lowshelf",function(c){return(new i(c)).set("type","lowshelf")});f.register("highshelf",
function(c){return(new i(c)).set("type","highshelf")});f.register("peaking",function(c){return(new i(c)).set("type","peaking")});f.register("notch",function(c){return(new i(c)).set("type","notch")});f.register("allpass",function(c){return(new i(c)).set("type","allpass")});f.alias("lpf","lowpass");f.alias("hpf","highpass");f.alias("bpf","bandpass");f.alias("bef","notch");f.alias("brf","notch");f.alias("apf","allpass")})(timbre);
(function(h){function i(c){h.Object.call(this,c);f.fixAR(this);c=this._;c.pitch=h(1);c.buffer=new Float32Array(0);c.isLooped=!1;c.isReversed=!1;c.duration=0;c.currentTime=0;c.currentTimeIncr=1E3*this.cell.length/h.samplerate;c.samplerate=44100;c.phase=0;c.phaseIncr=0;this.on("play",j)}var f=h.fn;f.extend(i);var j=function(c){this._.isEnded=!1===c},d=i.prototype,b=function(c){var a=this._;if("object"===typeof c){var e,b;c instanceof Float32Array?e=c:c.buffer instanceof Float32Array&&(e=c.buffer,"number"===
typeof c.samplerate&&(b=c.samplerate));e&&(0<b&&(a.samplerate=c.samplerate),a.buffer=e,a.phase=0,a.phaseIncr=a.samplerate/h.samplerate,a.duration=1E3*a.buffer.length/a.samplerate,a.currentTime=0,a.plotFlush=!0,this.reverse(a.isReversed))}};Object.defineProperties(d,{buffer:{set:b,get:function(){return this._.buffer}},pitch:{set:function(c){this._.pitch=h(c)},get:function(){return this._.pitch}},isLooped:{get:function(){return this._.isLooped}},isReversed:{get:function(){return this._.isReversed}},
isEnded:{get:function(){return this._.isEnded}},samplerate:{get:function(){return this._.samplerate}},duration:{get:function(){return this._.duration}},currentTime:{set:function(c){if("number"===typeof c){var a=this._;0<=c&&c<=a.duration&&(a.phase=c/1E3*a.samplerate,a.currentTime=c)}},get:function(){return this._.currentTime}}});d.clone=function(){var c=this._,a=h("buffer");c.buffer&&b.call(a,{buffer:c.buffer,samplerate:c.samplerate});a.loop(c.isLooped);a.reverse(c.isReversed);return a};d.slice=function(c,
a){var e=this._,d=h(e.originkey),c="number"===typeof c?0.001*c*e.samplerate|0:0,a="number"===typeof a?0.001*a*e.samplerate|0:e.buffer.length;if(c>a)var g=c,c=a,a=g;e.buffer&&(b.call(d,{buffer:e.buffer.subarray(c,a),samplerate:e.samplerate}),d._.isEnded=!1);d.loop(e.isLooped);d.reverse(e.isReversed);return d};d.reverse=function(c){var a=this._;a.isReversed=!!c;if(a.isReversed){if(0<a.phaseIncr&&(a.phaseIncr*=-1),0===a.phase&&a.buffer)a.phase=a.buffer.length+a.phaseIncr}else 0>a.phaseIncr&&(a.phaseIncr*=
-1);return this};d.loop=function(c){this._.isLooped=!!c;return this};d.bang=function(c){this._.phase=0;this._.isEnded=!1===c;this._.emit("bang");return this};d.process=function(c){var e=this._,b=this.cell;if(e.isEnded&&!e.buffer)return b;if(this.tickID!==c){this.tickID=c;var d=e.buffer,h=e.phase,i=e.mul,j=e.add,n=b.length;if(this.inputs.length){f.inputSignalAR(this);for(var o,p=0.001*e.samplerate,c=0;c<n;++c)o=b[c],h=o*p,b[c]=(d[h|0]||0)*i+j;e.phase=h;e.currentTime=o}else{c=e.pitch.process(c)[0];
o=e.phaseIncr*c;for(c=0;c<n;++c)b[c]=(d[h|0]||0)*i+j,h+=o;h>=d.length?e.isLooped?f.nextTick(g.bind(this)):f.nextTick(a.bind(this)):0>h&&(e.isLooped?f.nextTick(g.bind(this)):f.nextTick(a.bind(this)));e.phase=h;e.currentTime+=e.currentTimeIncr}}return b};var g=function(){var c=this._;c.phase>=c.buffer.length?c.phase=0:0>c.phase&&(c.phase=c.buffer.length+c.phaseIncr);this._.emit("looped")},a=function(){f.onended(this,0)},e=h.Object.prototype.plot;d.plot=function(c){var a=this._,b=a.buffer;if(a.plotFlush){for(var d=
new Float32Array(2048),g=0,f=b.length/2048,h=0;2048>h;h++)d[h]=b[g|0],g+=f;a.plotData=d;a.plotFlush=null}return e.call(this,c)};f.register("buffer",i)})(timbre);
(function(h){function i(b){h.Object.call(this,b);f.fixAR(this);b=new j(h.samplerate);b.setDelayTime(20);b.setRate(4);b.depth=20;b.feedback=0.2;b.mix=0.33;this._.chorus=b}var f=h.fn,j=h.modules.Chorus;f.extend(i);var d=i.prototype;Object.defineProperties(d,{type:{set:function(b){this._.chorus.setDelayTime(b)},get:function(){return this._.chorus.wave}},delay:{set:function(b){0.5<=b&&80>=b&&this._.chorus.setDelayTime(b)},get:function(){return this._.chorus.delayTime}},rate:{set:function(b){"number"===
typeof b&&0<b&&this._.chorus.setRate(b)},get:function(){return this._.chorus.rate}},depth:{set:function(b){"number"===typeof b&&(0<=b&&100>=b)&&(b*=h.samplerate/44100,this._.chorus.depth=b)},get:function(){return this._.chorus.depth}},fb:{set:function(b){"number"===typeof b&&(-1<=b&&1>=b)&&(this._.chorus.feedback=0.99996*b)},get:function(){return this._.chorus.feedback}},mix:{set:function(b){this._.mix=h(b)},get:function(){return this._.mix}}});d.process=function(b){var d=this._,a=this.cell;this.tickID!==
b&&(this.tickID=b,f.inputSignalAR(this),d.bypassed||d.chorus.process(a),f.outputSignalAR(this));return a};f.register("chorus",i)})(timbre);
(function(h){function i(d){h.Object.call(this,d);d=this._;d.min=-0.8;d.max=0.8}var f=h.fn;f.extend(i);var j=i.prototype;Object.defineProperties(j,{minmax:{set:function(d){var b=this._;"number"===typeof d&&(b.min=-Math.abs(d),b.max=-b.min)},get:function(){return this._.max}},min:{set:function(d){var b=this._;"number"===typeof d&&(b.max<d?b.max=d:b.min=d)},get:function(){return this._.min}},max:{set:function(d){var b=this._;"number"===typeof d&&(d<b.min?b.min=d:b.max=d)},get:function(){return this._.max}}});
j.process=function(d){var b=this.cell,g=this._;if(this.tickID!==d){this.tickID=d;var a=this.inputs,e=g.mul,c=g.add,l=a.length,k,f=b.length,h=g.min,i=g.max,j;for(k=f;k--;)b[k]=0;if(g.ar){for(g=0;g<l;++g){j=a[g].process(d);for(k=f;k--;)b[k]+=j[k]}for(k=f;k--;)d=b[k],d=d<h?h:d>i?i:d,b[k]=d;if(1!==e||0!==c)for(k=f;k--;)b[k]=b[k]*e+c}else{for(g=j=0;g<l;++g)j+=a[g].process(d)[0];j=(j<h?h:j>i?i:j)*e+c;for(k=f;k--;)b[k]=j}}return b};f.register("clip",i)})(timbre);
(function(h){function i(b){h.Object.call(this,b);f.fixAR(this);b=this._;b.thresh=h(-24);b.knee=h(30);b.ratio=h(12);b.postGain=6;b.reduction=0;b.comp=new d(h.samplerate);b.comp.dbPostGain=b.postGain;b.comp.setAttackTime(0.003);b.comp.setReleaseTime(0.25)}var f=h.fn,j=h.timevalue,d=h.modules.Compressor;f.extend(i);var b=i.prototype;Object.defineProperties(b,{thresh:{set:function(b){this._.thresh=h(b)},get:function(){return this._.thresh}},knee:{set:function(b){this._.kne=h(b)},get:function(){return this._.knee}},
ratio:{set:function(b){this._.ratio=h(b)},get:function(){return this._.ratio}},gain:{set:function(b){"number"===typeof b&&(this._.postGain=b,this._.comp.dbPostGain=b)},get:function(){return this._.postGain}},attack:{set:function(b){"string"===typeof b&&(b=j(b));"number"===typeof b&&(b=0>b?0:1E3<b?1E3:b,this._.attack=b,this._.comp.setAttackTime(0.001*b))},get:function(){return this._.comp.attackTime}},release:{set:function(b){"string"===typeof b&&(b=j(b),0>=b&&(b=0));"number"===typeof b&&(b=0>b?0:
1E3<b?1E3:b,this._.release=b,this._.comp.releaseTime=0.001*b)},get:function(){return this._.release}},reduction:{get:function(){return this._.reduction}}});b.process=function(b){var a=this._,e=this.cell;if(this.tickID!==b){this.tickID=b;f.inputSignalAR(this);var c=a.thresh.process(b)[0],d=a.knee.process(b)[0],b=a.ratio.process(b)[0];if(a.prevThresh!==c||a.prevKnee!==d||a.prevRatio!==b)a.prevThresh=c,a.prevKnee=d,a.prevRatio=b,a.comp.setParams(c,d,b);a.bypassed||(a.comp.process(e),a.reduction=a.comp.meteringGain);
f.outputSignalAR(this)}return e};f.register("comp",i);f.alias("compressor","comp")})(timbre);
(function(h){function i(b){h.Object.call(this,b);f.fixAR(this);b=this._;b.freq=h(440);b.osc1=new j(h.samplerate);b.osc2=new j(h.samplerate);b.osc1.step=this.cell.length;b.osc2.step=this.cell.length;b.tmp=new Float32Array(this.cell.length);b.beats=0.5;this.once("init",d)}var f=h.fn,j=h.modules.Oscillator;f.extend(i);var d=function(){this.wave||(this.wave="sin")},b=i.prototype;Object.defineProperties(b,{wave:{set:function(b){this._.osc1.setWave(b);this._.osc2.setWave(b)},get:function(){return this._.osc1.wave}},
freq:{set:function(b){this._.freq=h(b)},get:function(){return this._.freq}},beats:{set:function(b){"number"===typeof b&&0<b&&(this._.beats=b)},get:function(){return this._.beats}}});b.bang=function(){this._.osc1.reset();this._.osc2.reset();this._.emit("bang");return this};b.process=function(b){var a=this._,e=this.cell;if(this.tickID!==b){this.tickID=b;var c,d=e.length,b=a.freq.process(b)[0];c=a.osc1;var k=a.osc2,m=a.tmp;c.frequency=b-0.5*a.beats;c.process(m);for(c=d;c--;)e[c]=0.5*m[c];k.frequency=
b+0.5*a.beats;k.process(m);for(c=d;c--;)e[c]+=0.5*m[c];f.outputSignalAR(this)}return e};f.register("cosc",i)})(timbre);
(function(h){function i(a){h.Object.call(this,a);f.fixAR(this);a=this._;a.fb=h(0.2);a.mix=0.33;a.delay=new d;this.once("init",b)}var f=h.fn,j=h.timevalue,d=h.modules.EfxDelay;f.extend(i);var b=function(){this._.time||(this.time=100)},g=i.prototype;Object.defineProperties(g,{time:{set:function(a){"string"===typeof a&&(a=j(a));"number"===typeof a&&(0<a&&15E3>a)&&(this._.time=a,this._.delay.setParams({time:a}))},get:function(){return this._.time}},fb:{set:function(a){this._.fb=h(a)},get:function(){return this._.fb}},
mix:{set:function(a){"number"===typeof a&&(this._.mix=1<a?1:0>a?0:a)},get:function(){return this._.mix}},wet:{set:function(a){"number"===typeof a&&(this._.mix=1<a?1:0>a?0:a)},get:function(){return this._.mix}}});g.process=function(a){var b=this._,c=this.cell;if(this.tickID!==a){this.tickID=a;f.inputSignalAR(this);var a=b.fb.process(a)[0],d=b.mix;if(b.prevFb!==a||b.prevMix!==d)b.prevFb=a,b.prevMix=d,b.delay.setParams({feedback:a,wet:d});b.bypassed||b.delay.process(c,!0);f.outputSignalAR(this)}return c};
f.register("delay",i)})(timbre);
(function(h){function i(d){h.Object.call(this,d);f.fixAR(this);d=this._;d.pre=h(60);d.post=h(-18);d.samplerate=h.samplerate;d.x1=d.x2=d.y1=d.y2=0;d.b0=d.b1=d.b2=d.a1=d.a2=0;d.cutoff=0}var f=h.fn;f.extend(i);var j=i.prototype;Object.defineProperties(j,{cutoff:{set:function(d){"number"===typeof d&&0<d&&(this._.cutoff=d)},get:function(){return this._.cutoff}},pre:{set:function(d){this._.pre=h(d)},get:function(){return this._.pre}},post:{set:function(d){this._.post=h(d)},get:function(){return this._.post}}});
j.process=function(d){var b=this._,g=this.cell;if(this.tickID!==d){this.tickID=d;f.inputSignalAR(this);var a=-b.pre.process(d)[0],d=-b.post.process(d)[0];if(b.prevPreGain!==a||b.prevPostGain!==d)b.prevPreGain=a,b.prevPostGain=d,d=Math.pow(2,0.166666666*-d),b.preScale=Math.pow(2,0.166666666*-a)*d,b.limit=d;if(b.bypassed)f.outputSignalAR(this);else{var a=b.preScale,d=b.limit,e=b.mul,c=b.add,l,k,m,h;if(b.cutoff){b.prevCutoff!==b.cutoff&&(b.prevCutoff=b.cutoff,l=b.cutoff/(0.5*b.samplerate),1<=l?(b.b0=
1,b.b1=b.b2=b.a1=b.a2=0):0>=l?b.b0=b.b1=b.b2=b.a1=b.a2=0:(k=Math.pow(10,0.05),k=Math.sqrt(0.5*(4-Math.sqrt(16-16/(k*k)))),l*=Math.PI,k=0.5*k*Math.sin(l),k=0.5*(1-k)/(1+k),l=(0.5+k)*Math.cos(l),m=0.25*(0.5+k-l),b.b0=2*m,b.b1=4*m,b.b2=b.b0,b.a1=2*-l,b.a2=2*k));var i=b.x1,j=b.x2,n=b.y1,o=b.y2,p=b.b0,q=b.b1,u=b.b2,v=b.a1,w=b.a2;l=0;for(k=g.length;l<k;++l)m=g[l]*a,h=p*m+q*i+u*j-v*n-w*o,h=h>d?d:h<-d?-d:h,g[l]=h*e+c,j=i,i=m,o=n,n=h;if(0<i&&1.0E-4>i||0>i&&-1.0E-4<i)i=0;if(0<n&&1.0E-4>n||0>n&&-1.0E-4<n)n=
0;b.x1=i;b.x2=j;b.y1=n;b.y2=o}else for(l=g.length;l--;)m=g[l]*a,m=m>d?d:m<-d?-d:m,g[l]=m*e+c}}return g};f.register("distortion",i);f.alias("dist","distortion")})(timbre);
(function(h){function i(f){h.Object.call(this,f)}var f=h.fn;f.extend(i);i.prototype.process=function(h){var d=this.cell,b=this._;if(this.tickID!==h){this.tickID=h;var g=this.inputs,a=g.length,e,c=d.length,l,k;if(b.ar){if(0<g.length){l=g[0].process(h);d.set(l);for(b=1;b<a;++b){l=g[b].process(h);for(e=c;e--;)k=l[e],d[e]=0===k?0:d[e]/k}}else for(e=c;e--;)d[e]=0;f.outputSignalAR(this)}else{if(0<g.length){l=g[0].process(h)[0];for(b=1;b<a;++b)k=g[b].process(h)[0],l=0===k?0:l/k}else l=0;d[0]=l;f.outputSignalKR(this)}}return d};
f.register("/",i)})(timbre);
(function(h){function i(c){h.Object.call(this,c);c=this._;c.env=new b(h.samplerate);c.env.setStep(this.cell.length);c.tmp=new Float32Array(this.cell.length);c.ar=!1;c.plotFlush=!0;this.on("ar",a)}function f(c,a,b,e,d,g){"number"===typeof c[e]?b=c[e]:"number"===typeof c[d]?b=c[d]:g&&("string"===typeof c[e]?b=g(c[e]):"string"===typeof c[d]&&(b=g(c[d])));b<a&&(b=a);return b}var j=h.fn,d=h.timevalue,b=h.modules.Envelope,g=j.isDictionary;j.extend(i);var a=function(c){this._.env.setStep(c?1:this.cell.length)},
e=i.prototype;Object.defineProperties(e,{table:{set:function(c){if(Array.isArray(c)){for(var a=this._.env,e=[c[0]||l],g,f,h,i,j=1,q=c.length;j<q;++j)g=c[j][0]||l,f=c[j][1],h=c[j][2],"number"!==typeof f&&(f="string"===typeof f?d(f):10),10>f&&(f=10),"number"===typeof h?(i=h,h=b.CurveTypeCurve):(h=b.CurveTypeDict[h]||null,i=0),e.push([g,f,h,i]);a.setTable(e);this._.plotFlush=!0}},get:function(){return this._.env.table}},curve:{set:function(c){this._.env.setCurve(c)},get:function(){return this._.env.curve}},
releaseNode:{set:function(c){this._.env.setReleaseNode(c);this._.plotFlush=!0},get:function(){return this._.env.releaseNode+1}},loopNode:{set:function(c){this._.env.setLoopNode(c);this._.plotFlush=!0},get:function(){return this._.env.loopNode+1}}});e.clone=function(){var c=new i([]);c._.env=this._.env.clone();return c};e.reset=function(){this._.env.reset();return this};e.release=function(){var c=this._;c.env.release();c.emit("released");return this};e.bang=function(){var c=this._;c.env.reset();c.env.status=
b.StatusGate;c.emit("bang");return this};e.process=function(c){var a=this._,b=this.cell;if(this.tickID!==c){this.tickID=c;var e,c=b.length,d=a.mul,g=a.add;if(this.inputs.length)j.inputSignalAR(this);else for(e=c;e--;)b[e]=1;var f;e=null;if(a.ar){f=a.tmp;a.env.process(f);for(e=c;e--;)b[e]=b[e]*f[e]*d+g}else{f=a.env.next();for(e=c;e--;)b[e]=b[e]*f*d+g}(e=a.env.emit)&&("ended"===e?j.nextTick(j.onended.bind(null,this,0)):this._.emit(e,a.value))}return b};var c=h.Object.prototype.plot;e.plot=function(a){if(this._.plotFlush){var e=
this._.env.clone(),d=e.getInfo(1E3),g=d.totalDuration,f=d.loopBeginTime,l=d.releaseBeginTime,d=new Float32Array(256),i=0,j=g/d.length,q=!1,u=0.001*g*h.samplerate|0,v,u=u/d.length;e.setStep(u);e.status=b.StatusGate;u=0;for(v=d.length;u<v;++u)d[u]=e.next(),i+=j,!q&&i>=l&&(e.release(),q=!0);this._.plotData=d;this._.plotBefore=function(c,a,b,e,d){var k;Infinity!==f&&Infinity!==l&&(b=a+e*(f/g),k=a+e*(l/g),c.fillStyle="rgba(224, 224, 224, 0.8)",c.fillRect(b,0,k-b,d));Infinity!==l&&(b=a+e*(l/g),c.fillStyle=
"rgba(212, 212, 212, 0.8)",c.fillRect(b,0,e-b,d))};e=Infinity;i=-Infinity;for(u=0;u<v;++u)d[u]<e?e=d[u]:d[u]>i&&(i=d[u]);1>i&&(i=1);this._.plotRange=[e,i];this._.plotData=d;this._.plotFlush=null}return c.call(this,a)};j.register("env",i);var l=b.ZERO;j.register("perc",function(c){g(c[0])||c.unshift({});var a=c[0],b=f(a,10,10,"a","attackTime",d),e=f(a,10,1E3,"r","decayTime",d),h=f(a,l,1,"lv","level");a.table=[l,[h,b],[l,e]];return new i(c)});j.register("adsr",function(c){g(c[0])||c.unshift({});var a=
c[0],b=f(a,10,10,"a","attackTime",d),e=f(a,10,300,"d","decayTime",d),h=f(a,l,0.5,"s","sustainLevel"),j=f(a,10,1E3,"r","decayTime",d),o=f(a,l,1,"lv","level");a.table=[l,[o,b],[h,e],[l,j]];a.releaseNode=3;return new i(c)});j.register("adshr",function(c){g(c[0])||c.unshift({});var a=c[0],b=f(a,10,10,"a","attackTime",d),e=f(a,10,300,"d","decayTime",d),h=f(a,l,0.5,"s","sustainLevel"),j=f(a,10,500,"h","holdTime",d),o=f(a,10,1E3,"r","decayTime",d),p=f(a,l,1,"lv","level");a.table=[l,[p,b],[h,e],[h,j],[l,
o]];return new i(c)});j.register("asr",function(c){g(c[0])||c.unshift({});var a=c[0],b=f(a,10,10,"a","attackTime",d),e=f(a,l,0.5,"s","sustainLevel"),h=f(a,10,1E3,"r","releaseTime",d);a.table=[l,[e,b],[l,h]];a.releaseNode=2;return new i(c)});j.register("dadsr",function(c){g(c[0])||c.unshift({});var a=c[0],b=f(a,10,100,"dl","delayTime",d),e=f(a,10,10,"a","attackTime",d),h=f(a,10,300,"d","decayTime",d),j=f(a,l,0.5,"s","sustainLevel"),o=f(a,10,1E3,"r","relaseTime",d),p=f(a,l,1,"lv","level");a.table=[l,
[l,b],[p,e],[j,h],[l,o]];a.releaseNode=4;return new i(c)});j.register("ahdsfr",function(c){g(c[0])||c.unshift({});var a=c[0],b=f(a,10,10,"a","attackTime",d),e=f(a,10,10,"h","holdTime",d),h=f(a,10,300,"d","decayTime",d),j=f(a,l,0.5,"s","sustainLevel"),o=f(a,10,5E3,"f","fadeTime",d),p=f(a,10,1E3,"r","relaseTime",d),q=f(a,l,1,"lv","level");a.table=[l,[q,b],[q,e],[j,h],[l,o],[l,p]];a.releaseNode=5;return new i(c)});j.register("linen",function(c){g(c[0])||c.unshift({});var a=c[0],b=f(a,10,10,"a","attackTime",
d),e=f(a,10,1E3,"s","sustainTime",d),h=f(a,10,1E3,"r","releaseTime",d),j=f(a,l,1,"lv","level");a.table=[l,[j,b],[j,e],[l,h]];return new i(c)});j.register("env.tri",function(c){g(c[0])||c.unshift({});var a=c[0],b=f(a,20,1E3,"dur","duration",d),e=f(a,l,1,"lv","level"),b=0.5*b;a.table=[l,[e,b],[l,b]];return new i(c)});j.register("env.cutoff",function(c){g(c[0])||c.unshift({});var a=c[0],b=f(a,10,100,"r","relaseTime",d),e=f(a,l,1,"lv","level");a.table=[e,[l,b]];return new i(c)})})(timbre);
(function(h){function i(c){h.Object.call(this,c);f.fixAR(this);c=this._;c.biquads=Array(7);c.plotBefore=g;c.plotRange=[-18,18];c.plotFlush=!0}var f=h.fn,j=h.modules.FFT,d=h.modules.Biquad,b={hpf:0,lf:1,lmf:2,mf:3,hmf:4,hf:5,lpf:6};f.extend(i);var g=function(c,a,b,e,d){c.lineWidth=1;c.strokeStyle="rgb(192, 192, 192)";for(var g=0.5*h.samplerate,f=1;10>=f;++f)for(var i=1;4>=i;i++){var j=f*Math.pow(10,i);20>=j||g<=j||(c.beginPath(),j=Math.log(j/20)/Math.log(g/20),j=(j*e+a|0)+0.5,c.moveTo(j,b),c.lineTo(j,
b+d),c.stroke())}d/=6;for(f=1;6>f;f++)c.beginPath(),g=(b+f*d|0)+0.5,c.moveTo(a,g),c.lineTo(a+e,g),c.stroke()},a=i.prototype;Object.defineProperties(a,{params:{set:function(c){if("object"===typeof c)for(var a=Object.keys(c),b=0,e=a.length;b<e;++b){var d=c[a[b]];Array.isArray(d)?this.setParams(a[b],d[0],d[1],d[2]):this.setParams(a[b])}}}});a.setParams=function(c,a,e,g){var f=this._;"string"===typeof c&&(c=b[c]);if(0<=c&&c<f.biquads.length){c|=0;if("number"===typeof a&&"number"===typeof e){"number"!==
typeof g&&(g=0);var i=f.biquads[c];if(!i)switch(i=f.biquads[c]=new d(h.samplerate),c){case 0:i.setType("highpass");break;case f.biquads.length-1:i.setType("lowpass");break;default:i.setType("peaking")}i.setParams(a,e,g)}else f.biquads[c]=void 0;f.plotFlush=!0}return this};a.getParams=function(c){if(c=this._.biquads[c|0])return{freq:c.frequency,Q:c.Q,gain:c.gain}};a.process=function(c){var a=this._,b=this.cell;if(this.tickID!==c){this.tickID=c;f.inputSignalAR(this);if(!a.bypassed)for(var c=a.biquads,
a=0,e=c.length;a<e;++a)c[a]&&c[a].process(b);f.outputSignalAR(this)}return b};var e=new j(2048),c=h.Object.prototype.plot;a.plot=function(a){if(this._.plotFlush){var b=this._,g=new Float32Array(e.length);g[0]=1;for(var f=0,b=b.biquads.length;f<b;++f){var i=this.getParams(f);if(i){var j=new d(h.samplerate);0===f?j.setType("highpass"):f===b-1?j.setType("lowpass"):j.setType("peaking");j.setParams(i.freq,i.Q,i.gain);j.process(g)}}e.forward(g);for(var g=new Float32Array(512),b=0.5*h.samplerate,i=e.spectrum,
n,o,f=0;512>f;++f)j=20*Math.pow(b/20,f/512),n=j/(b/i.length),j=n|0,n-=j,0===j?j=i[j]:(o=i[j-1],j=i[j],j=(1-n)*o+n*j),g[f]=20*Math.log(j)*Math.LOG10E;this._.plotData=g;this._.plotFlush=null}return c.call(this,a)};f.register("eq",i)})(timbre);
(function(h){function i(b){h.Object.call(this,b);f.listener(this);f.stereo(this);f.fixAR(this);this.real=this.L;this.imag=this.R;this._.fft=new j(2*h.cellsize);this._.fftCell=new Float32Array(this._.fft.length);this._.prevCell=new Float32Array(h.cellsize);this._.plotFlush=!0;this._.plotRange=[0,1];this._.plotBarStyle=!0}var f=h.fn,j=h.modules.FFT;f.extend(i);var d=i.prototype;Object.defineProperties(d,{window:{set:function(b){this._.fft.setWindow(b)},get:function(){return this._.fft.windowName}},
spectrum:{get:function(){return this._.fft.spectrum}}});d.process=function(b){var a=this._,e=this.cell;if(this.tickID!==b){this.tickID=b;f.inputSignalAR(this);a.fftCell.set(a.prevCell);a.fftCell.set(e,e.length);a.fft.forward(a.fftCell);a.prevCell.set(e);for(var b=this.cellL,c=this.cellR,d=a.fft.real,a=a.fft.imag,k=e.length;k--;)b[k]=d[k],c[k]=a[k];this._.plotFlush=!0}return e};var b=h.Object.prototype.plot;d.plot=function(d){if(this._.plotFlush){var a=this._.fft.spectrum,e=a.length/64,c=1/e,f=new Float32Array(64),
k,h=a.length,i,j,r=0,n=0;for(k=0;k<h;k+=e){for(i=j=0;i<e;++i)j+=a[k+i];i=j*c;f[r++]=i;n<i&&(n=i)}for(k=f.length;k--;)f[k]/=n;this._.plotData=f;this._.plotFlush=null}return b.call(this,d)};f.register("fft",i)})(timbre);
(function(h){function i(d){h.Object.call(this,d);f.fixAR(this);d=this._;d.freq=h(440);d.samplerate=h.samplerate;d.reg=32768;d.shortFlag=!1;d.phase=0;d.lastValue=0}var f=h.fn;f.extend(i);var j=i.prototype;Object.defineProperties(j,{shortFlag:{set:function(d){this._.shortFlag=!!d},get:function(){return this._.shortFlag}},freq:{set:function(d){this._.freq=h(d)},get:function(){return this._.freq}}});j.process=function(d){var b=this._,g=this.cell;if(this.tickID!==d){this.tickID=d;var a=b.lastValue,e=b.phase,
d=b.freq.process(d)[0]/b.samplerate,c=b.reg,f=b.mul,k=b.add,h,i;if(b.shortFlag){h=0;for(i=g.length;h<i;++h)1<=e&&(c>>=1,c|=((c^c>>6)&1)<<15,a=(c&1)-0.5,e-=1),g[h]=a*f+k,e+=d}else{h=0;for(i=g.length;h<i;++h)1<=e&&(c>>=1,c|=((c^c>>1)&1)<<15,a=(c&1)-0.5,e-=1),g[h]=a*f+k,e+=d}b.reg=c;b.phase=e;b.lastValue=a}return g};f.register("fnoise",i)})(timbre);
(function(h){function i(b){h.Object.call(this,b);f.fixAR(this);this._.selected=0;this._.outputs=[];d=new Float32Array(this.cell.length)}var f=h.fn,j=h.ChannelObject,d;f.extend(i);var b=i.prototype;Object.defineProperties(b,{selected:{set:function(b){var a=this._;if("number"===typeof b){a.selected=b;b=a.outputs;for(a=b.length;a--;)b[a]&&b[a].cell.set(d)}},get:function(){return this._.selected}}});b.at=function(b){var a=this._,e=a.outputs[b];e||(a.outputs[b]=e=new j(this));return e};b.process=function(b){var a=
this._,e=this.cell;this.tickID!==b&&(this.tickID=b,f.inputSignalAR(this),f.outputSignalAR(this),a.outputs[a.selected]&&a.outputs[a.selected].cell.set(this.cell));return e};f.register("gate",i)})(timbre);
(function(h){function i(b){h.Object.call(this,b);f.fixAR(this);b=this._;b.fft=new j(2*h.cellsize);b.fftCell=new Float32Array(this._.fft.length);b.realBuffer=new Float32Array(this._.fft.length);b.imagBuffer=new Float32Array(this._.fft.length)}var f=h.fn,j=h.modules.FFT;f.extend(i);var d=i.prototype;Object.defineProperties(d,{real:{set:function(b){this._.real=h(b)},get:function(){return this._.real}},imag:{set:function(b){this._.imag=h(b)},get:function(){return this._.imag}}});d.process=function(b){var d=
this._,a=this.cell;if(this.tickID!==b&&(this.tickID=b,d.real&&d.imag)){var e=d.realBuffer,c=d.imagBuffer,l=d.real.process(b),b=d.imag.process(b);e.set(l);c.set(b);a.set(d.fft.inverse(e,c).subarray(0,a.length));f.outputSignalAR(this)}return a};f.register("ifft",i)})(timbre);
(function(h){function i(a){h.Object.call(this,a);f.timer(this);f.fixKR(this);a=this._;a.interval=h(1E3);a.count=0;a.delay=0;a.timeout=Infinity;a.currentTime=0;a.currentTimeIncr=1E3*h.cellsize/h.samplerate;a.delaySamples=0;a.countSamples=0;a.isEnded=!1;this.on("start",d)}var f=h.fn,j=h.timevalue;f.extend(i);var d=function(){var a=this._;a.delaySamples=h.samplerate*0.001*a.delay|0;a.countSamples=a.count=a.currentTime=0;a.isEnded=!1};Object.defineProperty(d,"unremovable",{value:!0,writable:!1});var b=
function(){this._.isEnded=!0;this._.emit("ended")},g=i.prototype;Object.defineProperties(g,{interval:{set:function(a){"string"===typeof a&&(a=j(a),0>=a&&(a=0));this._.interval=h(a)},get:function(){return this._.interval}},delay:{set:function(a){"string"===typeof a&&(a=j(a));"number"===typeof a&&0<=a&&(this._.delay=a,this._.delaySamples=h.samplerate*0.001*a|0)},get:function(){return this._.delay}},count:{set:function(a){"number"===typeof a&&(this._.count=a)},get:function(){return this._.count}},timeout:{set:function(a){"string"===
typeof a&&(a=j(a));"number"===typeof a&&0<=a&&(this._.timeout=a)},get:function(){return this._.timeout}},currentTime:{get:function(){return this._.currentTime}}});g.bang=function(){var a=this._;a.delaySamples=h.samplerate*0.001*a.delay|0;a.countSamples=a.count=a.currentTime=0;a.isEnded=!1;a.emit("bang");return this};g.process=function(a){var e=this.cell,c=this._;if(c.isEnded)return e;if(this.tickID!==a){this.tickID=a;0<c.delaySamples&&(c.delaySamples-=e.length);a=c.interval.process(a)[0];if(0>=c.delaySamples&&
(c.countSamples-=e.length,0>=c.countSamples)){c.countSamples+=0.001*h.samplerate*a|0;for(var a=this.inputs,d=c.count,g=d*c.mul+c.add,i=e.length;i--;)e[i]=g;g=0;for(i=a.length;g<i;++g)a[g].bang(d);c.count+=1}c.currentTime+=c.currentTimeIncr;c.currentTime>=c.timeout&&f.nextTick(b.bind(this))}return e};f.register("interval",i)})(timbre);
(function(h){function i(c){if(j)return j;j=this;h.Object.call(this,c);f.fixKR(this)}if("browser"===h.envtype){var f=h.fn,j=null;f.extend(i);var d={},b=!1,g=!1,a=!1,e=function(c){for(var e=j._,f=j.cell,e=c.keyCode*e.mul+e.add,l=f.length;l--;)f[l]=e;b=c.shiftKey;g=c.ctrlKey;a=c.altKey;d[c.keyCode]||(d[c.keyCode]=!0,j._.emit("keydown",c))},c=function(c){delete d[c.keyCode];j._.emit("keyup",c)},l=i.prototype;Object.defineProperties(l,{shiftKey:{get:function(){return b}},ctrlKey:{get:function(){return g}},
altKey:{get:function(){return a}}});l.start=function(){window.addEventListener("keydown",e,!0);window.addEventListener("keyup",c,!0);return this};l.stop=function(){window.removeEventListener("keydown",e,!0);window.removeEventListener("keyup",c,!0);return this};l.play=l.pause=function(){return this};f.register("keyboard",i)}})(timbre);
(function(h){function i(b){h.Object.call(this,b);b=this._;b.input=0;b.value=0;b.prev=null;b.ar=!1;b.map=j}var f=h.fn;f.extend(i);var j=function(b){return b},d=i.prototype;Object.defineProperties(d,{input:{set:function(b){"number"===typeof b&&(this._.input=b)},get:function(){return this._.input}},map:{set:function(b){"function"===typeof b&&(this._.map=b)},get:function(){return this._.map}}});d.bang=function(){this._.prev=null;this._.emit("bang");return this};d.at=function(b){return this._.map?this._.map(b):
0};d.process=function(b){var d=this.cell,a=this._;if(this.tickID!==b){this.tickID=b;var e=this.inputs.length,b=d.length;if(a.ar&&e){f.inputSignalAR(this);var c=a.map;if(c)for(e=b;e--;)d[e]=c(d[e]);a.value=d[b-1];f.outputSignalAR(this)}else{e=e?f.inputSignalKR(this):a.input;a.map&&a.prev!==e&&(a.prev=e,a.value=a.map(e));a=a.value*a.mul+a.add;for(e=b;e--;)d[e]=a}}return d};f.register("map",i)})(timbre);
(function(h){function i(f){h.Object.call(this,f)}var f=h.fn;f.extend(i);i.prototype.process=function(h){var d=this.cell,b=this._;if(this.tickID!==h){this.tickID=h;var g=this.inputs,a=g.length,e,c=d.length,l,k;if(b.ar){if(0<g.length){l=g[0].process(h);d.set(l);for(b=1;b<a;++b){l=g[b].process(h);for(e=c;e--;)k=l[e],d[e]<k&&(d[e]=k)}}else for(e=c;e--;)d[e]=0;f.outputSignalAR(this)}else{if(0<g.length){l=g[0].process(h)[0];for(b=1;b<a;++b)k=g[b].process(h)[0],l<k&&(l=k)}else l=0;d[0]=l;f.outputSignalKR(this)}}return d};
f.register("max",i)})(timbre);
(function(h){function i(a){h.Object.call(this,a);f.fixAR(this);f.stereo(this);a=this._;a.src=a.func=null;a.bufferL=new Float32Array(j);a.bufferR=new Float32Array(j);a.readIndex=0;a.writeIndex=0;a.totalRead=0;a.totalWrite=0}if("browser"===h.envtype){var f=h.fn,j=4096,d=j-1;f.extend(i);var b=i.prototype;b.listen=function(a){var c=g[h.env];c&&(c.set.call(this,a),c.listen.call(this))};b.unlisten=function(){var a=g[h.env];a&&a.unlisten.call(this);for(var c=this.cell,b=this.cellL,d=this.cellR,a=c.length;a--;)c[a]=
b[a]=d[a]=0;a=this._;c=a.bufferL;b=a.bufferR;for(a=c.length;a--;)c[a]=b[a]=0};b.process=function(a){var c=this.cell,b=this._;if(null===b.src)return c;if(this.tickID!==a){this.tickID=a;var a=b.bufferL,g=b.bufferR,h,i=c.length;if(b.totalWrite>b.totalRead+c.length){var j=this.cellL,r=this.cellR,n=b.readIndex;for(h=0;h<i;++h,++n)j[h]=a[n],r[h]=g[n],c[h]=0.5*(j[h]+r[h]);b.readIndex=n&d;b.totalRead+=c.length}f.outputSignalAR(this)}return c};var g={webkit:{set:function(a){var c=this._;a instanceof HTMLMediaElement&&
(c.src=f._audioContext.createMediaElementSource(a))},listen:function(){var b=this._,c=f._audioContext;b.gain=c.createGainNode();b.gain.gain.value=0;b.node=c.createJavaScriptNode(1024,2,1);b.node.onaudioprocess=a.bind(this);b.src.connect(b.node);b.node.connect(b.gain);b.gain.connect(c.destination)},unlisten:function(){var a=this._;a.src&&a.src.disconnect();a.gain&&a.gain.disconnect();a.node&&a.node.disconnect()}}},a=function(a){var c=this._,b=a.inputBuffer.getChannelData(0),a=a.inputBuffer.getChannelData(1),
g=c.bufferL,f=c.bufferR,h=c.writeIndex,i,j=b.length;for(i=0;i<j;++i,++h)g[h]=b[i],f[h]=a[i];c.writeIndex=h&d;c.totalWrite+=b.length};g.moz={set:function(a){var c=this._;a instanceof HTMLAudioElement&&(c.src=a,c.istep=h.samplerate/a.mozSampleRate)},listen:function(){var a=this._,c=a.bufferL,b=a.bufferR,g=0,f=0;2===a.src.mozChannels?(a.x=0,a.func=function(h){var i=a.writeIndex,j=a.totalWrite,h=h.frameBuffer,n,o=a.istep,p,q=h.length;n=a.x;for(p=0;p<q;p+=2)for(n+=o;0<n;)c[i]=0.5*(h[p]+g),b[i]=0.5*(h[p+
1]+f),g=h[p],f=h[p+1],i=i+1&d,++j,n-=1;a.x=n;a.writeIndex=i;a.totalWrite=j}):(a.x=0,a.func=function(g){var f=a.writeIndex,h=a.totalWrite,g=g.frameBuffer,k,i=a.istep,j,m=g.length;k=a.x;for(j=0;j<m;++j)for(k+=i;0<=k;)c[f]=b[f]=g[j],f=f+1&d,++h,k-=1;a.x=k;a.writeIndex=f;a.totalWrite=h});a.src.addEventListener("MozAudioAvailable",a.func)},unlisten:function(){var a=this._;a.func&&(a.src.removeEventListener("MozAudioAvailable",a.func),a.func=null)}};f.register("mediastream",i)}})(timbre);
(function(h){function i(d){h.Object.call(this,d);d=this._;d.midi=0;d.value=0;d.prev=null;d.a4=440;d.ar=!1}var f=h.fn;f.extend(i);var j=i.prototype;Object.defineProperties(j,{midi:{set:function(d){"number"===typeof d&&(this._.midi=d)},get:function(){return this._.midi}},a4:{set:function(d){"number"===typeof d&&(this._.a4=d,this._.prev=null)},get:function(){return this._.a4}}});j.bang=function(){this._.prev=null;this._.emit("bang");return this};j.at=function(d){return this._.a4*Math.pow(2,(d-69)/12)};
j.process=function(d){var b=this.cell,g=this._;if(this.tickID!==d){this.tickID=d;var a=this.inputs.length,d=b.length;if(g.ar&&a){f.inputSignalAR(this);for(var e=g.a4,a=d;a--;)b[a]=e*Math.pow(2,(b[a]-69)/12);g.value=b[d-1];f.outputSignalAR(this)}else{a=this.inputs.length?f.inputSignalKR(this):g.midi;g.prev!==a&&(g.prev=a,g.value=g.a4*Math.pow(2,(a-69)/12));g=g.value*g.mul+g.add;for(a=d;a--;)b[a]=g}}return b};f.register("midicps",i)})(timbre);
(function(h){function i(d){h.Object.call(this,d);d=this._;d.midi=0;d.value=0;d.prev=null;d.range=12;d.ar=!1}var f=h.fn;f.extend(i);var j=i.prototype;Object.defineProperties(j,{midi:{set:function(d){"number"===typeof d&&(this._.midi=d)},get:function(){return this._.midi}},range:{set:function(d){"number"===typeof d&&0<d&&(this._.range=d)},get:function(){return this._.range}}});j.bang=function(){this._.prev=null;this._.emit("bang");return this};j.at=function(d){return Math.pow(2,d/this._.range)};j.process=
function(d){var b=this.cell,g=this._;if(this.tickID!==d){this.tickID=d;var a=this.inputs.length,d=b.length;if(g.ar&&a){f.inputSignalAR(this);for(var e=g.range,a=d;a--;)b[a]=Math.pow(2,b[a]/e);g.value=b[d-1];f.outputSignalAR(this)}else{a=this.inputs.length?f.inputSignalKR(this):g.midi;g.prev!==a&&(g.prev=a,g.value=Math.pow(2,a/g.range));g=g.value*g.mul+g.add;for(a=d;a--;)b[a]=g}}return b};f.register("midiratio",i)})(timbre);
(function(h){function i(f){h.Object.call(this,f)}var f=h.fn;f.extend(i);i.prototype.process=function(h){var d=this.cell,b=this._;if(this.tickID!==h){this.tickID=h;var g=this.inputs,a=g.length,e,c=d.length,l,k;if(b.ar){if(0<g.length){l=g[0].process(h);d.set(l);for(b=1;b<a;++b){l=g[b].process(h);for(e=c;e--;)k=l[e],d[e]>k&&(d[e]=k)}}else for(e=c;e--;)d[e]=0;f.outputSignalAR(this)}else{if(0<g.length){l=g[0].process(h)[0];for(b=1;b<a;++b)k=g[b].process(h)[0],l>k&&(l=k)}else l=0;d[0]=l;f.outputSignalKR(this)}}return d};
f.register("min",i)})(timbre);
(function(h){function i(c){h.Object.call(this,c);f.timer(this);f.fixKR(this);c=this._;c.mml="";c.status={t:120,l:4,o:4,v:12,q:6,dot:0,tie:!1};c.commands=[];c.index=0;c.queue=[];c.currentTime=0;c.currentTimeIncr=1E3*h.cellsize/h.samplerate;c.queueTime=0;c.segnoIndex=-1;c.loopStack=[];c.prevNote=0;c.isEnded=!1;c.remain=Infinity;this.on("start",j)}var f=h.fn;f.extend(i);var j=function(){var c=this._;c.commands=a(c.mml);c.index=0;c.queue=[];c.currentTime=0;c.queueTime=0;c.segnoIndex=-1;c.loopStack=[];
c.prevNote=0;c.isEnded=!1;c.remain=Infinity;g(this)};Object.defineProperty(j,"unremoved",{value:!0,writable:!1});var d=i.prototype;Object.defineProperties(d,{mml:{set:function(c){var a=this._;"string"===typeof c&&(a.mml=c)},get:function(){return this._.mml}},currentTime:{get:function(){return this._.currentTime}},isEnded:{get:function(){return this._.isEnded}}});d.process=function(c){var a=this.cell,e=this._;if(e.isEnded)return a;if(this.tickID!==c){this.tickID=c;var c=this.inputs,d=e.queue,h,i,j;
if(d.length)for(;d[0][0]<=e.currentTime;){var n=e.queue.shift();if(n[1]){i=0;for(j=c.length;i<j;++i)h=c[i],h.noteOn?h.noteOn(n[1],n[3]):h.bang();e.remain=n[4];e.emit("mml","noteOn",{noteNum:n[1],velocity:n[3]});g(this)}else{i=0;for(j=c.length;i<j;++i)h=c[i],h.noteOff?h.noteOff(n[2],n[3]):h.release&&h.release();e.emit("mml","noteOff",{noteNum:n[2],velocity:n[3]})}if(0===d.length)break}e.remain-=e.currentTimeIncr;0===d.length&&0>=e.remain&&f.nextTick(b.bind(this));e.currentTime+=e.currentTimeIncr}return a};
var b=function(){this._.isEnded=!0;this._.emit("ended")},g=function(c){c=c._;if(!c.isEnded){var a,b=c.commands,e=c.queue,d=c.index,g=c.status,f=c.queueTime,h=c.loopStack,i,j,q,u,v;u=[];a:for(;;){if(b.length<=d)if(0<=c.segnoIndex)d=c.segnoIndex;else break;a=b[d++];switch(a.name){case "n":i=g.t||120;null!==a.len?(j=a.len,q=a.dot||0):(j=g.l,q=a.dot||g.dot);i=1E3*60/i*(4/j);i*=[1,1.5,1.75,1.875][q]||1;q=g.v<<3;if(g.tie){for(a=e.length;a--;)if(e[a][2]){e.splice(a,1);break}a=c.prevNote}else a=c.prevNote=
a.val+12*(g.o+1),e.push([f,a,null,q,i]);if(0<j){j=g.q/8;if(1>j){j=f+i*j;e.push([j,null,a,q]);a=0;for(v=u.length;a<v;++a)e.push([j,null,u[a],q])}u=[];f+=i;if(!g.tie)break a}else u.push(a);g.tie=!1;break;case "r":i=g.t||120;null!==a.len?(j=a.len,q=a.dot||0):(j=g.l,q=a.dot||g.dot);0<j&&(i=1E3*60/i*(4/j),i*=[1,1.5,1.75,1.875][q]||1,f+=i);break;case "l":g.l=a.val;g.dot=a.dot;break;case "o":g.o=a.val;break;case "<":9>g.o&&(g.o+=1);break;case ">":0<g.o&&(g.o-=1);break;case "v":g.v=a.val;break;case "(":15>
g.v&&(g.v+=1);break;case ")":0<g.v&&(g.v-=1);break;case "q":g.q=a.val;break;case "&":g.tie=!0;break;case "$":c.segnoIndex=d;break;case "[":h.push([d,null,null]);break;case "|":if((i=h[h.length-1])&&1===i[1])h.pop(),d=i[2];break;case "]":if(i=h[h.length-1])null===i[1]&&(i[1]=a.count,i[2]=d),i[1]-=1,0===i[1]?h.pop():d=i[0];break;case "t":g.t=null===a.val?120:a.val}}c.index=d;c.queueTime=f}},a=function(a){var b,d,g,f,h,i,j,o=Array(a.length),p=[];h=0;for(i=e.length;h<i;++h){b=e[h];for(d=b.re;g=d.exec(a);){if(!o[g.index]){f=
0;for(j=g[0].length;f<j;++f)o[g.index+f]=!0;if(f=b.func?b.func(g):{name:g[0]})f.index=g.index,f.origin=g[0],p.push(f)}for(;d.lastIndex<a.length&&o[d.lastIndex];)++d.lastIndex}}p.sort(function(a,c){return a.index-c.index});return p},e=[{re:/([cdefgab])([\-+]?)(\d*)(\.*)/g,func:function(a){return{name:"n",val:{c:0,d:2,e:4,f:5,g:7,a:9,b:11}[a[1]]+({"-":-1,"+":1}[a[2]]||0),len:""===a[3]?null:Math.min(a[3]|0,64),dot:a[4].length}}},{re:/r(\d*)(\.*)/g,func:function(a){return{name:"r",len:""===a[1]?null:
Math.max(1,Math.min(a[1]|0,64)),dot:a[2].length}}},{re:/&/g},{re:/l(\d*)(\.*)/g,func:function(a){return{name:"l",val:""===a[1]?4:Math.min(a[1]|0,64),dot:a[2].length}}},{re:/o([0-9])/g,func:function(a){return{name:"o",val:""===a[1]?4:a[1]|0}}},{re:/[<>]/g},{re:/v(\d*)/g,func:function(a){return{name:"v",val:""===a[1]?12:Math.min(a[1]|0,15)}}},{re:/[()]/g},{re:/q([0-8])/g,func:function(a){return{name:"q",val:""===a[1]?6:Math.min(a[1]|0,8)}}},{re:/\[/g},{re:/\|/g},{re:/\](\d*)/g,func:function(a){return{name:"]",
count:a[1]|0||2}}},{re:/t(\d*)/g,func:function(a){return{name:"t",val:""===a[1]?null:Math.max(5,Math.min(a[1]|0,300))}}},{re:/\$/g}];f.register("mml",i)})(timbre);
(function(h){function i(a){if(d)return d;d=this;h.Object.call(this,a);j.stereo(this);this.X=this.L;this.Y=this.R;j.fixKR(this)}function f(a){h.Object.call(this,a);d||(d=new i([]));j.fixKR(this)}if("browser"===h.envtype){var j=h.fn,d=null;j.extend(i);var b=function(a){d._.emit("click",a)},g=function(a){d._.emit("mousedown",a)},a=function(a){for(var c=a.clientX/window.innerWidth,a=a.clientY/window.innerHeight,b=d.cellL,e=d.cellR,g=b.length;g--;)b[g]=c,e[g]=a},e=function(a){d._.emit("mouseup",a)},c=
i.prototype;c.start=function(){window.addEventListener("click",b,!0);window.addEventListener("mousedown",g,!0);window.addEventListener("mousemove",a,!0);window.addEventListener("mouseup",e,!0);return this};c.stop=function(){window.removeEventListener("click",b,!0);window.removeEventListener("mousedown",g,!0);window.removeEventListener("mousemove",a,!0);window.removeEventListener("mouseup",e,!0);return this};c.play=c.pause=function(){return this};j.register("mouse",i);j.extend(f);Object.defineProperties(f.prototype,
{min:{set:function(a){var c=this._;c.min=a;c.delta=c.max-c.min;c.map.bang()},get:function(){return this._.min}},max:{set:function(a){var c=this._;c.max=a;c.delta=c.max-c.min;c.map.bang()},get:function(){return this._.max}},curve:{set:function(a){var c=this._;l[a]&&(c.map.map=l[a].bind(c),c.map.bang(),c.curveName=a)},get:function(){return this._.curveName}}});f.prototype.start=function(){d.start();return this};f.prototype.stop=function(){d.stop();return this};f.prototype.process=function(a){return this._.map.process(a)};
var l={lin:function(a){return a*this.delta+this.min},exp:function(a){var c=0>this.min?1.0E-6:this.min;return Math.pow(this.max/c,a)*c},sqr:function(a){return a*a*this.delta+this.min},cub:function(a){return a*a*a*this.delta+this.min}};j.register("mouse.x",function(a){var a=new f(a),c=a._;c.min=0;c.max=1;c.delta=1;c.curveName="lin";c.map=h("map",{map:l.lin.bind(c)},d.X);a.cell=c.map.cell;return a});j.register("mouse.y",function(a){var a=new f(a),c=a._;c.min=0;c.max=1;c.delta=1;c.curveName="lin";c.map=
h("map",{map:l.lin.bind(c)},d.Y);a.cell=c.map.cell;return a})}})(timbre);
(function(h){function i(f){h.Object.call(this,f)}var f=h.fn;f.extend(i);i.prototype.process=function(h){var d=this.cell,b=this._;if(this.tickID!==h){this.tickID=h;var g=this.inputs,a=g.length,e,c=d.length,i;if(b.ar){if(0<g.length){i=g[0].process(h);d.set(i);for(b=1;b<a;++b){i=g[b].process(h);for(e=c;e--;)d[e]*=i[e]}}else for(e=c;e--;)d[e]=0;f.outputSignalAR(this)}else{if(0<g.length){i=g[0].process(h)[0];for(b=1;b<a;++b)i*=g[b].process(h)[0]}else i=0;d[0]=i;f.outputSignalKR(this)}}return d};f.register("*",
i)})(timbre);
(function(h){function i(b){h.Object.call(this,b);b=this._;b.defaultValue=0;b.index=0;b.dict={};b.ar=!1}var f=h.fn;f.extend(i);var j=i.prototype;Object.defineProperties(j,{dict:{set:function(b){if("object"===typeof b)this._.dict=b;else if("function"===typeof b){for(var d={},a=0;128>a;++a)d[a]=b(a);this._.dict=d}},get:function(){return this._.dict}},defaultValue:{set:function(b){"number"===typeof b&&(this._.defaultValue=b)},get:function(){return this._.defaultValue}},index:{set:function(b){"number"===typeof b&&
(this._.index=b)},get:function(){return this._.index}}});j.at=function(b){var d=this._;return(d.dict[b|0]||d.defaultValue)*d.mul+d.add};j.clear=function(){this._.dict={};return this};j.process=function(b){var d=this.cell,a=this._;if(this.tickID!==b){this.tickID=b;var e=this.inputs.length,b=a.dict,c=a.defaultValue,h=a.mul,i=a.add,j;j=d.length;if(a.ar&&e){for(f.inputSignalAR(this);j--;)a=d[j],a=0>a?a-0.5|0:a+0.5|0,d[j]=(b[a]||c)*h+i;f.outputSignalAR(this)}else{a=this.inputs.length?f.inputSignalKR(this):
a.index;for(b=(b[0>a?a-0.5|0:a+0.5|0]||c)*h+i;j--;)d[j]=b}}return d};f.register("ndict",i);var d={90:48,83:49,88:50,68:51,67:52,86:53,71:54,66:55,72:56,78:57,74:58,77:59,188:60,76:61,190:62,186:63,81:60,50:61,87:62,51:63,69:64,82:65,53:66,84:67,54:68,89:69,55:70,85:71,73:72,57:73,79:74,48:75,80:76};f.register("ndict.key",function(b){b=new i(b);b.dict=d;return b})})(timbre);
(function(h){function i(f){h.Object.call(this,f)}var f=h.fn;f.extend(i);i.prototype.process=function(f){var d=this.cell,b=this._;if(this.tickID!==f){this.tickID=f;var f=b.mul,g=b.add,a=Math.random;if(b.ar)for(b=d.length;b--;)d[b]=(2*a()-1)*f+g;else{f=(2*a()+1)*f+g;for(b=d.length;b--;)d[b]=f}}return d};f.register("noise",i)})(timbre);
(function(h){function i(a){h.Object.call(this,a);a=this._;a.freq=h(440);a.phase=h(0);a.osc=new d(h.samplerate);a.tmp=new Float32Array(this.cell.length);a.osc.step=this.cell.length;this.once("init",b)}var f=h.fn,j=h.timevalue,d=h.modules.Oscillator;f.extend(i);var b=function(){var b=this._;this.wave||(this.wave="sin");b.plotData=b.osc.wave;b.plotLineWidth=2;b.plotCyclic=!0;b.plotBefore=a},g=i.prototype;Object.defineProperties(g,{wave:{set:function(a){this._.osc.setWave(a)},get:function(){return this._.osc.wave}},
freq:{set:function(a){"string"===typeof a&&(a=j(a),a=0>=a?0:1E3/a);this._.freq=h(a)},get:function(){return this._.freq}},phase:{set:function(a){this._.phase=h(a);this._.osc.feedback=!1},get:function(){return this._.phase}},fb:{set:function(a){this._.phase=h(a);this._.osc.feedback=!0},get:function(){return this._.phase}}});g.bang=function(){this._.osc.reset();this._.emit("bang");return this};g.process=function(a){var c=this._,b=this.cell;if(this.tickID!==a){this.tickID=a;var d,g=b.length;if(this.inputs.length)f.inputSignalAR(this);
else for(d=g;d--;)b[d]=1;d=c.osc;var h=c.freq.process(a),i=c.phase.process(a);d.frequency=h[0];d.phase=i[0];if(c.ar){a=c.tmp;c.freq.isAr?c.phase.isAr?d.processWithFreqAndPhaseArray(a,h,i):d.processWithFreqArray(a,h):c.phase.isAr?d.processWithPhaseArray(a,i):d.process(a);for(d=g;d--;)b[d]*=a[d]}else{c=d.next();for(d=g;d--;)b[d]*=c}f.outputSignalAR(this)}return b};var a;"browser"===h.envtype&&(a=function(a,c,b,d,g){g=(g>>1)+0.5;a.strokeStyle="#ccc";a.lineWidth=1;a.beginPath();a.moveTo(c,g+b);a.lineTo(c+
d,g+b);a.stroke()});f.register("osc",i);f.register("sin",function(a){return(new i(a)).set("wave","sin")});f.register("cos",function(a){return(new i(a)).set("wave","cos")});f.register("pulse",function(a){return(new i(a)).set("wave","pulse")});f.register("tri",function(a){return(new i(a)).set("wave","tri")});f.register("saw",function(a){return(new i(a)).set("wave","saw")});f.register("fami",function(a){return(new i(a)).set("wave","fami")});f.register("konami",function(a){return(new i(a)).set("wave",
"konami")});f.register("+sin",function(a){return(new i(a)).set("wave","+sin").kr()});f.register("+pulse",function(a){return(new i(a)).set("wave","+pulse").kr()});f.register("+tri",function(a){return(new i(a)).set("wave","+tri").kr()});f.register("+saw",function(a){return(new i(a)).set("wave","+saw").kr()});f.alias("square","pulse")})(timbre);
(function(h){function i(d){h.Object.call(this,d);f.stereo(this);f.fixAR(this);d=this._;d.value=h(0);d.panL=0.5;d.panR=0.5}var f=h.fn;f.extend(i);var j=i.prototype;Object.defineProperties(j,{value:{set:function(d){this._.value=h(d)},get:function(){return this._.value}}});j.process=function(d){var b=this._,g=this.cell;if(this.tickID!==d){this.tickID=d;var a=!1,e=b.value.process(d)[0];b.prevValue!==e&&(b.prevValue=e,a=!0);a&&(b.panL=Math.cos(0.5*Math.PI*(0.5*e+0.5)),b.panR=Math.sin(0.5*Math.PI*(0.5*
e+0.5)));for(var c=this.inputs,f,h=c.length,i=g.length,e=b.mul,j=b.add,s,r=this.cellL,n=this.cellR,a=i;a--;)r[a]=n[a]=g[a]=0;for(f=0;f<h;++f){s=c[f].process(d);for(a=i;a--;)r[a]=n[a]=g[a]+=s[a]}d=b.panL;b=b.panR;for(a=i;a--;)i=r[a]=r[a]*d*e+j,i+=n[a]=n[a]*b*e+j,g[a]=0.5*i}return g};f.register("pan",i)})(timbre);
(function(h){function i(a){h.Object.call(this,a);a=this._;a.value=0;a.env=new b(h.samplerate);a.env.step=this.cell.length;a.curve="lin";a.counter=0;a.ar=!1;this.on("ar",g)}var f=h.fn,j=h.timevalue,d=h.modules.Envelope,b=h.modules.EnvelopeValue;f.extend(i);var g=function(a){this._.env.step=a?1:this.cell.length},a=i.prototype;Object.defineProperties(a,{value:{set:function(a){"number"===typeof a&&(this._.env.value=a)},get:function(){return this._.env.value}}});a.to=function(a,b,e){var g=this._,f=g.env;
"string"===typeof b?b=j(b):"undefined"===typeof b&&(b=0);if("undefined"===typeof e)g.counter=f.setNext(a,b,d.CurveTypeLin),g.curve="lin";else{var h=d.CurveTypeDict[e];g.counter="undefined"===typeof h?f.setNext(a,b,d.CurveTypeCurve,e):f.setNext(a,b,h);g.curve=e}g.plotFlush=!0;return this};a.setAt=function(a,b){var e=this._;this.to(e.env.value,b,"set");e.atValue=a;return this};a.linTo=function(a,b){return this.to(a,b,"lin")};a.expTo=function(a,b){return this.to(a,b,"exp")};a.sinTo=function(a,b){return this.to(a,
b,"sin")};a.welTo=function(a,b){return this.to(a,b,"wel")};a.sqrTo=function(a,b){return this.to(a,b,"sqr")};a.cubTo=function(a,b){return this.to(a,b,"cub")};a.cancel=function(){var a=this._;a.counter=a.env.setNext(a.env.value,0,d.CurveTypeSet);return this};a.process=function(a){var b=this._,e=this.cell;if(this.tickID!==a){this.tickID=a;var g=e.length,h=b.mul,i=b.add,j=b.env,n=b.counter;if(this.inputs.length)f.inputSignalAR(this);else for(a=g;a--;)e[a]=1;0<n--&&(0>=n&&("set"===b.curve?j.setNext(b.atValue,
0,d.CurveTypeSet):j.setNext(j.value,0,d.CurveTypeSet),f.nextTick(f.onended.bind(null,this))),b.counter=n);var o,n=null;if(b.ar)for(a=0;a<g;++a)o=j.next(),e[a]=e[a]*o*h+i,null===n&&(n=b.env.emit);else{o=j.next();for(a=g;a--;)e[a]=e[a]*o*h+i}b.value=o}return e};var e=h.Object.prototype.plot;a.plot=function(a){var g=this._;if(g.plotFlush){var f=new b(128),h=new Float32Array(128),i,j;if("set"===g.curve){i=100;for(j=h.length;i<j;++i)h[i]=1}else{i=d.CurveTypeDict[g.curve];"undefined"===typeof i?f.setNext(1,
1E3,d.CurveTypeCurve,g.curve):f.setNext(1,1E3,i);i=0;for(j=h.length;i<j;++i)h[i]=f.next()}g.plotData=h;g.plotRange=[0,1];g.plotFlush=null}return e.call(this,a)};f.register("param",i)})(timbre);
(function(h){function i(b){h.Object.call(this,b);f.fixAR(this);b=this._;b.buffer=new Float32Array(h.cellsize);b.freq=h("sin",{freq:1,add:1E3,mul:250}).kr();b.Q=h(1);b.allpass=[];this.steps=2}var f=h.fn,j=h.modules.Biquad;f.extend(i);var d=i.prototype;Object.defineProperties(d,{freq:{set:function(b){this._.freq=b},get:function(){return this._.freq}},Q:{set:function(b){this._.Q=h(b)},get:function(){return this._.Q}},steps:{set:function(b){if("number"===typeof b){b|=0;if(2===b||4===b||8===b||12===b){var d=
this._.allpass;if(d.length<b)for(var a=d.length;a<b;++a)d[a]=new j(h.samplerate),d[a].setType("allpass")}this._.steps=b}},get:function(){return this._.steps}}});d.process=function(b){var d=this._,a=this.cell;if(this.tickID!==b){this.tickID=b;f.inputSignalAR(this);if(!d.bypassed){var e=d.freq.process(b)[0],b=d.Q.process(b)[0],c=d.steps;for(d.buffer.set(a);c--;)d.allpass[c].setParams(e,b,0),d.allpass[c].process(d.buffer),c--,d.allpass[c].setParams(e,b,0),d.allpass[c].process(d.buffer);for(c=a.length;c--;)a[c]=
0.5*(a[c]+d.buffer[c])}f.outputSignalAR(this)}return a};f.register("phaser",i);f.alias("phaseshift","phaser")})(timbre);
(function(h){function i(i){h.Object.call(this,i);f.fixAR(this);for(var i=new Uint8Array(5),d=0;5>d;++d)i[d]=(1073741824*Math.random()|0)%25;this._.whites=i;this._.key=0}var f=h.fn;f.extend(i);i.prototype.process=function(f){var d=this.cell,b=this._;if(this.tickID!==f){this.tickID=f;var g,a,e=b.key,c=b.whites,h=b.mul,i=b.add,m,t,f=0;for(g=d.length;f<g;++f){a=e++;31<e&&(e=0);t=a^e;for(a=m=0;5>a;++a)t&1<<a&&(c[a]=(1073741824*Math.random()|0)%25),m+=c[a];d[f]=(0.01666666*m-1)*h+i}b.key=e}return d};f.register("pink",
i)})(timbre);
(function(h){function i(d){h.Object.call(this,d);this._.freq=440;this._.buffer=null;this._.readIndex=0;this._.writeIndex=0}var f=h.fn;f.extend(i);var j=i.prototype;Object.defineProperties(j,{freq:{set:function(d){"number"===typeof d&&(0>d&&(d=0),this._.freq=d)},get:function(){return this._.freq}}});j.bang=function(){for(var d=this._,b=h.samplerate/d.freq+0.5|0,f=d.buffer=new Float32Array(b<<1),a=b;a--;)f[a]=2*Math.random()-1;d.readIndex=0;d.writeIndex=b;d.emit("bang");return this};j.process=function(d){var b=
this.cell,f=this._;if(this.tickID!==d&&(this.tickID=d,d=f.buffer)){var a=d.length,e=f.readIndex,c=f.writeIndex,h=f.mul,i=f.add,j,t,s=b.length;for(t=0;t<s;++t)j=d[e++],e>=a&&(e=0),j=0.5*(j+d[e]),d[c++]=j,c>=a&&(c=0),b[t]=j*h+i;f.readIndex=e;f.writeIndex=c}return b};f.register("pluck",i)})(timbre);
(function(h){function i(a){h.Object.call(this,a);f.listener(this);f.fixAR(this);a=this._;a.timeout=5E3;a.samplerate=h.samplerate;a.status=d;a.writeIndex=0;a.writeIndexIncr=1;a.currentTime=0;a.currentTimeIncr=1E3/h.samplerate}var f=h.fn,j=h.timevalue,d=0;f.extend(i);var b=i.prototype;Object.defineProperties(b,{timeout:{set:function(a){"string"===typeof a&&(a=j(a));"number"===typeof a&&0<a&&(this._.timeout=a)},get:function(){return this._.timeout}},samplerate:{set:function(a){"number"===typeof a&&(0<
a&&a<=h.samplerate)&&(this._.samplerate=a)},get:function(){return this._.samplerate}},currentTime:{get:function(){return this._.currentTime}}});b.start=function(){var a=this._,b;if(a.status===d){b=0.01*a.timeout*a.samplerate|0;if(!a.buffer||a.buffer.length<b)a.buffer=new Float32Array(b);a.writeIndex=0;a.writeIndexIncr=a.samplerate/h.samplerate;a.currentTime=0;a.status=1;a.emit("start");this.listen()}return this};b.stop=function(){var a=this._;1===a.status&&(a.status=d,a.emit("stop"),f.nextTick(g.bind(this)),
this.unlisten());return this};b.bang=function(){this._.status===d?this.srart():1===this._.status&&this.stop();this._.emit("bang");return this};b.process=function(a){var b=this._,c=this.cell;if(this.tickID!==a){this.tickID=a;f.inputSignalAR(this);if(1===b.status){for(var d=c.length,h=b.buffer,i=b.timeout,j=b.writeIndex,s=b.writeIndexIncr,r=b.currentTime,n=b.currentTimeIncr,a=0;a<d;++a)h[j|0]=c[a],j+=s,r+=n,i<=r&&f.nextTick(g.bind(this));b.writeIndex=j;b.currentTime=r}f.outputSignalAR(this)}return c};
var g=function(){var a=this._,b=new Float32Array(a.buffer.subarray(0,a.writeIndex|0));a.status=d;a.writeIndex=0;a.currentTime=0;a.emit("ended",{buffer:b,samplerate:a.samplerate})};f.register("record",i);f.alias("rec","record")})(timbre);
(function(h){function i(b){h.Object.call(this,b);f.fixAR(this);this._.reverb=new j(h.samplerate,h.cellsize)}var f=h.fn,j=h.modules.Reverb;f.extend(i);var d=i.prototype;Object.defineProperties(d,{room:{set:function(b){"number"===typeof b&&this._.reverb.setRoomSize(1<b?1:0>b?0:b)},get:function(){return this._.reverb.roomsize}},damp:{set:function(b){"number"===typeof b&&this._.reverb.setDamp(1<b?1:0>b?0:b)},get:function(){return this._.reverb.damp}},mix:{set:function(b){"number"===typeof b&&(this._.reverb.wet=
1<b?1:0>b?0:b)},get:function(){return this._.reverb.wet}}});d.process=function(b){var d=this._,a=this.cell;this.tickID!==b&&(this.tickID=b,f.inputSignalAR(this),d.bypassed||d.reverb.process(a),f.outputSignalAR(this));return a};f.register("reverb",i)})(timbre);
(function(h){function i(b){h.Object.call(this,b);f.timer(this);f.fixKR(this);b=this._;b.queue=[];b.currentTime=0;b.currentTimeIncr=1E3*h.cellsize/h.samplerate;b.maxRemain=1E3}var f=h.fn,j=h.timevalue;f.extend(i);var d=i.prototype;Object.defineProperties(d,{queue:{get:function(){return this._.queue}},remain:{get:function(){return this._.queue.length}},maxRemain:{set:function(b){"number"===typeof b&&0<b&&(this._.maxRemain=b)},get:function(){return this._.maxRemain}},isEmpty:{get:function(){return 0===
this._.queue.length}},currentTime:{get:function(){return this._.currentTime}}});d.sched=function(b,d){"string"===typeof b&&(b=j(b));"number"===typeof b&&this.schedAbs(this._.currentTime+b,d);return this};d.schedAbs=function(b,d){"string"===typeof b&&(b=j(b));if("number"===typeof b){var a=this._,e=a.queue;if(e.length>=a.maxRemain)return this;for(a=e.length;a--&&!(e[a][0]<b););e.splice(a+1,0,[b,h(d)])}return this};d.advance=function(b){"string"===typeof b&&(b=j(b));"number"===typeof b&&(this._.currentTime+=
b);return this};d.clear=function(){this._.queue.splice(0);return this};d.process=function(b){var d=this.cell,a=this._;if(a.isEnded)return d;if(this.tickID!==b){this.tickID=b;b=null;d=a.queue;if(d.length)for(;d[0][0]<a.currentTime;)if(a.queue.shift()[1].bang(),b="sched",0===d.length){b="empty";break}a.currentTime+=a.currentTimeIncr;b&&a.emit(b)}};f.register("schedule",i);f.alias("sche","schedule")})(timbre);
(function(h){function i(a){h.Object.call(this,a);f.listener(this);f.fixAR(this);this._.samples=0;this._.writeIndex=0;this._.plotFlush=!0;this.once("init",d)}var f=h.fn,j=h.timevalue;f.extend(i);var d=function(){this._.buffer||(this.size=1024);this._.interval||(this.interval=1E3)},b=i.prototype;Object.defineProperties(b,{size:{set:function(a){var b=this._;!b.buffer&&"number"===typeof a&&(b.buffer=new Float32Array(64>a?64:2048<a?2048:a),b.reservedinterval&&(this.interval=b.reservedinterval,b.reservedinterval=
null))},get:function(){return this._.buffer.length}},interval:{set:function(a){var b=this._;"string"===typeof a&&(a=j(a));"number"===typeof a&&0<a&&(b.buffer?(b.interval=a,b.samplesIncr=0.001*a*h.samplerate/b.buffer.length,1>b.samplesIncr&&(b.samplesIncr=1)):b.reservedinterval=a)},get:function(){return this._.interval}}});b.bang=function(){for(var a=this._,b=a.buffer,c=b.length;c--;)b[c]=0;a.samples=0;a.writeIndex=0;this._.emit("bang");return this};b.process=function(a){var b=this._,c=this.cell;if(this.tickID!==
a){this.tickID=a;f.inputSignalAR(this);for(var d=c.length,g=b.samples,h=b.samplesIncr,i=b.buffer,j=b.writeIndex,r=!1,n=b.mul,o=b.add,p=i.length-1,a=0;a<d;++a)0>=g&&(i[j++]=c[a],j&=p,r=b.plotFlush=!0,g+=h),c[a]=c[a]*n+o,--g;b.samples=g;b.writeIndex=j;r&&this._.emit("data")}return c};var g=h.Object.prototype.plot;b.plot=function(a){var b=this._;if(b.plotFlush){for(var c=b.buffer,d=c.length-1,f=new Float32Array(c.length),h=b.writeIndex,i=0,j=c.length;i<j;i++)f[i]=c[++h&d];b.plotData=f;b.plotFlush=null}return g.call(this,
a)};f.register("scope",i)})(timbre);
(function(h){function i(d){h.Object.call(this,d);this._.selected=0;this._.background=!1}var f=h.fn;f.extend(i);var j=i.prototype;Object.defineProperties(j,{selected:{set:function(d){if("number"===typeof d){this._.selected=d;for(var d=this.cell,b=d.length;b--;)d[b]=0}},get:function(){return this._.selected}},background:{set:function(d){this._.background=!!d},get:function(){return this._.background}}});j.process=function(d){var b=this._,g=this.cell;if(this.tickID!==d){this.tickID=d;var a=this.inputs,
e,c=a.length;if(b.background)for(e=0;e<c;++e)a[e].process(d);(b=a[b.selected])&&g.set(b.process(d));f.outputSignalAR(this)}return g};f.register("selector",i)})(timbre);
(function(h){function i(a){h.Object.call(this,a);f.listener(this);f.fixAR(this);this._.status=0;this._.samples=0;this._.samplesIncr=0;this._.writeIndex=0;this._.plotFlush=!0;this._.plotRange=[0,1];this._.plotBarStyle=!0;this.once("init",b)}var f=h.fn,j=h.timevalue,d=h.modules.FFT;f.extend(i);var b=function(){var a=this._;a.fft||(this.size=512);a.interval||(this.interval=500)},g=i.prototype;Object.defineProperties(g,{size:{set:function(a){var c=this._;if(!c.fft&&"number"===typeof a&&(c.fft=new d(256>
a?256:2048<a?2048:a),c.buffer=new Float32Array(c.fft.length),c.reservedwindow&&(c.fft.setWindow(c.reservedwindow),c.reservedwindow=null),c.reservedinterval))this.interval=c.reservedinterval,c.reservedinterval=null},get:function(){return this._.buffer.length}},window:{set:function(a){this._.fft.setWindow(a)},get:function(){return this._.fft.windowName}},interval:{set:function(a){var c=this._;"string"===typeof a&&(a=j(a));"number"===typeof a&&0<a&&(c.buffer?(c.interval=a,c.samplesIncr=0.001*a*h.samplerate,
c.samplesIncr<c.buffer.length&&(c.samplesIncr=c.buffer.length,c.interval=1E3*c.samplesIncr/h.samplerate)):c.reservedinterval=a)},get:function(){return this._.interval}},spectrum:{get:function(){return this._.fft.spectrum}},real:{get:function(){return this._.fft.real}},imag:{get:function(){return this._.fft.imag}}});g.bang=function(){this._.samples=0;this._.writeIndex=0;this._.emit("bang");return this};g.process=function(a){var c=this._,b=this.cell;if(this.tickID!==a){this.tickID=a;f.inputSignalAR(this);
for(var d=b.length,g=c.status,h=c.samples,i=c.samplesIncr,j=c.writeIndex,n=c.buffer,o=n.length,p=c.mul,q=c.add,u,a=0;a<d;++a)0>=h&&0===g&&(g=1,j=0,h+=i),1===g&&(n[j++]=b[a],o<=j&&(c.fft.forward(n),u=c.plotFlush=!0,g=0)),b[a]=b[a]*p+q,--h;c.samples=h;c.status=g;c.writeIndex=j;u&&this._.emit("data")}return b};var a=h.Object.prototype.plot;g.plot=function(b){if(this._.plotFlush){var c=this._.fft.spectrum,d=c.length/64,f=1/d,g=new Float32Array(64),h,i=c.length,j,n,o=0,p=0;for(h=0;h<i;h+=d){for(j=n=0;j<
d;++j)n+=c[h+j];j=n*f;g[o++]=j;p<j&&(p=j)}for(h=g.length;h--;)g[h]/=p;this._.plotData=g;this._.plotFlush=null}return a.call(this,b)};f.register("spectrum",i)})(timbre);
(function(h){function i(f){h.Object.call(this,f)}var f=h.fn;f.extend(i);i.prototype.process=function(h){var d=this.cell,b=this._;if(this.tickID!==h){this.tickID=h;var g=this.inputs,a=g.length,e,c=d.length,i;if(b.ar){if(0<g.length){i=g[0].process(h);d.set(i);for(b=1;b<a;++b){i=g[b].process(h);for(e=c;e--;)d[e]-=i[e]}}else for(e=c;e--;)d[e]=0;f.outputSignalAR(this)}else{if(0<g.length){i=g[0].process(h)[0];for(b=1;b<a;++b)i-=g[b].process(h)[0]}else i=0;d[0]=i;f.outputSignalKR(this)}}return d};f.register("-",
i)})(timbre);
(function(h){function i(a){h.Object.call(this,a);f.fixAR(this);a=this._;a.poly=4;a.genList=[];a.genDict={};a.synthdef=null;a.isEnded=!0;a.remGen=b.bind(this)}var f=h.fn;f.extend(i);var j=i.prototype;Object.defineProperties(j,{def:{set:function(a){"function"===typeof a&&(this._.synthdef=a)},get:function(){return this._.synthdef}},poly:{set:function(a){"number"===typeof a&&(0<a&&64>=a)&&(this._.poly=a)},get:function(){return this._.poly}}});var d=function(a){b.call(this,a.gen)},b=function(a){var b=this._,
e=b.genList.indexOf(a);-1!==e&&b.genList.splice(e,1);b.genDict[a.noteNum]=null},g=function(a,b,e,f){e|=0;0>=e?this.noteOff(this,a):127<e&&(e=127);var g=this._,i=g.genList,j=g.genDict,n=j[a];n&&g.remGen(n);b={freq:b,noteNum:a,velocity:e};if(f)for(var o in f)b[o]=f[o];b.doneAction=d.bind(this,b);n=this._.synthdef.call(this,b);n instanceof h.Object&&(n.noteNum=a,i.push(n),j[a]=b.gen=n,g.isEnded=!1,i.length>g.poly&&g.remGen(i[0]))},a=function(){for(var a=new Float32Array(128),b=0;128>b;++b)a[b]=440*Math.pow(2,
1*(b-69)/12);return a}();j.noteOn=function(c,b,e){var d=a[c]||440*Math.pow(2,(c-69)/12);g.call(this,c+0.5|0,d,b,e);return this};j.noteOff=function(a){(a=this._.genDict[a])&&a.release&&a.release();return this};j.noteOnWithFreq=function(a,b,e){var d=0<a?12*Math.log(1*a/440)*Math.LOG2E+69:0;g.call(this,d+0.5|0,a,b,e);return this};j.noteOffWithFreq=function(a){return this.noteOff((0<a?12*Math.log(1*a/440)*Math.LOG2E+69:0)+0.5|0)};j.allNoteOff=function(){for(var a=this._.genList,b=0,e=a.length;b<e;++b)a[b].release&&
a[b].release()};j.allSoundOff=function(){for(var a=this._,b=a.genList,a=a.genDict;b.length;)delete a[b.shift().noteNum]};j.process=function(a){var b=this.cell,e=this._;if(this.tickID!==a){this.tickID=a;f.inputSignalAR(this);if(!e.isEnded){var d,g,h,i=b.length,j,e=e.genList;d=0;for(g=e.length;d<g;++d){j=e[d].process(a);for(h=i;h--;)b[h]+=j[h]}0===g&&f.nextTick(f.onended.bind(null,this))}f.outputSignalAR(this)}return b};f.register("SynthDef",i);var e={set:function(a){f.isDictionary(a)?"string"===typeof a.type&&
(this._.env=a):a instanceof h.Object&&(this._.env=a)},get:function(){return this._.env}};f.register("OscGen",function(){var a={set:function(a){"string"===typeof a&&(this._.wave=a)},get:function(){return this._.wave}},b=function(a){var b=this._,c,e;c=b.env||{};e=c.type||"perc";b=h("osc",{wave:b.wave,freq:a.freq,mul:a.velocity/128});c instanceof h.Object?"function"===typeof c.clone&&(b=c.clone().append(b)):b=h(e,c,b);b.on("ended",a.doneAction).bang();return b};return function(d){d=new i(d);d._.wave=
"sin";Object.defineProperties(d,{env:e,wave:a});d.def=b;return d}}());f.register("PluckGen",function(){var a=function(a){var b,c,e;c=this._.env||{};e=c.type||"perc";b=h("pluck",{freq:a.freq,mul:a.velocity/128}).bang();c instanceof h.Object?"function"===typeof c.clone&&(b=c.clone().append(b)):b=h(e,c,b);b.on("ended",a.doneAction).bang();return b};return function(b){b=new i(b);Object.defineProperties(b,{env:e});b.def=a;return b}}())})(timbre);
(function(h){function i(a){h.Object.call(this,a);f.fixAR(this);a=this._;a.isLooped=!1;a.isEnded=!1}var f=h.fn,j=h.modules.Scissor,d=j.Tape,b=j.TapeStream;f.extend(i);var g=i.prototype;Object.defineProperties(g,{tape:{set:function(a){a instanceof d?(this._.tape=a,this._.tapeStream=new b(a,h.samplerate),this._.isEnded=!1):"object"===typeof a&&a.buffer instanceof Float32Array&&(this._.tape=new j(a),this._.tapeStream=new b(a,h.samplerate),this._.isEnded=!1)},get:function(){return this._.tape}},isLooped:{get:function(){return this._.isLooped}},
isEnded:{get:function(){return this._.isEnded}}});g.loop=function(a){this._.isLooped=!!a;this._.tapeStream&&(this._.tapeStream.isLooped=this._.isLooped);return this};g.bang=function(){this._.tapeStream&&this._.tapeStream.reset();this._.isEnded=!1;this._.emit("bang");return this};g.process=function(b){var c=this._,d=this.cell;if(this.tickID!==b){this.tickID=b;if(b=c.tapeStream)for(var g=c.mul,h=c.add,i=b.fetch(d.length),j=i[0],i=i[1],r=d.length;r--;)d[r]=0.5*(j[r]+i[r])*g+h;!c.isEnded&&b.isEnded&&
f.nextTick(a.bind(this))}return d};var a=function(){f.onended(this,0)};f.register("tape",i)})(timbre);
(function(h){function i(a){h.Object.call(this,a);f.timer(this);f.fixKR(this);a=this._;a.currentTime=0;a.currentTimeIncr=1E3*h.cellsize/h.samplerate;a.samplesMax=0;a.samples=0;a.isEnded=!0;this.once("init",d);this.on("start",b)}var f=h.fn,j=h.timevalue;f.extend(i);var d=function(){this._.timeout||(this.timeout=1E3)},b=function(){this._.isEnded=!1};Object.defineProperty(b,"unremovable",{value:!0,writable:!1});var g=function(){this._.isEnded=!0;this._.emit("ended")},a=i.prototype;Object.defineProperties(a,
{timeout:{set:function(a){var b=this._;"string"===typeof a&&(a=j(a));"number"===typeof a&&0<=a&&(b.timeout=a,b.samplesMax=h.samplerate*0.001*a|0,b.samples=b.samplesMax,b.isEnded=!1)},get:function(){return this._.timeout}},currentTime:{get:function(){return this._.currentTime}}});a.bang=function(){var a=this._;a.samples=a.samplesMax;a.currentTime=0;a.isEnded=!1;a.emit("bang");return this};a.process=function(a){var b=this.cell,d=this._;if(d.isEnded)return b;if(this.tickID!==a){this.tickID=a;0<d.samples&&
(d.samples-=b.length);if(0>=d.samples){for(var a=this.inputs,h=0,i=a.length;h<i;++h)a[h].bang();f.nextTick(g.bind(this))}d.currentTime+=d.currentTimeIncr}return b};f.register("timeout",i)})(timbre);
(function(h){function i(b){h.Object.call(this,b);b=this._;b.inMin=0;b.inMax=1;b.outMin=0;b.outMax=1;b.ar=!1;this.once("init",j)}var f=h.fn;f.extend(i);var j=function(){this._.warp||(this.warp="linlin")},d=i.prototype;Object.defineProperties(d,{inMin:{set:function(b){"number"===typeof b&&(this._.inMin=b)},get:function(){return this._.inMin}},inMax:{set:function(b){"number"===typeof b&&(this._.inMax=b)},get:function(){return this._.inMax}},outMin:{set:function(b){"number"===typeof b&&(this._.outMin=
b)},get:function(){return this._.outMin}},outMax:{set:function(b){"number"===typeof b&&(this._.outMax=b)},get:function(){return this._.outMax}},warp:{set:function(d){if("string"===typeof d){var a=b[d];a&&(this._.warp=a,this._.warpName=d)}},get:function(){return this._.warpName}}});d.process=function(b){var a=this._,d=this.cell;if(this.tickID!==b){this.tickID=b;var b=a.inMin,c=a.inMax,h=a.outMin,i=a.outMax,j=a.warp,t=this.inputs.length,s=a.mul,r=a.add,n;n=d.length;if(a.ar&&t){for(f.inputSignalAR(this);n--;)d[n]=
j(d[n],b,c,h,i)*s+r;f.outputSignalAR(this)}else{a=this.inputs.length?f.inputSignalKR(this):0;for(b=j(a,b,c,h,i)*s+r;n--;)d[n]=b}}return d};var b={linlin:function(b,a,d,c,f){return b<a?c:b>d?f:d===a?c:(b-a)/(d-a)*(f-c)+c},linexp:function(b,a,d,c,f){return b<a?c:b>d?f:0===c?0:d===a?f:Math.pow(f/c,(b-a)/(d-a))*c},explin:function(b,a,d,c,f){return b<a?c:b>d?f:0===a?f:Math.log(b/a)/Math.log(d/a)*(f-c)+c},expexp:function(b,a,d,c,f){return b<a?c:b>d?f:0===a||0===c?0:Math.pow(f/c,Math.log(b/a)/Math.log(d/
a))*c}};f.register("zmap",i)})(timbre);
