(function(i){function k(){function a(d){for(var b=Array(d.byteLength),c=d.BYTES_PER_ELEMENT,e,l=0,f=b.length;l<f;++l)e=8*(l%c),b[l]=(d[l/c|0]&255<<e)>>>e;b.__view=d;return b}function d(f,j,g,n){var q,h,t;if(Array.isArray(j))if(j.__view)if("undefined"===typeof g&&(g=0),"undefined"===typeof n&&(n=j.length-g),q=f.bytes,f.type===c)j=j.__view.slice(g/q|0,(g+n)/q|0);else{n=j.slice(g,g+n);j=Array(n.length/q|0);h=0;for(t=j.length;h<t;++h)j[h]=0;h=0;for(t=n.length;h<t;++h)j[h/q|0]+=(n[h]&255)<<8*(h%q)}else j=
j.slice();else j="number"===typeof j&&0<j?Array(j|0):[];if(f.type!==c){h=0;for(t=j.length;h<t;++h)j[h]=(+j[h]||0)&65535}else{h=0;for(t=j.length;h<t;++h)j[h]=j[h]||0}if(f.type===b){h=0;for(t=j.length;h<t;++h)j[h]&1<<8*q-1&&(j[h]-=1<<8*q)}j.__klass=f;j.constructor=window[f.name];j.set=e;j.subarray=l;j.BYTES_PER_ELEMENT=f.bytes;j.byteLength=f.bytes*j.length;j.byteOffset=g||0;Object.defineProperty(j,"buffer",{get:function(){return new a(this)}});return j}var b=1,c=2,e=function(a,d){"undefined"===typeof d&&
(d=0);var b,c=Math.min(this.length-d,a.length);for(b=0;b<c;++b)this[d+b]=a[b]},l=function(a,d){"undefined"===typeof d&&(d=this.length);return new this.constructor(this.slice(a,d))};[["Int8Array",1,b],["Uint8Array",1,0],["Int16Array",2,b],["Uint16Array",2,0],["Int32Array",4,b],["Uint32Array",4,0],["Float32Array",4,c],["Float64Array",8,c]].forEach(function(a){var b=a[0],c={bytes:a[1],type:a[2],name:b};window[b]=function(a,b,e){return d.call(this,c,a,b,e)}})}"undefined"===typeof Float32Array&&k();var g=
function(){return u.apply(null,arguments)},h=Array.prototype.slice,f=0,e=1,c=[8E3,11025,12E3,16E3,22050,24E3,32E3,44100,48E3],b=[32,64,128,256],a=null,d={},l={},n="undefined"!==typeof module&&module.exports?"node":"undefined"!==typeof window?"browser":"unknown",j="browser"===n&&/(iPhone|iPad|iPod|Android)/i.test(navigator.userAgent),q=!1,t=120,u=function(){var a=h.call(arguments),b=a[0],c;switch(typeof b){case "string":d[b]?c=new d[b](a.slice(1)):l[b]&&(c=l[b](a.slice(1)));break;case "number":c=new E(a);
break;case "boolean":c=new B(a);break;case "function":c=new I(a);break;case "object":if(null!==b){if(b instanceof s)return b;if(b.context instanceof s)return b.context;p(b)?c=new G(a):o(b)&&(c=new J(a))}}c===i&&(c=new C(a.slice(1)),console.warn('T("'+b+'") is not defined.'));a=c._;a.originkey=b;for(var b=a,e=c._.meta,f,j,g=c;null!==g&&g.constructor!==Object;){f=Object.getOwnPropertyNames(g);for(var n=0,q=f.length;n<q;++n)if(!e[f[n]])if(/^(constructor$|process$|_)/.test(f[n]))e[f[n]]="ignore";else if(j=
Object.getOwnPropertyDescriptor(g,f[n]),"function"===typeof j.value)e[f[n]]="function";else if(j.get||j.set)e[f[n]]="property";g=Object.getPrototypeOf(g)}b.meta=e;a.emit("init");return c};Object.defineProperties(g,{version:{value:"13.04.19"},envtype:{value:n},envmobile:{value:j},env:{get:function(){return a.impl.env}},samplerate:{get:function(){return a.samplerate}},channels:{get:function(){return a.channels}},cellsize:{get:function(){return a.cellsize}},currentTime:{get:function(){return a.currentTime}},
isPlaying:{get:function(){return a.status===e}},isRecording:{get:function(){return 3===a.status}},amp:{set:function(d){"number"===typeof d&&(a.amp=d)},get:function(){return a.amp}},bpm:{set:function(a){"number"===typeof a&&5<=a&&300>=a&&(t=a)},get:function(){return t}}});g.bind=function(d,b){a.bind(d,b);return g};g.setup=function(d){a.setup(d);return g};g.play=function(){a.play();return g};g.pause=function(){a.pause();return g};g.reset=function(){a.reset();a.events.emit("reset");return g};g.on=g.addListener=
function(d,b){a.on(d,b);return g};g.once=function(d,b){a.once(d,b);return g};g.off=g.removeListener=function(d,b){a.off(d,b);return g};g.removeAllListeners=function(d){a.removeAllListeners(d);return g};g.listeners=function(d){return a.listeners(d)};g.rec=function(){return a.rec.apply(a,arguments)};g.timevalue=function(){var a=function(a){var d=t;if(a=/^bpm(\d+(?:\.\d+)?)/i.exec(a))d=Math.max(5,Math.min(300,+(a[1]||0)));return d};return function(d){var b,c;if(b=/^(\d+(?:\.\d+)?)Hz$/i.exec(d))return 0===
+b[1]?0:1E3/+b[1];if(b=/L(\d+)?(\.*)$/i.exec(d))return d=1E3*60/a(d)*(4/(b[1]||4)),d*=[1,1.5,1.75,1.875][(b[2]||"").length]||1;if(b=/^(\d+(?:\.\d+)?|\.(?:\d+))(min|sec|m)s?$/i.exec(d))switch(b[2]){case "min":return 6E4*+(b[1]||0);case "sec":return 1E3*+(b[1]||0);case "m":return+(b[1]||0)}return(b=/^(?:([0-5]?[0-9]):)?(?:([0-5]?[0-9]):)(?:([0-5]?[0-9]))(?:\.([0-9]{1,3}))?$/.exec(d))?(c=3600*(b[1]||0)+60*(b[2]||0)+(b[3]||0),c=1E3*c+(((b[4]||"")+"00").substr(0,3)|0)):(b=/(\d+)\.(\d+)\.(\d+)$/i.exec(d))?
(c=480*(4*b[1]+ +b[2])+ +b[3],1E3*60/a(d)*(c/480)):(b=/(\d+)ticks$/i.exec(d))?1E3*60/a(d)*(b[1]/480):(b=/^(\d+)samples(?:\/(\d+)Hz)?$/i.exec(d))?1E3*b[1]/(b[2]||g.samplerate):0}}();var m=g.fn={SignalArray:Float32Array,currentTimeIncr:0,emptycell:null,FINISHED_STATE:f,PLAYING_STATE:e,UNSCHEDULED_STATE:2,SCHEDULED_STATE:3},o=m.isArray=Array.isArray,p=m.isDictionary=function(a){return"object"===typeof a&&a.constructor===Object};m.nop=function(){return this};m.isSignalArray=function(a){return a instanceof
m.SignalArray||Array.isArray(a)&&a.__klass&&2===a.__klass.type?!0:!1};m.extend=function(a,d){function b(){this.constructor=a}var d=d||s,c;for(c in d)d.hasOwnProperty(c)&&(a[c]=d[c]);b.prototype=d.prototype;a.prototype=new b;a.__super__=d.prototype;return a};m.constructorof=function(a,d){for(var b=a&&a.prototype;b;){if(b===d.prototype)return!0;b=Object.getPrototypeOf(b)}return!1};m.register=function(a,b){m.constructorof(b,s)?d[a]=b:l[a]=b};m.alias=function(a,b){d[b]?d[a]=d[b]:l[b]&&(l[a]=l[b])};m.getClass=
function(a){return d[a]};m.pointer=function(a,d,b){d=a.byteOffset+d*a.constructor.BYTES_PER_ELEMENT;return"number"===typeof b?new a.constructor(a.buffer,d,b):new a.constructor(a.buffer,d)};m.nextTick=function(d){a.nextTick(d);return g};m.fixAR=function(a){a._.ar=!0;a._.aronly=!0};m.fixKR=function(a){a._.ar=!1;a._.kronly=!0};m.changeWithValue=function(){var a=this._,a=a.value*a.mul+a.add;isNaN(a)&&(a=0);for(var d=this.cells[0],b=0,c=d.length;b<c;++b)d[b]=a};m.changeWithValue.unremovable=!0;m.clone=
function(a){var d=new a.constructor([]);d._.ar=a._.ar;d._.mul=a._.mul;d._.add=a._.add;d._.bypassed=a._.bypassed;return d};m.timer=function(){var d=function(d){return function(){-1===a.timers.indexOf(d)&&(a.timers.push(d),a.events.emit("addObject"),d._.emit("start"))}},b=function(d){return function(){var b=a.timers.indexOf(d);-1!==b&&(a.timers.splice(b,1),d._.emit("stop"),a.events.emit("removeObject"))}};return function(c){var e=d(c),l=b(c);c.start=function(){a.nextTick(e);return c};c.stop=function(){a.nextTick(l);
return c};return c}}();m.listener=function(){var d=function(d){return function(){-1===a.listeners.indexOf(d)&&(a.listeners.push(d),a.events.emit("addObject"),d._.emit("listen"))}},b=function(d){return function(){var b=a.listeners.indexOf(d);-1!==b&&(a.listeners.splice(b,1),d._.emit("unlisten"),a.events.emit("removeObject"))}};return function(c){var e=d(c),l=b(c);c.listen=function(){arguments.length&&c.append.apply(c,arguments);c.nodes.length&&a.nextTick(e);return c};c.unlisten=function(){arguments.length&&
c.remove.apply(c,arguments);c.nodes.length||a.nextTick(l);return c};return c}}();m.make_onended=function(a,d){return function(){a.playbackState=f;if("number"===typeof d)for(var b=a.cells[0],c=a.cells[1],e=a.cells[2],l=0,j=c.length;l<j;++l)b[0]=c[l]=e[l]=d;a._.emit("ended")}};m.inputSignalAR=function(a){var d=a.cells[0],b=a.cells[1],c=a.cells[2],l=a.nodes,f=l.length,j,g=d.length,n=a.tickID,q,h;if(2===a.numChannels){q=!0;if(0!==f){for(a=0;a<f;++a)if(l[a].playbackState===e){l[a].process(n);b.set(l[a].cells[1]);
c.set(l[a].cells[2]);q=!1;++a;break}for(;a<f;++a)if(l[a].playbackState===e){l[a].process(n);d=l[a].cells[1];h=l[a].cells[2];for(j=g;j;)j-=8,b[j]+=d[j],c[j]+=h[j],b[j+1]+=d[j+1],c[j+1]+=h[j+1],b[j+2]+=d[j+2],c[j+2]+=h[j+2],b[j+3]+=d[j+3],c[j+3]+=h[j+3],b[j+4]+=d[j+4],c[j+4]+=h[j+4],b[j+5]+=d[j+5],c[j+5]+=h[j+5],b[j+6]+=d[j+6],c[j+6]+=h[j+6],b[j+7]+=d[j+7],c[j+7]+=h[j+7]}}q&&(b.set(m.emptycell),c.set(m.emptycell))}else{q=!0;if(0!==f){for(a=0;a<f;++a)if(l[a].playbackState===e){l[a].process(n);d.set(l[a].cells[0]);
q=!1;++a;break}for(;a<f;++a)if(l[a].playbackState===e){b=l[a].process(n).cells[0];for(j=g;j;)j-=8,d[j]+=b[j],d[j+1]+=b[j+1],d[j+2]+=b[j+2],d[j+3]+=b[j+3],d[j+4]+=b[j+4],d[j+5]+=b[j+5],d[j+6]+=b[j+6],d[j+7]+=b[j+7]}}q&&d.set(m.emptycell)}};m.inputSignalKR=function(a){for(var d=a.nodes,b=d.length,c=a.tickID,j=0,a=0;a<b;++a)d[a].playbackState===e&&(j+=d[a].process(c).cells[0][0]);return j};m.outputSignalAR=function(a){var d=a.cells[0],b=a.cells[1],c=a.cells[2],e=a._.mul,j=a._.add;if(2===a.numChannels)for(a=
d.length;a;)a-=8,b[a]=b[a]*e+j,c[a]=c[a]*e+j,b[a+1]=b[a+1]*e+j,c[a+1]=c[a+1]*e+j,b[a+2]=b[a+2]*e+j,c[a+2]=c[a+2]*e+j,b[a+3]=b[a+3]*e+j,c[a+3]=c[a+3]*e+j,b[a+4]=b[a+4]*e+j,c[a+4]=c[a+4]*e+j,b[a+5]=b[a+5]*e+j,c[a+5]=c[a+5]*e+j,b[a+6]=b[a+6]*e+j,c[a+6]=c[a+6]*e+j,b[a+7]=b[a+7]*e+j,c[a+7]=c[a+7]*e+j,d[a]=0.5*(b[a]+c[a]),d[a+1]=0.5*(b[a+1]+c[a+1]),d[a+2]=0.5*(b[a+2]+c[a+2]),d[a+3]=0.5*(b[a+3]+c[a+3]),d[a+4]=0.5*(b[a+4]+c[a+4]),d[a+5]=0.5*(b[a+5]+c[a+5]),d[a+6]=0.5*(b[a+6]+c[a+6]),d[a+7]=0.5*(b[a+7]+c[a+
7]);else if(1!==e||0!==j)for(a=d.length;a;)a-=8,d[a]=d[a]*e+j,d[a+1]=d[a+1]*e+j,d[a+2]=d[a+2]*e+j,d[a+3]=d[a+3]*e+j,d[a+4]=d[a+4]*e+j,d[a+5]=d[a+5]*e+j,d[a+6]=d[a+6]*e+j,d[a+7]=d[a+7]*e+j};m.outputSignalKR=function(a){var d=a.cells[0],b=a.cells[1],c=a.cells[2],e=d[0]*a._.mul+a._.add;if(2===a.numChannels)for(a=d.length;a;)a-=8,d[a]=d[a+1]=d[a+2]=d[a+3]=d[a+4]=d[a+5]=d[a+6]=d[a+7]=b[a]=b[a+1]=b[a+2]=b[a+3]=b[a+4]=b[a+5]=b[a+6]=b[a+7]=c[a]=c[a+1]=c[a+2]=c[a+3]=c[a+4]=c[a+5]=c[a+6]=c[a+7]=e;else for(a=
d.length;a;)a-=8,d[a]=d[a+1]=d[a+2]=d[a+3]=d[a+4]=d[a+5]=d[a+6]=d[a+7]=e};m.fix_iOS6_1_problem=function(d){a.fix_iOS6_1_problem(d)};var r=g.modules={},w=r.EventEmitter=function(){function a(d){this.context=d;this.events={}}var d=a.prototype;d.emit=function(a){var d=this.events[a];if(!d)return!1;var b;if("function"===typeof d){switch(arguments.length){case 1:d.call(this.context);break;case 2:d.call(this.context,arguments[1]);break;case 3:d.call(this.context,arguments[1],arguments[2]);break;default:b=
h.call(arguments,1),d.apply(this.context,b)}return!0}if(o(d)){b=h.call(arguments,1);for(var d=d.slice(),c=0,e=d.length;c<e;++c)d[c]instanceof s?d[c].bang.apply(d[c],b):d[c].apply(this.context,b);return!0}if(d instanceof s)b=h.call(arguments,1),d.bang.apply(d,b);else return!1};d.on=function(a,d){if("function"!==typeof d&&!(d instanceof s))throw Error("addListener takes instances of Function or timbre.Object");var b=this.events;b[a]?o(b[a])?b[a].push(d):b[a]=[b[a],d]:b[a]=d;return this};d.once=function(a,
d){var b=this,c;if("function"===typeof d)c=function(){b.off(a,c);d.apply(b.context,arguments)};else if(d instanceof s)c=function(){b.off(a,c);d.bang.apply(d,arguments)};else throw Error("once takes instances of Function or timbre.Object");c.listener=d;b.on(a,c);return this};d.off=function(a,d){if("function"!==typeof d&&!(d instanceof s))throw Error("removeListener takes instances of Function or timbre.Object");var b=this.events;if(!b[a])return this;var c=b[a];if(o(c)){for(var e=-1,j=0,l=c.length;j<
l;++j)if(c[j]===d||c[j].listener&&c[j].listener===d){e=j;break}if(0>e)return this;c.splice(e,1);0===c.length&&(b[a]=null)}else if(c===d||c.listener&&c.listener===d)b[a]=null;return this};d.removeAllListeners=function(a){var d=this.events,b=!1,c=d[a];if(o(c))for(var e=c.length;e--;){var j=c[e];j.unremovable?b=!0:this.off(a,j)}else c&&(c.unremovable?b=!0:this.off(a,c));b||(d[a]=null);return this};d.listeners=function(a){var d=this.events;if(!d[a])return[];d=d[a];if(!o(d))return d.unremovable?[]:[d];
for(var d=d.slice(),a=[],b=0,c=d.length;b<c;++b)d[b].unremovable||a.push(d[b]);return a};return a}(),v=r.Deferred=function(){function a(b){this.context=b||this;this._state="pending";this._doneList=[];this._failList=[];this._promise=new d(this)}function d(a){this.context=a.context;this.then=a.then;this.done=function(){a.done.apply(a,arguments);return this};this.fail=function(){a.fail.apply(a,arguments);return this};this.pipe=function(){return a.pipe.apply(a,arguments)};this.always=function(){a.always.apply(a,
arguments);return this};this.promise=function(){return this};this.isResolved=function(){return a.isResolved()};this.isRejected=function(){return a.isRejected()}}var b=a.prototype,c=function(a,d,b,c){if("pending"===this._state){this._state=a;for(var a=0,e=d.length;a<e;++a)d[a].apply(b,c);this._doneList=this._failList=null}},e=function(a){return a&&"function"===typeof a.promise};b.resolve=function(){var a=h.call(arguments,0);c.call(this,"resolved",this._doneList,this.context||this,a);return this};b.resolveWith=
function(a){var d=h.call(arguments,1);c.call(this,"resolved",this._doneList,a,d);return this};b.reject=function(){var a=h.call(arguments,0);c.call(this,"rejected",this._failList,this.context||this,a);return this};b.rejectWith=function(a){var d=h.call(arguments,1);c.call(this,"rejected",this._failList,a,d);return this};b.promise=function(){return this._promise};b.done=function(){for(var a=h.call(arguments),d="resolved"===this._state,b="pending"===this._state,c=this._doneList,e=0,j=a.length;e<j;++e)if("function"===
typeof a[e])if(d)a[e]();else b&&c.push(a[e]);return this};b.fail=function(){for(var a=h.call(arguments),d="rejected"===this._state,b="pending"===this._state,c=this._failList,e=0,j=a.length;e<j;++e)if("function"===typeof a[e])if(d)a[e]();else b&&c.push(a[e]);return this};b.always=function(){this.done.apply(this,arguments);this.fail.apply(this,arguments);return this};b.then=function(a,d){return this.done(a).fail(d)};b.pipe=function(d,b){var c=this,j=new a(this.context);this.done(function(){var a=d.apply(c.context,
arguments);e(a)?a.then(function(){var d=h.call(arguments);j.resolveWith.apply(j,[a].concat(d))}):j.resolveWith(c,a)});this.fail(function(){if("function"===typeof b){var a=b.apply(c.context,arguments);e(a)&&a.fail(function(){var d=h.call(arguments);j.rejectWith.apply(j,[a].concat(d))})}else j.reject.apply(j,arguments)});return j.promise()};b.isResolved=function(){return"resolved"===this._state};b.isRejected=function(){return"rejected"===this._state};b.state=function(){return this._state};a.when=function(d){var b=
0,c=h.call(arguments),j=c.length,l=j;1===j&&!e(d)&&(l=0);var f=1===l?d:new a,g=function(a,d){return function(b){d[a]=1<arguments.length?h.call(arguments):b;--l||f.resolve.apply(f,d)}};if(1<j)for(var n=Array(j),q=function(){f.reject()};b<j;++b)c[b]&&e(c[b])?c[b].promise().done(g(b,n)).fail(q):(n[b]=c[b],--l);l||f.resolve.apply(f,c);return f.promise()};return a}(),s=g.Object=function(){function d(b,c){this._={};var j=this._.events=new w(this);this._.emit=function(){return j.emit.apply(j,arguments)};
if(p(c[0])){var l=c.shift();this.once("init",function(){this.set(l)})}this.tickID=-1;this.nodes=c.map(g);this.cells=[];this.numChannels=b;switch(b){case 0:this.L=this.R=new z(null);this.cells[0]=this.cells[1]=this.cells[2]=this.L.cell;break;case 1:this.L=this.R=new z(this);this.cells[0]=this.cells[1]=this.cells[2]=this.L.cell;break;case 2:this.L=new z(this),this.R=new z(this),this.cells[0]=new m.SignalArray(a.cellsize),this.cells[1]=this.L.cell,this.cells[2]=this.R.cell}this.playbackState=e;this._.ar=
!0;this._.mul=1;this._.add=0;this._.dac=null;this._.bypassed=!1;this._.meta={};this._.samplerate=a.samplerate;this._.cellsize=a.cellsize}var b=d.prototype;Object.defineProperties(b,{isAr:{get:function(){return this._.ar}},isKr:{get:function(){return!this._.ar}},isBypassed:{get:function(){return this._.bypassed}},isEnded:{get:function(){return!(this.playbackState&1)}},mul:{set:function(a){"number"===typeof a&&(this._.mul=a,this._.emit("setMul",a))},get:function(){return this._.mul}},add:{set:function(a){"number"===
typeof a&&(this._.add=a,this._.emit("setAdd",a))},get:function(){return this._.add}}});b.toString=function(){return this.constructor.name};b.valueOf=function(){a.tickID!==this.tickID&&this.process(a.tickID);return this.cells[0][0]};b.append=function(){if(0<arguments.length){var a=h.call(arguments).map(g);this.nodes=this.nodes.concat(a);this._.emit("append",a)}return this};b.appendTo=function(a){a.append(this);return this};b.remove=function(){if(0<arguments.length){for(var a,d=this.nodes,b=[],c=0,
e=arguments.length;c<e;++c)if(-1!==(a=d.indexOf(arguments[c])))b.push(d[a]),d.splice(a,1);0<b.length&&this._.emit("remove",b)}return this};b.removeFrom=function(a){a.remove(this);return this};b.removeAll=function(){var a=this.nodes.slice();this.nodes=[];0<a.length&&this._.emit("remove",a);return this};b.removeAtIndex=function(a){var d=this.nodes[a];d&&(this.nodes.splice(a,1),this._.emit("remove",[d]));return this};b.on=b.addListener=function(a,d){this._.events.on(a,d);return this};b.once=function(a,
d){this._.events.once(a,d);return this};b.off=b.removeListener=function(a,d){this._.events.off(a,d);return this};b.removeAllListeners=function(a){this._.events.removeAllListeners(a);return this};b.listeners=function(a){return this._.events.listeners(a)};b.set=function(a,d){var b,c,e=this._.meta;switch(typeof a){case "string":switch(e[a]){case "property":this[a]=d;break;case "function":this[a](d);break;default:for(b=this;null!==b;){if(c=Object.getOwnPropertyDescriptor(b,a))if("function"===typeof c.value)e[a]=
"function",this[a](d);else if(c.get||c.set)e[a]="property",this[a]=d;b=Object.getPrototypeOf(b)}}break;case "object":for(b in a)this.set(b,a[b])}return this};b.get=function(a){if("property"===this._.meta[a])return this[a]};b.bang=function(){this._.emit.apply(this,["bang"].concat(h.call(arguments)));return this};b.process=m.nop;b.bypass=function(){this._.bypassed=0===arguments.length?!0:!!arguments[0];return this};b.play=function(){var a=this._.dac;null===a&&(a=this._.dac=new K(this));a.playbackState===
f&&(a.play(),this._.emit.apply(this,["play"].concat(h.call(arguments))));return this};b.pause=function(){var a=this._.dac;a&&a.playbackState===e&&(a.pause(),this._.dac=null,this._.emit("pause"));return this};b.start=b.stop=b.listen=b.unlisten=function(){return this};b.ar=function(){0===arguments.length||arguments[0]?this._.kronly||(this._.ar=!0,this._.emit("ar",!0)):this.kr(!0);return this};b.kr=function(){0===arguments.length||arguments[0]?this._.aronly||(this._.ar=!1,this._.emit("ar",!1)):this.ar(!0);
return this};b.plot="browser"===n?function(a){var d=this._,b=a.target;if(!b)return this;var c=a.width||b.width||320,e=a.height||b.height||240,j=(a.x||0)+0.5,l=a.y||0,b=b.getContext("2d"),f;f=a.foreground!==i?a.foreground:d.plotForeground||"rgb(  0, 128, 255)";var g;g=a.background!==i?a.background:d.plotBackground||"rgb(255, 255, 255)";var n=a.lineWidth||d.plotLineWidth||1,q=!!d.plotCyclic,h=d.plotData||this.cells[0],t=a.range||d.plotRange||[-1.2,1.2],m=t[0],t=e/(t[1]-m),k=c/h.length,u,o=h.length;
b.save();b.rect(j,l,c,e);null!==g&&(b.fillStyle=g,b.fillRect(j,l,c,e));d.plotBefore&&d.plotBefore.call(this,b,j,l,c,e);if(d.plotBarStyle){b.fillStyle=f;for(g=f=0;g<o;++g)q=(h[g]-m)*t,u=e-q,b.fillRect(f+j,u+l,k,q),f+=k}else{b.strokeStyle=f;b.lineWidth=n;b.beginPath();f=0;n=e-(h[0]-m)*t;b.moveTo(f+j,n+l);for(g=1;g<o;++g)f+=k,u=e-(h[g]-m)*t,b.lineTo(f+j,u+l);q?b.lineTo(f+k+j,n+l):b.lineTo(f+k+j,u+l);b.stroke()}d.plotAfter&&d.plotAfter.call(this,b,j,l,c,e);if(a=a.border||d.plotBorder)b.strokeStyle="string"===
typeof a?a:"#000",b.lineWidth=1,b.strokeRect(j,l,c,e);b.restore();return this}:m.nop;return d}(),z=g.ChannelObject=function(){function d(b){g.Object.call(this,-1,[]);m.fixAR(this);this._.parent=b;this.cell=new m.SignalArray(a.cellsize);this.L=this.R=this;this.cells[0]=this.cells[1]=this.cells[2]=this.cell;this.numChannels=1}m.extend(d);d.prototype.process=function(a){this.tickID!==a&&(this.tickID=a,this._.parent&&this._.parent.process(a));return this};return d}(),C=function(){function a(d){s.call(this,
2,d)}m.extend(a);a.prototype.process=function(a){var d=this._;this.tickID!==a&&(this.tickID=a,d.ar?(m.inputSignalAR(this),m.outputSignalAR(this)):(this.cells[0][0]=m.inputSignalKR(this),m.outputSignalKR(this)));return this};m.register("+",a);return a}(),E=function(){function a(d){s.call(this,1,[]);m.fixKR(this);this.value=d[0];if(p(d[1])){var b=d[1];this.once("init",function(){this.set(b)})}this.on("setAdd",m.changeWithValue);this.on("setMul",m.changeWithValue)}m.extend(a);Object.defineProperties(a.prototype,
{value:{set:function(a){"number"===typeof a&&(this._.value=isNaN(a)?0:a,m.changeWithValue.call(this))},get:function(){return this._.value}}});return a}(),B=function(){function a(d){s.call(this,1,[]);m.fixKR(this);this.value=d[0];if(p(d[1])){var b=d[1];this.once("init",function(){this.set(b)})}this.on("setAdd",m.changeWithValue);this.on("setMul",m.changeWithValue)}m.extend(a);Object.defineProperties(a.prototype,{value:{set:function(a){this._.value=a?1:0;m.changeWithValue.call(this)},get:function(){return!!this._.value}}});
return a}(),I=function(){function a(d){s.call(this,1,[]);m.fixKR(this);this.func=d[0];this._.value=0;if(p(d[1])){var b=d[1];this.once("init",function(){this.set(b)})}this.on("setAdd",m.changeWithValue);this.on("setMul",m.changeWithValue)}m.extend(a);var d=a.prototype;Object.defineProperties(d,{func:{set:function(a){"function"===typeof a&&(this._.func=a)},get:function(){return this._.func}},args:{set:function(a){this._.args=o(a)?a:[a]},get:function(){return this._.args}}});d.bang=function(){var a=
this._,d=h.call(arguments).concat(a.args),d=a.func.apply(this,d);"number"===typeof d&&(a.value=d,m.changeWithValue.call(this));this._.emit("bang");return this};return a}(),J=function(){function a(d){s.call(this,1,[]);m.fixKR(this);if(p(d[1])){var b=d[1];this.once("init",function(){this.set(b)})}}m.extend(a);Object.defineProperties(a.prototype,{});return a}(),G=function(){function a(d){s.call(this,1,[]);m.fixKR(this);if(p(d[1])){var b=d[1];this.once("init",function(){this.set(b)})}}m.extend(a);Object.defineProperties(a.prototype,
{});return a}(),K=function(){function d(a){s.call(this,2,[]);this.playbackState=f;var e=this._;e.node=a;e.onplay=b(this);e.onpause=c(this)}m.extend(d);var b=function(d){return function(){-1===a.inlets.indexOf(d)&&(a.inlets.push(d),a.events.emit("addObject"),d.playbackState=e,d._.emit("play"))}},c=function(d){return function(){var b=a.inlets.indexOf(d);-1!==b&&(a.inlets.splice(b,1),d.playbackState=f,d._.emit("pause"),a.events.emit("removeObject"))}},j=d.prototype;j.play=function(){a.nextTick(this._.onplay)};
j.pause=function(){a.nextTick(this._.onpause)};j.process=function(a){var d=this._.node;d.playbackState&1?(d.process(a),this.cells[1].set(d.cells[1]),this.cells[2].set(d.cells[2])):(this.cells[1].set(m.emptycell),this.cells[2].set(m.emptycell))};return d}(),r=function(){function a(){this.context=this;this.tickID=0;this.impl=null;this.amp=0.8;this.status=f;this.samplerate=44100;this.channels=2;this.cellsize=64;this.streammsec=20;this.currentTime=this.streamsize=0;this.nextTicks=[];this.inlets=[];this.timers=
[];this.listeners=[];this.deferred=null;this.recStart=0;this.recBuffers=null;this.delayProcess=d(this);this.events=null;m.currentTimeIncr=1E3*this.cellsize/this.samplerate;m.emptycell=new m.SignalArray(this.cellsize);this.reset(!0)}var d=function(a){return function(){a.recStart=Date.now();a.process()}},j=a.prototype;j.bind=function(a,d){"function"===typeof a&&(this.impl=new a(this,d),this.impl.defaultSamplerate&&(this.samplerate=this.impl.defaultSamplerate));return this};j.setup=function(a){if("object"===
typeof a&&(-1!==c.indexOf(a.samplerate)&&(this.samplerate=a.samplerate<=this.impl.maxSamplerate?a.samplerate:this.impl.maxSamplerate),-1!==b.indexOf(a.cellsize)&&(this.cellsize=a.cellsize),"undefined"!==typeof Float64Array&&"undefined"!==typeof a.f64))q=!!a.f64,m.SignalArray=q?Float64Array:Float32Array;m.currentTimeIncr=1E3*this.cellsize/this.samplerate;m.emptycell=new m.SignalArray(this.cellsize);return this};j.getAdjustSamples=function(a){a=a||this.samplerate;a=Math.ceil(Math.log(this.streammsec/
1E3*a)*Math.LOG2E);return 1<<(8>a?8:14<a?14:a)};j.play=function(){this.status===f&&(this.status=e,this.streamsize=this.getAdjustSamples(),this.strmL=new m.SignalArray(this.streamsize),this.strmR=new m.SignalArray(this.streamsize),this.impl.play(),this.events.emit("play"));return this};j.pause=function(){this.status===e&&(this.status=f,this.impl.pause(),this.events.emit("pause"));return this};j.reset=function(a){a&&(this.events=(new w(this)).on("addObject",function(){this.status===f&&this.play()}).on("removeObject",
function(){this.status===e&&0===this.inlets.length+this.timers.length+this.listeners.length&&this.pause()}));this.currentTime=0;this.nextTicks=[];this.inlets=[];this.timers=[];this.listeners=[];return this};j.process=function(){var a=this.tickID,d=this.strmL,b=this.strmR,c=this.amp,e,j,l,f=this.streamsize,g=0,n,q,h,t=this.cellsize,k=this.streamsize/this.cellsize,i=this.timers,u=this.inlets,o=this.listeners,p=m.currentTimeIncr;for(l=0;l<f;++l)d[l]=b[l]=0;for(;k--;){++a;n=0;for(q=i.length;n<q;++n)i[n].playbackState&
1&&i[n].process(a);n=0;for(q=u.length;n<q;++n)if(e=u[n],e.process(a),e.playbackState&1){j=e.cells[1];e=e.cells[2];h=0;for(l=g;h<t;++h,++l)d[l]+=j[h],b[l]+=e[h]}g+=t;n=0;for(q=o.length;n<q;++n)o[n].playbackState&1&&o[n].process(a);this.currentTime+=p;l=this.nextTicks.splice(0);n=0;for(q=l.length;n<q;++n)l[n]()}for(l=0;l<f;++l)e=d[l]*c,-1>e?e=-1:1<e&&(e=1),d[l]=e,e=b[l]*c,-1>e?e=-1:1<e&&(e=1),b[l]=e;this.tickID=a;a=this.currentTime;if(3===this.status){if(2===this.recCh)this.recBuffers.push(new m.SignalArray(d)),
this.recBuffers.push(new m.SignalArray(b));else{c=new m.SignalArray(d.length);l=0;for(f=c.length;l<f;++l)c[l]=0.5*(d[l]+b[l]);this.recBuffers.push(c)}a>=this.maxDuration?this.deferred.sub.reject():a>=this.recDuration?this.deferred.sub.resolve():20<Date.now()-this.recStart?setTimeout(this.delayProcess,10):this.process()}};j.nextTick=function(a){this.status===f?a():this.nextTicks.push(a)};j.rec=function(){m.fix_iOS6_1_problem(!0);var a=new v(this);if(this.deferred)return console.warn("rec deferred is exists??"),
a.reject().promise();if(this.status!==f)return console.log("status is not none",this.status),a.reject().promise();var d=0,b=arguments,c=p(b[d])?b[d++]:{},d=b[d];if("function"!==typeof d)return console.warn("no function"),a.reject().promise();this.deferred=a;this.status=3;this.reset();var e=new u("+"),j=new v(this),n=this;j.then(l,function(){m.fix_iOS6_1_problem(!1);l.call(n,!0)});this.deferred.sub=j;this.savedSamplerate=this.samplerate;this.samplerate=c.samplerate||this.samplerate;this.recDuration=
c.recDuration||Infinity;this.maxDuration=c.maxDuration||6E5;this.recCh=c.ch||1;2!==this.recCh&&(this.recCh=1);this.recBuffers=[];this.streamsize=this.getAdjustSamples();this.strmL=new m.SignalArray(this.streamsize);this.strmR=new m.SignalArray(this.streamsize);this.inlets.push(e);d({done:function(){j.resolve.apply(j,h.call(arguments))},send:function(){e.append.apply(e,arguments)}});setTimeout(this.delayProcess,10);return a.promise()};var l=function(){this.status=f;this.reset();var a=this.recBuffers,
d=this.samplerate,b=this.streamsize,c;this.samplerate=this.savedSamplerate;c=Infinity!==this.recDuration?0.001*this.recDuration*d|0:(a.length>>this.recCh-1)*b;var e,j=c/b|0,l=0,n=0,g=c;if(2===this.recCh){var q=new m.SignalArray(c),h=new m.SignalArray(c),t=new m.SignalArray(c);for(e=0;e<j;++e)if(q.set(a[l++],n),h.set(a[l++],n),n+=b,g-=b,0<g&&g<b){q.set(a[l++].subarray(0,g),n);h.set(a[l++].subarray(0,g),n);break}e=0;for(j=c;e<j;++e)t[e]=0.5*(q[e]+h[e]);a={samplerate:d,channels:2,buffer:[t,q,h]}}else{c=
new m.SignalArray(c);for(e=0;e<j;++e)if(c.set(a[l++],n),n+=b,g-=b,0<g&&g<b){c.set(a[l++].subarray(0,g),n);break}a={samplerate:d,channels:1,buffer:[c]}}this.deferred.resolve.apply(this.deferred,[].concat.apply([a],arguments));this.deferred=null};j.on=function(a,d){this.events.on(a,d)};j.once=function(a,d){this.events.once(a,d)};j.off=function(a,d){this.events.off(a,d)};j.removeAllListeners=function(a){this.events.removeListeners(a)};j.listeners=function(a){return this.events.listeners(a)};j.fix_iOS6_1_problem=
function(a){this.impl.fix_iOS6_1_problem&&this.impl.fix_iOS6_1_problem(a)};return a}(),H=null,H="undefined"!==typeof webkitAudioContext?function(a){var d=new webkitAudioContext,b,c;m._audioContext=d;this.defaultSamplerate=this.maxSamplerate=d.sampleRate;this.env="webkit";var e=navigator.userAgent;e.match(/linux/i)?a.streammsec*=8:e.match(/win(dows)?\s*(nt 5\.1|xp)/i)&&(a.streammsec*=4);this.play=function(){var e,j=a.getAdjustSamples(d.sampleRate),l=a.streamsize,f,n;if(a.samplerate===d.sampleRate)e=
function(d){d=d.outputBuffer;a.process();d.getChannelData(0).set(a.strmL);d.getChannelData(1).set(a.strmR)};else if(a.samplerate*2===d.sampleRate)e=function(d){var b=a.strmL,c=a.strmR,e=d.outputBuffer,d=e.getChannelData(0),j=e.getChannelData(1),l=e.length,f;a.process();for(e=f=0;e<l;e=e+2,++f){d[e]=d[e+1]=b[f];j[e]=j[e+1]=c[f]}};else{f=l;n=a.samplerate/d.sampleRate;e=function(d){for(var b=a.strmL,c=a.strmR,e=d.outputBuffer,d=e.getChannelData(0),j=e.getChannelData(1),g=e.length,e=0;e<g;++e){if(f>=
l){a.process();f=f-l}d[e]=b[f|0];j[e]=c[f|0];f=f+n}}}b=d.createBufferSource();c=d.createJavaScriptNode(j,2,a.channels);c.onaudioprocess=e;b.noteOn(0);b.connect(c);c.connect(d.destination)};this.pause=function(){b.disconnect();c.disconnect()};if(j){var l=0,f=d.createBufferSource();this.fix_iOS6_1_problem=function(a){l=l+(a?1:-1);if(l===1){f.noteOn(0);f.connect(d.destination)}else l===0&&f.disconnect()}}}:"function"===typeof Audio&&"function"===typeof(new Audio).mozSetup?function(a){var d=function(){var a=
new Blob(["var t=0;onmessage=function(e){if(t)t=clearInterval(t),0;if(typeof e.data=='number'&&e.data>0)t=setInterval(function(){postMessage(0);},e.data);};"],{type:"text/javascript"}),a=URL.createObjectURL(a);return new Worker(a)}();this.maxSamplerate=48E3;this.defaultSamplerate=44100;this.env="moz";this.play=function(){var b=new Audio,c=new Float32Array(a.streamsize*a.channels),e=a.streammsec,j=0,l=1E3*(a.streamsize/a.samplerate),f=Date.now();b.mozSetup(a.channels,a.samplerate);d.onmessage=function(){if(!(j>
Date.now()-f)){var d=a.strmL,e=a.strmR,n=c.length,g=d.length;for(a.process();g--;)c[--n]=e[g],c[--n]=d[g];b.mozWriteAudio(c);j+=l}};d.postMessage(e)};this.pause=function(){d.postMessage(0)}}:function(){this.maxSamplerate=48E3;this.defaultSamplerate=44100;this.env="nop";this.play=function(){};this.pause=function(){}},a=(new r).bind(H),F=g;"node"===n?module.exports=global.timbre=F:"browser"===n&&(F.noConflict=function(){var a=window.timbre,d=window.T;return function(b){window.T===F&&(window.T=d);b&&
window.timbre===F&&(window.timbre=a);return F}}(),window.timbre=window.T=F);(function(){if(!(a.impl.env!=="nop"||n!=="browser"||j)){var d=navigator,b;try{b=d.plugins&&d.mimeTypes&&d.mimeTypes.length?d.plugins["Shockwave Flash"].description.match(/([0-9]+)/)[0]:(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version").match(/([0-9]+)/)[0]}catch(c){b=-1}if(!(b<10)){var e,l=function(){var a=document.getElementsByTagName("script");if(a&&a.length)for(var d,b=0,c=a.length;b<c;++b)if(d=
/^(.*\/)timbre(?:\.dev)?\.js$/i.exec(a[b].src))return d[1]+"timbre.swf"}();window.timbrejs_flashfallback_init=function(){a.bind(function(a){var d=0;this.defaultSamplerate=this.maxSamplerate=44100;this.env="flash";this.play=function(){var b,c=Array(a.streamsize*a.channels),j=a.streammsec,f=0,n=a.streamsize/a.samplerate*1E3,g=Date.now();b=function(){if(!(f>Date.now()-g)){var d=a.strmL,b=a.strmR,j=c.length,l=d.length;for(a.process();l--;){c[--j]=b[l]*32768|0;c[--j]=d[l]*32768|0}e.writeAudio(c.join(" "));
f=f+n}};if(e.setup){e.setup(a.channels,a.samplerate);d=setInterval(b,j)}else console.warn("Cannot find "+l)};this.pause=function(){if(d!==0){e.cancel();clearInterval(d);d=0}}});delete window.timbrejs_flashfallback_init};b=l+"?"+ +new Date;var f=document.createElement("div");f.id="TimbreFlashPlayerDiv";f.style.display="inline";f.width=f.height=1;if(d.plugins&&d.mimeTypes&&d.mimeTypes.length){d=document.createElement("object");d.id="TimbreFlashPlayer";d.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000";
d.width=d.height=1;d.setAttribute("data",b);d.setAttribute("type","application/x-shockwave-flash");b=document.createElement("param");b.setAttribute("name","allowScriptAccess");b.setAttribute("value","always");d.appendChild(b);f.appendChild(d)}else f.innerHTML='<object id="TimbreFlashPlayer" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="1" height="1"><param name="movie" value="'+b+'" /><param name="bgcolor" value="#FFFFFF" /><param name="quality" value="high" /><param name="allowScriptAccess" value="always" /></object>';
window.addEventListener("load",function(){document.body.appendChild(f);e=document.TimbreFlashPlayer})}}})()})();
(function(i){function k(f){this.samplerate=f;this.frequency=340;this.Q=1;this.b0=this.b1=this.b2=this.a1=this.a2=this.x1R=this.x2R=this.y1R=this.y2R=this.x1L=this.x2L=this.y1L=this.y2L=this.gain=0;this.setType("lpf")}var g=k.prototype;g.process=function(f,e){var c,b,a,d=this.x1L,l=this.x2L,n=this.y1L,j=this.y2L,g=this.x1R,h=this.x2R,k=this.y1R,m=this.y2R,i=this.b0,p=this.b1,r=this.b2,w=this.a1,v=this.a2,s,z;s=0;for(z=f.length;s<z;++s)c=f[s],b=i*c+p*d+r*l-w*n-v*j,l=d,d=c,j=n,n=b,c=e[s],a=i*c+p*g+r*
h-w*k-v*m,h=g,g=c,m=k,k=a,f[s]=b,e[s]=a;this.x1L=d;this.x2L=l;this.y1L=n;this.y2L=j;this.x1R=g;this.x2R=h;this.y1R=k;this.y2R=m};g.setType=function(f){var e;if(e=h[f])this.type=f,e.call(this,this.frequency,this.Q,this.gain)};g.setParams=function(f,e,c){this.frequency=f;this.Q=e;this.gain=c;var b=h[this.type];b&&b.call(this,f,e,c);return this};var h={lowpass:function(f,e){f/=0.5*this.samplerate;if(1<=f)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else if(0>=f)this.b0=this.b1=this.b2=this.a1=this.a2=
0;else{var c=Math.pow(10,0.05*(0>e?0:e)),b=Math.sqrt(0.5*(4-Math.sqrt(16-16/(c*c)))),c=Math.PI*f,b=0.5*b*Math.sin(c),b=0.5*(1-b)/(1+b),c=(0.5+b)*Math.cos(c),a=0.25*(0.5+b-c);this.b0=2*a;this.b1=4*a;this.b2=this.b0;this.a1=2*-c;this.a2=2*b}},highpass:function(f,e){f/=0.5*this.samplerate;if(1<=f)this.b0=this.b1=this.b2=this.a1=this.a2=0;else if(0>=f)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else{var c=Math.pow(10,0.05*(0>e?0:e)),b=Math.sqrt((4-Math.sqrt(16-16/(c*c)))/2),c=Math.PI*f,b=0.5*b*Math.sin(c),
b=0.5*(1-b)/(1+b),c=(0.5+b)*Math.cos(c),a=0.25*(0.5+b+c);this.b0=2*a;this.b1=-4*a;this.b2=this.b0;this.a1=2*-c;this.a2=2*b}},bandpass:function(f,e){f/=0.5*this.samplerate;if(0<f&&1>f)if(0<e){var c=Math.PI*f,b=Math.sin(c)/(2*e),c=Math.cos(c),a=1/(1+b);this.b0=b*a;this.b1=0;this.b2=-b*a;this.a1=-2*c*a;this.a2=(1-b)*a}else this.b0=this.b1=this.b2=this.a1=this.a2=0;else this.b0=this.b1=this.b2=this.a1=this.a2=0},lowshelf:function(f,e,c){f/=0.5*this.samplerate;e=Math.pow(10,c/40);if(1<=f)this.b0=e*e,this.b1=
this.b2=this.a1=this.a2=0;else if(0>=f)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else{var f=Math.PI*f,c=0.5*Math.sin(f)*Math.sqrt(0*(e+1/e)+2),f=Math.cos(f),c=2*Math.sqrt(e)*c,b=e+1,a=e-1,d=1/(b+a*f+c);this.b0=e*(b-a*f+c)*d;this.b1=2*e*(a-b*f)*d;this.b2=e*(b-a*f-c)*d;this.a1=-2*(a+b*f)*d;this.a2=(b+a*f-c)*d}},highshelf:function(f,e,c){f/=0.5*this.samplerate;e=Math.pow(10,c/40);if(1<=f)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else if(0>=f)this.b0=e*e,this.b1=this.b2=this.a1=this.a2=0;else{var f=
Math.PI*f,c=0.5*Math.sin(f)*Math.sqrt(0*(e+1/e)+2),f=Math.cos(f),c=2*Math.sqrt(e)*c,b=e+1,a=e-1,d=1/(b-a*f+c);this.b0=e*(b+a*f+c)*d;this.b1=-2*e*(a+b*f)*d;this.b2=e*(b+a*f-c)*d;this.a1=2*(a-b*f)*d;this.a2=(b-a*f-c)*d}},peaking:function(f,e,c){f/=0.5*this.samplerate;if(0<f&&1>f)if(c=Math.pow(10,c/40),0<e){var f=Math.PI*f,e=Math.sin(f)/(2*e),f=Math.cos(f),b=1/(1+e/c);this.b0=(1+e*c)*b;this.b1=-2*f*b;this.b2=(1-e*c)*b;this.a1=this.b1;this.a2=(1-e/c)*b}else this.b0=c*c,this.b1=this.b2=this.a1=this.a2=
0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0},notch:function(f,e){f/=0.5*this.samplerate;if(0<f&&1>f)if(0<e){var c=Math.PI*f,b=Math.sin(c)/(2*e),c=Math.cos(c),a=1/(1+b);this.b0=a;this.b1=-2*c*a;this.b2=a;this.a1=this.b1;this.a2=(1-b)*a}else this.b0=this.b1=this.b2=this.a1=this.a2=0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0},allpass:function(f,e){f/=0.5*this.samplerate;if(0<f&&1>f)if(0<e){var c=Math.PI*f,b=Math.sin(c)/(2*e),c=Math.cos(c),a=1/(1+b);this.b0=(1-b)*a;this.b1=-2*c*a;this.b2=
(1+b)*a;this.a1=this.b1;this.a2=this.b0}else this.b0=-1,this.b1=this.b2=this.a1=this.a2=0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0}};h.lpf=h.lowpass;h.hpf=h.highpass;h.bpf=h.bandpass;h.bef=h.notch;h.brf=h.notch;h.apf=h.allpass;i.modules.Biquad=k})(timbre);
(function(i){function k(f){this.samplerate=f;this.buffersize=1<<Math.round(Math.log(0.1*f)*Math.LOG2E);this.bufferL=new i.fn.SignalArray(this.buffersize+1);this.bufferR=new i.fn.SignalArray(this.buffersize+1);this._wave=this.wave=null;this.writeIndex=this.buffersize>>1;this.readIndex=0;this.delayTime=20;this.rate=4;this.depth=20;this.feedback=0.2;this.wet=0.5;this.phaseIncr=this.phase=0;this.phaseStep=4;this.setWaveType("sin");this.setDelayTime(this.delayTime);this.setRate(this.rate)}var g=k.prototype,
h=[];h[0]=function(){for(var f=new Float32Array(512),e=0;512>e;++e)f[e]=Math.sin(2*Math.PI*(e/512));return f}();h[1]=function(){for(var f=new Float32Array(512),e,c=0;512>c;++c)e=c/512-0.25,f[c]=1-4*Math.abs(Math.round(e)-e);return f}();g.setWaveType=function(f){"sin"===f?(this.wave=f,this._wave=h[0]):"tri"===f&&(this.wave=f,this._wave=h[1])};g.setDelayTime=function(f){this.delayTime=f;for(f=this.writeIndex-(0.001*f*this.samplerate|0);0>f;)f+=this.buffersize;this.readIndex=f};g.setRate=function(f){this.rate=
f;this.phaseIncr=512*this.rate/this.samplerate*this.phaseStep};g.process=function(f,e){var c=this.bufferL,b=this.bufferR,a=this.buffersize,d=a-1,l=this._wave,g=this.phase,j=this.phaseIncr,q=this.writeIndex,h=this.readIndex,k=this.depth,m=this.feedback,i,p,r,w=this.wet,v=1-w,s,z=f.length,C,E=this.phaseStep;for(s=0;s<z;){r=l[g|0]*k;for(g+=j;512<g;)g-=512;for(C=0;C<E;++C,++s)p=h+a+r&d,i=0.5*(c[p]+c[p+1]),c[q]=f[s]-i*m,f[s]=f[s]*v+i*w,i=0.5*(b[p]+b[p+1]),b[q]=e[s]-i*m,e[s]=e[s]*v+i*w,q=q+1&d,h=h+1&d}this.phase=
g;this.writeIndex=q;this.readIndex=h};i.modules.Chorus=k})(timbre);
(function(i){function k(c,b){this.samplerate=c;this.channels=b;this.preDelayReadIndex=this.lastPreDelayFrames=0;this.preDelayWriteIndex=f;this.K=this.ykneeThresholdDb=this.kneeThresholdDb=this.kneeThreshold=this.dbKnee=this.dbThreshold=this.linearThreshold=this.slope=this.ratio=-1;this.attackTime=0.003;this.releaseTime=0.25;this.preDelayTime=0.006;this.dbPostGain=0;this.effectBlend=1;this.releaseZone1=0.09;this.releaseZone2=0.16;this.releaseZone3=0.42;this.releaseZone4=0.98;this.detectorAverage=0;
this.meteringGain=this.compressorGain=1;this.delayBufferL=new i.fn.SignalArray(g);this.delayBufferR=2===b?new i.fn.SignalArray(g):this.delayBufferL;this.preDelayTime=6;this.preDelayReadIndex=0;this.preDelayWriteIndex=f;this.maxAttackCompressionDiffDb=-1;this.meteringReleaseK=1-Math.exp(-1/(0.325*this.samplerate));this.setAttackTime(this.attackTime);this.setReleaseTime(this.releaseTime);this.setPreDelayTime(this.preDelayTime);this.setParams(-24,30,12)}var g=1024,h=g-1,f=256,e=k.prototype;e.clone=function(){var c=
new k(this.samplerate,this.channels);c.setAttackTime(this.attackTime);c.setReleaseTime(this.releaseTime);c.setPreDelayTime(this.preDelayTime);c.setParams(this.dbThreshold,this.dbKnee,this.ratio);return c};e.setAttackTime=function(c){this.attackTime=Math.max(0.001,c);this._attackFrames=this.attackTime*this.samplerate};e.setReleaseTime=function(c){this.releaseTime=Math.max(0.001,c);var b=this.releaseTime*this.samplerate;this._satReleaseFrames=0.0025*this.samplerate;var c=b*this.releaseZone1,a=b*this.releaseZone2,
d=b*this.releaseZone3,b=b*this.releaseZone4;this._kA=0.9999999999999998*c+1.8432219684323923E-16*a-1.9373394351676423E-16*d+8.824516011816245E-18*b;this._kB=-1.5788320352845888*c+2.3305837032074286*a-0.9141194204840429*d+0.1623677525612032*b;this._kC=0.5334142869106424*c-1.272736789213631*a+0.9258856042207512*d-0.18656310191776226*b;this._kD=0.08783463138207234*c-0.1694162967925622*a+0.08588057951595272*d-0.00429891410546283*b;this._kE=-0.042416883008123074*c+0.1115693827987602*a-0.09764676325265872*
d+0.028494263462021576*b};e.setPreDelayTime=function(c){this.preDelayTime=c;c*=this.samplerate;c>g-1&&(c=g-1);if(this.lastPreDelayFrames!==c){this.lastPreDelayFrames=c;for(var b=0,a=this.delayBufferL.length;b<a;++b)this.delayBufferL[b]=this.delayBufferR[b]=0;this.preDelayReadIndex=0;this.preDelayWriteIndex=c}};e.setParams=function(c,b,a){this._k=this.updateStaticCurveParameters(c,b,a);c=1/this.saturate(1,this._k);c=Math.pow(c,0.6);this._masterLinearGain=Math.pow(10,0.05*this.dbPostGain)*c};e.kneeCurve=
function(c,b){return c<this.linearThreshold?c:this.linearThreshold+(1-Math.exp(-b*(c-this.linearThreshold)))/b};e.saturate=function(c,b){var a;c<this.kneeThreshold?a=this.kneeCurve(c,b):(a=this.ykneeThresholdDb+this.slope*((c?20*Math.log(c)*Math.LOG10E:-1E3)-this.kneeThresholdDb),a=Math.pow(10,0.05*a));return a};e.slopeAt=function(c,b){if(c<this.linearThreshold)return 1;var a=1.001*c,d=c?20*Math.log(c)*Math.LOG10E:-1E3,e=a?20*Math.log(a)*Math.LOG10E:-1E3,f=this.kneeCurve(c,b),a=this.kneeCurve(a,b),
f=f?20*Math.log(f)*Math.LOG10E:-1E3;return((a?20*Math.log(a)*Math.LOG10E:-1E3)-f)/(e-d)};e.kAtSlope=function(c){for(var b=Math.pow(10,0.05*(this.dbThreshold+this.dbKnee)),a=0.1,d=1E4,e=5,f=0;15>f;++f)this.slopeAt(b,e)<c?d=e:a=e,e=Math.sqrt(a*d);return e};e.updateStaticCurveParameters=function(c,b,a){this.dbThreshold=c;this.linearThreshold=Math.pow(10,0.05*c);this.dbKnee=b;this.ratio=a;this.slope=1/this.ratio;this.kneeThresholdDb=c+b;this.kneeThreshold=Math.pow(10,0.05*this.kneeThresholdDb);c=this.kAtSlope(1/
this.ratio);this.ykneeThresholdDb=(b=this.kneeCurve(this.kneeThreshold,c))?20*Math.log(b)*Math.LOG10E:-1E3;return this._k=c};e.process=function(c,b){for(var a=1-this.effectBlend,d=this.effectBlend,e=this._k,f=this._masterLinearGain,j=this._satReleaseFrames,g=this._kA,t=this._kB,i=this._kC,k=this._kD,o=this._kE,p=c.length/64,r=0,w=this.detectorAverage,v=this.compressorGain,s=this.maxAttackCompressionDiffDb,z=1/this._attackFrames,C=this.preDelayReadIndex,E=this.preDelayWriteIndex,B=this.detectorAverage,
I=this.delayBufferL,J=this.delayBufferR,G=this.meteringGain,K=this.meteringReleaseK,H=0;H<p;++H){var F=Math.asin(w)/(0.5*Math.PI),D;D=F>v;var x=v/F,x=x?20*Math.log(x)*Math.LOG10E:-1E3;if(Infinity===x||isNaN(x))x=-1;if(D)s=-1,x=-12>x?0:0<x?3:0.25*(x+12),D=x*x,D=Math.pow(10,0.05*(5/(g+t*x+i*D+k*D*x+o*D*D)));else{if(-1===s||s<x)s=x;x=0.25/Math.max(0.5,s);D=1-Math.pow(x,z)}for(x=64;x--;){var A=0,y=0.5*(c[r]+b[r]);I[E]=c[r];J[E]=b[r];0>y&&(y*=-1);A<y&&(A=y);0>A&&(A*=-1);y=this.saturate(A,e);y=(A=1.0E-4>=
A?1:y/A)?-20*Math.log(A)*Math.LOG10E:1E3;2>y&&(y=2);y=Math.pow(10,0.05*(y/j))-1;B+=(A-B)*(A>B?y:1);1<B&&(B=1);1>D?v+=(F-v)*D:(v*=D,1<v&&(v=1));y=Math.sin(0.5*Math.PI*v);A=a+d*f*y;y=20*Math.log(y)*Math.LOG10E;G=y<G?y:G+(y-G)*K;c[r]=I[C]*A;b[r]=J[C]*A;r++;C=C+1&h;E=E+1&h}1.0E-6>B&&(B=1.0E-6);1.0E-6>v&&(v=1.0E-6)}this.preDelayReadIndex=C;this.preDelayWriteIndex=E;this.detectorAverage=B;this.compressorGain=v;this.maxAttackCompressionDiffDb=s;this.meteringGain=G};e.reset=function(){this.detectorAverage=
0;this.meteringGain=this.compressorGain=1;for(var c=0,b=this.delayBufferL.length;c<b;++c)this.delayBufferL[c]=this.delayBufferR[c]=0;this.preDelayReadIndex=0;this.preDelayWriteIndex=f;this.maxAttackCompressionDiffDb=-1};i.modules.Compressor=k})(timbre);
(function(i){function k(){}k.prototype.decode=function(g,h,f){if("string"===typeof g){if(/\.wav$/.test(g))return k.wav_decode(g,h,f);if(k.ogg_decode&&/\.ogg$/.test(g))return k.ogg_decode(g,h,f);if(k.mp3_decode&&/\.mp3$/.test(g))return k.mp3_decode(g,h,f)}else if("object"===typeof g){if("wav"===g.type)return k.wav_decode(g.data,h,f);if(k.ogg_decode&&"ogg"===g.type)return k.ogg_decode(g.data,h,f);if(k.mp3_decode&&"mp3"===g.type)return k.mp3_decode(g.data,h,f)}if(k.webkit_decode)return"object"===typeof g?
k.webkit_decode(g.data,h,f):k.webkit_decode(g,h,f);if(k.moz_decode)return k.moz_decode(g,h,f);h(!1)};i.modules.Decoder=k;k.getBinaryWithPath="browser"===i.envtype?function(g,h){i.fn.fix_iOS6_1_problem(!0);var f=new XMLHttpRequest;f.open("GET",g);f.responseType="arraybuffer";f.onreadystatechange=function(){4===f.readyState&&(f.response?h(new Uint8Array(f.response)):void 0!==f.responseBody&&h(new Uint8Array(VBArray(f.responseBody).toArray())),i.fn.fix_iOS6_1_problem(!1))};f.send()}:function(g,h){h("no support")};
k.wav_decode=function(){var g=function(g,f,e){if("RIFF"!==String.fromCharCode(g[0],g[1],g[2],g[3])||g[4]+(g[5]<<8)+(g[6]<<16)+(g[7]<<24)+8!==g.length||"WAVE"!==String.fromCharCode(g[8],g[9],g[10],g[11])||"fmt "!==String.fromCharCode(g[12],g[13],g[14],g[15]))return f(!1);var c=g[22]+(g[23]<<8),b=g[24]+(g[25]<<8)+(g[26]<<16)+(g[27]<<24),a=g[34]+(g[35]<<8);if("data"!==String.fromCharCode(g[36],g[37],g[38],g[39]))return f(!1);var d=g[40]+(g[41]<<8)+(g[42]<<16)+(g[43]<<24),l=(d/c>>1)/b;if(d>g.length-44)return f(!1);
var n,j,d=new Float32Array(l*b|0);2===c&&(n=new Float32Array(d.length),j=new Float32Array(d.length));f({samplerate:b,channels:c,buffer:[d,n,j],duration:l});if(8===a)g=new Int8Array(g.buffer,44);else if(16===a)g=new Int16Array(g.buffer,44);else if(32===a)g=new Int32Array(g.buffer,44);else if(24===a){for(var g=new Uint8Array(g.buffer,44),q,t,i,f=new Int32Array(g.length/3),b=0,l=g.length,k=0;b<l;)q=g[b++],t=g[b++],i=g[b++],q=q+(t<<8)+(i<<16),q=q&8388608?q-16777216:q,f[k++]=q;g=f}a=1/((1<<a-1)-1);if(2===
c){c=b=0;for(f=d.length;c<f;++c)l=n[c]=g[b++]*a,l+=j[c]=g[b++]*a,d[c]=0.5*l}else{c=0;for(f=d.length;c<f;++c)d[c]=g[c]*a}e()};return function(h,f,e){"string"===typeof h?k.getBinaryWithPath(h,function(c){g(c,f,e)}):g(h,f,e)}}();k.webkit_decode=function(){if("undefined"!==typeof webkitAudioContext){var g=i.fn._audioContext,h=function(f,e,c){var b,a,d,l;if("string"===typeof f)return c(!1);try{d=g.createBuffer(f.buffer,!1)}catch(n){return e(!1)}f=g.sampleRate;b=d.numberOfChannels;2===b?(console.log(d),
a=d.getChannelData(0),d=d.getChannelData(1)):a=d=d.getChannelData(0);l=a.length/f;for(var j=new Float32Array(a),q=0,h=j.length;q<h;++q)j[q]=0.5*(j[q]+d[q]);e({samplerate:f,channels:b,buffer:[j,a,d],duration:l});c()};return function(f,e,c){if(f instanceof File){var b=new FileReader;b.onload=function(a){h(new Uint8Array(a.target.result),e,c)};b.readAsArrayBuffer(f)}else"string"===typeof f?k.getBinaryWithPath(f,function(a){h(a,e,c)}):h(f,e,c)}}}();k.moz_decode=function(){if("function"===typeof Audio&&
"function"===typeof(new Audio).mozSetup)return function(g,h,f){var e,c,b,a,d,l,n=0,j=new Audio(g);j.volume=0;j.addEventListener("loadedmetadata",function(){e=j.mozSampleRate;c=j.mozChannels;l=j.duration;b=new Float32Array(j.duration*e|0);2===c&&(a=new Float32Array(j.duration*e|0),d=new Float32Array(j.duration*e|0));2===c?j.addEventListener("MozAudioAvailable",function(c){for(var e=c.frameBuffer,j=0,l=e.length;j<l;j=j+2){c=a[n]=e[j];c=c+(d[n]=e[j+1]);b[n]=c*0.5;n=n+1}},!1):j.addEventListener("MozAudioAvailable",
function(a){for(var a=a.frameBuffer,d=0,c=a.length;d<c;++d){b[d]=a[d];n=n+1}},!1);j.play();setTimeout(function(){h({samplerate:e,channels:c,buffer:[b,a,d],duration:l})},1E3)},!1);j.addEventListener("ended",function(){f()},!1);j.load()}}()})(timbre);
(function(i){function k(a){this.samplerate=a||44100;this.value=h;this.status=j;this.curve="linear";this.step=1;this.emit=this.loopNode=this.releaseNode=null;this._envValue=new g(a);this._table=[];this._initValue=h;this._curveValue=0;this._defaultCurveType=e;this._counter=this._index=0}function g(a){this.samplerate=a;this.value=h;this.step=1;this._curveType=e;this._y2=this._y1=this._b1=this._a2=this._grow=this._curveValue=0}var h=k.ZERO=1.0E-6,f=k.CurveTypeSet=0,e=k.CurveTypeLin=1,c=k.CurveTypeExp=
2,b=k.CurveTypeSin=3,a=k.CurveTypeWel=4,d=k.CurveTypeCurve=5,l=k.CurveTypeSqr=6,n=k.CurveTypeCub=7,j=k.StatusWait=0,q=k.StatusGate=1,t=k.StatusSustain=2,u=k.StatusRelease=3,m=k.StatusEnd=4,o={set:f,lin:e,linear:e,exp:c,exponential:c,sin:b,sine:b,wel:a,welch:a,sqr:l,squared:l,cub:n,cubed:n};k.CurveTypeDict=o;var p=k.prototype;p.clone=function(){var a=new k(this.samplerate);a._table=this._table;a._initValue=this._initValue;a.setCurve(this.curve);null!==this.releaseNode&&a.setReleaseNode(this.releaseNode+
1);null!==this.loopNode&&a.setLoopNode(this.loopNode+1);a.setStep(this.step);a.reset();return a};p.setTable=function(a){this._initValue=a[0];this._table=a.slice(1);this.value=this._envValue.value=this._initValue;this._counter=this._index=0;this.status=j};p.setCurve=function(a){"number"===typeof a?(this._defaultCurveType=d,this._curveValue=a):this._defaultCurveType=o[a]||null;this.curve=a};p.setReleaseNode=function(a){"number"===typeof a&&0<a&&(this.releaseNode=a-1)};p.setLoopNode=function(a){"number"===
typeof a&&0<a&&(this.loopNode=a-1)};p.setStep=function(a){this.step=this._envValue.step=a};p.reset=function(){this.value=this._envValue.value=this._initValue;this._counter=this._index=0;this.status=j};p.release=function(){null!==this.releaseNode&&(this._counter=0,this.status=u)};p.getInfo=function(a){var d=this._table,b,c,e=0,j=Infinity,l=Infinity,f=!1;b=0;for(c=d.length;b<c;++b){this.loopNode===b&&(j=e);this.releaseNode===b&&(l=e=e<a?e+a:a);var g=d[b];Array.isArray(g)&&(e+=g[1])}Infinity!==j&&Infinity===
l&&(e+=a,f=!0);return{totalDuration:e,loopBeginTime:j,releaseBeginTime:l,isEndlessLoop:f}};p.calcStatus=function(){var a=this.status,b=this._table,c=this._index,j=this._counter,l=this._curveValue,f=this._defaultCurveType,g=this.loopNode,n=this.releaseNode,h=this._envValue,i,k,o=null;switch(a){case q:case u:for(;0>=j;)c>=b.length?a===q&&null!==g?c=g:(a=m,j=Infinity,o="ended"):a===q&&c===n?null!==g&&g<n?c=g:(a=t,j=Infinity,o="sustained"):(i=b[c++],j=i[0],k=null===i[2]?f:i[2],k===d&&(l=i[3],0.001>Math.abs(l)&&
(k=e)),i=i[1],j=h.setNext(j,i,k,l))}this.status=a;this.emit=o;this._index=c;this._counter=j;return a};p.next=function(){this.calcStatus()&1&&(this.value=this._envValue.next()||h);this._counter-=1;return this.value};p.process=function(a){var d=this._envValue,b,c=a.length;if(this.calcStatus()&1)for(b=0;b<c;++b)a[b]=d.next()||h;else{d=this.value||h;for(b=0;b<c;++b)a[b]=d}this.value=a[c-1];this._counter-=a.length};g.prototype.setNext=function(j,g,q,h){var t=this.value,i,k,m,u,o,g=0.001*g*this.samplerate/
this.step|0;1>g&&(g=1,q=f);switch(q){case f:this.value=j;break;case e:i=(j-t)/g;break;case c:i=0!==t?Math.pow(j/t,1/g):0;break;case b:h=Math.PI/g;k=0.5*(j+t);m=2*Math.cos(h);u=0.5*(j-t);o=u*Math.sin(0.5*Math.PI-h);break;case a:h=0.5*Math.PI/g;m=2*Math.cos(h);j>=t?(k=t,u=0,o=-Math.sin(h)*(j-t)):(k=j,u=t-j,o=Math.cos(h)*(t-j));break;case d:j=(j-t)/(1-Math.exp(h));k=t+j;m=j;i=Math.exp(h/g);break;case l:u=Math.sqrt(t);o=Math.sqrt(j);i=(o-u)/g;break;case n:u=Math.pow(t,0.33333333),o=Math.pow(j,0.33333333),
i=(o-u)/g}this.next=r[q];this._grow=i;this._a2=k;this._b1=m;this._y1=u;this._y2=o;return g};var r=[];r[f]=function(){return this.value};r[e]=function(){return this.value+=this._grow};r[c]=function(){return this.value*=this._grow};r[b]=function(){var a=this._b1*this._y1-this._y2;this.value=this._a2-a;this._y2=this._y1;this._y1=a;return this.value};r[a]=function(){var a=this._b1*this._y1-this._y2;this.value=this._a2+a;this._y2=this._y1;this._y1=a;return this.value};r[d]=function(){this._b1*=this._grow;
return this.value=this._a2-this._b1};r[l]=function(){this._y1+=this._grow;return this.value=this._y1*this._y1};r[n]=function(){this._y1+=this._grow;return this.value=this._y1*this._y1*this._y1};g.prototype.next=r[f];i.modules.Envelope=k;i.modules.EnvelopeValue=g})(timbre);
(function(i){function k(e){this.length=e=1<<Math.ceil(Math.log("number"===typeof e?e:512)*Math.LOG2E);this.buffer=new i.fn.SignalArray(e);this.real=new i.fn.SignalArray(e);this.imag=new i.fn.SignalArray(e);this._real=new i.fn.SignalArray(e);this._imag=new i.fn.SignalArray(e);this.mag=new i.fn.SignalArray(e>>1);this.minDecibels=-30;this.maxDecibels=-100;e=h.get(e);this._bitrev=e.bitrev;this._sintable=e.sintable;this._costable=e.costable}var g=k.prototype;g.setWindow=function(e){if("string"===typeof e){var c=
/([A-Za-z]+)(?:\(([01]\.?\d*)\))?/.exec(e);if(null!==c){var b=c[1].toLowerCase(),c=void 0!==c[2]?+c[2]:0.25;if(b=f[b]){this._window||(this._window=new i.fn.SignalArray(this.length));for(var a=this._window,d=0,l=this.length,c=0>c?0:1<c?1:c;d<l;++d)a[d]=b(d,l,c);this.windowName=e}}}};g.forward=function(e){var c=this.buffer,b=this.real,a=this.imag,d=this._window,l=this._bitrev,f=this._sintable,j=this._costable,g=c.length,h,i,k,o,p,r,w;if(d)for(h=0;h<g;++h)c[h]=e[h]*d[h];else c.set(e);for(h=0;h<g;++h)b[h]=
c[l[h]],a[h]=0;for(c=1;c<g;c=d){l=0;d=c+c;i=g/d;for(e=0;e<c;e++){k=j[l];o=f[l];for(h=e;h<g;h+=d)p=h+c,r=o*a[p]+k*b[p],w=k*a[p]-o*b[p],b[p]=b[h]-r,b[h]+=r,a[p]=a[h]-w,a[h]+=w;l+=i}}f=this.mag;for(h=0;h<g;++h)j=b[h],e=a[h],f[h]=Math.sqrt(j*j+e*e);return{real:b,imag:a}};g.inverse=function(e,c){var b=this.buffer,a=this._real,d=this._imag,l=this._bitrev,f=this._sintable,j=this._costable,g=b.length,h,i,k,o,p,r,w,v,s,z;for(h=0;h<g;++h)i=l[h],a[h]=+e[i],d[h]=-c[i];for(l=1;l<g;l=k){o=0;k=l+l;p=g/k;for(i=0;i<
l;i++){r=j[o];w=f[o];for(h=i;h<g;h+=k)v=h+l,s=w*d[v]+r*a[v],z=r*d[v]-w*a[v],a[v]=a[h]-s,a[h]+=s,d[v]=d[h]-z,d[h]+=z;o+=p}}for(h=0;h<g;++h)b[h]=a[h]/g;return b};g.getFrequencyData=function(e){var c=this.minDecibels,b,a=Math.min(this.mag.length,e.length);if(a){var d,l=this.mag,f=0;for(b=0;b<a;++b)d=l[b],e[b]=!d?c:20*Math.log(d)*Math.LOG10E,f<e[b]&&(f=e[b])}return e};var h={get:function(e){var c;if(!(c=h[e])){var b,a,d,l;c=new Int16Array(e);l=e>>1;for(b=a=0;;){c[b]=a;if(++b>=e)break;for(d=l;d<=a;)a-=
d,d>>=1;a+=d}a=Math.floor(Math.log(e)/Math.LN2);b=new i.fn.SignalArray((1<<a)-1);l=new i.fn.SignalArray((1<<a)-1);var f=2*Math.PI;a=0;for(d=b.length;a<d;++a)b[a]=Math.sin(f*(a/e)),l[a]=Math.cos(f*(a/e));h[e]={bitrev:c,sintable:b,costable:l};c=h[e]}return c}},f=function(){var e=Math.PI,c=2*Math.PI,b=Math.abs,a=Math.pow,d=Math.cos,l=Math.sin,f=Math.E;return{rectangular:function(){return 1},hann:function(a,b){return 0.5*(1-d(c*a/(b-1)))},hamming:function(a,b){return 0.54-0.46*d(c*a/(b-1))},tukery:function(a,
b,c){return a<c*(b-1)/2?0.5*(1+d(e*(2*a/(c*(b-1))-1))):(b-1)*(1-c/2)<a?0.5*(1+d(e*(2*a/(c*(b-1))-2/c+1))):1},cosine:function(a,d){return l(e*a/(d-1))},lanczos:function(a,d){return l(e*(2*a/(d-1)-1))/(e*(2*a/(d-1)-1))},triangular:function(a,d){return 2/(d+1)*((d+1)/2-b(a-(d-1)/2))},bartlett:function(a,d){return 2/(d-1)*((d-1)/2-b(a-(d-1)/2))},gaussian:function(d,b,c){return a(f,-0.5*a((d-(b-1)/2)/(c*(b-1)/2),2))},bartlettHann:function(a,e){return 0.62-0.48*b(a/(e-1)-0.5)-0.38*d(c*a/(e-1))},blackman:function(a,
b,l){var f=l/2;return(1-l)/2-0.5*d(c*a/(b-1))+f*d(4*e*a/(b-1))}}}();i.modules.FFT=k})(timbre);
(function(i){function k(b){this.samplerate=b||44100;this.wave=null;this.step=1;this.phase=this.value=this.frequency=0;this.feedback=!1;this._lastouts=this._x=0;this._coeff=g/this.samplerate;this._radtoinc=g/(2*Math.PI)}var g=1024,h=g-1,f=k.prototype;f.setWave=function(b){var a,d,c=this.wave;this.wave||(this.wave=new Float32Array(g+1));if("function"===typeof b)for(a=0;a<g;++a)c[a]=b(a/g);else if(i.fn.isSignalArray(b))if(b.length===c.length)c.set(b);else{d=b.length/g;for(a=0;a<g;++a)c[a]=b[a*d|0]}else"string"===
typeof b&&void 0!==(d=e(b))&&this.wave.set(d);this.wave[g]=this.wave[0]};f.clone=function(){var b=new k(this.samplerate);b.wave=this.wave;b.step=this.step;b.frequency=this.frequency;b.value=this.value;b.phase=this.phase;b.feedback=this.feedback;return b};f.reset=function(){this._x=0};f.next=function(){var b=this._x;this.value=this.wave[(b+this.phase*this._radtoinc|0)&h];b+=this.frequency*this._coeff*this.step;b>g&&(b-=g);this._x=b;return this.value};f.process=function(b){var a=this.wave,d=this._radtoinc,
c,e=this._x,j,f,i=this.frequency*this._coeff,k,m=this.step;if(this.feedback){j=this._lastouts;d*=this.phase;for(k=0;k<m;++k)c=e+j*d,j=c|0,c-=j,j&=h,f=a[j],j=a[j+1],b[k]=j=f+c*(j-f),e+=i;this._lastouts=j}else{d*=this.phase;for(k=0;k<m;++k)c=e+d,j=c|0,c-=j,j&=h,f=a[j],j=a[j+1],b[k]=f+c*(j-f),e+=i}e>g&&(e-=g);this._x=e;this.value=b[b.length-1]};f.processWithFreqArray=function(b,a){var d=this.wave,c=this._radtoinc,e,j=this._x,f,i,k=this._coeff,m,o=this.step;if(this.feedback){f=this._lastouts;c*=this.phase;
for(m=0;m<o;++m)e=j+f*c,f=e|0,e-=f,f&=h,i=d[f],f=d[f+1],b[m]=f=i+e*(f-i),j+=a[m]*k;this._lastouts=f}else{c=this.phase*this._radtoinc;for(m=0;m<o;++m)e=j+c,f=e|0,e-=f,f&=h,i=d[f],f=d[f+1],b[m]=i+e*(f-i),j+=a[m]*k}j>g&&(j-=g);this._x=j;this.value=b[b.length-1]};f.processWithPhaseArray=function(b,a){var d=this.wave,c=this._radtoinc,e,j=this._x,f,i,k=this.frequency*this._coeff,m,o=this.step;if(this.feedback){f=this._lastouts;c*=this.phase;for(m=0;m<o;++m)e=j+f*c,f=e|0,e-=f,f&=h,i=d[f],f=d[f+1],b[m]=f=
i+e*(f-i),j+=k;this._lastouts=f}else for(m=0;m<o;++m)e=j+a[m]*c,f=e|0,e-=f,f&=h,i=d[f],f=d[f+1],b[m]=i+e*(f-i),j+=k;j>g&&(j-=g);this._x=j;this.value=b[b.length-1]};f.processWithFreqAndPhaseArray=function(b,a,d){var c=this.wave,e=this._radtoinc,j,f=this._x,i,k,m=this._coeff,o,p=this.step;if(this.feedback){d=this._lastouts;e*=this.phase;for(o=0;o<p;++o)j=f+d*e,i=j|0,j-=i,i&=h,k=c[i],i=c[i+1],b[o]=d=k+j*(i-k),f+=a[o]*m;this._lastouts=d}else for(o=0;o<p;++o)j=f+d[o]*g,i=j|0,j-=i,i&=h,k=c[i],i=c[i+1],
b[o]=k+j*(i-k),f+=a[o]*m;f>g&&(f-=g);this._x=f;this.value=b[b.length-1]};var e=function(b){var a=c[b];if(void 0!==a)return"function"===typeof a&&(a=a()),a;var d;d=/^([\-+]?)(\w+)(?:\((@[0-7])?:?(\d+)?\))?$/.exec(b);if(null!==d){var a=d[1],e=d[3],f=d[4];d=c[d[2]];var j,g;if(void 0===d)a=void 0;else{"function"===typeof d&&(d=d());switch(e){case "@1":for(j=512;1024>j;++j)d[j]=0;break;case "@2":for(j=512;1024>j;++j)d[j]=Math.abs(d[j]);break;case "@3":for(j=256;512>j;++j)d[j]=0;for(j=512;768>j;++j)d[j]=
Math.abs(d[j]);for(j=768;1024>j;++j)d[j]=0;break;case "@4":e=new Float32Array(1024);for(j=0;512>j;++j)e[j]=d[j<<1];d=e;break;case "@5":e=new Float32Array(1024);for(j=0;512>j;++j)e[j]=Math.abs(d[j<<1]);d=e}if(void 0!==f&&50!==f){f*=0.01;f=0>f?0:1<f?1:f;e=new Float32Array(1024);f=1024*f|0;for(j=0;j<f;++j)e[j]=d[512*(j/f)|0];g=1024-f;for(f=0;1024>j;++j,++f)e[j]=d[512*(f/g)+512|0];d=e}if("+"===a)for(j=0;1024>j;++j)d[j]=0.5*d[j]+0.5;else if("-"===a)for(j=0;1024>j;++j)d[j]*=-1;a=d}if(void 0!==a)return c[b]=
a}d=/^wavb\(((?:[0-9a-fA-F][0-9a-fA-F])+)\)$/.exec(b);if(null!==d){b=d[1];a=new Float32Array(1024);d=b.length>>1;if(-1!==[2,4,8,16,32,64,128,256,512,1024].indexOf(d))for(j=e=0;e<d;++e){f=parseInt(b.substr(2*e,2),16);f=f&128?(f-256)/128:f/127;g=0;for(var h=1024/d;g<h;++g)a[j++]=f}return a}d=/^wavc\(([0-9a-fA-F]{8})\)$/.exec(b);if(null!==d){a=d[1];b=new Float32Array(1024);if(8===a.length){e=parseInt(a,16);d=new Float32Array(8);d[0]=1;for(a=0;7>a;++a)d[a+1]=0.0625*(e&15),e>>=4;for(a=0;8>a;++a){j=0;f=
(a+1)/1024;for(e=0;1024>e;++e)b[e]+=Math.sin(2*Math.PI*j)*d[a],j+=f}for(a=d=0;1024>a;++a)if(d<(e=Math.abs(b[a])))d=e;if(0<d)for(a=0;1024>a;++a)b[a]/=d}return b}};k.getWavetable=e;k.setWavetable=function(b,a){var d,e=new Float32Array(1024),f;if("function"===typeof a)for(f=0;1024>f;++f)e[f]=a(f/1024);else if(i.fn.isSignalArray(a))if(a.length===e.length)e.set(a);else{d=a.length/1024;for(f=0;1024>f;++f)e[f]=a[f*d|0]}c[b]=e};var c={sin:function(){for(var b=new Float32Array(1024),a=0;1024>a;++a)b[a]=Math.sin(2*
Math.PI*(a/1024));return b},cos:function(){for(var b=new Float32Array(1024),a=0;1024>a;++a)b[a]=Math.cos(2*Math.PI*(a/1024));return b},pulse:function(){for(var b=new Float32Array(1024),a=0;1024>a;++a)b[a]=512>a?1:-1;return b},tri:function(){for(var b=new Float32Array(1024),a,d=0;1024>d;++d)a=d/1024-0.25,b[d]=1-4*Math.abs(Math.round(a)-a);return b},saw:function(){for(var b=new Float32Array(1024),a,d=0;1024>d;++d)a=d/1024,b[d]=2*(a-Math.round(a));return b},fami:function(){for(var b=[0,0.125,0.25,0.375,
0.5,0.625,0.75,0.875,0.875,0.75,0.625,0.5,0.375,0.25,0.125,0,-0.125,-0.25,-0.375,-0.5,-0.625,-0.75,-0.875,-1,-1,-0.875,-0.75,-0.625,-0.5,-0.375,-0.25,-0.125],a=new Float32Array(1024),d=0;1024>d;++d)a[d]=b[d/1024*b.length|0];return a},konami:function(){for(var b=[-0.625,-0.875,-0.125,0.75,0.5,0.125,0.5,0.75,0.25,-0.125,0.5,0.875,0.625,0,0.25,0.375,-0.125,-0.75,0,0.625,0.125,-0.5,-0.375,-0.125,-0.75,-1,-0.625,0,-0.375,-0.875,-0.625,-0.25],a=new Float32Array(1024),d=0;1024>d;++d)a[d]=b[d/1024*b.length|
0];return a}};i.modules.Oscillator=k})(timbre);
(function(i){function k(b,a){this.samplerate=b;var d,c,n=b/44100;c=2*f.length;this.comb=Array(c);this.combout=Array(c);for(d=0;d<c;++d)this.comb[d]=new g(f[d%f.length]*n),this.combout[d]=new i.fn.SignalArray(a);c=2*e.length;this.allpass=Array(c);for(d=0;d<c;++d)this.allpass[d]=new h(e[d%e.length]*n);this.outputs=[new i.fn.SignalArray(a),new i.fn.SignalArray(a)];this.damp=0;this.wet=0.33;this.setRoomSize(0.5);this.setDamp(0.5)}function g(b){this.buffer=new i.fn.SignalArray(b|0);this.buffersize=this.buffer.length;
this.damp=this.filterstore=this.feedback=this.bufidx=0}function h(b){this.buffer=new i.fn.SignalArray(b|0);this.buffersize=this.buffer.length;this.bufidx=0}var f=[1116,1188,1277,1356,1422,1491,1557,1617],e=[225,556,441,341],c=k.prototype;c.setRoomSize=function(b){var a=this.comb;this.roomsize=b;a[0].feedback=a[1].feedback=a[2].feedback=a[3].feedback=a[4].feedback=a[5].feedback=a[6].feedback=a[7].feedback=a[8].feedback=a[9].feedback=a[10].feedback=a[11].feedback=a[12].feedback=a[13].feedback=a[14].feedback=
a[15].feedback=0.28*b+0.7};c.setDamp=function(b){var a=this.comb;this.damp=b;a[0].damp=a[1].damp=a[2].damp=a[3].damp=a[4].damp=a[5].damp=a[6].damp=a[7].damp=a[8].damp=a[9].damp=a[10].damp=a[11].damp=a[12].damp=a[13].damp=a[14].damp=a[15].damp=0.4*b};c.process=function(b,a){var d=this.comb,c=this.combout,e=this.allpass,f=this.outputs[0],g=this.outputs[1],h=this.wet,i=1-h,k=b.length;d[0].process(b,c[0]);d[1].process(b,c[1]);d[2].process(b,c[2]);d[3].process(b,c[3]);d[4].process(b,c[4]);d[5].process(b,
c[5]);d[6].process(b,c[6]);d[7].process(b,c[7]);d[8].process(a,c[8]);d[9].process(a,c[9]);d[10].process(a,c[10]);d[11].process(a,c[11]);d[12].process(a,c[12]);d[13].process(a,c[13]);d[14].process(a,c[14]);d[15].process(a,c[15]);for(d=0;d<k;++d)f[d]=c[0][d]+c[1][d]+c[2][d]+c[3][d]+c[4][d]+c[5][d]+c[6][d]+c[7][d],g[d]=c[8][d]+c[9][d]+c[10][d]+c[11][d]+c[12][d]+c[13][d]+c[14][d]+c[15][d];e[0].process(f,f);e[1].process(f,f);e[2].process(f,f);e[3].process(f,f);e[4].process(g,g);e[5].process(g,g);e[6].process(g,
g);e[7].process(g,g);for(d=0;d<k;++d)b[d]=f[d]*h+b[d]*i,a[d]=g[d]*h+a[d]*i};g.prototype.process=function(b,a){var d,c,e=this.buffer,f=this.buffersize,g=this.bufidx,h=this.filterstore,i=this.feedback,k=this.damp,o=1-k,p,r=b.length;for(p=0;p<r;++p)d=0.015*b[p],c=e[g],h=c*o+h*k,e[g]=d+h*i,++g>=f&&(g=0),a[p]=c;this.bufidx=g;this.filterstore=h};h.prototype.process=function(b,a){var d,c,e,f=this.buffer,g=this.buffersize,h=this.bufidx,i,k=b.length;for(i=0;i<k;++i)d=b[i],e=f[h],c=-d+e,f[h]=d+0.5*e,++h>=g&&
(h=0),a[i]=c;this.bufidx=h};i.modules.Reverb=k})(timbre);
(function(i){function k(b){return new g(b)}function g(b){this.fragments=[];b&&this.fragments.push(new h(b,0,b.buffer[0].length/(b.samplerate||44100)))}function h(b,a,d,e,f,j,g){b||(b=c);this.buffer=b.buffer[0];this.samplerate=b.samplerate||44100;this.start=a;this._duration=d;this.reverse=e||!1;this.pitch=f||100;this.stretch=j||!1;this.pan=g||50}function f(b,a){this.tape=b;this.fragments=b.fragments;this.samplerate=a||44100;this.isEnded=!1;this.buffer=null;this.bufferEndIndex=this.bufferBeginIndex=
this.bufferIndexIncr=this.bufferIndex=0;this.fragment=null;this.fragmentIndex=0;this.panR=this.panL=0.5}var e=new Float32Array(60),c={buffer:e,samplerate:1};k.silence=function(b){return(new k(c)).slice(0,1).fill(b)};k.join=function(b){for(var a=new g,d=0;d<b.length;d++)b[d]instanceof g&&a.add_fragments(b[d].fragments);return a};k.Tape=g;g.prototype.add_fragment=function(b){this.fragments.push(b);return this};g.prototype.add_fragments=function(b){for(var a=0;a<b.length;a++)this.fragments.push(b[a]);
return this};g.prototype.duration=function(){for(var b=0,a=0;a<this.fragments.length;a++)b+=this.fragments[a].duration();return b};g.prototype.slice=function(b,a){var d=this.duration();b+a>d&&(a=d-b);for(var d=new g,c=b,e=a,f=0;f<this.fragments.length;f++){var e=this.fragments[f].create(c,e),h=e[0],c=e[1],e=e[2];h&&d.add_fragment(h);if(0===e)break}return d};g.prototype.cut=g.prototype.slice;g.prototype.concat=function(b){var a=new g;a.add_fragments(this.fragments);a.add_fragments(b.fragments);return a};
g.prototype.loop=function(b){var a,d=[];for(a=0;a<this.fragments.length;a++)d.push(this.fragments[a].clone());var c=new g;for(a=0;a<b;a++)c.add_fragments(d);return c};g.prototype.times=g.prototype.loop;g.prototype.split=function(b){for(var a=this.duration()/b,d=[],c=0;c<b;c++)d.push(this.slice(c*a,a));return d};g.prototype.fill=function(b){var a=this.duration();if(0===a)throw"EmptyFragment";var d=b%a;return this.loop(b/a|0).plus(this.slice(0,d))};g.prototype.replace=function(b,a,d){var c=new g,a=
b+a,c=c.plus(this.slice(0,b)),e=c.duration();e<b&&(c=c.plus(k.silence(b-e)));c=c.plus(d);b=this.duration();b>a&&(c=c.plus(this.slice(a,b-a)));return c};g.prototype.reverse=function(){for(var b=new g,a=this.fragments.length;a--;){var d=this.fragments[a].clone();d.reverse=!d.isReversed();b.add_fragment(d)}return b};g.prototype.pitch=function(b,a){for(var d=new g,a=a||!1,c=0;c<this.fragments.length;c++){var e=this.fragments[c].clone();e.pitch*=0.01*b;e.stretch=a;d.add_fragment(e)}return d};g.prototype.stretch=
function(b){return this.pitch(100*(1/(0.01*b)),!0)};g.prototype.pan=function(b){var a=new g;100<b?b=100:0>b&&(b=0);for(var d=0;d<this.fragments.length;d++){var c=this.fragments[d].clone();c.pan=b;a.add_fragment(c)}return a};g.prototype.silence=function(){return k.silence(this.duration())};g.prototype.join=function(b){for(var a=new g,d=0;d<b.length;d++)b[d]instanceof g&&a.add_fragments(b[d].fragments);return a};h.prototype.duration=function(){return this._duration*(100/this.pitch)};h.prototype.original_duration=
function(){return this._duration};h.prototype.isReversed=function(){return this.reverse};h.prototype.isStretched=function(){return this.stretched};h.prototype.create=function(b,a){var d=this.duration();if(b>=d)return[null,b-d,a];b+a>=d?(d-=b,a-=d):(d=a,a=0);var c=this.clone();c.start=this.start+0.01*b*this.pitch;c._duration=0.01*d*this.pitch;c.reverse=!1;return[c,0,a]};h.prototype.clone=function(){var b=new h;b.buffer=this.buffer;b.samplerate=this.samplerate;b.start=this.start;b._duration=this._duration;
b.reverse=this.reverse;b.pitch=this.pitch;b.stretch=this.stretch;b.pan=this.pan;return b};k.Fragment=h;k.TapeStream=f;f.prototype.reset=function(){this.isEnded=!1;this.buffer=null;this.bufferEndIndex=this.bufferBeginIndex=this.bufferIndexIncr=this.bufferIndex=0;this.fragment=null;this.fragmentIndex=0;this.panR=this.panL=0.5;this.isLooped=!1;return this};f.prototype.fetch=function(b){var a=new i.fn.SignalArray(b),d=new i.fn.SignalArray(b),c=this.fragments;if(0===c.length)return[a,d];for(var f=100*
this.samplerate,j=this.buffer,g=this.bufferIndex,h=this.bufferIndexIncr,k=this.bufferBeginIndex,m=this.bufferEndIndex,o=this.fragment,p=this.fragmentIndex,r=this.panL,w=this.panR,v=0;v<b;v++){for(;!j||g<k||g>=m;)if(!o||p<c.length)o=c[p++],j=o.buffer,h=o.samplerate/f*o.pitch,k=o.start*o.samplerate,m=k+o.original_duration()*o.samplerate,g=0.01*o.pan,r=1-g,w=g,o.reverse?(h*=-1,g=m+h):g=k;else if(this.isLooped)j=null,m=k=h=g=0,o=null,p=0;else{this.isEnded=!0;j=e;g=h=0;break}a[v]=j[g|0]*r;d[v]=j[g|0]*
w;g+=h}this.buffer=j;this.bufferIndex=g;this.bufferIndexIncr=h;this.bufferBeginIndex=k;this.bufferEndIndex=m;this.fragment=o;this.fragmentIndex=p;this.panL=r;this.panR=w;return[a,d]};i.modules.Scissor=k})(timbre);
(function(i){function k(g){this.samplerate=g;this.buffersize=1<<Math.ceil(Math.log(1.5*g)*Math.LOG2E);this.buffermask=this.buffersize-1;this.writeBufferL=new i.fn.SignalArray(this.buffersize);this.writeBufferR=new i.fn.SignalArray(this.buffersize);this.readBufferL=this.writeBufferL;this.readBufferR=this.writeBufferR;this.mix=this.cross=this.feedback=this.delaytime=null;this.writeIndex=this.readIndex=this.prevR=this.prevL=0;this.setParams(125,0.25,!1,0.45)}var g=k.prototype;g.setParams=function(g,
f,e,c){this.delaytime!==g&&(this.delaytime=g,g=0.001*g*this.samplerate|0,g>this.buffermask&&(g=this.buffermask),this.writeIndex=this.readIndex+g&this.buffermask);this.feedback!==f&&(this.feedback=f);this.cross!==e&&((this.cross=e)?(this.readBufferL=this.writeBufferR,this.readBufferR=this.writeBufferL):(this.readBufferL=this.writeBufferL,this.readBufferR=this.writeBufferR));this.mix!==c&&(this.mix=c)};g.process=function(g,f){var e=this.readBufferL,c=this.readBufferR,b=this.writeBufferL,a=this.writeBufferR,
d=this.readIndex,l=this.writeIndex,n=this.buffermask,j=this.feedback,q=this.mix,i=1-q,k=this.prevL,m=this.prevR,o,p,r=g.length;for(p=0;p<r;++p)o=e[d],b[l]=g[p]-o*j,g[p]=k=0.5*(g[p]*i+o*q+k),o=c[d],a[l]=f[p]-o*j,f[p]=m=0.5*(f[p]*i+o*q+m),d+=1,l=l+1&n;this.readIndex=d&this.buffermask;this.writeIndex=l;this.prevL=k;this.prevR=m};i.modules.StereoDelay=k})(timbre);
(function(i){var k=i.fn,g=i.modules;k.register("audio",function(e){e=new (k.getClass("buffer"))(e);e.playbackState=k.FINISHED_STATE;e._.isLoaded=!1;Object.defineProperties(e,{isLoaded:{get:function(){return this._.isLoaded}}});e.load=h;e.loadthis=f;return e});var h=function(e){var c=this,b=this._,a=new g.Deferred(this),d=arguments,f=1;a.done(function(){c._.emit("done")});"function"===typeof d[f]&&(a.done(d[f++]),"function"===typeof d[f]&&a.fail(d[f++]));b.loadedTime=0;(new g.Decoder).decode(e,function(d,
b){var e=c._;if(d){c.playbackState=k.PLAYING_STATE;e.samplerate=d.samplerate;e.channels=d.channels;e.bufferMix=null;e.buffer=d.buffer;e.phase=0;e.phaseIncr=d.samplerate/i.samplerate;e.duration=d.duration*1E3;e.currentTime=0;if(e.isReversed){e.phaseIncr=e.phaseIncr*-1;e.phase=d.buffer[0].length+e.phaseIncr}c._.emit("loadedmetadata")}else a.reject(b)},function(){c._.isLoaded=true;c._.plotFlush=true;c._.emit("loadeddata");a.resolveWith(c)});return a.promise()},f=function(){h.apply(this,arguments);return this}})(timbre);
(function(i){function k(a){i.Object.call(this,2,a);g.fixAR(this);a=this._;a.biquad=new f(a.samplerate);a.freq=i(340);a.band=i(1);a.gain=i(0);a.plotBefore=e;a.plotRange=[-18,18];a.plotFlush=!0}var g=i.fn,h=i.modules.FFT,f=i.modules.Biquad;g.extend(k);var e=function(a,b,c,e,f){a.lineWidth=1;a.strokeStyle="rgb(192, 192, 192)";for(var g=0.5*this._.samplerate,h=1;10>=h;++h)for(var i=1;4>=i;i++){var k=h*Math.pow(10,i);20>=k||g<=k||(a.beginPath(),k=Math.log(k/20)/Math.log(g/20),k=(k*e+b|0)+0.5,a.moveTo(k,
c),a.lineTo(k,c+f),a.stroke())}f/=6;for(h=1;6>h;h++)a.beginPath(),g=(c+h*f|0)+0.5,a.moveTo(b,g),a.lineTo(b+e,g),a.stroke()},c=k.prototype;Object.defineProperties(c,{type:{set:function(a){var b=this._;a!==b.biquad.type&&(b.biquad.setType(a),b.plotFlush=!0)},get:function(){return this._.biquad.type}},freq:{set:function(a){this._.freq=i(a)},get:function(){return this._.freq}},cutoff:{set:function(a){this._.freq=i(a)},get:function(){return this._.freq}},res:{set:function(a){this._.band=i(a)},get:function(){return this._.band}},
Q:{set:function(a){this._.band=i(a)},get:function(){return this._.band}},band:{set:function(a){this._.band=i(a)},get:function(){return this._.band}},gain:{set:function(a){this._.gain=i(a)},get:function(){return this._.gain}}});c.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;g.inputSignalAR(this);var c=b.freq.process(a).cells[0][0],e=b.band.process(a).cells[0][0],a=b.gain.process(a).cells[0][0];if(b.prevFreq!==c||b.prevband!==e||b.prevGain!==a)b.prevFreq=c,b.prevband=e,b.prevGain=
a,b.biquad.setParams(c,e,a),b.plotFlush=!0;b.bypassed||b.biquad.process(this.cells[1],this.cells[2]);g.outputSignalAR(this)}return this};var b=new h(2048),a=i.Object.prototype.plot;c.plot=function(d){if(this._.plotFlush){var c=new f(this._.samplerate);c.setType(this.type);c.setParams(this.freq.valueOf(),this.band.valueOf(),this.gain.valueOf());var e=new Float32Array(b.length);e[0]=1;c.process(e,e);b.forward(e);var c=new Float32Array(512),e=0.5*this._.samplerate,j=new Float32Array(512),g,h,i,k;b.getFrequencyData(j);
for(g=0;512>g;++g)i=20*Math.pow(e/20,g/512),h=i/(e/j.length),i=h|0,h-=i,0===i?i=j[i]:(k=j[i-1],i=j[i],i=(1-h)*k+h*i),c[g]=i;this._.plotData=c;this._.plotFlush=null}return a.call(this,d)};g.register("biquad",k);g.register("lowpass",function(a){return(new k(a)).set("type","lowpass")});g.register("highpass",function(a){return(new k(a)).set("type","highpass")});g.register("bandpass",function(a){return(new k(a)).set("type","bandpass")});g.register("lowshelf",function(a){return(new k(a)).set("type","lowshelf")});
g.register("highshelf",function(a){return(new k(a)).set("type","highshelf")});g.register("peaking",function(a){return(new k(a)).set("type","peaking")});g.register("notch",function(a){return(new k(a)).set("type","notch")});g.register("allpass",function(a){return(new k(a)).set("type","allpass")});g.alias("lpf","lowpass");g.alias("hpf","highpass");g.alias("bpf","bandpass");g.alias("bef","notch");g.alias("brf","notch");g.alias("apf","allpass")})(timbre);
(function(i){function k(a){i.Object.call(this,1,a);g.fixAR(this);a=this._;a.pitch=i(1);a.samplerate=44100;a.channels=0;a.bufferMix=null;a.buffer=[];a.isLooped=!1;a.isReversed=!1;a.duration=0;a.currentTime=0;a.currentTimeObj=null;a.phase=0;a.phaseIncr=0;a.onended=g.make_onended(this,0);a.onlooped=f(this)}var g=i.fn,h=function(a){return g.isSignalArray(a)||a instanceof Float32Array};g.extend(k);var f=function(a){return function(){var d=a._;d.phase>=d.buffer[0].length?d.phase=0:0>d.phase&&(d.phase=d.buffer[0].length+
d.phaseIncr);a._.emit("looped")}},e=k.prototype,c=function(a){var d=this._;if("object"===typeof a){var b=[],c;h(a)?b[0]=a:"object"===typeof a&&(Array.isArray(a.buffer)?h(a.buffer[0])&&(b=h(a.buffer[1])&&h(a.buffer[2])?a.buffer:[a.buffer[0]]):h(a.buffer)&&(b=[a.buffer]),"number"===typeof a.samplerate&&(c=a.samplerate));b.length&&(0<c&&(d.samplerate=a.samplerate),d.bufferMix=null,d.buffer=b,d.phase=0,d.phaseIncr=d.samplerate/i.samplerate,d.duration=1E3*d.buffer[0].length/d.samplerate,d.currentTime=
0,d.plotFlush=!0,this.reverse(d.isReversed))}};Object.defineProperties(e,{buffer:{set:c,get:function(){var a=this._;return{samplerate:a.samplerate,channels:a.channels,buffer:a.buffer}}},pitch:{set:function(a){this._.pitch=i(a)},get:function(){return this._.pitch}},isLooped:{get:function(){return this._.isLooped}},isReversed:{get:function(){return this._.isReversed}},samplerate:{get:function(){return this._.samplerate}},duration:{get:function(){return this._.duration}},currentTime:{set:function(a){if("number"===
typeof a){var d=this._;0<=a&&a<=d.duration&&(d.phase=a/1E3*d.samplerate,d.currentTime=a)}else a instanceof i.Object?this._.currentTimeObj=a:null===a&&(this._.currentTimeObj=null)},get:function(){return this._.currentTimeObj?this._.currentTimeObj:this._.currentTime}}});e.clone=function(){var a=this._,d=g.clone(this);a.buffer.length&&c.call(d,{buffer:a.buffer,samplerate:a.samplerate,channels:a.channels});d.loop(a.isLooped);d.reverse(a.isReversed);return d};e.slice=function(a,d){var b=this._,e=i(b.originkey);
if(b.buffer.length){a="number"===typeof a?0.001*a*b.samplerate|0:0;d="number"===typeof d?0.001*d*b.samplerate|0:b.buffer[0].length;if(a>d)var f=a,a=d,d=f;2===b.channels?c.call(e,{buffer:[g.pointer(b.buffer[0],a,d-a),g.pointer(b.buffer[1],a,d-a),g.pointer(b.buffer[2],a,d-a)],samplerate:b.samplerate}):c.call(e,{buffer:g.pointer(b.buffer[0],a,d-a),samplerate:b.samplerate});e.playbackState=g.PLAYING_STATE}e.loop(b.isLooped);e.reverse(b.isReversed);return e};e.reverse=function(a){var d=this._;d.isReversed=
!!a;if(d.isReversed){if(0<d.phaseIncr&&(d.phaseIncr*=-1),0===d.phase&&d.buffer.length)d.phase=d.buffer[0].length+d.phaseIncr}else 0>d.phaseIncr&&(d.phaseIncr*=-1);return this};e.loop=function(a){this._.isLooped=!!a;return this};e.bang=function(a){this.playbackState=!1===a?g.FINISHED_STATE:g.PLAYING_STATE;this._.phase=0;this._.emit("bang");return this};e.process=function(a){var d=this._;if(!d.buffer.length)return this;if(this.tickID!==a){this.tickID=a;var b=this.cells[1],c=this.cells[2],e=d.phase,
f=d.cellsize,h,i;2===d.channels?(h=d.buffer[1],i=d.buffer[2]):h=i=d.buffer[0];if(d.currentTimeObj){for(var k=d.currentTimeObj.process(a).cells[0],o,p=0.001*d.samplerate,a=0;a<f;++a)o=k[a],e=o*p,b[a]=h[e|0]||0,c[a]=i[e|0]||0;d.phase=e;d.currentTime=o}else{a=d.pitch.process(a).cells[0][0];o=d.phaseIncr*a;for(a=0;a<f;++a)b[a]=h[e|0]||0,c[a]=i[e|0]||0,e+=o;e>=h.length?d.isLooped?g.nextTick(d.onlooped):g.nextTick(d.onended):0>e&&(d.isLooped?g.nextTick(d.onlooped):g.nextTick(d.onended));d.phase=e;d.currentTime+=
g.currentTimeIncr}g.outputSignalAR(this)}return this};var b=i.Object.prototype.plot;e.plot=function(a){var d=this._,c,e;if(d.plotFlush){2===d.channels?(c=d.buffer[1],e=d.buffer[2]):c=e=d.buffer[0];for(var f=new Float32Array(2048),g=0,h=c.length/2048,i=0;2048>i;i++)f[i]=0.5*(c[g|0]+e[g|0]),g+=h;d.plotData=f;d.plotFlush=null}return b.call(this,a)};g.register("buffer",k)})(timbre);
(function(i){function k(e){i.Object.call(this,2,e);g.fixAR(this);e=new h(this._.samplerate);e.setDelayTime(20);e.setRate(4);e.depth=20;e.feedback=0.2;e.mix=0.33;this._.chorus=e}var g=i.fn,h=i.modules.Chorus;g.extend(k);var f=k.prototype;Object.defineProperties(f,{type:{set:function(e){this._.chorus.setDelayTime(e)},get:function(){return this._.chorus.wave}},delay:{set:function(e){0.5<=e&&80>=e&&this._.chorus.setDelayTime(e)},get:function(){return this._.chorus.delayTime}},rate:{set:function(e){"number"===
typeof e&&0<e&&this._.chorus.setRate(e)},get:function(){return this._.chorus.rate}},depth:{set:function(e){"number"===typeof e&&(0<=e&&100>=e)&&(e*=this._.samplerate/44100,this._.chorus.depth=e)},get:function(){return this._.chorus.depth}},fb:{set:function(e){"number"===typeof e&&(-1<=e&&1>=e)&&(this._.chorus.feedback=0.99996*e)},get:function(){return this._.chorus.feedback}},mix:{set:function(e){this._.mix=i(e)},get:function(){return this._.mix}}});f.process=function(e){var c=this._;this.tickID!==
e&&(this.tickID=e,g.inputSignalAR(this),c.bypassed||c.chorus.process(this.cells[1],this.cells[2]),g.outputSignalAR(this));return this};g.register("chorus",k)})(timbre);
(function(i){function k(f){i.Object.call(this,2,f);f=this._;f.min=-0.8;f.max=0.8}var g=i.fn;g.extend(k);var h=k.prototype;Object.defineProperties(h,{minmax:{set:function(f){var e=this._;"number"===typeof f&&(e.min=-Math.abs(f),e.max=-e.min)},get:function(){return this._.max}},min:{set:function(f){var e=this._;"number"===typeof f&&(e.max<f?e.max=f:e.min=f)},get:function(){return this._.min}},max:{set:function(f){var e=this._;"number"===typeof f&&(f<e.min?e.min=f:e.max=f)},get:function(){return this._.max}}});
h.process=function(f){var e=this._;if(this.tickID!==f){this.tickID=f;var f=this.cells[1],c=this.cells[2],b=f.length,a=e.min,d=e.max,l;if(e.ar){g.inputSignalAR(this);for(e=0;e<b;++e)l=f[e],l<a?l=a:l>d&&(l=d),f[e]=l,l=c[e],l<a?l=a:l>d&&(l=d),c[e]=l;g.outputSignalAR(this)}else l=g.inputSignalKR(this),l<a?l=a:l>d&&(l=d),this.cells[0][0]=l,g.outputSignalKR(this)}return this};g.register("clip",k)})(timbre);
(function(i){function k(c){i.Object.call(this,2,c);g.fixAR(this);c=this._;c.prevThresh=-24;c.prevKnee=30;c.prevRatio=12;c.thresh=i(c.prevThresh);c.knee=i(c.prevKnee);c.ratio=i(c.prevRatio);c.postGain=6;c.reduction=0;c.attack=3;c.release=25;c.comp=new f(c.samplerate);c.comp.dbPostGain=c.postGain;c.comp.setAttackTime(0.001*c.attack);c.comp.setReleaseTime(0.001*c.release);c.comp.setPreDelayTime(6);c.comp.setParams(c.prevThresh,c.prevKnee,c.prevRatio)}var g=i.fn,h=i.timevalue,f=i.modules.Compressor;g.extend(k);
var e=k.prototype;Object.defineProperties(e,{thresh:{set:function(c){this._.thresh=i(c)},get:function(){return this._.thresh}},thre:{set:function(c){this._.thresh=i(c)},get:function(){return this._.thre}},knee:{set:function(c){this._.kne=i(c)},get:function(){return this._.knee}},ratio:{set:function(c){this._.ratio=i(c)},get:function(){return this._.ratio}},gain:{set:function(c){"number"===typeof c&&(this._.comp.dbPostGain=c)},get:function(){return this._.comp.dbPostGain}},attack:{set:function(c){"string"===
typeof c&&(c=h(c));"number"===typeof c&&(c=0>c?0:1E3<c?1E3:c,this._.attack=c,this._.comp.setAttackTime(0.001*c))},get:function(){return this._.attack}},release:{set:function(c){"string"===typeof c&&(c=h(c));"number"===typeof c&&(c=0>c?0:1E3<c?1E3:c,this._.release=c,this._.comp.setReleaseTime(0.001*c))},get:function(){return this._.release}},reduction:{get:function(){return this._.reduction}}});e.process=function(c){var b=this._;if(this.tickID!==c){this.tickID=c;g.inputSignalAR(this);var a=b.thresh.process(c).cells[0][0],
d=b.knee.process(c).cells[0][0],c=b.ratio.process(c).cells[0][0];if(b.prevThresh!==a||b.prevKnee!==d||b.prevRatio!==c)b.prevThresh=a,b.prevKnee=d,b.prevRatio=c,b.comp.setParams(a,d,c);b.bypassed||(b.comp.process(this.cells[1],this.cells[2]),b.reduction=b.comp.meteringGain);g.outputSignalAR(this)}return this};g.register("comp",k)})(timbre);
(function(i){function k(c){i.Object.call(this,2,c);g.fixAR(this);c=this._;c.time=i(100);c.fb=i(0.2);c.cross=i(!1);c.mix=0.33;c.delay=new f(c.samplerate)}var g=i.fn,h=i.timevalue,f=i.modules.StereoDelay;g.extend(k);var e=k.prototype;Object.defineProperties(e,{time:{set:function(c){"string"===typeof c&&(c=h(c));this._.time=i(c)},get:function(){return this._.time}},fb:{set:function(c){this._.fb=i(c)},get:function(){return this._.fb}},cross:{set:function(c){this._.cross=i(c)},get:function(){return this._.cross}},
mix:{set:function(c){"number"===typeof c&&(this._.mix=1<c?1:0>c?0:c)},get:function(){return this._.mix}}});e.process=function(c){var b=this._;if(this.tickID!==c){this.tickID=c;var a=b.time.process(c).cells[0][0],d=b.fb.process(c).cells[0][0],c=0!==b.cross.process(c).cells[0][0],e=b.mix;if(b.prevTime!==a||b.prevFb!==d||b.prevCross!==c||b.prevMix!==e)b.prevTime=a,b.prevFb=d,b.prevCross=c,b.prevMix=e,b.delay.setParams(a,d,c,e);g.inputSignalAR(this);b.bypassed||b.delay.process(this.cells[1],this.cells[2]);
g.outputSignalAR(this)}return this};g.register("delay",k)})(timbre);
(function(i){function k(f){i.Object.call(this,2,f);g.fixAR(this);f=this._;f.pre=i(60);f.post=i(-18);f.x1L=f.x2L=f.y1L=f.y2L=0;f.x1R=f.x2R=f.y1R=f.y2R=0;f.b0=f.b1=f.b2=f.a1=f.a2=0;f.cutoff=0;f.Q=1;f.preScale=0;f.postScale=0}var g=i.fn;g.extend(k);var h=k.prototype;Object.defineProperties(h,{cutoff:{set:function(f){"number"===typeof f&&0<f&&(this._.cutoff=f)},get:function(){return this._.cutoff}},pre:{set:function(f){this._.pre=i(f)},get:function(){return this._.pre}},post:{set:function(f){this._.post=
i(f)},get:function(){return this._.post}}});h.process=function(f){var e=this._;if(this.tickID!==f){this.tickID=f;g.inputSignalAR(this);var c=-e.pre.process(f).cells[0][0],f=-e.post.process(f).cells[0][0];if(e.prevPreGain!==c||e.prevPostGain!==f)e.prevPreGain=c,e.prevPostGain=f,e.preScale=Math.pow(10,0.05*-c),e.postScale=Math.pow(10,0.05*-f);if(!e.bypassed){var c=this.cells[1],f=this.cells[2],b=e.preScale,a=e.postScale,d,l,h,j,i;if(e.cutoff){e.prevCutoff!==e.cutoff&&(e.prevCutoff=e.cutoff,l=2*Math.PI*
e.cutoff/e.samplerate,d=Math.cos(l),l=Math.sin(l)/(2*e.Q),h=1/(1+l),e.b0=0.5*(1-d)*h,e.b1=1-d*h,e.b2=0.5*(1-d)*h,e.a1=-2*d*h,e.a2=1-l*h);var k=e.x1L,u=e.x2L,m=e.y1L,o=e.y2L,p=e.x1R,r=e.x2R,w=e.y1R,v=e.y2R,s=e.b0,z=e.b1,C=e.b2,E=e.a1,B=e.a2;d=0;for(l=c.length;d<l;++d)j=c[d]*b,i=s*j+z*k+C*u-E*m-B*o,h=i*a,-1>h?h=-1:1<h&&(h=1),c[d]=h,u=k,k=j,o=m,m=i,j=f[d]*b,i=s*j+z*p+C*r-E*w-B*v,h=i*a,-1>h?h=-1:1<h&&(h=1),f[d]=h,r=p,p=j,v=w,w=i;e.x1L=k;e.x2L=u;e.y1L=m;e.y2L=o;e.x1R=p;e.x2R=r;e.y1R=w;e.y2R=v}else{d=0;
for(l=c.length;d<l;++d)h=c[d]*b*a,-1>h?h=-1:1<h&&(h=1),c[d]=h,h=f[d]*b*a,-1>h?h=-1:1<h&&(h=1),f[d]=h}}g.outputSignalAR(this)}return this};g.register("dist",k)})(timbre);
(function(i){function k(g){i.Object.call(this,2,g);this._.ar=!1}var g=i.fn;g.extend(k);k.prototype.process=function(h){var f=this._;if(this.tickID!==h){this.tickID=h;var e=this.nodes,c=this.cells[0],b=this.cells[1],a=this.cells[2],d,l=e.length,i=c.length,j,k;if(f.ar){if(0<e.length){e[0].process(h);j=e[0].cells[1];k=e[0].cells[2];b.set(j);a.set(k);for(d=1;d<l;++d){e[d].process(h);j=e[d].cells[1];k=e[d].cells[2];for(c=0;c<i;++c)f=j[c],b[c]=0===f?0:b[c]/f,f=k[c],a[c]=0===f?0:a[c]/f}}else for(c=0;c<i;++c)b[c]=
a[d]=0;g.outputSignalAR(this)}else{if(0<e.length){b=e[0].process(h).cells[0][0];for(d=1;d<l;++d)f=e[d].process(h).cells[0][0],b=0===f?0:b/f}else b=0;c[0]=b;g.outputSignalKR(this)}}return this};g.register("/",k)})(timbre);
(function(i){function k(d){i.Object.call(this,2,d);d=this._;d.env=new e(d.samplerate);d.env.setStep(d.cellsize);d.tmp=new h.SignalArray(d.cellsize);d.ar=!1;d.plotFlush=!0;d.onended=a(this);this.on("ar",b)}function g(a,d,b,c,e,f){"number"===typeof a[c]?b=a[c]:"number"===typeof a[e]?b=a[e]:f&&("string"===typeof a[c]?b=f(a[c]):"string"===typeof a[e]&&(b=f(a[e])));b<d&&(b=d);return b}var h=i.fn,f=i.timevalue,e=i.modules.Envelope,c=h.isDictionary;h.extend(k);var b=function(a){this._.env.setStep(a?1:this._.cellsize)},
a=function(a){return function(){a._.emit("ended")}},d=k.prototype;Object.defineProperties(d,{table:{set:function(a){if(Array.isArray(a)){for(var d=this._.env,b=[a[0]||n],c,g,l,h,i=1,k=a.length;i<k;++i)c=a[i][0]||n,g=a[i][1],l=a[i][2],"number"!==typeof g&&(g="string"===typeof g?f(g):10),10>g&&(g=10),"number"===typeof l?(h=l,l=e.CurveTypeCurve):(l=e.CurveTypeDict[l]||null,h=0),b.push([c,g,l,h]);d.setTable(b);this._.plotFlush=!0}},get:function(){return this._.env.table}},curve:{set:function(a){this._.env.setCurve(a)},
get:function(){return this._.env.curve}},releaseNode:{set:function(a){this._.env.setReleaseNode(a);this._.plotFlush=!0},get:function(){return this._.env.releaseNode+1}},loopNode:{set:function(a){this._.env.setLoopNode(a);this._.plotFlush=!0},get:function(){return this._.env.loopNode+1}}});d.clone=function(){var a=h.clone(this);a._.env=this._.env.clone();return a};d.reset=function(){this._.env.reset();return this};d.release=function(){var a=this._;a.env.release();a.emit("released");return this};d.bang=
function(){var a=this._;a.env.reset();a.env.status=e.StatusGate;a.emit("bang");return this};d.process=function(a){var d=this._;if(this.tickID!==a){this.tickID=a;var a=this.cells[1],b=this.cells[2],c,e=d.cellsize;if(this.nodes.length)h.inputSignalAR(this);else for(c=0;c<e;++c)a[c]=b[c]=1;var f;c=null;if(d.ar){f=d.tmp;d.env.process(f);for(c=0;c<e;++c)a[c]*=f[c],b[c]*=f[c]}else{f=d.env.next();for(c=0;c<e;++c)a[c]*=f,b[c]*=f}c=d.env.emit;h.outputSignalAR(this);c&&("ended"===c?h.nextTick(d.onended):this._.emit(c,
d.value))}return this};var l=i.Object.prototype.plot;d.plot=function(a){if(this._.plotFlush){var d=this._.env.clone(),b=d.getInfo(1E3),c=b.totalDuration,f=b.loopBeginTime,g=b.releaseBeginTime,b=new Float32Array(256),h=0,i=c/b.length,k=!1,n=0.001*c*this._.samplerate|0,s,n=n/b.length;d.setStep(n);d.status=e.StatusGate;n=0;for(s=b.length;n<s;++n)b[n]=d.next(),h+=i,!k&&h>=g&&(d.release(),k=!0);this._.plotData=b;this._.plotBefore=function(a,d,b,e,j){var l;Infinity!==f&&Infinity!==g&&(b=d+e*(f/c),l=d+e*
(g/c),a.fillStyle="rgba(224, 224, 224, 0.8)",a.fillRect(b,0,l-b,j));Infinity!==g&&(b=d+e*(g/c),a.fillStyle="rgba(212, 212, 212, 0.8)",a.fillRect(b,0,e-b,j))};d=Infinity;h=-Infinity;for(n=0;n<s;++n)b[n]<d?d=b[n]:b[n]>h&&(h=b[n]);1>h&&(h=1);this._.plotRange=[d,h];this._.plotData=b;this._.plotFlush=null}return l.call(this,a)};h.register("env",k);var n=e.ZERO;h.register("perc",function(a){c(a[0])||a.unshift({});var d=a[0],b=g(d,10,10,"a","attackTime",f),e=g(d,10,1E3,"r","decayTime",f),l=g(d,n,1,"lv",
"level");d.table=[n,[l,b],[n,e]];return new k(a)});h.register("adsr",function(a){c(a[0])||a.unshift({});var d=a[0],b=g(d,10,10,"a","attackTime",f),e=g(d,10,300,"d","decayTime",f),l=g(d,n,0.5,"s","sustainLevel"),h=g(d,10,1E3,"r","decayTime",f),i=g(d,n,1,"lv","level");d.table=[n,[i,b],[l,e],[n,h]];d.releaseNode=3;return new k(a)});h.register("adshr",function(a){c(a[0])||a.unshift({});var d=a[0],b=g(d,10,10,"a","attackTime",f),e=g(d,10,300,"d","decayTime",f),l=g(d,n,0.5,"s","sustainLevel"),h=g(d,10,
500,"h","holdTime",f),i=g(d,10,1E3,"r","decayTime",f),r=g(d,n,1,"lv","level");d.table=[n,[r,b],[l,e],[l,h],[n,i]];return new k(a)});h.register("asr",function(a){c(a[0])||a.unshift({});var d=a[0],b=g(d,10,10,"a","attackTime",f),e=g(d,n,0.5,"s","sustainLevel"),l=g(d,10,1E3,"r","releaseTime",f);d.table=[n,[e,b],[n,l]];d.releaseNode=2;return new k(a)});h.register("dadsr",function(a){c(a[0])||a.unshift({});var d=a[0],b=g(d,10,100,"dl","delayTime",f),e=g(d,10,10,"a","attackTime",f),l=g(d,10,300,"d","decayTime",
f),h=g(d,n,0.5,"s","sustainLevel"),i=g(d,10,1E3,"r","relaseTime",f),r=g(d,n,1,"lv","level");d.table=[n,[n,b],[r,e],[h,l],[n,i]];d.releaseNode=4;return new k(a)});h.register("ahdsfr",function(a){c(a[0])||a.unshift({});var d=a[0],b=g(d,10,10,"a","attackTime",f),e=g(d,10,10,"h","holdTime",f),l=g(d,10,300,"d","decayTime",f),h=g(d,n,0.5,"s","sustainLevel"),i=g(d,10,5E3,"f","fadeTime",f),r=g(d,10,1E3,"r","relaseTime",f),w=g(d,n,1,"lv","level");d.table=[n,[w,b],[w,e],[h,l],[n,i],[n,r]];d.releaseNode=5;return new k(a)});
h.register("linen",function(a){c(a[0])||a.unshift({});var d=a[0],b=g(d,10,10,"a","attackTime",f),e=g(d,10,1E3,"s","sustainTime",f),l=g(d,10,1E3,"r","releaseTime",f),h=g(d,n,1,"lv","level");d.table=[n,[h,b],[h,e],[n,l]];return new k(a)});h.register("env.tri",function(a){c(a[0])||a.unshift({});var d=a[0],b=g(d,20,1E3,"dur","duration",f),e=g(d,n,1,"lv","level"),b=0.5*b;d.table=[n,[e,b],[n,b]];return new k(a)});h.register("env.cutoff",function(a){c(a[0])||a.unshift({});var d=a[0],b=g(d,10,100,"r","relaseTime",
f),e=g(d,n,1,"lv","level");d.table=[e,[n,b]];return new k(a)})})(timbre);
(function(i){function k(a){i.Object.call(this,2,a);g.fixAR(this);a=this._;a.biquads=Array(7);a.plotBefore=c;a.plotRange=[-18,18];a.plotFlush=!0}var g=i.fn,h=i.modules.FFT,f=i.modules.Biquad,e={hpf:0,lf:1,lmf:2,mf:3,hmf:4,hf:5,lpf:6};g.extend(k);var c=function(a,d,b,c,e){a.lineWidth=1;a.strokeStyle="rgb(192, 192, 192)";for(var f=0.5*this._.samplerate,g=1;10>=g;++g)for(var h=1;4>=h;h++){var i=g*Math.pow(10,h);20>=i||f<=i||(a.beginPath(),i=Math.log(i/20)/Math.log(f/20),i=(i*c+d|0)+0.5,a.moveTo(i,b),
a.lineTo(i,b+e),a.stroke())}e/=6;for(g=1;6>g;g++)a.beginPath(),f=(b+g*e|0)+0.5,a.moveTo(d,f),a.lineTo(d+c,f),a.stroke()},b=k.prototype;Object.defineProperties(b,{params:{set:function(a){if("object"===typeof a)for(var d=Object.keys(a),b=0,c=d.length;b<c;++b){var e=a[d[b]];Array.isArray(e)?this.setParams(d[b],e[0],e[1],e[2]):this.setParams(d[b])}}}});b.setParams=function(a,d,b,c){var g=this._;"string"===typeof a&&(a=e[a]);if(0<=a&&a<g.biquads.length){a|=0;if("number"===typeof d&&"number"===typeof b){"number"!==
typeof c&&(c=0);var h=g.biquads[a];if(!h)switch(h=g.biquads[a]=new f(g.samplerate),a){case 0:h.setType("highpass");break;case g.biquads.length-1:h.setType("lowpass");break;default:h.setType("peaking")}h.setParams(d,b,c)}else g.biquads[a]=void 0;g.plotFlush=!0}return this};b.getParams=function(a){if(a=this._.biquads[a|0])return{freq:a.frequency,Q:a.Q,gain:a.gain}};b.process=function(a){var d=this._;if(this.tickID!==a){this.tickID=a;g.inputSignalAR(this);if(!d.bypassed)for(var a=this.cells[1],b=this.cells[2],
d=d.biquads,c=0,e=d.length;c<e;++c)d[c]&&d[c].process(a,b);g.outputSignalAR(this)}return this};var a=new h(2048),d=i.Object.prototype.plot;b.plot=function(b){if(this._.plotFlush){var c=this._,e=new Float32Array(a.length);e[0]=1;for(var g=0,h=c.biquads.length;g<h;++g){var i=this.getParams(g);if(i){var k=new f(c.samplerate);0===g?k.setType("highpass"):g===h-1?k.setType("lowpass"):k.setType("peaking");k.setParams(i.freq,i.Q,i.gain);k.process(e,e)}}a.forward(e);var e=new Float32Array(512),c=0.5*c.samplerate,
h=new Float32Array(512),o;a.getFrequencyData(h);for(g=0;512>g;++g)i=20*Math.pow(c/20,g/512),k=i/(c/h.length),i=k|0,k-=i,0===i?i=h[i]:(o=h[i-1],i=h[i],i=(1-k)*o+k*i),e[g]=i;this._.plotData=e;this._.plotFlush=null}return d.call(this,b)};g.register("eq",k)})(timbre);
(function(i){function k(c){i.Object.call(this,2,c);g.listener(this);g.fixAR(this);this.real=new i.ChannelObject(this);this.imag=new i.ChannelObject(this);this.cells[3]=this.real.cell;this.cells[4]=this.imag.cell;c=this._;c.fft=new h(2*c.cellsize);c.fftCell=new g.SignalArray(c.fft.length);c.prevCell=new g.SignalArray(c.cellsize);c.freqs=new g.SignalArray(c.fft.length>>1);c.plotFlush=!0;c.plotRange=[0,32];c.plotBarStyle=!0}var g=i.fn,h=i.modules.FFT;g.extend(k);var f=k.prototype;Object.defineProperties(f,
{window:{set:function(c){this._.fft.setWindow(c)},get:function(){return this._.fft.windowName}},spectrum:{get:function(){return this._.fft.getFrequencyData(this._.freqs)}}});f.process=function(c){var b=this._;if(this.tickID!==c){this.tickID=c;g.inputSignalAR(this);g.outputSignalAR(this);var c=this.cells[0],a=b.cellsize;b.fftCell.set(b.prevCell);b.fftCell.set(c,a);b.fft.forward(b.fftCell);b.prevCell.set(c);b.plotFlush=!0;this.cells[3].set(b.fft.real.subarray(0,a));this.cells[4].set(b.fft.imag.subarray(0,
a))}return this};var e=i.Object.prototype.plot;f.plot=function(c){this._.plotFlush&&(this._.plotData=this.spectrum,this._.plotFlush=null);return e.call(this,c)};g.register("fft",k)})(timbre);
(function(i){function k(f){i.Object.call(this,1,f);g.fixAR(this);f=this._;f.freq=i(440);f.reg=32768;f.shortFlag=!1;f.phase=0;f.lastValue=0}var g=i.fn;g.extend(k);var h=k.prototype;Object.defineProperties(h,{shortFlag:{set:function(f){this._.shortFlag=!!f},get:function(){return this._.shortFlag}},freq:{set:function(f){this._.freq=i(f)},get:function(){return this._.freq}}});h.process=function(f){var e=this._,c=this.cells[0];if(this.tickID!==f){this.tickID=f;var b=e.lastValue,a=e.phase,f=e.freq.process(f).cells[0][0]/
e.samplerate,d=e.reg,g=e.mul,h=e.add,j,i;if(e.shortFlag){j=0;for(i=c.length;j<i;++j)1<=a&&(d>>=1,d|=((d^d>>6)&1)<<15,b=(d&1)-0.5,a-=1),c[j]=b*g+h,a+=f}else{j=0;for(i=c.length;j<i;++j)1<=a&&(d>>=1,d|=((d^d>>1)&1)<<15,b=(d&1)-0.5,a-=1),c[j]=b*g+h,a+=f}e.reg=d;e.phase=a;e.lastValue=b}return this};g.register("fnoise",k)})(timbre);
(function(i){function k(e){i.Object.call(this,2,e);g.fixAR(this);this._.selected=0;this._.outputs=[]}var g=i.fn,h=function(){function e(c){i.Object.call(this,2,[]);g.fixAR(this);this._.parent=c}g.extend(e);e.prototype.process=function(c){this.tickID!==c&&(this.tickID=c,this._.parent.process(c));return this};return e}();g.extend(k);var f=k.prototype;Object.defineProperties(f,{selected:{set:function(e){var c=this._;if("number"===typeof e){c.selected=e;for(var e=c.outputs,c=0,b=e.length;c<b;++c)e[c]&&
(e[c].cells[0].set(g.emptycell),e[c].cells[1].set(g.emptycell),e[c].cells[2].set(g.emptycell))}},get:function(){return this._.selected}}});f.at=function(e){var c=this._,b=c.outputs[e];b||(c.outputs[e]=b=new h(this));return b};f.process=function(e){var c=this._;if(this.tickID!==e&&(this.tickID=e,g.inputSignalAR(this),g.outputSignalAR(this),e=c.outputs[c.selected]))e.cells[0].set(this.cells[0]),e.cells[1].set(this.cells[1]),e.cells[2].set(this.cells[2]);return this};g.register("gate",k)})(timbre);
(function(i){function k(e){i.Object.call(this,1,e);g.fixAR(this);e=this._;e.fft=new h(2*e.cellsize);e.fftCell=new g.SignalArray(this._.fft.length);e.realBuffer=new g.SignalArray(this._.fft.length);e.imagBuffer=new g.SignalArray(this._.fft.length)}var g=i.fn,h=i.modules.FFT;g.extend(k);var f=k.prototype;Object.defineProperties(f,{real:{set:function(e){this._.real=i(e)},get:function(){return this._.real}},imag:{set:function(e){this._.imag=i(e)},get:function(){return this._.imag}}});f.process=function(e){var c=
this._;if(this.tickID!==e&&(this.tickID=e,c.real&&c.imag)){var b=this.cells[0],a=c.realBuffer,d=c.imagBuffer,f=c.real.process(e).cells[0],e=c.imag.process(e).cells[0];a.set(f);d.set(e);b.set(c.fft.inverse(a,d).subarray(0,c.cellsize));g.outputSignalAR(this)}return this};g.register("ifft",k)})(timbre);
(function(i){function k(c){i.Object.call(this,1,c);g.timer(this);g.fixKR(this);c=this._;c.interval=i(1E3);c.count=0;c.delay=0;c.timeout=Infinity;c.currentTime=0;c.delaySamples=0;c.countSamples=0;c.onended=g.make_onended(this);this.on("start",f)}var g=i.fn,h=i.timevalue;g.extend(k);var f=function(){var c=this._;this.playbackState=g.PLAYING_STATE;c.delaySamples=c.samplerate*0.001*c.delay|0;c.countSamples=c.count=c.currentTime=0};Object.defineProperty(f,"unremovable",{value:!0,writable:!1});var e=k.prototype;
Object.defineProperties(e,{interval:{set:function(c){"string"===typeof c&&(c=h(c),0>=c&&(c=0));this._.interval=i(c)},get:function(){return this._.interval}},delay:{set:function(c){"string"===typeof c&&(c=h(c));"number"===typeof c&&0<=c&&(this._.delay=c,this._.delaySamples=this._.samplerate*0.001*c|0)},get:function(){return this._.delay}},count:{set:function(c){"number"===typeof c&&(this._.count=c)},get:function(){return this._.count}},timeout:{set:function(c){"string"===typeof c&&(c=h(c));"number"===
typeof c&&0<=c&&(this._.timeout=c)},get:function(){return this._.timeout}},currentTime:{get:function(){return this._.currentTime}}});e.bang=function(){var c=this._;this.playbackState=g.PLAYING_STATE;c.delaySamples=c.samplerate*0.001*c.delay|0;c.countSamples=c.count=c.currentTime=0;c.emit("bang");return this};e.process=function(c){var b=this.cells[0],a=this._;if(this.tickID!==c){this.tickID=c;0<a.delaySamples&&(a.delaySamples-=b.length);c=a.interval.process(c).cells[0][0];if(0>=a.delaySamples&&(a.countSamples-=
b.length,0>=a.countSamples)){a.countSamples+=0.001*a.samplerate*c|0;for(var c=this.nodes,d=a.count,e=d*a.mul+a.add,f=0,j=b.length;f<j;++f)b[f]=e;b=0;for(e=c.length;b<e;++b)c[b].bang(d);a.count+=1}a.currentTime+=g.currentTimeIncr;a.currentTime>=a.timeout&&g.nextTick(a.onended)}return this};g.register("interval",k)})(timbre);
(function(i){function k(e){i.Object.call(this,1,e);g.fixAR(this);var e=this._,c=Math.ceil(Math.log(e.samplerate)*Math.LOG2E);e.buffersize=1<<c;e.buffermask=e.buffersize-1;e.buffer=new g.SignalArray(e.buffersize);e.time=0;e.readIndex=0;e.writeIndex=0}var g=i.fn,h=i.timevalue;g.extend(k);var f=k.prototype;Object.defineProperties(f,{time:{set:function(e){"string"===typeof e&&(e=h(e));if("number"===typeof e&&0<e){var c=this._;c.time=e;e=0.001*e*c.samplerate|0;e>c.buffermask&&(e=c.buffermask);c.writeIndex=
c.readIndex+e&c.buffermask}},get:function(){return this._.time}}});f.process=function(e){var c=this._;if(this.tickID!==e){this.tickID=e;g.inputSignalAR(this);var e=this.cells[0],b=c.buffer,a=c.buffermask,d=c.readIndex,f=c.writeIndex,h,j=e.length;for(h=0;h<j;++h)b[f]=e[h],e[h]=b[d],d+=1,f=f+1&a;c.readIndex=d&a;c.writeIndex=f;g.outputSignalAR(this)}return this};g.register("lag",k)})(timbre);
(function(i){function k(e){i.Object.call(this,1,e);e=this._;e.input=0;e.value=0;e.prev=null;e.ar=!1;e.map=h}var g=i.fn;g.extend(k);var h=function(e){return e},f=k.prototype;Object.defineProperties(f,{input:{set:function(e){"number"===typeof e&&(this._.input=e)},get:function(){return this._.input}},map:{set:function(e){"function"===typeof e&&(this._.map=e)},get:function(){return this._.map}}});f.bang=function(){this._.prev=null;this._.emit("bang");return this};f.at=function(e){return this._.map?this._.map(e):
0};f.process=function(e){var c=this.cells[0],b=this._;if(this.tickID!==e){this.tickID=e;var a=this.nodes.length,e=c.length;if(b.ar&&a){g.inputSignalAR(this);var d=b.map;if(d)for(a=0;a<e;++a)c[a]=d(c[a]);b.value=c[e-1];g.outputSignalAR(this)}else{a=a?g.inputSignalKR(this):b.input;b.map&&b.prev!==a&&(b.prev=a,b.value=b.map(a));b=b.value*b.mul+b.add;for(a=0;a<e;++a)c[a]=b}}return this};g.register("map",k)})(timbre);
(function(i){function k(g){i.Object.call(this,1,g)}var g=i.fn;g.extend(k);k.prototype.process=function(h){var f=this.cells[0],e=this._;if(this.tickID!==h){this.tickID=h;var c=this.nodes,b=c.length,a,d=f.length,l,i;if(e.ar){if(0<c.length){l=c[0].process(h).cells[0];f.set(l);for(e=1;e<b;++e){l=c[e].process(h).cells[0];for(a=0;a<d;++a)i=l[a],f[a]<i&&(f[a]=i)}}else for(a=0;a<d;++a)f[a]=0;g.outputSignalAR(this)}else{if(0<c.length){l=c[0].process(h).cells[0][0];for(e=1;e<b;++e)i=c[e].process(h).cells[0][0],
l<i&&(l=i)}else l=0;f[0]=l;g.outputSignalKR(this)}}return this};g.register("max",k)})(timbre);
(function(i){function k(a){i.Object.call(this,2,a);g.fixAR(this);a=this._;a.src=a.func=null;a.bufferL=new g.SignalArray(h);a.bufferR=new g.SignalArray(h);a.readIndex=0;a.writeIndex=0;a.totalRead=0;a.totalWrite=0}if("browser"===i.envtype){var g=i.fn,h=4096,f=h-1;g.extend(k);var e=k.prototype;e.listen=function(a){var d=c[i.env];d&&(d.set.call(this,a),d.listen.call(this))};e.unlisten=function(){var a=c[i.env];a&&a.unlisten.call(this);this.cells[0].set(g.emptycell);this.cells[1].set(g.emptycell);this.cells[2].set(g.emptycell);
for(var d=this._,a=d.bufferL,d=d.bufferR,b=0,e=a.length;b<e;++b)a[b]=d[b]=0};e.process=function(a){var d=this._;if(null===d.src)return this;if(this.tickID!==a){this.tickID=a;a=d.cellsize;if(d.totalWrite>d.totalRead+a){var b=d.readIndex,c=b+a;this.cells[1].set(d.bufferL.subarray(b,c));this.cells[2].set(d.bufferR.subarray(b,c));d.readIndex=c&f;d.totalRead+=a}g.outputSignalAR(this)}return this};var c={webkit:{set:function(a){var d=this._;a instanceof HTMLMediaElement&&(d.src=g._audioContext.createMediaElementSource(a))},
listen:function(){var a=this._,d=g._audioContext;a.gain=d.createGainNode();a.gain.gain.value=0;a.node=d.createJavaScriptNode(1024,2,2);a.node.onaudioprocess=b(this);a.src.connect(a.node);a.node.connect(a.gain);a.gain.connect(d.destination)},unlisten:function(){var a=this._;a.src&&a.src.disconnect();a.gain&&a.gain.disconnect();a.node&&a.node.disconnect()}}},b=function(a){return function(d){var b=a._,d=d.inputBuffer,c=d.length,e=b.writeIndex;b.bufferL.set(d.getChannelData(0),e);b.bufferR.set(d.getChannelData(1),
e);b.writeIndex=e+c&f;b.totalWrite+=c}};c.moz={set:function(a){var d=this._;a instanceof HTMLAudioElement&&(d.src=a,d.istep=d.samplerate/a.mozSampleRate)},listen:function(){var a=this._,d=a.bufferL,b=a.bufferR,c=0,e=0;2===a.src.mozChannels?(a.x=0,a.func=function(g){var h=a.writeIndex,i=a.totalWrite,g=g.frameBuffer,k,o=a.istep,p,r=g.length;k=a.x;for(p=0;p<r;p+=2){for(k+=o;0<k;)d[h]=0.5*(g[p]+c),b[h]=0.5*(g[p+1]+e),h=h+1&f,++i,k-=1;c=g[p];e=g[p+1]}a.x=k;a.writeIndex=h;a.totalWrite=i}):(a.x=0,a.func=
function(e){var g=a.writeIndex,j=a.totalWrite,e=e.frameBuffer,h,i=a.istep,k,r=e.length;h=a.x;for(k=0;k<r;++k){for(h+=i;0<=h;)d[g]=b[g]=0.5*(e[k]+c),g=g+1&f,++j,h-=1;c=e[k]}a.x=h;a.writeIndex=g;a.totalWrite=j});a.src.addEventListener("MozAudioAvailable",a.func)},unlisten:function(){var a=this._;a.func&&(a.src.removeEventListener("MozAudioAvailable",a.func),a.func=null)}};g.register("mediastream",k)}})(timbre);
(function(i){function k(f){i.Object.call(this,1,f);f=this._;f.midi=0;f.value=0;f.prev=null;f.a4=440;f.ar=!1}var g=i.fn;g.extend(k);var h=k.prototype;Object.defineProperties(h,{midi:{set:function(f){"number"===typeof f&&(this._.midi=f)},get:function(){return this._.midi}},a4:{set:function(f){"number"===typeof f&&(this._.a4=f,this._.prev=null)},get:function(){return this._.a4}}});h.bang=function(){this._.prev=null;this._.emit("bang");return this};h.at=function(f){return this._.a4*Math.pow(2,(f-69)/
12)};h.process=function(f){var e=this._;if(this.tickID!==f){this.tickID=f;var f=this.cells[0],c=this.nodes.length,b=f.length;if(e.ar&&c){g.inputSignalAR(this);for(var a=e.a4,c=0;c<b;++c)f[c]=a*Math.pow(2,(f[c]-69)/12);e.value=f[b-1];g.outputSignalAR(this)}else b=c?g.inputSignalKR(this):e.midi,e.prev!==b&&(e.prev=b,e.value=e.a4*Math.pow(2,(b-69)/12)),f[0]=e.value,g.outputSignalKR(this)}return this};g.register("midicps",k)})(timbre);
(function(i){function k(f){i.Object.call(this,1,f);f=this._;f.midi=0;f.value=0;f.prev=null;f.range=12;f.ar=!1}var g=i.fn;g.extend(k);var h=k.prototype;Object.defineProperties(h,{midi:{set:function(f){"number"===typeof f&&(this._.midi=f)},get:function(){return this._.midi}},range:{set:function(f){"number"===typeof f&&0<f&&(this._.range=f)},get:function(){return this._.range}}});h.bang=function(){this._.prev=null;this._.emit("bang");return this};h.at=function(f){return Math.pow(2,f/this._.range)};h.process=
function(f){var e=this.cells[0],c=this._;if(this.tickID!==f){this.tickID=f;var b=this.nodes.length,f=e.length;if(c.ar&&b){g.inputSignalAR(this);for(var a=c.range,b=0;b<f;++b)e[b]=Math.pow(2,e[b]/a);c.value=e[f-1];g.outputSignalAR(this)}else{b=this.nodes.length?g.inputSignalKR(this):c.midi;c.prev!==b&&(c.prev=b,c.value=Math.pow(2,b/c.range));c=c.value*c.mul+c.add;for(b=0;b<f;++b)e[b]=c}}return this};g.register("midiratio",k)})(timbre);
(function(i){function k(g){i.Object.call(this,1,g)}var g=i.fn;g.extend(k);k.prototype.process=function(h){var f=this.cells[0],e=this._;if(this.tickID!==h){this.tickID=h;var c=this.nodes,b=c.length,a,d=f.length,l,i;if(e.ar){if(0<c.length){l=c[0].process(h).cells[0];f.set(l);for(e=1;e<b;++e){l=c[e].process(h).cells[0];for(a=0;a<d;++a)i=l[a],f[a]>i&&(f[a]=i)}}else for(a=0;a<d;++a)f[a]=0;g.outputSignalAR(this)}else{if(0<c.length){l=c[0].process(h).cells[0][0];for(e=1;e<b;++e)i=c[e].process(h).cells[0][0],
l>i&&(l=i)}else l=0;f[0]=l;g.outputSignalKR(this)}}return this};g.register("min",k)})(timbre);
(function(i){function k(a){i.Object.call(this,0,a);g.timer(this);g.fixKR(this);a=this._;a.mml="";a.status={t:120,l:4,o:4,v:12,q:6,dot:0,tie:!1};a.commands=[];a.index=0;a.queue=[];a.currentTime=0;a.queueTime=0;a.segnoIndex=-1;a.loopStack=[];a.prevNote=0;a.remain=Infinity;a.onended=g.make_onended(this);this.on("start",h)}var g=i.fn;g.extend(k);var h=function(){var a=this._;this.playbackState=g.PLAYING_STATE;a.commands=c(a.mml);a.index=0;a.queue=[];a.currentTime=0;a.queueTime=0;a.segnoIndex=-1;a.loopStack=
[];a.prevNote=0;a.remain=Infinity;e(this)};Object.defineProperty(h,"unremoved",{value:!0,writable:!1});var f=k.prototype;Object.defineProperties(f,{mml:{set:function(a){var d=this._;"string"===typeof a&&(d.mml=a)},get:function(){return this._.mml}},currentTime:{get:function(){return this._.currentTime}}});f.on=f.addListener=function(a,d){"mml"===a&&(a="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."));this._.events.on(a,d);return this};f.once=function(a,
d){"mml"===a&&(a="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."));this._.events.once(a,d);return this};f.off=f.removeListener=function(a,d){"mml"===a&&(a="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."));this._.events.off(a,d);return this};f.removeAllListeners=function(a){"mml"===a&&(console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."),a="data");this._.events.removeAllListeners(a);
return this};f.listeners=function(a){"mml"===a&&(console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."),a="data");return this._.events.listeners(a)};f.process=function(a){var d=this._;if(this.tickID!==a){this.tickID=a;var a=this.nodes,b=d.queue,c,f,h;if(b.length)for(;b[0][0]<=d.currentTime;){var i=d.queue.shift();if(i[1]){f=0;for(h=a.length;f<h;++f)c=a[f],c.noteOn?c.noteOn(i[1],i[3]):c.bang();d.remain=i[4];d.emit("data","noteOn",{noteNum:i[1],velocity:i[3]});
e(this)}else{f=0;for(h=a.length;f<h;++f)c=a[f],c.noteOff?c.noteOff(i[2],i[3]):c.release&&c.release();d.emit("data","noteOff",{noteNum:i[2],velocity:i[3]})}if(0===b.length)break}d.remain-=g.currentTimeIncr;0===b.length&&0>=d.remain&&g.nextTick(d.onended);d.currentTime+=g.currentTimeIncr}return this};var e=function(a){var a=a._,d,b=a.commands,c=a.queue,e=a.index,f=a.status,g=a.queueTime,h=a.loopStack,i,k,p,r,w;r=[];a:for(;;){if(b.length<=e)if(0<=a.segnoIndex)e=a.segnoIndex;else break;d=b[e++];switch(d.name){case "n":i=
f.t||120;null!==d.len?(k=d.len,p=d.dot||0):(k=f.l,p=d.dot||f.dot);i=1E3*60/i*(4/k);i*=[1,1.5,1.75,1.875][p]||1;p=f.v<<3;if(f.tie){for(d=c.length;d--;)if(c[d][2]){c.splice(d,1);break}d=a.prevNote}else d=a.prevNote=d.val+12*(f.o+1),c.push([g,d,null,p,i]);if(0<k){k=f.q/8;if(1>k){k=g+i*k;c.push([k,null,d,p]);d=0;for(w=r.length;d<w;++d)c.push([k,null,r[d],p])}r=[];g+=i;if(!f.tie)break a}else r.push(d);f.tie=!1;break;case "r":i=f.t||120;null!==d.len?(k=d.len,p=d.dot||0):(k=f.l,p=d.dot||f.dot);0<k&&(i=1E3*
60/i*(4/k),i*=[1,1.5,1.75,1.875][p]||1,g+=i);break;case "l":f.l=d.val;f.dot=d.dot;break;case "o":f.o=d.val;break;case "<":9>f.o&&(f.o+=1);break;case ">":0<f.o&&(f.o-=1);break;case "v":f.v=d.val;break;case "(":15>f.v&&(f.v+=1);break;case ")":0<f.v&&(f.v-=1);break;case "q":f.q=d.val;break;case "&":f.tie=!0;break;case "$":a.segnoIndex=e;break;case "[":h.push([e,null,null]);break;case "|":if((i=h[h.length-1])&&1===i[1])h.pop(),e=i[2];break;case "]":if(i=h[h.length-1])null===i[1]&&(i[1]=d.count,i[2]=e),
i[1]-=1,0===i[1]?h.pop():e=i[0];break;case "t":f.t=null===d.val?120:d.val}}a.index=e;a.queueTime=g},c=function(a){var d,c,e,f,g,h,i,k=Array(a.length),o=[];g=0;for(h=b.length;g<h;++g){d=b[g];for(c=d.re;e=c.exec(a);){if(!k[e.index]){f=0;for(i=e[0].length;f<i;++f)k[e.index+f]=!0;if(f=d.func?d.func(e):{name:e[0]})f.index=e.index,f.origin=e[0],o.push(f)}for(;c.lastIndex<a.length&&k[c.lastIndex];)++c.lastIndex}}o.sort(function(a,d){return a.index-d.index});return o},b=[{re:/([cdefgab])([\-+]?)(\d*)(\.*)/g,
func:function(a){return{name:"n",val:{c:0,d:2,e:4,f:5,g:7,a:9,b:11}[a[1]]+({"-":-1,"+":1}[a[2]]||0),len:""===a[3]?null:Math.min(a[3]|0,64),dot:a[4].length}}},{re:/r(\d*)(\.*)/g,func:function(a){return{name:"r",len:""===a[1]?null:Math.max(1,Math.min(a[1]|0,64)),dot:a[2].length}}},{re:/&/g},{re:/l(\d*)(\.*)/g,func:function(a){return{name:"l",val:""===a[1]?4:Math.min(a[1]|0,64),dot:a[2].length}}},{re:/o([0-9])/g,func:function(a){return{name:"o",val:""===a[1]?4:a[1]|0}}},{re:/[<>]/g},{re:/v(\d*)/g,func:function(a){return{name:"v",
val:""===a[1]?12:Math.min(a[1]|0,15)}}},{re:/[()]/g},{re:/q([0-8])/g,func:function(a){return{name:"q",val:""===a[1]?6:Math.min(a[1]|0,8)}}},{re:/\[/g},{re:/\|/g},{re:/\](\d*)/g,func:function(a){return{name:"]",count:a[1]|0||2}}},{re:/t(\d*)/g,func:function(a){return{name:"t",val:""===a[1]?null:Math.max(5,Math.min(a[1]|0,300))}}},{re:/\$/g}];g.register("mml",k)})(timbre);
(function(i){function k(g){i.Object.call(this,1,g)}var g=i.fn;g.extend(k);k.prototype.process=function(h){var f=this._;this.tickID!==h&&(this.tickID=h,f.ar?(g.inputSignalAR(this),g.outputSignalAR(this)):(this.cells[0][0]=g.inputSignalKR(this),g.outputSignalKR(this)));return this};g.register("mono",k)})(timbre);
(function(i){function k(g){i.Object.call(this,2,g)}var g=i.fn;g.extend(k);k.prototype.process=function(h){var f=this._;if(this.tickID!==h){this.tickID=h;var e=this.nodes,c=this.cells[0],b=this.cells[1],a=this.cells[2],d=e.length,i=c.length,k,j;if(f.ar){if(0<e.length){e[0].process(h);k=e[0].cells[1];j=e[0].cells[2];b.set(k);a.set(j);for(f=1;f<d;++f){e[f].process(h);k=e[f].cells[1];j=e[f].cells[2];for(c=0;c<i;++c)b[c]*=k[c],a[c]*=j[c]}}else for(c=0;c<i;++c)b[c]=a[c]=0;g.outputSignalAR(this)}else{if(0<
e.length){b=e[0].process(h).cells[0][0];for(f=1;f<d;++f)b*=e[f].process(h).cells[0][0]}else b=0;c[0]=b;g.outputSignalKR(this)}}return this};g.register("*",k)})(timbre);
(function(i){function k(f){i.Object.call(this,1,f);f=this._;f.defaultValue=0;f.index=0;f.dict={};f.ar=!1}var g=i.fn;g.extend(k);var h=k.prototype;Object.defineProperties(h,{dict:{set:function(f){if("object"===typeof f)this._.dict=f;else if("function"===typeof f){for(var e={},c=0;128>c;++c)e[c]=f(c);this._.dict=e}},get:function(){return this._.dict}},defaultValue:{set:function(f){"number"===typeof f&&(this._.defaultValue=f)},get:function(){return this._.defaultValue}},index:{set:function(f){"number"===
typeof f&&(this._.index=f)},get:function(){return this._.index}}});h.at=function(f){var e=this._;return(e.dict[f|0]||e.defaultValue)*e.mul+e.add};h.clear=function(){this._.dict={};return this};h.process=function(f){var e=this.cells[0],c=this._;if(this.tickID!==f){this.tickID=f;var b=this.nodes.length,a;a=c.dict;var d=c.defaultValue,h=c.mul,i=c.add,f=e.length;if(c.ar&&b){g.inputSignalAR(this);for(c=0;c<f;++c)b=e[c],b=0>b?b-0.5|0:b+0.5|0,e[c]=(a[b]||d)*h+i;g.outputSignalAR(this)}else{b=this.nodes.length?
g.inputSignalKR(this):c.index;a=(a[0>b?b-0.5|0:b+0.5|0]||d)*h+i;for(c=0;c<f;++c)e[c]=a}}return this};g.register("ndict",k)})(timbre);(function(i){function k(g){i.Object.call(this,1,g)}var g=i.fn;g.extend(k);k.prototype.process=function(g){var f=this.cells[0],e=this._;if(this.tickID!==g){this.tickID=g;var g=e.mul,c=e.add,b;if(e.ar){e=0;for(b=f.length;e<b;++e)f[e]=(2*Math.random()-1)*g+c}else{g=(2*Math.random()+1)*g+c;e=0;for(b=f.length;e<b;++e)f[e]=g}}return this};g.register("noise",k)})(timbre);
(function(i){function k(a){i.Object.call(this,2,a);a=this._;a.freq=i(440);a.phase=i(0);a.osc=new f(a.samplerate);a.tmp=new g.SignalArray(a.cellsize);a.osc.step=a.cellsize;this.once("init",e)}var g=i.fn,h=i.timevalue,f=i.modules.Oscillator;g.extend(k);var e=function(){var a=this._;this.wave||(this.wave="sin");a.plotData=a.osc.wave;a.plotLineWidth=2;a.plotCyclic=!0;a.plotBefore=b},c=k.prototype;Object.defineProperties(c,{wave:{set:function(a){this._.osc.setWave(a)},get:function(){return this._.osc.wave}},
freq:{set:function(a){"string"===typeof a&&(a=h(a),a=0>=a?0:1E3/a);this._.freq=i(a)},get:function(){return this._.freq}},phase:{set:function(a){this._.phase=i(a);this._.osc.feedback=!1},get:function(){return this._.phase}},fb:{set:function(a){this._.phase=i(a);this._.osc.feedback=!0},get:function(){return this._.phase}}});c.clone=function(){var a=g.clone(this);a._.osc=this._.osc.clone();a._.freq=this._.freq;a._.phase=this._.phase;return a};c.bang=function(){this._.osc.reset();this._.emit("bang");
return this};c.process=function(a){var d=this._;if(this.tickID!==a){this.tickID=a;var b=this.cells[1],c=this.cells[2],e,f=d.cellsize;if(this.nodes.length)g.inputSignalAR(this);else for(e=0;e<f;++e)b[e]=c[e]=1;e=d.osc;var h=d.freq.process(a).cells[0],i=d.phase.process(a).cells[0];e.frequency=h[0];e.phase=i[0];if(d.ar){a=d.tmp;d.freq.isAr?d.phase.isAr?e.processWithFreqAndPhaseArray(a,h,i):e.processWithFreqArray(a,h):d.phase.isAr?e.processWithPhaseArray(a,i):e.process(a);for(e=0;e<f;++e)b[e]*=a[e],c[e]*=
a[e]}else{d=e.next();for(e=0;e<f;++e)b[e]*=d,c[e]*=d}g.outputSignalAR(this)}return this};var b;"browser"===i.envtype&&(b=function(a,d,b,c,e){e=(e>>1)+0.5;a.strokeStyle="#ccc";a.lineWidth=1;a.beginPath();a.moveTo(d,e+b);a.lineTo(d+c,e+b);a.stroke()});g.register("osc",k);g.register("sin",function(a){return(new k(a)).set("wave","sin")});g.register("cos",function(a){return(new k(a)).set("wave","cos")});g.register("pulse",function(a){return(new k(a)).set("wave","pulse")});g.register("tri",function(a){return(new k(a)).set("wave",
"tri")});g.register("saw",function(a){return(new k(a)).set("wave","saw")});g.register("fami",function(a){return(new k(a)).set("wave","fami")});g.register("konami",function(a){return(new k(a)).set("wave","konami")});g.register("+sin",function(a){return(new k(a)).set("wave","+sin").kr()});g.register("+pulse",function(a){return(new k(a)).set("wave","+pulse").kr()});g.register("+tri",function(a){return(new k(a)).set("wave","+tri").kr()});g.register("+saw",function(a){return(new k(a)).set("wave","+saw").kr()});
g.alias("square","pulse")})(timbre);
(function(i){function k(f){i.Object.call(this,2,f);g.fixAR(this);f=this._;f.pos=i(0);f.panL=0.5;f.panR=0.5}var g=i.fn;g.extend(k);var h=k.prototype;Object.defineProperties(h,{pos:{set:function(f){this._.pos=i(f)},get:function(){return this._.pos}}});h.process=function(f){var e=this._;if(this.tickID!==f){this.tickID=f;var c=e.pos.process(f).cells[0][0];e.prevPos!==c&&(e.panL=1-c,e.panR=e.prevPos=c);var b=this.nodes,c=this.cells[1],a=this.cells[2],d,h=b.length,i,j=c.length,k;if(h){k=b[0].process(f).cells[0];
for(i=0;i<j;++i)c[i]=a[i]=k[i];for(d=1;d<h;++d){k=b[d].process(f).cells[0];for(i=0;i<j;++i)c[i]=a[i]+=k[i]}f=e.panL;e=e.panR;for(i=0;i<j;++i)c[i]*=f,a[i]*=e}else c.set(g.emptycell),a.set(g.emptycell);g.outputSignalAR(this)}return this};g.register("pan",k)})(timbre);
(function(i){function k(a){i.Object.call(this,2,a);a=this._;a.value=0;a.env=new e(a.samplerate);a.env.step=a.cellsize;a.curve="lin";a.counter=0;a.ar=!1;a.onended=c(this);this.on("ar",b)}var g=i.fn,h=i.timevalue,f=i.modules.Envelope,e=i.modules.EnvelopeValue;g.extend(k);var c=function(a,d){return function(){if("number"===typeof d)for(var b=a.cells[0],c=a.cells[1],e=a.cells[2],f=a._.env.value,g=0,h=c.length;g<h;++g)b[0]=c[g]=e[g]=f;a._.emit("ended")}},b=function(a){this._.env.step=a?1:this._.cellsize},
a=k.prototype;Object.defineProperties(a,{value:{set:function(a){"number"===typeof a&&(this._.env.value=a)},get:function(){return this._.env.value}}});a.to=function(a,d,b){var c=this._,e=c.env;"string"===typeof d?d=h(d):"undefined"===typeof d&&(d=0);if("undefined"===typeof b)c.counter=e.setNext(a,d,f.CurveTypeLin),c.curve="lin";else{var g=f.CurveTypeDict[b];c.counter="undefined"===typeof g?e.setNext(a,d,f.CurveTypeCurve,b):e.setNext(a,d,g);c.curve=b}c.plotFlush=!0;return this};a.setAt=function(a,d){var b=
this._;this.to(b.env.value,d,"set");b.atValue=a;return this};a.linTo=function(a,d){return this.to(a,d,"lin")};a.expTo=function(a,d){return this.to(a,d,"exp")};a.sinTo=function(a,d){return this.to(a,d,"sin")};a.welTo=function(a,d){return this.to(a,d,"wel")};a.sqrTo=function(a,d){return this.to(a,d,"sqr")};a.cubTo=function(a,d){return this.to(a,d,"cub")};a.cancel=function(){var a=this._;a.counter=a.env.setNext(a.env.value,0,f.CurveTypeSet);return this};a.process=function(a){var d=this._;if(this.tickID!==
a){this.tickID=a;var a=this.cells[1],b=this.cells[2],c,e=d.cellsize,h=d.env,i=d.counter,k;if(this.nodes.length)g.inputSignalAR(this);else for(c=0;c<e;++c)a[c]=b[c]=1;0>=i&&("set"===d.curve?h.setNext(d.atValue,0,f.CurveTypeSet):h.setNext(h.value,0,f.CurveTypeSet),g.nextTick(d.onended),d.counter=Infinity);if(d.ar){for(c=0;c<e;++c)k=h.next(),a[c]*=k,b[c]*=k;d.counter-=d.cellsize}else{k=h.next();for(c=0;c<e;++c)a[c]*=k,b[c]*=k;d.counter-=1}g.outputSignalAR(this);d.value=k}return this};var d=i.Object.prototype.plot;
a.plot=function(a){var b=this._;if(b.plotFlush){var c=new e(128),g=new Float32Array(128),h,i;if("set"===b.curve){h=100;for(i=g.length;h<i;++h)g[h]=1}else{h=f.CurveTypeDict[b.curve];"undefined"===typeof h?c.setNext(1,1E3,f.CurveTypeCurve,b.curve):c.setNext(1,1E3,h);h=0;for(i=g.length;h<i;++h)g[h]=c.next()}b.plotData=g;b.plotRange=[0,1];b.plotFlush=null}return d.call(this,a)};g.register("param",k)})(timbre);
(function(i){function k(e){i.Object.call(this,2,e);g.fixAR(this);e=this._;e.freq=i("sin",{freq:1,add:1E3,mul:250}).kr();e.Q=i(1);e.allpass=[];this.steps=2}var g=i.fn,h=i.modules.Biquad;g.extend(k);var f=k.prototype;Object.defineProperties(f,{freq:{set:function(e){this._.freq=e},get:function(){return this._.freq}},Q:{set:function(e){this._.Q=i(e)},get:function(){return this._.Q}},steps:{set:function(e){if("number"===typeof e){e|=0;if(2===e||4===e||8===e||12===e){var c=this._.allpass;if(c.length<e)for(var b=
c.length;b<e;++b)c[b]=new h(this._.samplerate),c[b].setType("allpass")}this._.steps=e}},get:function(){return this._.steps}}});f.process=function(e){var c=this._;if(this.tickID!==e){this.tickID=e;g.inputSignalAR(this);if(!c.bypassed){var b=this.cells[1],a=this.cells[2],d=c.freq.process(e).cells[0][0],e=c.Q.process(e).cells[0][0],f=c.steps,h;for(h=0;h<f;h+=2)c.allpass[h].setParams(d,e,0),c.allpass[h].process(b,a),c.allpass[h+1].setParams(d,e,0),c.allpass[h+1].process(b,a)}g.outputSignalAR(this)}return this};
g.register("phaser",k)})(timbre);
(function(i){function k(h){i.Object.call(this,1,h);g.fixAR(this);for(var h=new Uint8Array(5),f=0;5>f;++f)h[f]=(1073741824*Math.random()|0)%25;this._.whites=h;this._.key=0}var g=i.fn;g.extend(k);k.prototype.process=function(g){var f=this.cells[0],e=this._;if(this.tickID!==g){this.tickID=g;var c,b,a=e.key,d=e.whites,i=e.mul,k=e.add,j,q,g=0;for(c=f.length;g<c;++g){b=a++;31<a&&(a=0);q=b^a;for(b=j=0;5>b;++b)q&1<<b&&(d[b]=(1073741824*Math.random()|0)%25),j+=d[b];f[g]=(0.01666666*j-1)*i+k}e.key=a}return this};
g.register("pink",k)})(timbre);
(function(i){function k(f){i.Object.call(this,1,f);this._.freq=440;this._.buffer=null;this._.index=0}var g=i.fn;g.extend(k);var h=k.prototype;Object.defineProperties(h,{freq:{set:function(f){"number"===typeof f&&(0>f&&(f=0),this._.freq=f)},get:function(){return this._.freq}}});h.bang=function(){for(var f=this._,e=f.samplerate/f.freq+0.5|0,c=f.buffer=new g.SignalArray(e),b=0;b<e;++b)c[b]=2*Math.random()-1;f.index=0;f.emit("bang");return this};h.process=function(f){var e=this.cells[0],c=this._;if(this.tickID!==
f&&(this.tickID=f,f=c.buffer)){var b=f.length,a=c.index,d,g=c.mul,h=c.add,i,k,t=e.length;for(k=0;k<t;++k)d=a,i=f[a++],a>=b&&(a=0),i=0.5*(i+f[a]),f[d]=i,e[k]=i*g+h;c.index=a}return this};g.register("pluck",k)})(timbre);
(function(i){function k(b){i.Object.call(this,1,b);g.listener(this);g.fixAR(this);b=this._;b.timeout=5E3;b.status=f;b.writeIndex=0;b.writeIndexIncr=1;b.currentTime=0;b.currentTimeIncr=1E3/b.samplerate;b.onended=e(this)}var g=i.fn,h=i.timevalue,f=0;g.extend(k);var e=function(b){return function(){var a=b._,d=new g.SignalArray(a.buffer.subarray(0,a.writeIndex|0));a.status=f;a.writeIndex=0;a.currentTime=0;a.emit("ended",{buffer:d,samplerate:a.samplerate})}},c=k.prototype;Object.defineProperties(c,{timeout:{set:function(b){"string"===
typeof b&&(b=h(b));"number"===typeof b&&0<b&&(this._.timeout=b)},get:function(){return this._.timeout}},samplerate:{set:function(b){"number"===typeof b&&(0<b&&b<=this._.samplerate)&&(this._.samplerate=b)},get:function(){return this._.samplerate}},currentTime:{get:function(){return this._.currentTime}}});c.start=function(){var b=this._,a;if(b.status===f){a=0.01*b.timeout*b.samplerate|0;if(!b.buffer||b.buffer.length<a)b.buffer=new g.SignalArray(a);b.writeIndex=0;b.writeIndexIncr=b.samplerate/i.samplerate;
b.currentTime=0;b.status=1;b.emit("start");this.listen()}return this};c.stop=function(){var b=this._;1===b.status&&(b.status=f,b.emit("stop"),g.nextTick(b.onended),this.unlisten());return this};c.bang=function(){this._.status===f?this.srart():1===this._.status&&this.stop();this._.emit("bang");return this};c.process=function(b){var a=this._,d=this.cells[0];if(this.tickID!==b){this.tickID=b;g.inputSignalAR(this);if(1===a.status){for(var c=d.length,e=a.buffer,f=a.timeout,h=a.writeIndex,i=a.writeIndexIncr,
k=a.currentTime,m=a.currentTimeIncr,b=0;b<c;++b)e[h|0]=d[b],h+=i,k+=m,f<=k&&g.nextTick(a.onended);a.writeIndex=h;a.currentTime=k}g.outputSignalAR(this)}return this};g.register("record",k);g.alias("rec","record")})(timbre);
(function(i){function k(e){i.Object.call(this,2,e);g.fixAR(this);this._.reverb=new h(this._.samplerate,this._.cellsize)}var g=i.fn,h=i.modules.Reverb;g.extend(k);var f=k.prototype;Object.defineProperties(f,{room:{set:function(e){"number"===typeof e&&this._.reverb.setRoomSize(1<e?1:0>e?0:e)},get:function(){return this._.reverb.roomsize}},damp:{set:function(e){"number"===typeof e&&this._.reverb.setDamp(1<e?1:0>e?0:e)},get:function(){return this._.reverb.damp}},mix:{set:function(e){"number"===typeof e&&
(this._.reverb.wet=1<e?1:0>e?0:e)},get:function(){return this._.reverb.wet}}});f.process=function(e){var c=this._;this.tickID!==e&&(this.tickID=e,g.inputSignalAR(this),c.bypassed||c.reverb.process(this.cells[1],this.cells[2]),g.outputSignalAR(this));return this};g.register("reverb",k)})(timbre);
(function(i){function k(e){i.Object.call(this,0,e);g.timer(this);g.fixKR(this);e=this._;e.queue=[];e.currentTime=0;e.maxRemain=1E3}var g=i.fn,h=i.timevalue;g.extend(k);var f=k.prototype;Object.defineProperties(f,{queue:{get:function(){return this._.queue}},remain:{get:function(){return this._.queue.length}},maxRemain:{set:function(e){"number"===typeof e&&0<e&&(this._.maxRemain=e)},get:function(){return this._.maxRemain}},isEmpty:{get:function(){return 0===this._.queue.length}},currentTime:{get:function(){return this._.currentTime}}});
f.sched=function(e,c){"string"===typeof e&&(e=h(e));"number"===typeof e&&this.schedAbs(this._.currentTime+e,c);return this};f.schedAbs=function(e,c){"string"===typeof e&&(e=h(e));if("number"===typeof e){var b=this._,a=b.queue;if(a.length>=b.maxRemain)return this;for(b=a.length;b--&&!(a[b][0]<e););a.splice(b+1,0,[e,i(c)])}return this};f.advance=function(e){"string"===typeof e&&(e=h(e));"number"===typeof e&&(this._.currentTime+=e);return this};f.clear=function(){this._.queue.splice(0);return this};
f.process=function(e){var c=this._;if(this.tickID!==e){this.tickID=e;var e=null,b=c.queue;if(b.length)for(;b[0][0]<c.currentTime;)if(c.queue.shift()[1].bang(),e="sched",0===b.length){e="empty";break}c.currentTime+=g.currentTimeIncr;e&&c.emit(e)}return this};g.register("schedule",k);g.alias("sche","schedule")})(timbre);
(function(i){function k(b){i.Object.call(this,2,b);g.listener(this);g.fixAR(this);b=this._;b.samples=0;b.writeIndex=0;b.plotFlush=!0;this.once("init",f)}var g=i.fn,h=i.timevalue;g.extend(k);var f=function(){this._.buffer||(this.size=1024);this._.interval||(this.interval=1E3)},e=k.prototype;Object.defineProperties(e,{size:{set:function(b){var a=this._;!a.buffer&&"number"===typeof b&&(a.buffer=new g.SignalArray(64>b?64:2048<b?2048:b),a.reservedinterval&&(this.interval=a.reservedinterval,a.reservedinterval=
null))},get:function(){return this._.buffer.length}},interval:{set:function(b){var a=this._;"string"===typeof b&&(b=h(b));"number"===typeof b&&0<b&&(a.buffer?(a.interval=b,a.samplesIncr=0.001*b*a.samplerate/a.buffer.length,1>a.samplesIncr&&(a.samplesIncr=1)):a.reservedinterval=b)},get:function(){return this._.interval}}});e.bang=function(){for(var b=this._,a=b.buffer,d=0,c=a.length;d<c;++d)a[d]=0;b.samples=0;b.writeIndex=0;this._.emit("bang");return this};e.process=function(b){var a=this._;if(this.tickID!==
b){this.tickID=b;g.inputSignalAR(this);g.outputSignalAR(this);var b=this.cells[0],d,c=a.cellsize,e=a.samples,f=a.samplesIncr,h=a.buffer,i=a.writeIndex,k=!1,m=h.length;for(d=0;d<c;++d)0>=e&&(h[i++]=b[d],i>=m&&(i=0),k=a.plotFlush=!0,e+=f),--e;a.samples=e;a.writeIndex=i;k&&this._.emit("data")}return this};var c=i.Object.prototype.plot;e.plot=function(b){var a=this._;if(a.plotFlush){for(var d=a.buffer,e=d.length-1,f=new Float32Array(d.length),g=a.writeIndex,h=0,i=d.length;h<i;h++)f[h]=d[++g&e];a.plotData=
f;a.plotFlush=null}return c.call(this,b)};g.register("scope",k)})(timbre);
(function(i){function k(b){i.Object.call(this,2,b);f.fixAR(this);b=this._;b.numberOfInputs=0;b.numberOfOutputs=0;b.bufferSize=0;b.bufferMask=0;b.duration=0;b.inputBufferL=null;b.inputBufferR=null;b.outputBufferL=null;b.outputBufferR=null;b.onaudioprocess=null;b.index=0;this.once("init",e)}function g(b,a){this.samplerate=b._.samplerate;this.length=b._.bufferSize;this.duration=b._.duration;this.numberOfChannels=a.length;this.getChannelData=function(d){return a[d]}}function h(b){var a=b._;this.node=
b;this.playbackTime=i.currentTime;this.inputBuffer=2===a.numberOfInputs?new g(b,[a.inputBufferL,a.inputBufferR]):new g(b,[a.inputBufferL]);this.outputBuffer=2===a.numberOfOutputs?new g(b,[a.outputBufferL,a.outputBufferR]):new g(b,[a.outputBufferL])}var f=i.fn;f.extend(k);var e=function(){var b=this._;0===b.numberOfInputs&&(this.numberOfInputs=1);0===b.numberOfOutputs&&(this.numberOfOutputs=1);0===b.bufferSize&&(this.bufferSize=1024)},c=k.prototype;Object.defineProperties(c,{numberOfInputs:{set:function(b){var a=
this._;0===a.numberOfInputs&&(a.numberOfInputs=2===b?2:1)},get:function(){return this._.numberOfInputs}},numberOfOutputs:{set:function(b){var a=this._;0===a.numberOfOutputs&&(a.numberOfOutputs=2===b?2:1)},get:function(){return this._.numberOfOutputs}},bufferSize:{set:function(b){var a=this._;0===a.bufferSize&&-1!==[256,512,1024,2048,4096,8192,16384].indexOf(b)&&(a.bufferSize=b,a.bufferMask=b-1,a.duration=b/a.samplerate,a.inputBufferL=new f.SignalArray(b),a.inputBufferR=new f.SignalArray(b),a.outputBufferL=
new f.SignalArray(b),a.outputBufferR=new f.SignalArray(b))},get:function(){return this._.bufferSize}},onaudioprocess:{set:function(b){"function"===typeof b&&(this._.onaudioprocess=b)},get:function(){return this._.onaudioprocess}}});c.process=function(b){var a=this._;if(this.tickID!==b){this.tickID=b;var b=a.cellsize,d=a.bufferMask,c=a.index,e=c+b,g,i=this.cells[1],k=this.cells[2];f.inputSignalAR(this);if(2===a.numberOfInputs)a.inputBufferL.set(i,c),a.inputBufferR.set(k,c);else{g=a.inputBufferL;for(var u=
0;u<b;u++)g[c+u]=0.5*(i[u]+k[u])}i.set(a.outputBufferL.subarray(c,e));k.set(a.outputBufferR.subarray(c,e));a.index=e&d;0===a.index&&a.onaudioprocess&&(a.onaudioprocess(new h(this)),1===a.numberOfOutputs&&a.outputBufferR.set(a.outputBufferL));f.outputSignalAR(this)}return this};f.register("script",k)})(timbre);
(function(i){function k(f){i.Object.call(this,2,f);this._.selected=0;this._.background=!1}var g=i.fn;g.extend(k);var h=k.prototype;Object.defineProperties(h,{selected:{set:function(f){"number"===typeof f&&(this._.selected=f,this.cells[1].set(g.emptycell),this.cells[2].set(g.emptycell))},get:function(){return this._.selected}},background:{set:function(f){this._.background=!!f},get:function(){return this._.background}}});h.process=function(f){var e=this._;if(this.tickID!==f){this.tickID=f;var c=this.nodes,
b,a=c.length;if(e.background)for(b=0;b<a;++b)c[b].process(f);if(c=c[e.selected])e.background||c.process(f),this.cells[1].set(c.cells[1]),this.cells[2].set(c.cells[2]);g.outputSignalAR(this)}return this};g.register("selector",k)})(timbre);
(function(i){function k(a){i.Object.call(this,2,a);g.listener(this);g.fixAR(this);a=this._;a.status=e;a.samples=0;a.samplesIncr=0;a.writeIndex=0;a.plotFlush=!0;a.plotRange=[0,32];a.plotBarStyle=!0;this.once("init",c)}var g=i.fn,h=i.timevalue,f=i.modules.FFT,e=0;g.extend(k);var c=function(){var a=this._;a.fft||(this.size=512);a.interval||(this.interval=500)},b=k.prototype;Object.defineProperties(b,{size:{set:function(a){var b=this._;if(!b.fft&&"number"===typeof a&&(b.fft=new f(256>a?256:2048<a?2048:
a),b.buffer=new g.SignalArray(b.fft.length),b.freqs=new g.SignalArray(b.fft.length>>1),b.reservedwindow&&(b.fft.setWindow(b.reservedwindow),b.reservedwindow=null),b.reservedinterval))this.interval=b.reservedinterval,b.reservedinterval=null},get:function(){return this._.buffer.length}},window:{set:function(a){this._.fft.setWindow(a)},get:function(){return this._.fft.windowName}},interval:{set:function(a){var b=this._;"string"===typeof a&&(a=h(a));"number"===typeof a&&0<a&&(b.buffer?(b.interval=a,b.samplesIncr=
0.001*a*b.samplerate,b.samplesIncr<b.buffer.length&&(b.samplesIncr=b.buffer.length,b.interval=1E3*b.samplesIncr/b.samplerate)):b.reservedinterval=a)},get:function(){return this._.interval}},spectrum:{get:function(){return this._.fft.getFrequencyData(this._.freqs)}},real:{get:function(){return this._.fft.real}},imag:{get:function(){return this._.fft.imag}}});b.bang=function(){this._.samples=0;this._.writeIndex=0;this._.emit("bang");return this};b.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=
a;g.inputSignalAR(this);g.outputSignalAR(this);var a=this.cells[0],c,f=a.length,h=b.status,i=b.samples,k=b.samplesIncr,m=b.writeIndex,o=b.buffer,p=o.length,r;for(c=0;c<f;++c)0>=i&&h===e&&(h=1,m=0,i+=k),1===h&&(o[m++]=a[c],p<=m&&(b.fft.forward(o),r=b.plotFlush=!0,h=e)),--i;b.samples=i;b.status=h;b.writeIndex=m;r&&this._.emit("data")}return this};var a=i.Object.prototype.plot;b.plot=function(b){this._.plotFlush&&(this._.plotData=this.spectrum,this._.plotFlush=null);return a.call(this,b)};g.register("spectrum",
k)})(timbre);
(function(i){function k(g){i.Object.call(this,2,g);this._.ar=!1}var g=i.fn;g.extend(k);k.prototype.process=function(h){var f=this._;if(this.tickID!==h){this.tickID=h;var e=this.nodes,c=this.cells[0],b=this.cells[1],a=this.cells[2],d,i=e.length,k=c.length,j;if(f.ar){if(0<e.length){e[0].process(h);f=e[0].cells[1];j=e[0].cells[2];b.set(f);a.set(j);for(d=1;d<i;++d){e[d].process(h);f=e[d].cells[1];j=e[d].cells[2];for(c=0;c<k;++c)b[c]-=f[c],a[c]-=j[c]}}else for(c=0;c<k;++c)b[c]=a[d]=0;g.outputSignalAR(this)}else{if(0<e.length){b=
e[0].process(h).cells[0][0];for(d=1;d<i;++d)b-=e[d].process(h).cells[0][0]}else b=0;c[0]=b;g.outputSignalKR(this)}}return this};g.register("-",k)})(timbre);
(function(i){function k(a){i.Object.call(this,2,a);g.fixAR(this);a=this._;this.playbackState=g.FINISHED_STATE;a.poly=4;a.genList=[];a.genDict={};a.synthdef=null;a.remGen=e(this);a.onended=g.make_onended(this)}var g=i.fn;g.extend(k);var h=k.prototype;Object.defineProperties(h,{def:{set:function(a){"function"===typeof a&&(this._.synthdef=a)},get:function(){return this._.synthdef}},poly:{set:function(a){"number"===typeof a&&(0<a&&64>=a)&&(this._.poly=a)},get:function(){return this._.poly}}});var f=function(a,
b){return function(){a._.remGen(b.gen)}},e=function(a){return function(b){var c=a._,e=c.genList.indexOf(b);-1!==e&&c.genList.splice(e,1);c.genDict[b.noteNum]=null}},c=function(a,b,c,e){c|=0;0>=c?this.noteOff(this,a):127<c&&(c=127);var h=this._,k=h.genList,u=h.genDict,m=u[a];m&&h.remGen(m);b={freq:b,noteNum:a,velocity:c};if(e)for(var o in e)b[o]=e[o];b.doneAction=f(this,b);m=this._.synthdef.call(this,b);m instanceof i.Object&&(m.noteNum=a,k.push(m),u[a]=b.gen=m,this.playbackState=g.PLAYING_STATE,k.length>
h.poly&&h.remGen(k[0]))},b=function(){for(var a=new Float32Array(128),b=0;128>b;++b)a[b]=440*Math.pow(2,1*(b-69)/12);return a}();h.noteOn=function(a,e,f){var g=b[a]||440*Math.pow(2,(a-69)/12);c.call(this,a+0.5|0,g,e,f);return this};h.noteOff=function(a){(a=this._.genDict[a])&&a.release&&a.release();return this};h.noteOnWithFreq=function(a,b,e){var f=0<a?12*Math.log(1*a/440)*Math.LOG2E+69:0;c.call(this,f+0.5|0,a,b,e);return this};h.noteOffWithFreq=function(a){return this.noteOff((0<a?12*Math.log(1*
a/440)*Math.LOG2E+69:0)+0.5|0)};h.allNoteOff=function(){for(var a=this._.genList,b=0,c=a.length;b<c;++b)a[b].release&&a[b].release()};h.allSoundOff=function(){for(var a=this._,b=a.genList,a=a.genDict;b.length;)delete a[b.shift().noteNum]};h.process=function(a){var b=this.cells[0],c=this._;if(this.tickID!==a){this.tickID=a;if(this.playbackState===g.PLAYING_STATE){var e=c.genList,f,h=this.cells[1],i=this.cells[2],k,b=b.length,o,p;if(e.length){f=e[0];f.process(a);h.set(f.cells[1]);i.set(f.cells[2]);
c=1;for(k=e.length;c<k;++c){f=e[c];f.process(a);o=f.cells[1];p=f.cells[2];for(f=0;f<b;++f)h[f]+=o[f],i[f]+=p[f]}}else g.nextTick(c.onended)}g.outputSignalAR(this)}return this};g.register("SynthDef",k);var a={set:function(a){g.isDictionary(a)?"string"===typeof a.type&&(this._.env=a):a instanceof i.Object&&(this._.env=a)},get:function(){return this._.env}};g.register("OscGen",function(){var b={set:function(a){a instanceof i.Object&&(this._.osc=a)},get:function(){return this._.osc}},c={set:function(a){"string"===
typeof a&&(this._.wave=a)},get:function(){return this._.wave}},e=function(a){var b=this._,c,d,e;c=b.osc||null;d=b.env||{};e=d.type||"perc";c instanceof i.Object&&"function"===typeof c.clone&&(c=c.clone());c||(c=i("osc",{wave:b.wave}));c.freq=a.freq;c.mul=c.mul*a.velocity/128;b=c;d instanceof i.Object?"function"===typeof d.clone&&(b=d.clone().append(b)):b=i(e,d,b);b.on("ended",a.doneAction).bang();return b};return function(f){f=new k(f);f._.wave="sin";Object.defineProperties(f,{env:a,osc:b,wave:c});
f.def=e;return f}}());g.register("PluckGen",function(){var b=function(a){var b,c,d;c=this._.env||{};d=c.type||"perc";b=i("pluck",{freq:a.freq,mul:a.velocity/128}).bang();c instanceof i.Object?"function"===typeof c.clone&&(b=c.clone().append(b)):b=i(d,c,b);b.on("ended",a.doneAction).bang();return b};return function(c){c=new k(c);Object.defineProperties(c,{env:a});c.def=b;return c}}())})(timbre);
(function(i){function k(a){i.Object.call(this,2,a);g.fixAR(this);a=this._;a.isLooped=!1;a.onended=g.make_onended(this,0)}var g=i.fn,h=i.modules.Scissor,f=h.Tape,e=h.TapeStream,c=g.isSignalArray;g.extend(k);var b=k.prototype;Object.defineProperties(b,{tape:{set:function(a){a instanceof f?(this.playbackState=g.PLAYING_STATE,this._.tape=a,this._.tapeStream=new e(a,this._.samplerate)):"object"===typeof a&&(Array.isArray(a.buffer)&&c(a.buffer[0]))&&(this.playbackState=g.PLAYING_STATE,this._.tape=new h(a),
this._.tapeStream=new e(a,this._.samplerate))},get:function(){return this._.tape}},isLooped:{get:function(){return this._.isLooped}}});b.loop=function(a){this._.isLooped=!!a;this._.tapeStream&&(this._.tapeStream.isLooped=this._.isLooped);return this};b.bang=function(){this.playbackState=g.PLAYING_STATE;this._.tapeStream&&this._.tapeStream.reset();this._.emit("bang");return this};b.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;if(a=b.tapeStream){var c=this.cells[1],e=this.cells[2],
f=a.fetch(c.length);c.set(f[0]);e.set(f[1]);this.playbackState===g.PLAYING_STATE&&a.isEnded&&g.nextTick(b.onended)}g.outputSignalAR(this)}return this};g.register("tape",k)})(timbre);
(function(i){function k(b){i.Object.call(this,0,b);g.timer(this);g.fixKR(this);b=this._;this.playbackState=g.FINISHED_STATE;b.currentTime=0;b.samplesMax=0;b.samples=0;b.onended=g.make_onended(this);this.once("init",f);this.on("start",e)}var g=i.fn,h=i.timevalue;g.extend(k);var f=function(){this._.timeout||(this.timeout=1E3)},e=function(){this.playbackState=g.PLAYING_STATE};Object.defineProperty(e,"unremovable",{value:!0,writable:!1});var c=k.prototype;Object.defineProperties(c,{timeout:{set:function(b){var a=
this._;"string"===typeof b&&(b=h(b));"number"===typeof b&&0<=b&&(this.playbackState=g.PLAYING_STATE,a.timeout=b,a.samplesMax=a.samplerate*0.001*b|0,a.samples=a.samplesMax)},get:function(){return this._.timeout}},currentTime:{get:function(){return this._.currentTime}}});c.bang=function(){var b=this._;this.playbackState=g.PLAYING_STATE;b.samples=b.samplesMax;b.currentTime=0;b.emit("bang");return this};c.process=function(b){var a=this.cells[0],c=this._;if(this.tickID!==b){this.tickID=b;0<c.samples&&
(c.samples-=a.length);if(0>=c.samples){for(var b=this.nodes,a=0,e=b.length;a<e;++a)b[a].bang();g.nextTick(c.onended)}c.currentTime+=g.currentTimeIncr}return this};g.register("timeout",k)})(timbre);
(function(i){function k(f){i.Object.call(this,1,f);g.fixAR(this);this._.curve=null}var g=i.fn;g.extend(k);var h=k.prototype;Object.defineProperties(h,{curve:{set:function(f){g.isSignalArray(f)&&(this._.curve=f)},get:function(){return this._.curve}}});h.process=function(f){var e=this._;if(this.tickID!==f){this.tickID=f;g.inputSignalAR(this);if(e.curve){var f=this.cells[0],c=e.curve,b=c.length,a,d=e.cellsize;for(a=0;a<d;++a)e=0.5*(f[a]+1)*b+0.5|0,0>e?e=0:e>=b-1&&(e=b-1),f[a]=c[e]}g.outputSignalAR(this)}return this};
g.register("waveshaper",k)})(timbre);
(function(i){function k(c){i.Object.call(this,1,c);c=this._;c.inMin=0;c.inMax=1;c.outMin=0;c.outMax=1;c.ar=!1;this.once("init",h)}var g=i.fn;g.extend(k);var h=function(){this._.warp||(this.warp="linlin")},f=k.prototype;Object.defineProperties(f,{inMin:{set:function(c){"number"===typeof c&&(this._.inMin=c)},get:function(){return this._.inMin}},inMax:{set:function(c){"number"===typeof c&&(this._.inMax=c)},get:function(){return this._.inMax}},outMin:{set:function(c){"number"===typeof c&&(this._.outMin=
c)},get:function(){return this._.outMin}},outMax:{set:function(c){"number"===typeof c&&(this._.outMax=c)},get:function(){return this._.outMax}},warp:{set:function(c){if("string"===typeof c){var b=e[c];b&&(this._.warp=b,this._.warpName=c)}},get:function(){return this._.warpName}}});f.process=function(c){var b=this._,a=this.cells[0];if(this.tickID!==c){this.tickID=c;var d=b.inMin,e=b.inMax,f=b.outMin,h=b.outMax,i=b.warp,k=this.nodes.length,u=b.mul,m=b.add,c=a.length;if(b.ar&&k){g.inputSignalAR(this);
for(b=0;b<c;++b)a[b]=i(a[b],d,e,f,h)*u+m;g.outputSignalAR(this)}else{b=this.nodes.length?g.inputSignalKR(this):0;d=i(b,d,e,f,h)*u+m;for(b=0;b<c;++b)a[b]=d}}return this};var e={linlin:function(c,b,a,d,e){return c<b?d:c>a?e:a===b?d:(c-b)/(a-b)*(e-d)+d},linexp:function(c,b,a,d,e){return c<b?d:c>a?e:0===d?0:a===b?e:Math.pow(e/d,(c-b)/(a-b))*d},explin:function(c,b,a,d,e){return c<b?d:c>a?e:0===b?e:Math.log(c/b)/Math.log(a/b)*(e-d)+d},expexp:function(c,b,a,d,e){return c<b?d:c>a?e:0===b||0===d?0:Math.pow(e/
d,Math.log(c/b)/Math.log(a/b))*d}};g.register("zmap",k)})(timbre);
