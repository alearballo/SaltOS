(function(i){var h=function(){return o.apply(null,arguments)},g=Array.prototype.slice,k=0,e=1,d=[8E3,11025,12E3,16E3,22050,24E3,32E3,44100,48E3],c=[32,64,128,256],b=null,a={},f={},j="undefined"!==typeof window?"browser":"undefined"!==typeof module&&module.exports?"node":"unknown",l="browser"===j&&/(iPhone|iPad|iPod|Android)/i.test(navigator.userAgent),p=!1,n=120,o=function(){var b=g.call(arguments),c=b[0],j,d;switch(typeof c){case "string":if(a[c])j=new a[c](b.slice(1));else if(f[c])j=f[c](b.slice(1));
else if(d=/^(.+?)(?:\.(ar|kr))?$/.exec(c))if(c=d[1],a[c]?j=new a[c](b.slice(1)):f[c]&&(j=f[c](b.slice(1))),j&&d[2])j[d[2]]();break;case "number":j=new B(b);break;case "boolean":j=new E(b);break;case "function":j=new C(b);break;case "object":if(null!==c){if(c instanceof t)return c;if(c.context instanceof t)return c.context;q(c)?j=new I(b):u(c)&&(j=new J(b))}}j===i&&(j=new z(b.slice(1)),console.warn('T("'+c+'") is not defined.'));b=j._;b.originkey=c;c=b;d=j._.meta;for(var e,l,p=j;null!==p&&p.constructor!==
Object;){e=Object.getOwnPropertyNames(p);for(var n=0,m=e.length;n<m;++n)if(!d[e[n]])if(/^(constructor$|process$|_)/.test(e[n]))d[e[n]]="ignore";else if(l=Object.getOwnPropertyDescriptor(p,e[n]),"function"===typeof l.value)d[e[n]]="function";else if(l.get||l.set)d[e[n]]="property";p=Object.getPrototypeOf(p)}c.meta=d;b.emit("init");return j};Object.defineProperties(h,{version:{value:"14.06.23"},envtype:{value:j},envmobile:{value:l},env:{get:function(){return b.impl.env}},samplerate:{get:function(){return b.samplerate}},
channels:{get:function(){return b.channels}},cellsize:{get:function(){return b.cellsize}},currentTime:{get:function(){return b.currentTime}},isPlaying:{get:function(){return b.status===e}},isRecording:{get:function(){return 3===b.status}},amp:{set:function(a){"number"===typeof a&&(b.amp=a)},get:function(){return b.amp}},bpm:{set:function(a){"number"===typeof a&&5<=a&&300>=a&&(n=a)},get:function(){return n}}});h.bind=function(a,f){b.bind(a,f);return h};h.setup=function(a){b.setup(a);return h};h.play=
function(){b.play();return h};h.pause=function(){b.pause();return h};h.reset=function(){b.reset();b.events.emit("reset");return h};h.on=h.addListener=function(a,f){b.on(a,f);return h};h.once=function(a,f){b.once(a,f);return h};h.off=h.removeListener=function(a,f){b.off(a,f);return h};h.removeAllListeners=function(a){b.removeAllListeners(a);return h};h.listeners=function(a){return b.listeners(a)};h.rec=function(){return b.rec.apply(b,arguments)};h.timevalue=function(){var a=function(a){var f=n;if(a=
/^bpm(\d+(?:\.\d+)?)/i.exec(a))f=Math.max(5,Math.min(300,+(a[1]||0)));return f};return function(f){var b,c;if(b=/^(\d+(?:\.\d+)?)Hz$/i.exec(f))return 0===+b[1]?0:1E3/+b[1];if(b=/L(\d+)?(\.*)$/i.exec(f))return f=1E3*60/a(f)*(4/(b[1]||4)),f*=[1,1.5,1.75,1.875][(b[2]||"").length]||1;if(b=/^(\d+(?:\.\d+)?|\.(?:\d+))(min|sec|m)s?$/i.exec(f))switch(b[2]){case "min":return 6E4*+(b[1]||0);case "sec":return 1E3*+(b[1]||0);case "m":return+(b[1]||0)}return(b=/^(?:([0-5]?[0-9]):)?(?:([0-5]?[0-9]):)(?:([0-5]?[0-9]))(?:\.([0-9]{1,3}))?$/.exec(f))?
(c=3600*(b[1]||0)+60*(b[2]||0)+(b[3]||0),c=1E3*c+(((b[4]||"")+"00").substr(0,3)|0)):(b=/(\d+)\.(\d+)\.(\d+)$/i.exec(f))?(c=480*(4*b[1]+ +b[2])+ +b[3],1E3*60/a(f)*(c/480)):(b=/(\d+)ticks$/i.exec(f))?1E3*60/a(f)*(b[1]/480):(b=/^(\d+)samples(?:\/(\d+)Hz)?$/i.exec(f))?1E3*b[1]/(b[2]||h.samplerate):0}}();var m=h.fn={SignalArray:Float32Array,currentTimeIncr:0,emptycell:null,FINISHED_STATE:k,PLAYING_STATE:e,UNSCHEDULED_STATE:2,SCHEDULED_STATE:3},u=m.isArray=Array.isArray,q=m.isDictionary=function(a){return"object"===
typeof a&&a.constructor===Object};m.nop=function(){return this};m.isSignalArray=function(a){return a instanceof m.SignalArray||Array.isArray(a)&&a.__klass&&2===a.__klass.type?!0:!1};m.extend=function(a,b){function f(){this.constructor=a}var b=b||t,c;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);f.prototype=b.prototype;a.prototype=new f;a.__super__=b.prototype;return a};m.constructorof=function(a,b){for(var f=a&&a.prototype;f;){if(f===b.prototype)return!0;f=Object.getPrototypeOf(f)}return!1};m.register=
function(b,c){m.constructorof(c,t)?a[b]=c:f[b]=c};m.alias=function(b,c){a[c]?a[b]=a[c]:f[c]&&(f[b]=f[c])};m.getClass=function(b){return a[b]};m.pointer=function(a,b,f){b=a.byteOffset+b*a.constructor.BYTES_PER_ELEMENT;return"number"===typeof f?new a.constructor(a.buffer,b,f):new a.constructor(a.buffer,b)};m.nextTick=function(a){b.nextTick(a);return h};m.fixAR=function(a){a._.ar=!0;a._.aronly=!0};m.fixKR=function(a){a._.ar=!1;a._.kronly=!0};m.changeWithValue=function(){var a=this._,a=a.value*a.mul+
a.add;isNaN(a)&&(a=0);for(var b=this.cells[0],f=0,c=b.length;f<c;++f)b[f]=a};m.changeWithValue.unremovable=!0;m.clone=function(a){var b=new a.constructor([]);b._.ar=a._.ar;b._.mul=a._.mul;b._.add=a._.add;b._.bypassed=a._.bypassed;return b};m.timer=function(){var a=function(a){return function(){-1===b.timers.indexOf(a)&&(b.timers.push(a),b.events.emit("addObject"),a._.emit("start"),m.buddies_start(a))}},f=function(a){return function(){var f=b.timers.indexOf(a);-1!==f&&(b.timers.splice(f,1),a._.emit("stop"),
b.events.emit("removeObject"),m.buddies_stop(a))}};return function(c){var j=a(c),d=f(c);c.nodeType=t.TIMER;c.start=function(){b.nextTick(j);return c};c.stop=function(){b.nextTick(d);return c};return c}}();m.listener=function(){var a=function(a){return function(){-1===b.listeners.indexOf(a)&&(b.listeners.push(a),b.events.emit("addObject"),a._.emit("listen"),m.buddies_start(a))}},f=function(a){return function(){var f=b.listeners.indexOf(a);-1!==f&&(b.listeners.splice(f,1),a._.emit("unlisten"),b.events.emit("removeObject"),
m.buddies_stop(a))}};return function(c){var j=a(c),d=f(c);c.nodeType=t.LISTENER;c.listen=function(a){arguments.length&&c.append.apply(c,arguments);c.nodes.length&&b.nextTick(j);return c};c.unlisten=function(){arguments.length&&c.remove.apply(c,arguments);c.nodes.length||b.nextTick(d);return c};return c}}();m.make_onended=function(a,b){return function(){a.playbackState=k;if("number"===typeof b)for(var f=a.cells[0],c=a.cells[1],j=a.cells[2],d=0,e=c.length;d<e;++d)f[0]=c[d]=j[d]=b;a._.emit("ended")}};
m.inputSignalAR=function(a){var b=a.cells[0],f=a.cells[1],c=a.cells[2],j=a.nodes,d=j.length,l,p=b.length,g=a.tickID,n,o;if(2===a.numChannels){n=!0;if(0!==d){for(a=0;a<d;++a)if(j[a].playbackState===e){j[a].process(g);f.set(j[a].cells[1]);c.set(j[a].cells[2]);n=!1;++a;break}for(;a<d;++a)if(j[a].playbackState===e){j[a].process(g);b=j[a].cells[1];o=j[a].cells[2];for(l=p;l;)l-=8,f[l]+=b[l],c[l]+=o[l],f[l+1]+=b[l+1],c[l+1]+=o[l+1],f[l+2]+=b[l+2],c[l+2]+=o[l+2],f[l+3]+=b[l+3],c[l+3]+=o[l+3],f[l+4]+=b[l+
4],c[l+4]+=o[l+4],f[l+5]+=b[l+5],c[l+5]+=o[l+5],f[l+6]+=b[l+6],c[l+6]+=o[l+6],f[l+7]+=b[l+7],c[l+7]+=o[l+7]}}n&&(f.set(m.emptycell),c.set(m.emptycell))}else{n=!0;if(0!==d){for(a=0;a<d;++a)if(j[a].playbackState===e){j[a].process(g);b.set(j[a].cells[0]);n=!1;++a;break}for(;a<d;++a)if(j[a].playbackState===e){f=j[a].process(g).cells[0];for(l=p;l;)l-=8,b[l]+=f[l],b[l+1]+=f[l+1],b[l+2]+=f[l+2],b[l+3]+=f[l+3],b[l+4]+=f[l+4],b[l+5]+=f[l+5],b[l+6]+=f[l+6],b[l+7]+=f[l+7]}}n&&b.set(m.emptycell)}};m.inputSignalKR=
function(a){for(var b=a.nodes,f=b.length,c=a.tickID,j=0,a=0;a<f;++a)b[a].playbackState===e&&(j+=b[a].process(c).cells[0][0]);return j};m.outputSignalAR=function(a){var b=a.cells[0],f=a.cells[1],c=a.cells[2],j=a._.mul,d=a._.add;if(2===a.numChannels)for(a=b.length;a;)a-=8,f[a]=f[a]*j+d,c[a]=c[a]*j+d,f[a+1]=f[a+1]*j+d,c[a+1]=c[a+1]*j+d,f[a+2]=f[a+2]*j+d,c[a+2]=c[a+2]*j+d,f[a+3]=f[a+3]*j+d,c[a+3]=c[a+3]*j+d,f[a+4]=f[a+4]*j+d,c[a+4]=c[a+4]*j+d,f[a+5]=f[a+5]*j+d,c[a+5]=c[a+5]*j+d,f[a+6]=f[a+6]*j+d,c[a+
6]=c[a+6]*j+d,f[a+7]=f[a+7]*j+d,c[a+7]=c[a+7]*j+d,b[a]=0.5*(f[a]+c[a]),b[a+1]=0.5*(f[a+1]+c[a+1]),b[a+2]=0.5*(f[a+2]+c[a+2]),b[a+3]=0.5*(f[a+3]+c[a+3]),b[a+4]=0.5*(f[a+4]+c[a+4]),b[a+5]=0.5*(f[a+5]+c[a+5]),b[a+6]=0.5*(f[a+6]+c[a+6]),b[a+7]=0.5*(f[a+7]+c[a+7]);else if(1!==j||0!==d)for(a=b.length;a;)a-=8,b[a]=b[a]*j+d,b[a+1]=b[a+1]*j+d,b[a+2]=b[a+2]*j+d,b[a+3]=b[a+3]*j+d,b[a+4]=b[a+4]*j+d,b[a+5]=b[a+5]*j+d,b[a+6]=b[a+6]*j+d,b[a+7]=b[a+7]*j+d};m.outputSignalKR=function(a){var b=a.cells[0],f=a.cells[1],
c=a.cells[2],j=b[0]*a._.mul+a._.add;if(2===a.numChannels)for(a=b.length;a;)a-=8,b[a]=b[a+1]=b[a+2]=b[a+3]=b[a+4]=b[a+5]=b[a+6]=b[a+7]=f[a]=f[a+1]=f[a+2]=f[a+3]=f[a+4]=f[a+5]=f[a+6]=f[a+7]=c[a]=c[a+1]=c[a+2]=c[a+3]=c[a+4]=c[a+5]=c[a+6]=c[a+7]=j;else for(a=b.length;a;)a-=8,b[a]=b[a+1]=b[a+2]=b[a+3]=b[a+4]=b[a+5]=b[a+6]=b[a+7]=j};m.buddies_start=function(a){var a=a._.buddies,b,f,c;f=0;for(c=a.length;f<c;++f)switch(b=a[f],b.nodeType){case t.DSP:b.play();break;case t.TIMER:b.start();break;case t.LISTENER:b.listen()}};
m.buddies_stop=function(a){var a=a._.buddies,b,f,c;f=0;for(c=a.length;f<c;++f)switch(b=a[f],b.nodeType){case t.DSP:b.pause();break;case t.TIMER:b.stop();break;case t.LISTENER:b.unlisten()}};m.fix_iOS6_1_problem=function(a){b.fix_iOS6_1_problem(a)};var r=h.modules={},s=r.EventEmitter=function(){function a(b){this.context=b;this.events={}}var b=a.prototype;b.emit=function(a){var b=this.events[a];if(!b)return!1;var f;if("function"===typeof b){switch(arguments.length){case 1:b.call(this.context);break;
case 2:b.call(this.context,arguments[1]);break;case 3:b.call(this.context,arguments[1],arguments[2]);break;default:f=g.call(arguments,1),b.apply(this.context,f)}return!0}if(u(b)){f=g.call(arguments,1);for(var b=b.slice(),c=0,j=b.length;c<j;++c)b[c]instanceof t?b[c].bang.apply(b[c],f):b[c].apply(this.context,f);return!0}if(b instanceof t)f=g.call(arguments,1),b.bang.apply(b,f);else return!1};b.on=function(a,b){if("function"!==typeof b&&!(b instanceof t))throw Error("addListener takes instances of Function or timbre.Object");
var f=this.events;f[a]?u(f[a])?f[a].push(b):f[a]=[f[a],b]:f[a]=b;return this};b.once=function(a,b){var f=this,c;if("function"===typeof b)c=function(){f.off(a,c);b.apply(f.context,arguments)};else if(b instanceof t)c=function(){f.off(a,c);b.bang.apply(b,arguments)};else throw Error("once takes instances of Function or timbre.Object");c.listener=b;f.on(a,c);return this};b.off=function(a,b){if("function"!==typeof b&&!(b instanceof t))throw Error("removeListener takes instances of Function or timbre.Object");
var f=this.events;if(!f[a])return this;var c=f[a];if(u(c)){for(var j=-1,d=0,l=c.length;d<l;++d)if(c[d]===b||c[d].listener&&c[d].listener===b){j=d;break}if(0>j)return this;c.splice(j,1);0===c.length&&(f[a]=null)}else if(c===b||c.listener&&c.listener===b)f[a]=null;return this};b.removeAllListeners=function(a){var b=this.events,f=!1,c=b[a];if(u(c))for(var j=c.length;j--;){var d=c[j];d.unremovable?f=!0:this.off(a,d)}else c&&(c.unremovable?f=!0:this.off(a,c));f||(b[a]=null);return this};b.listeners=function(a){var b=
this.events;if(!b[a])return[];b=b[a];if(!u(b))return b.unremovable?[]:[b];for(var b=b.slice(),a=[],f=0,c=b.length;f<c;++f)b[f].unremovable||a.push(b[f]);return a};return a}(),v=r.Deferred=function(){function a(f){this.context=f||this;this._state="pending";this._doneList=[];this._failList=[];this._promise=new b(this)}function b(a){this.context=a.context;this.then=a.then;this.done=function(){a.done.apply(a,arguments);return this};this.fail=function(){a.fail.apply(a,arguments);return this};this.pipe=
function(){return a.pipe.apply(a,arguments)};this.always=function(){a.always.apply(a,arguments);return this};this.promise=function(){return this};this.isResolved=function(){return a.isResolved()};this.isRejected=function(){return a.isRejected()}}var f=a.prototype,c=function(a,b,f,c){if("pending"===this._state){this._state=a;for(var a=0,j=b.length;a<j;++a)b[a].apply(f,c);this._doneList=this._failList=null}},j=function(a){return a&&"function"===typeof a.promise};f.resolve=function(){var a=g.call(arguments,
0);c.call(this,"resolved",this._doneList,this.context||this,a);return this};f.resolveWith=function(a){var b=g.call(arguments,1);c.call(this,"resolved",this._doneList,a,b);return this};f.reject=function(){var a=g.call(arguments,0);c.call(this,"rejected",this._failList,this.context||this,a);return this};f.rejectWith=function(a){var b=g.call(arguments,1);c.call(this,"rejected",this._failList,a,b);return this};f.promise=function(){return this._promise};f.done=function(){for(var a=g.call(arguments),b=
"resolved"===this._state,f="pending"===this._state,c=this._doneList,j=0,d=a.length;j<d;++j)if("function"===typeof a[j])if(b)a[j]();else f&&c.push(a[j]);return this};f.fail=function(){for(var a=g.call(arguments),b="rejected"===this._state,f="pending"===this._state,c=this._failList,j=0,d=a.length;j<d;++j)if("function"===typeof a[j])if(b)a[j]();else f&&c.push(a[j]);return this};f.always=function(){this.done.apply(this,arguments);this.fail.apply(this,arguments);return this};f.then=function(a,b){return this.done(a).fail(b)};
f.pipe=function(b,f){var c=this,d=new a(this.context);this.done(function(){var a=b.apply(c.context,arguments);j(a)?a.then(function(){var b=g.call(arguments);d.resolveWith.apply(d,[a].concat(b))}):d.resolveWith(c,a)});this.fail(function(){if("function"===typeof f){var a=f.apply(c.context,arguments);j(a)&&a.fail(function(){var b=g.call(arguments);d.rejectWith.apply(d,[a].concat(b))})}else d.reject.apply(d,arguments)});return d.promise()};f.isResolved=function(){return"resolved"===this._state};f.isRejected=
function(){return"rejected"===this._state};f.state=function(){return this._state};a.when=function(b){var f=0,c=g.call(arguments),d=c.length,l=d;1===d&&!j(b)&&(l=0);var e=1===l?b:new a,p=function(a,b){return function(f){b[a]=1<arguments.length?g.call(arguments):f;--l||e.resolve.apply(e,b)}};if(1<d)for(var n=Array(d),m=function(){e.reject()};f<d;++f)c[f]&&j(c[f])?c[f].promise().done(p(f,n)).fail(m):(n[f]=c[f],--l);l||e.resolve.apply(e,c);return e.promise()};return a}(),t=h.Object=function(){function a(f,
c){this._={};var j=this._.events=new s(this);this._.emit=function(){return j.emit.apply(j,arguments)};if(q(c[0])){var d=c.shift(),l=d["in"];this.once("init",function(){this.set(d);l&&(u(l)?this.append.apply(this,l):l instanceof a&&this.append(l))})}this.tickID=-1;this.nodes=c.map(h);this.cells=[];this.numChannels=f;switch(f){case 0:this.L=this.R=new w(null);this.cells[0]=this.cells[1]=this.cells[2]=this.L.cell;break;case 1:this.L=this.R=new w(this);this.cells[0]=this.cells[1]=this.cells[2]=this.L.cell;
break;case 2:this.L=new w(this),this.R=new w(this),this.cells[0]=new m.SignalArray(b.cellsize),this.cells[1]=this.L.cell,this.cells[2]=this.R.cell}this.playbackState=e;this.nodeType=a.DSP;this._.ar=!0;this._.mul=1;this._.add=0;this._.dac=null;this._.bypassed=!1;this._.meta={};this._.samplerate=b.samplerate;this._.cellsize=b.cellsize;this._.buddies=[]}a.DSP=1;a.TIMER=2;a.LISTENER=3;var f=a.prototype;Object.defineProperties(f,{isAr:{get:function(){return this._.ar}},isKr:{get:function(){return!this._.ar}},
isBypassed:{get:function(){return this._.bypassed}},isEnded:{get:function(){return!(this.playbackState&1)}},mul:{set:function(a){"number"===typeof a&&(this._.mul=a,this._.emit("setMul",a))},get:function(){return this._.mul}},add:{set:function(a){"number"===typeof a&&(this._.add=a,this._.emit("setAdd",a))},get:function(){return this._.add}},buddies:{set:function(b){u(b)||(b=[b]);this._.buddies=b.filter(function(b){return b instanceof a})},get:function(){return this._.buddies}}});f.toString=function(){return this.constructor.name};
f.valueOf=function(){b.tickID!==this.tickID&&this.process(b.tickID);return this.cells[0][0]};f.append=function(){if(0<arguments.length){var a=g.call(arguments).map(h);this.nodes=this.nodes.concat(a);this._.emit("append",a)}return this};f.appendTo=function(a){a.append(this);return this};f.remove=function(){if(0<arguments.length){for(var a,b=this.nodes,f=[],c=0,j=arguments.length;c<j;++c)if(-1!==(a=b.indexOf(arguments[c])))f.push(b[a]),b.splice(a,1);0<f.length&&this._.emit("remove",f)}return this};
f.removeFrom=function(a){a.remove(this);return this};f.removeAll=function(){var a=this.nodes.slice();this.nodes=[];0<a.length&&this._.emit("remove",a);return this};f.removeAtIndex=function(a){var b=this.nodes[a];b&&(this.nodes.splice(a,1),this._.emit("remove",[b]));return this};f.postMessage=function(a){this._.emit("message",a);return this};f.to=function(b){if(b instanceof a)b.append(this);else{var f=g.call(arguments);q(f[1])?f.splice(2,0,this):f.splice(1,0,this);b=o.apply(null,f)}return b};f.splice=
function(b,f,c){f?f instanceof a&&(c=f.nodes.indexOf(c),-1!==c&&f.nodes.splice(c,1),b instanceof a?(b.nodes.push(this),f.nodes.push(b)):f.nodes.push(this)):this._.dac&&(b instanceof a?c instanceof a?c._.dac&&(c._.dac._.node=b,b._.dac=c._.dac,c._.dac=null,b.nodes.push(this)):this._.dac&&(this._.dac._.node=b,b._.dac=this._.dac,this._.dac=null,b.nodes.push(this)):c instanceof a&&c._.dac&&(c._.dac._.node=this,this._.dac=c._.dac,c._.dac=null));return this};f.on=f.addListener=function(a,b){this._.events.on(a,
b);return this};f.once=function(a,b){this._.events.once(a,b);return this};f.off=f.removeListener=function(a,b){this._.events.off(a,b);return this};f.removeAllListeners=function(a){this._.events.removeAllListeners(a);return this};f.listeners=function(a){return this._.events.listeners(a)};f.set=function(a,b){var f,c,j=this._.meta;switch(typeof a){case "string":switch(j[a]){case "property":this[a]=b;break;case "function":this[a](b);break;default:for(f=this;null!==f;){if(c=Object.getOwnPropertyDescriptor(f,
a))if("function"===typeof c.value)j[a]="function",this[a](b);else if(c.get||c.set)j[a]="property",this[a]=b;f=Object.getPrototypeOf(f)}}break;case "object":for(f in a)this.set(f,a[f])}return this};f.get=function(a){if("property"===this._.meta[a])return this[a]};f.bang=function(){this._.emit.apply(this,["bang"].concat(g.call(arguments)));return this};f.process=m.nop;f.bypass=function(){this._.bypassed=0===arguments.length?!0:!!arguments[0];return this};f.play=function(){var a=this._.dac;null===a&&
(a=this._.dac=new G(this));a.play()&&this._.emit.apply(this,["play"].concat(g.call(arguments)));m.buddies_start(this);return this};f.pause=function(){var a=this._.dac;a&&a.playbackState===e&&(a.pause(),this._.dac=null,this._.emit("pause"));m.buddies_stop(this);return this};f.start=f.stop=f.listen=f.unlisten=function(){return this};f.ar=function(){0===arguments.length||arguments[0]?this._.kronly||(this._.ar=!0,this._.emit("ar",!0)):this.kr(!0);return this};f.kr=function(){0===arguments.length||arguments[0]?
this._.aronly||(this._.ar=!1,this._.emit("ar",!1)):this.ar(!0);return this};f.plot="browser"===j?function(a){var b=this._,f=a.target;if(!f)return this;var c=a.width||f.width||320,j=a.height||f.height||240,d=(a.x||0)+0.5,l=a.y||0,f=f.getContext("2d"),e;e=a.foreground!==i?a.foreground:b.plotForeground||"rgb(  0, 128, 255)";var p;p=a.background!==i?a.background:b.plotBackground||"rgb(255, 255, 255)";var g=a.lineWidth||b.plotLineWidth||1,n=!!b.plotCyclic,m=b.plotData||this.cells[0],o=a.range||b.plotRange||
[-1.2,1.2],k=o[0],o=j/(o[1]-k),h=c/m.length,u,q=m.length;f.save();f.rect(d,l,c,j);null!==p&&(f.fillStyle=p,f.fillRect(d,l,c,j));b.plotBefore&&b.plotBefore.call(this,f,d,l,c,j);if(b.plotBarStyle){f.fillStyle=e;for(p=e=0;p<q;++p)n=(m[p]-k)*o,u=j-n,f.fillRect(e+d,u+l,h,n),e+=h}else{f.strokeStyle=e;f.lineWidth=g;f.beginPath();e=0;g=j-(m[0]-k)*o;f.moveTo(e+d,g+l);for(p=1;p<q;++p)e+=h,u=j-(m[p]-k)*o,f.lineTo(e+d,u+l);n?f.lineTo(e+h+d,g+l):f.lineTo(e+h+d,u+l);f.stroke()}b.plotAfter&&b.plotAfter.call(this,
f,d,l,c,j);if(a=a.border||b.plotBorder)f.strokeStyle="string"===typeof a?a:"#000",f.lineWidth=1,f.strokeRect(d,l,c,j);f.restore();return this}:m.nop;return a}(),w=h.ChannelObject=function(){function a(f){h.Object.call(this,-1,[]);m.fixAR(this);this._.parent=f;this.cell=new m.SignalArray(b.cellsize);this.L=this.R=this;this.cells[0]=this.cells[1]=this.cells[2]=this.cell;this.numChannels=1}m.extend(a);a.prototype.process=function(a){this.tickID!==a&&(this.tickID=a,this._.parent&&this._.parent.process(a));
return this};return a}(),z=function(){function a(b){t.call(this,2,b)}m.extend(a);a.prototype.process=function(a){var b=this._;this.tickID!==a&&(this.tickID=a,b.ar?(m.inputSignalAR(this),m.outputSignalAR(this)):(this.cells[0][0]=m.inputSignalKR(this),m.outputSignalKR(this)));return this};m.register("+",a);return a}(),B=function(){function a(b){t.call(this,1,[]);m.fixKR(this);this.value=b[0];if(q(b[1])){var f=b[1];this.once("init",function(){this.set(f)})}this.on("setAdd",m.changeWithValue);this.on("setMul",
m.changeWithValue)}m.extend(a);Object.defineProperties(a.prototype,{value:{set:function(a){"number"===typeof a&&(this._.value=isNaN(a)?0:a,m.changeWithValue.call(this))},get:function(){return this._.value}}});return a}(),E=function(){function a(b){t.call(this,1,[]);m.fixKR(this);this.value=b[0];if(q(b[1])){var f=b[1];this.once("init",function(){this.set(f)})}this.on("setAdd",m.changeWithValue);this.on("setMul",m.changeWithValue)}m.extend(a);Object.defineProperties(a.prototype,{value:{set:function(a){this._.value=
a?1:0;m.changeWithValue.call(this)},get:function(){return!!this._.value}}});return a}(),C=function(){function a(b){t.call(this,1,[]);m.fixKR(this);this.func=b[0];this._.value=0;if(q(b[1])){var f=b[1];this.once("init",function(){this.set(f)})}this.on("setAdd",m.changeWithValue);this.on("setMul",m.changeWithValue)}m.extend(a);var b=a.prototype;Object.defineProperties(b,{func:{set:function(a){"function"===typeof a&&(this._.func=a)},get:function(){return this._.func}},args:{set:function(a){this._.args=
u(a)?a:[a]},get:function(){return this._.args}}});b.bang=function(){var a=this._,b=g.call(arguments).concat(a.args),b=a.func.apply(this,b);"number"===typeof b&&(a.value=b,m.changeWithValue.call(this));this._.emit("bang");return this};return a}(),J=function(){function a(b){t.call(this,1,[]);var f,c;f=0;for(c=b[0].length;f<c;++f)this.append(b[0][f]);if(q(b[1])){var j=b[1];this.once("init",function(){this.set(j)})}}m.extend(a);var b=a.prototype;Object.defineProperties(b,{});b.bang=function(){var a=["bang"].concat(g.call(arguments)),
b=this.nodes,f,c;f=0;for(c=b.length;f<c;++f)b[f].bang.apply(b[f],a);return this};b.postMessage=function(a){var b=this.nodes,f,c;f=0;for(c=b.length;f<c;++f)b[f].postMessage(a);return this};b.process=function(a){var b=this._;this.tickID!==a&&(this.tickID=a,b.ar?(m.inputSignalAR(this),m.outputSignalAR(this)):(this.cells[0][0]=m.inputSignalKR(this),m.outputSignalKR(this)));return this};return a}(),I=function(){function a(b){t.call(this,1,[]);m.fixKR(this);if(q(b[1])){var f=b[1];this.once("init",function(){this.set(f)})}}
m.extend(a);Object.defineProperties(a.prototype,{});return a}(),G=function(){function a(b){t.call(this,2,[]);this.playbackState=k;var j=this._;j.node=b;j.onplay=f(this);j.onpause=c(this)}m.extend(a);var f=function(a){return function(){-1===b.inlets.indexOf(a)&&(b.inlets.push(a),b.events.emit("addObject"),a.playbackState=e,a._.emit("play"))}},c=function(a){return function(){var f=b.inlets.indexOf(a);-1!==f&&(b.inlets.splice(f,1),a.playbackState=k,a._.emit("pause"),b.events.emit("removeObject"))}},
j=a.prototype;j.play=function(){b.nextTick(this._.onplay);return-1===b.inlets.indexOf(this)};j.pause=function(){b.nextTick(this._.onpause)};j.process=function(a){var b=this._.node;b.playbackState&1?(b.process(a),this.cells[1].set(b.cells[1]),this.cells[2].set(b.cells[2])):(this.cells[1].set(m.emptycell),this.cells[2].set(m.emptycell))};return a}(),r=function(){function a(){this.context=this;this.tickID=0;this.impl=null;this.amp=0.8;this.status=k;this.samplerate=44100;this.channels=2;this.cellsize=
64;this.streammsec=20;this.currentTime=this.streamsize=0;this.nextTicks=[];this.inlets=[];this.timers=[];this.listeners=[];this.deferred=null;this.recStart=0;this.recBuffers=null;this.delayProcess=b(this);this.events=null;m.currentTimeIncr=1E3*this.cellsize/this.samplerate;m.emptycell=new m.SignalArray(this.cellsize);this.reset(!0)}var b=function(a){return function(){a.recStart=Date.now();a.process()}},f=a.prototype;f.bind=function(a,b){"function"===typeof a&&(this.impl=new a(this,b),this.impl.defaultSamplerate&&
(this.samplerate=this.impl.defaultSamplerate));return this};f.setup=function(a){if("object"===typeof a&&(-1!==d.indexOf(a.samplerate)&&(this.samplerate=a.samplerate<=this.impl.maxSamplerate?a.samplerate:this.impl.maxSamplerate),-1!==c.indexOf(a.cellsize)&&(this.cellsize=a.cellsize),"undefined"!==typeof Float64Array&&"undefined"!==typeof a.f64))p=!!a.f64,m.SignalArray=p?Float64Array:Float32Array;m.currentTimeIncr=1E3*this.cellsize/this.samplerate;m.emptycell=new m.SignalArray(this.cellsize);return this};
f.getAdjustSamples=function(a){a=a||this.samplerate;a=Math.ceil(Math.log(this.streammsec/1E3*a)*Math.LOG2E);return 1<<(8>a?8:14<a?14:a)};f.play=function(){this.status===k&&(this.status=e,this.streamsize=this.getAdjustSamples(),this.strmL=new m.SignalArray(this.streamsize),this.strmR=new m.SignalArray(this.streamsize),this.impl.play(),this.events.emit("play"));return this};f.pause=function(){this.status===e&&(this.status=k,this.impl.pause(),this.events.emit("pause"));return this};f.reset=function(a){a&&
(this.events=(new s(this)).on("addObject",function(){this.status===k&&this.play()}).on("removeObject",function(){this.status===e&&0===this.inlets.length+this.timers.length+this.listeners.length&&this.pause()}));this.currentTime=0;this.nextTicks=[];this.inlets=[];this.timers=[];this.listeners=[];return this};f.process=function(){var a=this.tickID,b=this.strmL,f=this.strmR,c=this.amp,j,d,l,e=this.streamsize,p=0,g,n,o,k=this.cellsize,h=this.streamsize/this.cellsize,i=this.timers,u=this.inlets,q=this.listeners,
r=m.currentTimeIncr;for(l=0;l<e;++l)b[l]=f[l]=0;for(;h--;){++a;g=0;for(n=i.length;g<n;++g)i[g].playbackState&1&&i[g].process(a);g=0;for(n=u.length;g<n;++g)if(j=u[g],j.process(a),j.playbackState&1){d=j.cells[1];j=j.cells[2];o=0;for(l=p;o<k;++o,++l)b[l]+=d[o],f[l]+=j[o]}p+=k;g=0;for(n=q.length;g<n;++g)q[g].playbackState&1&&q[g].process(a);this.currentTime+=r;l=this.nextTicks.splice(0);g=0;for(n=l.length;g<n;++g)l[g]()}for(l=0;l<e;++l)j=b[l]*c,-1>j?j=-1:1<j&&(j=1),b[l]=j,j=f[l]*c,-1>j?j=-1:1<j&&(j=1),
f[l]=j;this.tickID=a;a=this.currentTime;if(3===this.status){if(2===this.recCh)this.recBuffers.push(new m.SignalArray(b)),this.recBuffers.push(new m.SignalArray(f));else{c=new m.SignalArray(b.length);l=0;for(e=c.length;l<e;++l)c[l]=0.5*(b[l]+f[l]);this.recBuffers.push(c)}a>=this.maxDuration?this.deferred.sub.reject():a>=this.recDuration?this.deferred.sub.resolve():20<Date.now()-this.recStart?setTimeout(this.delayProcess,10):this.process()}};f.nextTick=function(a){this.status===k?a():this.nextTicks.push(a)};
f.rec=function(){m.fix_iOS6_1_problem(!0);var a=new v(this);if(this.deferred)return console.warn("rec deferred is exists??"),a.reject().promise();if(this.status!==k)return console.log("status is not none",this.status),a.reject().promise();var b=0,f=arguments,c=q(f[b])?f[b++]:{},b=f[b];if("function"!==typeof b)return console.warn("no function"),a.reject().promise();this.deferred=a;this.status=3;this.reset();var d=new o("+"),l=new v(this),e=this;l.then(j,function(){m.fix_iOS6_1_problem(!1);j.call(e,
!0)});this.deferred.sub=l;this.savedSamplerate=this.samplerate;this.samplerate=c.samplerate||this.samplerate;this.recDuration=c.recDuration||Infinity;this.maxDuration=c.maxDuration||6E5;this.recCh=c.ch||1;2!==this.recCh&&(this.recCh=1);this.recBuffers=[];this.streamsize=this.getAdjustSamples();this.strmL=new m.SignalArray(this.streamsize);this.strmR=new m.SignalArray(this.streamsize);this.inlets.push(d);b({done:function(){l.resolve.apply(l,g.call(arguments))},send:function(){d.append.apply(d,arguments)}});
setTimeout(this.delayProcess,10);return a.promise()};var j=function(){this.status=k;this.reset();var a=this.recBuffers,b=this.samplerate,f=this.streamsize,c;this.samplerate=this.savedSamplerate;c=Infinity!==this.recDuration?0.001*this.recDuration*b|0:(a.length>>this.recCh-1)*f;var j,d=c/f|0,l=0,e=0,p=c;if(2===this.recCh){var g=new m.SignalArray(c),n=new m.SignalArray(c),o=new m.SignalArray(c);for(j=0;j<d;++j)if(g.set(a[l++],e),n.set(a[l++],e),e+=f,p-=f,0<p&&p<f){g.set(a[l++].subarray(0,p),e);n.set(a[l++].subarray(0,
p),e);break}j=0;for(d=c;j<d;++j)o[j]=0.5*(g[j]+n[j]);a={samplerate:b,channels:2,buffer:[o,g,n]}}else{c=new m.SignalArray(c);for(j=0;j<d;++j)if(c.set(a[l++],e),e+=f,p-=f,0<p&&p<f){c.set(a[l++].subarray(0,p),e);break}a={samplerate:b,channels:1,buffer:[c]}}this.deferred.resolve.apply(this.deferred,[].concat.apply([a],arguments));this.deferred=null};f.on=function(a,b){this.events.on(a,b)};f.once=function(a,b){this.events.once(a,b)};f.off=function(a,b){this.events.off(a,b)};f.removeAllListeners=function(a){this.events.removeListeners(a)};
f.listeners=function(a){return this.events.listeners(a)};f.fix_iOS6_1_problem=function(a){this.impl.fix_iOS6_1_problem&&this.impl.fix_iOS6_1_problem(a)};return a}(),K=null,H=i;"undefined"!==typeof window&&(H=window.AudioContext||window.webkitAudioContext);var K="undefined"!==typeof H?function(a){var b=new H,f,c;m._audioContext=b;this.defaultSamplerate=this.maxSamplerate=b.sampleRate;this.env="webkit";var j=navigator.userAgent;j.match(/linux/i)?a.streammsec*=8:j.match(/win(dows)?\s*(nt 5\.1|xp)/i)&&
(a.streammsec*=4);this.play=function(){var j,d=a.getAdjustSamples(b.sampleRate),l=a.streamsize,e,p;if(a.samplerate===b.sampleRate)j=function(b){b=b.outputBuffer;a.process();b.getChannelData(0).set(a.strmL);b.getChannelData(1).set(a.strmR)};else if(a.samplerate*2===b.sampleRate)j=function(b){var f=a.strmL,c=a.strmR,j=b.outputBuffer,b=j.getChannelData(0),d=j.getChannelData(1),l=j.length,e;a.process();for(j=e=0;j<l;j=j+2,++e){b[j]=b[j+1]=f[e];d[j]=d[j+1]=c[e]}};else{e=l;p=a.samplerate/b.sampleRate;j=
function(b){for(var f=a.strmL,c=a.strmR,j=b.outputBuffer,b=j.getChannelData(0),d=j.getChannelData(1),g=j.length,j=0;j<g;++j){if(e>=l){a.process();e=e-l}b[j]=f[e|0];d[j]=c[e|0];e=e+p}}}f=b.createBufferSource();c=b.createScriptProcessor(d,2,a.channels);c.onaudioprocess=j;f.noteOn&&f.noteOn(0);f.connect(c);c.connect(b.destination)};this.pause=function(){f.disconnect();c.disconnect()};if(l){var d=0,e=b.createBufferSource();this.fix_iOS6_1_problem=function(a){d=d+(a?1:-1);if(d===1){e.noteOn(0);e.connect(b.destination)}else d===
0&&e.disconnect()}}}:function(){this.maxSamplerate=48E3;this.defaultSamplerate=44100;this.env="nop";this.play=function(){};this.pause=function(){}},b=(new r).bind(K),F=h;"node"===j?module.exports=global.timbre=F:"browser"===j&&(F.noConflict=function(){var a=window.timbre,b=window.T;return function(f){window.T===F&&(window.T=b);f&&window.timbre===F&&(window.timbre=a);return F}}(),window.timbre=window.T=F);(function(){if(!(b.impl.env!=="nop"||j!=="browser"||l)){var a=navigator,f;try{f=a.plugins&&a.mimeTypes&&
a.mimeTypes.length?a.plugins["Shockwave Flash"].description.match(/([0-9]+)/)[0]:(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version").match(/([0-9]+)/)[0]}catch(c){f=-1}if(!(f<10)){var d,e=function(){var a=document.getElementsByTagName("script");if(a&&a.length)for(var b,f=0,c=a.length;f<c;++f)if(b=/^(.*\/)timbre(?:\.dev)?\.js$/i.exec(a[f].src))return b[1]+"timbre.swf"}();window.timbrejs_flashfallback_init=function(){b.bind(function(a){var b=0;this.defaultSamplerate=this.maxSamplerate=
44100;this.env="flash";this.play=function(){var f,c=Array(a.streamsize*a.channels),j=a.streammsec,l=0,p=a.streamsize/a.samplerate*1E3,g=Date.now();f=function(){if(!(l>Date.now()-g)){var b=a.strmL,f=a.strmR,j=c.length,e=b.length;for(a.process();e--;){c[--j]=f[e]*32768|0;c[--j]=b[e]*32768|0}d.writeAudio(c.join(" "));l=l+p}};if(d.setup){d.setup(a.channels,a.samplerate);b=setInterval(f,j)}else console.warn("Cannot find "+e)};this.pause=function(){if(b!==0){d.cancel();clearInterval(b);b=0}}});delete window.timbrejs_flashfallback_init};
f=e+"?"+ +new Date;var p=document.createElement("div");p.id="TimbreFlashPlayerDiv";p.style.display="inline";p.width=p.height=1;if(a.plugins&&a.mimeTypes&&a.mimeTypes.length){a=document.createElement("object");a.id="TimbreFlashPlayer";a.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000";a.width=a.height=1;a.setAttribute("data",f);a.setAttribute("type","application/x-shockwave-flash");f=document.createElement("param");f.setAttribute("name","allowScriptAccess");f.setAttribute("value","always");a.appendChild(f);
p.appendChild(a)}else p.innerHTML='<object id="TimbreFlashPlayer" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="1" height="1"><param name="movie" value="'+f+'" /><param name="bgcolor" value="#FFFFFF" /><param name="quality" value="high" /><param name="allowScriptAccess" value="always" /></object>';window.addEventListener("load",function(){document.body.appendChild(p);d=document.TimbreFlashPlayer})}}})()})();
(function(i){function h(e){this.samplerate=e;this.frequency=340;this.Q=1;this.b0=this.b1=this.b2=this.a1=this.a2=this.x1R=this.x2R=this.y1R=this.y2R=this.x1L=this.x2L=this.y1L=this.y2L=this.gain=0;this.setType("lpf")}var g=h.prototype;g.process=function(e,d){var c,b,a,f=this.x1L,j=this.x2L,l=this.y1L,p=this.y2L,g=this.x1R,o=this.x2R,m=this.y1R,k=this.y2R,h=this.b0,i=this.b1,s=this.b2,v=this.a1,t=this.a2,w,z;w=0;for(z=e.length;w<z;++w)c=e[w],b=h*c+i*f+s*j-v*l-t*p,j=f,f=c,p=l,l=b,c=d[w],a=h*c+i*g+s*
o-v*m-t*k,o=g,g=c,k=m,m=a,e[w]=b,d[w]=a;this.x1L=f;this.x2L=j;this.y1L=l;this.y2L=p;this.x1R=g;this.x2R=o;this.y1R=m;this.y2R=k};g.setType=function(e){var d;if(d=k[e])this.type=e,d.call(this,this.frequency,this.Q,this.gain)};g.setParams=function(e,d,c){this.frequency=e;this.Q=d;this.gain=c;var b=k[this.type];b&&b.call(this,e,d,c);return this};var k={lowpass:function(e,d){e/=0.5*this.samplerate;if(1<=e)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else if(0>=e)this.b0=this.b1=this.b2=this.a1=this.a2=
0;else{var c=Math.pow(10,0.05*(0>d?0:d)),b=Math.sqrt(0.5*(4-Math.sqrt(16-16/(c*c)))),c=Math.PI*e,b=0.5*b*Math.sin(c),b=0.5*(1-b)/(1+b),c=(0.5+b)*Math.cos(c),a=0.25*(0.5+b-c);this.b0=2*a;this.b1=4*a;this.b2=this.b0;this.a1=2*-c;this.a2=2*b}},highpass:function(e,d){e/=0.5*this.samplerate;if(1<=e)this.b0=this.b1=this.b2=this.a1=this.a2=0;else if(0>=e)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else{var c=Math.pow(10,0.05*(0>d?0:d)),b=Math.sqrt((4-Math.sqrt(16-16/(c*c)))/2),c=Math.PI*e,b=0.5*b*Math.sin(c),
b=0.5*(1-b)/(1+b),c=(0.5+b)*Math.cos(c),a=0.25*(0.5+b+c);this.b0=2*a;this.b1=-4*a;this.b2=this.b0;this.a1=2*-c;this.a2=2*b}},bandpass:function(e,d){e/=0.5*this.samplerate;if(0<e&&1>e)if(0<d){var c=Math.PI*e,b=Math.sin(c)/(2*d),c=Math.cos(c),a=1/(1+b);this.b0=b*a;this.b1=0;this.b2=-b*a;this.a1=-2*c*a;this.a2=(1-b)*a}else this.b0=this.b1=this.b2=this.a1=this.a2=0;else this.b0=this.b1=this.b2=this.a1=this.a2=0},lowshelf:function(e,d,c){e/=0.5*this.samplerate;d=Math.pow(10,c/40);if(1<=e)this.b0=d*d,this.b1=
this.b2=this.a1=this.a2=0;else if(0>=e)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else{var e=Math.PI*e,c=0.5*Math.sin(e)*Math.sqrt(0*(d+1/d)+2),e=Math.cos(e),c=2*Math.sqrt(d)*c,b=d+1,a=d-1,f=1/(b+a*e+c);this.b0=d*(b-a*e+c)*f;this.b1=2*d*(a-b*e)*f;this.b2=d*(b-a*e-c)*f;this.a1=-2*(a+b*e)*f;this.a2=(b+a*e-c)*f}},highshelf:function(e,d,c){e/=0.5*this.samplerate;d=Math.pow(10,c/40);if(1<=e)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else if(0>=e)this.b0=d*d,this.b1=this.b2=this.a1=this.a2=0;else{var e=
Math.PI*e,c=0.5*Math.sin(e)*Math.sqrt(0*(d+1/d)+2),e=Math.cos(e),c=2*Math.sqrt(d)*c,b=d+1,a=d-1,f=1/(b-a*e+c);this.b0=d*(b+a*e+c)*f;this.b1=-2*d*(a+b*e)*f;this.b2=d*(b+a*e-c)*f;this.a1=2*(a-b*e)*f;this.a2=(b-a*e-c)*f}},peaking:function(e,d,c){e/=0.5*this.samplerate;if(0<e&&1>e)if(c=Math.pow(10,c/40),0<d){var e=Math.PI*e,d=Math.sin(e)/(2*d),e=Math.cos(e),b=1/(1+d/c);this.b0=(1+d*c)*b;this.b1=-2*e*b;this.b2=(1-d*c)*b;this.a1=this.b1;this.a2=(1-d/c)*b}else this.b0=c*c,this.b1=this.b2=this.a1=this.a2=
0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0},notch:function(e,d){e/=0.5*this.samplerate;if(0<e&&1>e)if(0<d){var c=Math.PI*e,b=Math.sin(c)/(2*d),c=Math.cos(c),a=1/(1+b);this.b0=a;this.b1=-2*c*a;this.b2=a;this.a1=this.b1;this.a2=(1-b)*a}else this.b0=this.b1=this.b2=this.a1=this.a2=0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0},allpass:function(e,d){e/=0.5*this.samplerate;if(0<e&&1>e)if(0<d){var c=Math.PI*e,b=Math.sin(c)/(2*d),c=Math.cos(c),a=1/(1+b);this.b0=(1-b)*a;this.b1=-2*c*a;this.b2=
(1+b)*a;this.a1=this.b1;this.a2=this.b0}else this.b0=-1,this.b1=this.b2=this.a1=this.a2=0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0}};k.lpf=k.lowpass;k.hpf=k.highpass;k.bpf=k.bandpass;k.bef=k.notch;k.brf=k.notch;k.apf=k.allpass;i.modules.Biquad=h})(timbre);
(function(i){function h(e){this.samplerate=e;this.buffersize=1<<Math.round(Math.log(0.1*e)*Math.LOG2E);this.bufferL=new i.fn.SignalArray(this.buffersize+1);this.bufferR=new i.fn.SignalArray(this.buffersize+1);this._wave=this.wave=null;this.writeIndex=this.buffersize>>1;this.readIndex=0;this.delayTime=20;this.rate=4;this.depth=20;this.feedback=0.2;this.wet=0.5;this.phaseIncr=this.phase=0;this.phaseStep=4;this.setWaveType("sin");this.setDelayTime(this.delayTime);this.setRate(this.rate)}var g=h.prototype,
k=[];k[0]=function(){for(var e=new Float32Array(512),d=0;512>d;++d)e[d]=Math.sin(2*Math.PI*(d/512));return e}();k[1]=function(){for(var e=new Float32Array(512),d,c=0;512>c;++c)d=c/512-0.25,e[c]=1-4*Math.abs(Math.round(d)-d);return e}();g.setWaveType=function(e){"sin"===e?(this.wave=e,this._wave=k[0]):"tri"===e&&(this.wave=e,this._wave=k[1])};g.setDelayTime=function(e){this.delayTime=e;for(e=this.writeIndex-(0.001*e*this.samplerate|0);0>e;)e+=this.buffersize;this.readIndex=e};g.setRate=function(e){this.rate=
e;this.phaseIncr=512*this.rate/this.samplerate*this.phaseStep};g.process=function(e,d){var c=this.bufferL,b=this.bufferR,a=this.buffersize,f=a-1,j=this._wave,l=this.phase,p=this.phaseIncr,g=this.writeIndex,o=this.readIndex,m=this.depth,k=this.feedback,h,i,s,v=this.wet,t=1-v,w,z=e.length,B,E=this.phaseStep;for(w=0;w<z;){s=j[l|0]*m;for(l+=p;512<l;)l-=512;for(B=0;B<E;++B,++w)i=o+a+s&f,h=0.5*(c[i]+c[i+1]),c[g]=e[w]-h*k,e[w]=e[w]*t+h*v,h=0.5*(b[i]+b[i+1]),b[g]=d[w]-h*k,d[w]=d[w]*t+h*v,g=g+1&f,o=o+1&f}this.phase=
l;this.writeIndex=g;this.readIndex=o};i.modules.Chorus=h})(timbre);
(function(i){function h(c,b){this.samplerate=c;this.channels=b;this.preDelayReadIndex=this.lastPreDelayFrames=0;this.preDelayWriteIndex=e;this.K=this.ykneeThresholdDb=this.kneeThresholdDb=this.kneeThreshold=this.dbKnee=this.dbThreshold=this.linearThreshold=this.slope=this.ratio=-1;this.attackTime=0.003;this.releaseTime=0.25;this.preDelayTime=0.006;this.dbPostGain=0;this.effectBlend=1;this.releaseZone1=0.09;this.releaseZone2=0.16;this.releaseZone3=0.42;this.releaseZone4=0.98;this.detectorAverage=0;
this.meteringGain=this.compressorGain=1;this.delayBufferL=new i.fn.SignalArray(g);this.delayBufferR=2===b?new i.fn.SignalArray(g):this.delayBufferL;this.preDelayTime=6;this.preDelayReadIndex=0;this.preDelayWriteIndex=e;this.maxAttackCompressionDiffDb=-1;this.meteringReleaseK=1-Math.exp(-1/(0.325*this.samplerate));this.setAttackTime(this.attackTime);this.setReleaseTime(this.releaseTime);this.setPreDelayTime(this.preDelayTime);this.setParams(-24,30,12)}var g=1024,k=g-1,e=256,d=h.prototype;d.clone=function(){var c=
new h(this.samplerate,this.channels);c.setAttackTime(this.attackTime);c.setReleaseTime(this.releaseTime);c.setPreDelayTime(this.preDelayTime);c.setParams(this.dbThreshold,this.dbKnee,this.ratio);return c};d.setAttackTime=function(c){this.attackTime=Math.max(0.001,c);this._attackFrames=this.attackTime*this.samplerate};d.setReleaseTime=function(c){this.releaseTime=Math.max(0.001,c);var b=this.releaseTime*this.samplerate;this._satReleaseFrames=0.0025*this.samplerate;var c=b*this.releaseZone1,a=b*this.releaseZone2,
f=b*this.releaseZone3,b=b*this.releaseZone4;this._kA=0.9999999999999998*c+1.8432219684323923E-16*a-1.9373394351676423E-16*f+8.824516011816245E-18*b;this._kB=-1.5788320352845888*c+2.3305837032074286*a-0.9141194204840429*f+0.1623677525612032*b;this._kC=0.5334142869106424*c-1.272736789213631*a+0.9258856042207512*f-0.18656310191776226*b;this._kD=0.08783463138207234*c-0.1694162967925622*a+0.08588057951595272*f-0.00429891410546283*b;this._kE=-0.042416883008123074*c+0.1115693827987602*a-0.09764676325265872*
f+0.028494263462021576*b};d.setPreDelayTime=function(c){this.preDelayTime=c;c*=this.samplerate;c>g-1&&(c=g-1);if(this.lastPreDelayFrames!==c){this.lastPreDelayFrames=c;for(var b=0,a=this.delayBufferL.length;b<a;++b)this.delayBufferL[b]=this.delayBufferR[b]=0;this.preDelayReadIndex=0;this.preDelayWriteIndex=c}};d.setParams=function(c,b,a){this._k=this.updateStaticCurveParameters(c,b,a);c=1/this.saturate(1,this._k);c=Math.pow(c,0.6);this._masterLinearGain=Math.pow(10,0.05*this.dbPostGain)*c};d.kneeCurve=
function(c,b){return c<this.linearThreshold?c:this.linearThreshold+(1-Math.exp(-b*(c-this.linearThreshold)))/b};d.saturate=function(c,b){var a;c<this.kneeThreshold?a=this.kneeCurve(c,b):(a=this.ykneeThresholdDb+this.slope*((c?20*Math.log(c)*Math.LOG10E:-1E3)-this.kneeThresholdDb),a=Math.pow(10,0.05*a));return a};d.slopeAt=function(c,b){if(c<this.linearThreshold)return 1;var a=1.001*c,f=c?20*Math.log(c)*Math.LOG10E:-1E3,j=a?20*Math.log(a)*Math.LOG10E:-1E3,d=this.kneeCurve(c,b),a=this.kneeCurve(a,b),
d=d?20*Math.log(d)*Math.LOG10E:-1E3;return((a?20*Math.log(a)*Math.LOG10E:-1E3)-d)/(j-f)};d.kAtSlope=function(c){for(var b=Math.pow(10,0.05*(this.dbThreshold+this.dbKnee)),a=0.1,f=1E4,j=5,d=0;15>d;++d)this.slopeAt(b,j)<c?f=j:a=j,j=Math.sqrt(a*f);return j};d.updateStaticCurveParameters=function(c,b,a){this.dbThreshold=c;this.linearThreshold=Math.pow(10,0.05*c);this.dbKnee=b;this.ratio=a;this.slope=1/this.ratio;this.kneeThresholdDb=c+b;this.kneeThreshold=Math.pow(10,0.05*this.kneeThresholdDb);c=this.kAtSlope(1/
this.ratio);this.ykneeThresholdDb=(b=this.kneeCurve(this.kneeThreshold,c))?20*Math.log(b)*Math.LOG10E:-1E3;return this._k=c};d.process=function(c,b){for(var a=1-this.effectBlend,f=this.effectBlend,j=this._k,d=this._masterLinearGain,e=this._satReleaseFrames,g=this._kA,o=this._kB,m=this._kC,h=this._kD,i=this._kE,r=c.length/64,s=0,v=this.detectorAverage,t=this.compressorGain,w=this.maxAttackCompressionDiffDb,z=1/this._attackFrames,B=this.preDelayReadIndex,E=this.preDelayWriteIndex,C=this.detectorAverage,
J=this.delayBufferL,I=this.delayBufferR,G=this.meteringGain,K=this.meteringReleaseK,H=0;H<r;++H){var F=Math.asin(v)/(0.5*Math.PI),D;D=F>t;var x=t/F,x=x?20*Math.log(x)*Math.LOG10E:-1E3;if(Infinity===x||isNaN(x))x=-1;if(D)w=-1,x=-12>x?0:0<x?3:0.25*(x+12),D=x*x,D=Math.pow(10,0.05*(5/(g+o*x+m*D+h*D*x+i*D*D)));else{if(-1===w||w<x)w=x;x=0.25/Math.max(0.5,w);D=1-Math.pow(x,z)}for(x=64;x--;){var A=0,y=0.5*(c[s]+b[s]);J[E]=c[s];I[E]=b[s];0>y&&(y*=-1);A<y&&(A=y);0>A&&(A*=-1);y=this.saturate(A,j);y=(A=1.0E-4>=
A?1:y/A)?-20*Math.log(A)*Math.LOG10E:1E3;2>y&&(y=2);y=Math.pow(10,0.05*(y/e))-1;C+=(A-C)*(A>C?y:1);1<C&&(C=1);1>D?t+=(F-t)*D:(t*=D,1<t&&(t=1));y=Math.sin(0.5*Math.PI*t);A=a+f*d*y;y=20*Math.log(y)*Math.LOG10E;G=y<G?y:G+(y-G)*K;c[s]=J[B]*A;b[s]=I[B]*A;s++;B=B+1&k;E=E+1&k}1.0E-6>C&&(C=1.0E-6);1.0E-6>t&&(t=1.0E-6)}this.preDelayReadIndex=B;this.preDelayWriteIndex=E;this.detectorAverage=C;this.compressorGain=t;this.maxAttackCompressionDiffDb=w;this.meteringGain=G};d.reset=function(){this.detectorAverage=
0;this.meteringGain=this.compressorGain=1;for(var c=0,b=this.delayBufferL.length;c<b;++c)this.delayBufferL[c]=this.delayBufferR[c]=0;this.preDelayReadIndex=0;this.preDelayWriteIndex=e;this.maxAttackCompressionDiffDb=-1};i.modules.Compressor=h})(timbre);
(function(i){function h(){}h.prototype.decode=function(g,k,e){if("string"===typeof g){if(/\.wav$/.test(g))return h.wav_decode(g,k,e);if(h.ogg_decode&&/\.ogg$/.test(g))return h.ogg_decode(g,k,e);if(h.mp3_decode&&/\.mp3$/.test(g))return h.mp3_decode(g,k,e)}else if("object"===typeof g){if("wav"===g.type)return h.wav_decode(g.data,k,e);if(h.ogg_decode&&"ogg"===g.type)return h.ogg_decode(g.data,k,e);if(h.mp3_decode&&"mp3"===g.type)return h.mp3_decode(g.data,k,e)}if(h.webkit_decode)return"object"===typeof g?
h.webkit_decode(g.data||g,k,e):h.webkit_decode(g,k,e);if(h.moz_decode)return h.moz_decode(g,k,e);k(!1)};i.modules.Decoder=h;h.getBinaryWithPath="browser"===i.envtype?function(g,k){i.fn.fix_iOS6_1_problem(!0);var e=new XMLHttpRequest;e.open("GET",g);e.responseType="arraybuffer";e.onreadystatechange=function(){4===e.readyState&&(e.response?k(new Uint8Array(e.response)):void 0!==e.responseBody&&k(new Uint8Array(VBArray(e.responseBody).toArray())),i.fn.fix_iOS6_1_problem(!1))};e.send()}:function(g,k){k("no support")};
h.wav_decode=function(){var g=function(g,e,d){if("RIFF"!==String.fromCharCode(g[0],g[1],g[2],g[3])||g[4]+(g[5]<<8)+(g[6]<<16)+(g[7]<<24)+8!==g.length||"WAVE"!==String.fromCharCode(g[8],g[9],g[10],g[11])||"fmt "!==String.fromCharCode(g[12],g[13],g[14],g[15]))return e(!1);for(var c=g[22]+(g[23]<<8),b=g[24]+(g[25]<<8)+(g[26]<<16)+(g[27]<<24),a=g[34]+(g[35]<<8),f=36;f<g.length&&"data"!==String.fromCharCode(g[f],g[f+1],g[f+2],g[f+3]);)f+=1;if(f>=g.length)return e(!1);var f=f+4,j=g[f]+(g[f+1]<<8)+(g[f+
2]<<16)+(g[f+3]<<24),l=(j/c>>1)/b,f=f+4;if(j>g.length-f)return e(!1);var p,n,j=new Float32Array(l*b|0);2===c&&(p=new Float32Array(j.length),n=new Float32Array(j.length));e({samplerate:b,channels:c,buffer:[j,p,n],duration:l});if(8===a)g=new Int8Array(g.buffer,f);else if(16===a)g=new Int16Array(g.buffer,f);else if(32===a)g=new Int32Array(g.buffer,f);else if(24===a){for(var g=new Uint8Array(g.buffer,f),o,m,h,f=new Int32Array(g.length/3),e=0,b=g.length,l=0;e<b;)o=g[e++],m=g[e++],h=g[e++],o=o+(m<<8)+(h<<
16),o=o&8388608?o-16777216:o,f[l++]=o;g=f}a=1/((1<<a-1)-1);if(2===c){f=e=0;for(c=j.length;f<c;++f)b=p[f]=g[e++]*a,b+=n[f]=g[e++]*a,j[f]=0.5*b}else{f=0;for(c=j.length;f<c;++f)j[f]=g[f]*a}d()};return function(k,e,d){"string"===typeof k?h.getBinaryWithPath(k,function(c){g(c,e,d)}):g(k,e,d)}}();h.webkit_decode=function(){if("undefined"!==typeof i.fn._audioContext){var g=i.fn._audioContext,k=function(e,d,c){var b,a,f,j;if("string"===typeof e)return c(!1);try{f=g.createBuffer(e.buffer,!1)}catch(l){return d(!1)}e=
g.sampleRate;b=f.numberOfChannels;2===b?(a=f.getChannelData(0),f=f.getChannelData(1)):a=f=f.getChannelData(0);j=a.length/e;for(var p=new Float32Array(a),n=0,o=p.length;n<o;++n)p[n]=0.5*(p[n]+f[n]);d({samplerate:e,channels:b,buffer:[p,a,f],duration:j});c()};return function(e,d,c){if(e instanceof File){var b=new FileReader;b.onload=function(a){k(new Uint8Array(a.target.result),d,c)};b.readAsArrayBuffer(e)}else"string"===typeof e?h.getBinaryWithPath(e,function(a){k(a,d,c)}):k(e,d,c)}}}();h.moz_decode=
function(){if("function"===typeof Audio&&"function"===typeof(new Audio).mozSetup)return function(g,h,e){var d,c,b,a,f,j,l=0,p=new Audio(g);p.volume=0;p.addEventListener("loadedmetadata",function(){d=p.mozSampleRate;c=p.mozChannels;j=p.duration;b=new Float32Array(p.duration*d|0);2===c&&(a=new Float32Array(p.duration*d|0),f=new Float32Array(p.duration*d|0));2===c?p.addEventListener("MozAudioAvailable",function(c){for(var j=c.frameBuffer,d=0,e=j.length;d<e;d=d+2){c=a[l]=j[d];c=c+(f[l]=j[d+1]);b[l]=c*
0.5;l=l+1}},!1):p.addEventListener("MozAudioAvailable",function(a){for(var a=a.frameBuffer,f=0,c=a.length;f<c;++f){b[f]=a[f];l=l+1}},!1);p.play();setTimeout(function(){h({samplerate:d,channels:c,buffer:[b,a,f],duration:j})},1E3)},!1);p.addEventListener("ended",function(){e()},!1);p.load()}}()})(timbre);
(function(i){function h(a){this.samplerate=a||44100;this.value=k;this.status=p;this.curve="linear";this.step=1;this.emit=this.loopNode=this.releaseNode=null;this._envValue=new g(a);this._table=[];this._initValue=k;this._curveValue=0;this._defaultCurveType=d;this._counter=this._index=0}function g(a){this.samplerate=a;this.value=k;this.step=1;this._curveType=d;this._y2=this._y1=this._b1=this._a2=this._grow=this._curveValue=0}var k=h.ZERO=1.0E-6,e=h.CurveTypeSet=0,d=h.CurveTypeLin=1,c=h.CurveTypeExp=
2,b=h.CurveTypeSin=3,a=h.CurveTypeWel=4,f=h.CurveTypeCurve=5,j=h.CurveTypeSqr=6,l=h.CurveTypeCub=7,p=h.StatusWait=0,n=h.StatusGate=1,o=h.StatusSustain=2,m=h.StatusRelease=3,u=h.StatusEnd=4,q={set:e,lin:d,linear:d,exp:c,exponential:c,sin:b,sine:b,wel:a,welch:a,sqr:j,squared:j,cub:l,cubed:l};h.CurveTypeDict=q;var r=h.prototype;r.clone=function(){var a=new h(this.samplerate);a._table=this._table;a._initValue=this._initValue;a.setCurve(this.curve);null!==this.releaseNode&&a.setReleaseNode(this.releaseNode+
1);null!==this.loopNode&&a.setLoopNode(this.loopNode+1);a.setStep(this.step);a.reset();return a};r.setTable=function(a){this._initValue=a[0];this._table=a.slice(1);this.value=this._envValue.value=this._initValue;this._counter=this._index=0;this.status=p};r.setCurve=function(a){"number"===typeof a?(this._defaultCurveType=f,this._curveValue=a):this._defaultCurveType=q[a]||null;this.curve=a};r.setReleaseNode=function(a){"number"===typeof a&&0<a&&(this.releaseNode=a-1)};r.setLoopNode=function(a){"number"===
typeof a&&0<a&&(this.loopNode=a-1)};r.setStep=function(a){this.step=this._envValue.step=a};r.reset=function(){this.value=this._envValue.value=this._initValue;this._counter=this._index=0;this.status=p};r.release=function(){null!==this.releaseNode&&(this._counter=0,this.status=m)};r.getInfo=function(a){var b=this._table,f,c,j=0,d=Infinity,l=Infinity,e=!1;f=0;for(c=b.length;f<c;++f){this.loopNode===f&&(d=j);this.releaseNode===f&&(l=j=j<a?j+a:a);var g=b[f];Array.isArray(g)&&(j+=g[1])}Infinity!==d&&Infinity===
l&&(j+=a,e=!0);return{totalDuration:j,loopBeginTime:d,releaseBeginTime:l,isEndlessLoop:e}};r.calcStatus=function(){var a=this.status,b=this._table,c=this._index,j=this._counter,l=this._curveValue,e=this._defaultCurveType,g=this.loopNode,p=this.releaseNode,h=this._envValue,k,i,q=null;switch(a){case n:case m:for(;0>=j;)c>=b.length?a===n&&null!==g?c=g:(a=u,j=Infinity,q="ended"):a===n&&c===p?null!==g&&g<p?c=g:(a=o,j=Infinity,q="sustained"):(k=b[c++],j=k[0],i=null===k[2]?e:k[2],i===f&&(l=k[3],0.001>Math.abs(l)&&
(i=d)),k=k[1],j=h.setNext(j,k,i,l))}this.status=a;this.emit=q;this._index=c;this._counter=j;return a};r.next=function(){this.calcStatus()&1&&(this.value=this._envValue.next()||k);this._counter-=1;return this.value};r.process=function(a){var b=this._envValue,f,c=a.length;if(this.calcStatus()&1)for(f=0;f<c;++f)a[f]=b.next()||k;else{b=this.value||k;for(f=0;f<c;++f)a[f]=b}this.value=a[c-1];this._counter-=a.length};g.prototype.setNext=function(g,p,n,m){var o=this.value,h,k,i,u,q,p=0.001*p*this.samplerate/
this.step|0;1>p&&(p=1,n=e);switch(n){case e:this.value=g;break;case d:h=(g-o)/p;break;case c:h=0!==o?Math.pow(g/o,1/p):0;break;case b:m=Math.PI/p;k=0.5*(g+o);i=2*Math.cos(m);u=0.5*(g-o);q=u*Math.sin(0.5*Math.PI-m);break;case a:m=0.5*Math.PI/p;i=2*Math.cos(m);g>=o?(k=o,u=0,q=-Math.sin(m)*(g-o)):(k=g,u=o-g,q=Math.cos(m)*(o-g));break;case f:g=(g-o)/(1-Math.exp(m));k=o+g;i=g;h=Math.exp(m/p);break;case j:u=Math.sqrt(o);q=Math.sqrt(g);h=(q-u)/p;break;case l:u=Math.pow(o,0.33333333),q=Math.pow(g,0.33333333),
h=(q-u)/p}this.next=s[n];this._grow=h;this._a2=k;this._b1=i;this._y1=u;this._y2=q;return p};var s=[];s[e]=function(){return this.value};s[d]=function(){return this.value+=this._grow};s[c]=function(){return this.value*=this._grow};s[b]=function(){var a=this._b1*this._y1-this._y2;this.value=this._a2-a;this._y2=this._y1;this._y1=a;return this.value};s[a]=function(){var a=this._b1*this._y1-this._y2;this.value=this._a2+a;this._y2=this._y1;this._y1=a;return this.value};s[f]=function(){this._b1*=this._grow;
return this.value=this._a2-this._b1};s[j]=function(){this._y1+=this._grow;return this.value=this._y1*this._y1};s[l]=function(){this._y1+=this._grow;return this.value=this._y1*this._y1*this._y1};g.prototype.next=s[e];i.modules.Envelope=h;i.modules.EnvelopeValue=g})(timbre);
(function(i){function h(d){this.length=d=1<<Math.ceil(Math.log("number"===typeof d?d:512)*Math.LOG2E);this.buffer=new i.fn.SignalArray(d);this.real=new i.fn.SignalArray(d);this.imag=new i.fn.SignalArray(d);this._real=new i.fn.SignalArray(d);this._imag=new i.fn.SignalArray(d);this.mag=new i.fn.SignalArray(d>>1);this.minDecibels=-30;this.maxDecibels=-100;d=k.get(d);this._bitrev=d.bitrev;this._sintable=d.sintable;this._costable=d.costable}var g=h.prototype;g.setWindow=function(d){if("string"===typeof d){var c=
/([A-Za-z]+)(?:\(([01]\.?\d*)\))?/.exec(d);if(null!==c){var b=c[1].toLowerCase(),c=void 0!==c[2]?+c[2]:0.25;if(b=e[b]){this._window||(this._window=new i.fn.SignalArray(this.length));for(var a=this._window,f=0,j=this.length,c=0>c?0:1<c?1:c;f<j;++f)a[f]=b(f,j,c);this.windowName=d}}}};g.forward=function(d){var c=this.buffer,b=this.real,a=this.imag,f=this._window,j=this._bitrev,l=this._sintable,e=this._costable,g=c.length,o,m,h,k,i,s,v;if(f)for(o=0;o<g;++o)c[o]=d[o]*f[o];else c.set(d);for(o=0;o<g;++o)b[o]=
c[j[o]],a[o]=0;for(c=1;c<g;c=f){j=0;f=c+c;m=g/f;for(d=0;d<c;d++){h=e[j];k=l[j];for(o=d;o<g;o+=f)i=o+c,s=k*a[i]+h*b[i],v=h*a[i]-k*b[i],b[i]=b[o]-s,b[o]+=s,a[i]=a[o]-v,a[o]+=v;j+=m}}l=this.mag;for(o=0;o<g;++o)e=b[o],d=a[o],l[o]=Math.sqrt(e*e+d*d);return{real:b,imag:a}};g.inverse=function(d,c){var b=this.buffer,a=this._real,f=this._imag,j=this._bitrev,l=this._sintable,e=this._costable,g=b.length,o,m,h,k,i,s,v,t,w,z;for(o=0;o<g;++o)m=j[o],a[o]=+d[m],f[o]=-c[m];for(j=1;j<g;j=h){k=0;h=j+j;i=g/h;for(m=0;m<
j;m++){s=e[k];v=l[k];for(o=m;o<g;o+=h)t=o+j,w=v*f[t]+s*a[t],z=s*f[t]-v*a[t],a[t]=a[o]-w,a[o]+=w,f[t]=f[o]-z,f[o]+=z;k+=i}}for(o=0;o<g;++o)b[o]=a[o]/g;return b};g.getFrequencyData=function(d){var c=this.minDecibels,b,a=Math.min(this.mag.length,d.length);if(a){var f,j=this.mag,l=0;for(b=0;b<a;++b)f=j[b],d[b]=!f?c:20*Math.log(f)*Math.LOG10E,l<d[b]&&(l=d[b])}return d};var k={get:function(d){var c;if(!(c=k[d])){var b,a,f,j;c=new Int16Array(d);j=d>>1;for(b=a=0;;){c[b]=a;if(++b>=d)break;for(f=j;f<=a;)a-=
f,f>>=1;a+=f}a=Math.floor(Math.log(d)/Math.LN2);b=new i.fn.SignalArray((1<<a)-1);j=new i.fn.SignalArray((1<<a)-1);var l=2*Math.PI;a=0;for(f=b.length;a<f;++a)b[a]=Math.sin(l*(a/d)),j[a]=Math.cos(l*(a/d));k[d]={bitrev:c,sintable:b,costable:j};c=k[d]}return c}},e=function(){var d=Math.PI,c=2*Math.PI,b=Math.abs,a=Math.pow,f=Math.cos,j=Math.sin,l=Math.E;return{rectangular:function(){return 1},hann:function(a,b){return 0.5*(1-f(c*a/(b-1)))},hamming:function(a,b){return 0.54-0.46*f(c*a/(b-1))},tukery:function(a,
b,c){return a<c*(b-1)/2?0.5*(1+f(d*(2*a/(c*(b-1))-1))):(b-1)*(1-c/2)<a?0.5*(1+f(d*(2*a/(c*(b-1))-2/c+1))):1},cosine:function(a,b){return j(d*a/(b-1))},lanczos:function(a,b){return j(d*(2*a/(b-1)-1))/(d*(2*a/(b-1)-1))},triangular:function(a,f){return 2/(f+1)*((f+1)/2-b(a-(f-1)/2))},bartlett:function(a,f){return 2/(f-1)*((f-1)/2-b(a-(f-1)/2))},gaussian:function(b,f,c){return a(l,-0.5*a((b-(f-1)/2)/(c*(f-1)/2),2))},bartlettHann:function(a,j){return 0.62-0.48*b(a/(j-1)-0.5)-0.38*f(c*a/(j-1))},blackman:function(a,
b,j){var l=j/2;return(1-j)/2-0.5*f(c*a/(b-1))+l*f(4*d*a/(b-1))}}}();i.modules.FFT=h})(timbre);
(function(i){function h(b){this.samplerate=b||44100;this.wave=null;this.step=1;this.phase=this.value=this.frequency=0;this.feedback=!1;this._lastouts=this._x=0;this._coeff=g/this.samplerate;this._radtoinc=g/(2*Math.PI)}var g=1024,k=g-1,e=h.prototype;e.setWave=function(b){var a,f,c=this.wave;this.wave||(this.wave=new Float32Array(g+1));if("function"===typeof b)for(a=0;a<g;++a)c[a]=b(a/g);else if(i.fn.isSignalArray(b))if(b.length===c.length)c.set(b);else{f=b.length/g;for(a=0;a<g;++a)c[a]=b[a*f|0]}else"string"===
typeof b&&void 0!==(f=d(b))&&this.wave.set(f);this.wave[g]=this.wave[0]};e.clone=function(){var b=new h(this.samplerate);b.wave=this.wave;b.step=this.step;b.frequency=this.frequency;b.value=this.value;b.phase=this.phase;b.feedback=this.feedback;return b};e.reset=function(){this._x=0};e.next=function(){var b=this._x;this.value=this.wave[(b+this.phase*this._radtoinc|0)&k];b+=this.frequency*this._coeff*this.step;b>g&&(b-=g);this._x=b;return this.value};e.process=function(b){var a=this.wave,f=this._radtoinc,
c,d=this._x,e,n,o=this.frequency*this._coeff,m,h=this.step;if(this.feedback){e=this._lastouts;f*=this.phase;for(m=0;m<h;++m)c=d+e*f,e=c|0,c-=e,e&=k,n=a[e],e=a[e+1],b[m]=e=n+c*(e-n),d+=o;this._lastouts=e}else{f*=this.phase;for(m=0;m<h;++m)c=d+f,e=c|0,c-=e,e&=k,n=a[e],e=a[e+1],b[m]=n+c*(e-n),d+=o}d>g&&(d-=g);this._x=d;this.value=b[b.length-1]};e.processWithFreqArray=function(b,a){var f=this.wave,c=this._radtoinc,d,e=this._x,n,o,m=this._coeff,h,i=this.step;if(this.feedback){n=this._lastouts;c*=this.phase;
for(h=0;h<i;++h)d=e+n*c,n=d|0,d-=n,n&=k,o=f[n],n=f[n+1],b[h]=n=o+d*(n-o),e+=a[h]*m;this._lastouts=n}else{c=this.phase*this._radtoinc;for(h=0;h<i;++h)d=e+c,n=d|0,d-=n,n&=k,o=f[n],n=f[n+1],b[h]=o+d*(n-o),e+=a[h]*m}e>g&&(e-=g);this._x=e;this.value=b[b.length-1]};e.processWithPhaseArray=function(b,a){var f=this.wave,c=this._radtoinc,d,e=this._x,n,o,m=this.frequency*this._coeff,h,i=this.step;if(this.feedback){n=this._lastouts;c*=this.phase;for(h=0;h<i;++h)d=e+n*c,n=d|0,d-=n,n&=k,o=f[n],n=f[n+1],b[h]=n=
o+d*(n-o),e+=m;this._lastouts=n}else for(h=0;h<i;++h)d=e+a[h]*c,n=d|0,d-=n,n&=k,o=f[n],n=f[n+1],b[h]=o+d*(n-o),e+=m;e>g&&(e-=g);this._x=e;this.value=b[b.length-1]};e.processWithFreqAndPhaseArray=function(b,a,f){var c=this.wave,d=this._radtoinc,e,n=this._x,h,m,i=this._coeff,q,r=this.step;if(this.feedback){f=this._lastouts;d*=this.phase;for(q=0;q<r;++q)e=n+f*d,h=e|0,e-=h,h&=k,m=c[h],h=c[h+1],b[q]=f=m+e*(h-m),n+=a[q]*i;this._lastouts=f}else for(q=0;q<r;++q)e=n+f[q]*g,h=e|0,e-=h,h&=k,m=c[h],h=c[h+1],
b[q]=m+e*(h-m),n+=a[q]*i;n>g&&(n-=g);this._x=n;this.value=b[b.length-1]};var d=function(b){var a=c[b];if(void 0!==a)return"function"===typeof a&&(a=a()),a;var f;f=/^([\-+]?)(\w+)(?:\((@[0-7])?:?(\d+)?\))?$/.exec(b);if(null!==f){var a=f[1],j=f[3],d=f[4];f=c[f[2]];var e,g;if(void 0===f)a=void 0;else{"function"===typeof f&&(f=f());switch(j){case "@1":for(e=512;1024>e;++e)f[e]=0;break;case "@2":for(e=512;1024>e;++e)f[e]=Math.abs(f[e]);break;case "@3":for(e=256;512>e;++e)f[e]=0;for(e=512;768>e;++e)f[e]=
Math.abs(f[e]);for(e=768;1024>e;++e)f[e]=0;break;case "@4":j=new Float32Array(1024);for(e=0;512>e;++e)j[e]=f[e<<1];f=j;break;case "@5":j=new Float32Array(1024);for(e=0;512>e;++e)j[e]=Math.abs(f[e<<1]);f=j}if(void 0!==d&&50!==d){d*=0.01;d=0>d?0:1<d?1:d;j=new Float32Array(1024);d=1024*d|0;for(e=0;e<d;++e)j[e]=f[512*(e/d)|0];g=1024-d;for(d=0;1024>e;++e,++d)j[e]=f[512*(d/g)+512|0];f=j}if("+"===a)for(e=0;1024>e;++e)f[e]=0.5*f[e]+0.5;else if("-"===a)for(e=0;1024>e;++e)f[e]*=-1;a=f}if(void 0!==a)return c[b]=
a}f=/^wavb\(((?:[0-9a-fA-F][0-9a-fA-F])+)\)$/.exec(b);if(null!==f){b=f[1];a=new Float32Array(1024);f=b.length>>1;if(-1!==[2,4,8,16,32,64,128,256,512,1024].indexOf(f))for(e=j=0;j<f;++j){d=parseInt(b.substr(2*j,2),16);d=d&128?(d-256)/128:d/127;g=0;for(var h=1024/f;g<h;++g)a[e++]=d}return a}f=/^wavc\(([0-9a-fA-F]{8})\)$/.exec(b);if(null!==f){a=f[1];b=new Float32Array(1024);if(8===a.length){j=parseInt(a,16);f=new Float32Array(8);f[0]=1;for(a=0;7>a;++a)f[a+1]=0.0625*(j&15),j>>=4;for(a=0;8>a;++a){e=0;d=
(a+1)/1024;for(j=0;1024>j;++j)b[j]+=Math.sin(2*Math.PI*e)*f[a],e+=d}for(a=f=0;1024>a;++a)if(f<(j=Math.abs(b[a])))f=j;if(0<f)for(a=0;1024>a;++a)b[a]/=f}return b}};h.getWavetable=d;h.setWavetable=function(b,a){var f,j=new Float32Array(1024),d;if("function"===typeof a)for(d=0;1024>d;++d)j[d]=a(d/1024);else if(i.fn.isSignalArray(a))if(a.length===j.length)j.set(a);else{f=a.length/1024;for(d=0;1024>d;++d)j[d]=a[d*f|0]}c[b]=j};var c={sin:function(){for(var b=new Float32Array(1024),a=0;1024>a;++a)b[a]=Math.sin(2*
Math.PI*(a/1024));return b},cos:function(){for(var b=new Float32Array(1024),a=0;1024>a;++a)b[a]=Math.cos(2*Math.PI*(a/1024));return b},pulse:function(){for(var b=new Float32Array(1024),a=0;1024>a;++a)b[a]=512>a?1:-1;return b},tri:function(){for(var b=new Float32Array(1024),a,f=0;1024>f;++f)a=f/1024-0.25,b[f]=1-4*Math.abs(Math.round(a)-a);return b},saw:function(){for(var b=new Float32Array(1024),a,f=0;1024>f;++f)a=f/1024,b[f]=2*(a-Math.round(a));return b},fami:function(){for(var b=[0,0.125,0.25,0.375,
0.5,0.625,0.75,0.875,0.875,0.75,0.625,0.5,0.375,0.25,0.125,0,-0.125,-0.25,-0.375,-0.5,-0.625,-0.75,-0.875,-1,-1,-0.875,-0.75,-0.625,-0.5,-0.375,-0.25,-0.125],a=new Float32Array(1024),f=0;1024>f;++f)a[f]=b[f/1024*b.length|0];return a},konami:function(){for(var b=[-0.625,-0.875,-0.125,0.75,0.5,0.125,0.5,0.75,0.25,-0.125,0.5,0.875,0.625,0,0.25,0.375,-0.125,-0.75,0,0.625,0.125,-0.5,-0.375,-0.125,-0.75,-1,-0.625,0,-0.375,-0.875,-0.625,-0.25],a=new Float32Array(1024),f=0;1024>f;++f)a[f]=b[f/1024*b.length|
0];return a}};i.modules.Oscillator=h})(timbre);
(function(i){function h(b,a){this.samplerate=b;var f,c,l=b/44100;c=2*e.length;this.comb=Array(c);this.combout=Array(c);for(f=0;f<c;++f)this.comb[f]=new g(e[f%e.length]*l),this.combout[f]=new i.fn.SignalArray(a);c=2*d.length;this.allpass=Array(c);for(f=0;f<c;++f)this.allpass[f]=new k(d[f%d.length]*l);this.outputs=[new i.fn.SignalArray(a),new i.fn.SignalArray(a)];this.damp=0;this.wet=0.33;this.setRoomSize(0.5);this.setDamp(0.5)}function g(b){this.buffer=new i.fn.SignalArray(b|0);this.buffersize=this.buffer.length;
this.damp=this.filterstore=this.feedback=this.bufidx=0}function k(b){this.buffer=new i.fn.SignalArray(b|0);this.buffersize=this.buffer.length;this.bufidx=0}var e=[1116,1188,1277,1356,1422,1491,1557,1617],d=[225,556,441,341],c=h.prototype;c.setRoomSize=function(b){var a=this.comb;this.roomsize=b;a[0].feedback=a[1].feedback=a[2].feedback=a[3].feedback=a[4].feedback=a[5].feedback=a[6].feedback=a[7].feedback=a[8].feedback=a[9].feedback=a[10].feedback=a[11].feedback=a[12].feedback=a[13].feedback=a[14].feedback=
a[15].feedback=0.28*b+0.7};c.setDamp=function(b){var a=this.comb;this.damp=b;a[0].damp=a[1].damp=a[2].damp=a[3].damp=a[4].damp=a[5].damp=a[6].damp=a[7].damp=a[8].damp=a[9].damp=a[10].damp=a[11].damp=a[12].damp=a[13].damp=a[14].damp=a[15].damp=0.4*b};c.process=function(b,a){var f=this.comb,c=this.combout,d=this.allpass,e=this.outputs[0],g=this.outputs[1],h=this.wet,m=1-h,i=b.length;f[0].process(b,c[0]);f[1].process(b,c[1]);f[2].process(b,c[2]);f[3].process(b,c[3]);f[4].process(b,c[4]);f[5].process(b,
c[5]);f[6].process(b,c[6]);f[7].process(b,c[7]);f[8].process(a,c[8]);f[9].process(a,c[9]);f[10].process(a,c[10]);f[11].process(a,c[11]);f[12].process(a,c[12]);f[13].process(a,c[13]);f[14].process(a,c[14]);f[15].process(a,c[15]);for(f=0;f<i;++f)e[f]=c[0][f]+c[1][f]+c[2][f]+c[3][f]+c[4][f]+c[5][f]+c[6][f]+c[7][f],g[f]=c[8][f]+c[9][f]+c[10][f]+c[11][f]+c[12][f]+c[13][f]+c[14][f]+c[15][f];d[0].process(e,e);d[1].process(e,e);d[2].process(e,e);d[3].process(e,e);d[4].process(g,g);d[5].process(g,g);d[6].process(g,
g);d[7].process(g,g);for(f=0;f<i;++f)b[f]=e[f]*h+b[f]*m,a[f]=g[f]*h+a[f]*m};g.prototype.process=function(b,a){var f,c,d=this.buffer,e=this.buffersize,g=this.bufidx,h=this.filterstore,m=this.feedback,i=this.damp,k=1-i,r,s=b.length;for(r=0;r<s;++r)f=0.015*b[r],c=d[g],h=c*k+h*i,d[g]=f+h*m,++g>=e&&(g=0),a[r]=c;this.bufidx=g;this.filterstore=h};k.prototype.process=function(b,a){var f,c,d,e=this.buffer,g=this.buffersize,h=this.bufidx,m,i=b.length;for(m=0;m<i;++m)f=b[m],d=e[h],c=-f+d,e[h]=f+0.5*d,++h>=g&&
(h=0),a[m]=c;this.bufidx=h};i.modules.Reverb=h})(timbre);
(function(i){function h(b){return new g(b)}function g(b){this.fragments=[];b&&this.fragments.push(new k(b,0,b.buffer[0].length/(b.samplerate||44100)))}function k(b,a,f,j,d,e,g){b||(b=c);this.buffer=b.buffer[0];this.samplerate=b.samplerate||44100;this.start=a;this._duration=f;this.reverse=j||!1;this.pitch=d||100;this.stretch=e||!1;this.pan=g||50}function e(b,a){this.tape=b;this.fragments=b.fragments;this.samplerate=a||44100;this.isEnded=!1;this.buffer=null;this.bufferEndIndex=this.bufferBeginIndex=
this.bufferIndexIncr=this.bufferIndex=0;this.fragment=null;this.fragmentIndex=0;this.panR=this.panL=0.5}var d=new Float32Array(60),c={buffer:d,samplerate:1};h.silence=function(b){return(new h(c)).slice(0,1).fill(b)};h.join=function(b){for(var a=new g,f=0;f<b.length;f++)b[f]instanceof g&&a.add_fragments(b[f].fragments);return a};h.Tape=g;g.prototype.add_fragment=function(b){this.fragments.push(b);return this};g.prototype.add_fragments=function(b){for(var a=0;a<b.length;a++)this.fragments.push(b[a]);
return this};g.prototype.duration=function(){for(var b=0,a=0;a<this.fragments.length;a++)b+=this.fragments[a].duration();return b};g.prototype.slice=function(b,a){var f=this.duration();b+a>f&&(a=f-b);for(var f=new g,c=b,d=a,e=0;e<this.fragments.length;e++){var d=this.fragments[e].create(c,d),n=d[0],c=d[1],d=d[2];n&&f.add_fragment(n);if(0===d)break}return f};g.prototype.cut=g.prototype.slice;g.prototype.concat=function(b){var a=new g;a.add_fragments(this.fragments);a.add_fragments(b.fragments);return a};
g.prototype.loop=function(b){var a,f=[];for(a=0;a<this.fragments.length;a++)f.push(this.fragments[a].clone());var c=new g;for(a=0;a<b;a++)c.add_fragments(f);return c};g.prototype.times=g.prototype.loop;g.prototype.split=function(b){for(var a=this.duration()/b,f=[],c=0;c<b;c++)f.push(this.slice(c*a,a));return f};g.prototype.fill=function(b){var a=this.duration();if(0===a)throw"EmptyFragment";var f=b%a;return this.loop(b/a|0).plus(this.slice(0,f))};g.prototype.replace=function(b,a,f){var c=new g,a=
b+a,c=c.plus(this.slice(0,b)),d=c.duration();d<b&&(c=c.plus(h.silence(b-d)));c=c.plus(f);b=this.duration();b>a&&(c=c.plus(this.slice(a,b-a)));return c};g.prototype.reverse=function(){for(var b=new g,a=this.fragments.length;a--;){var f=this.fragments[a].clone();f.reverse=!f.isReversed();b.add_fragment(f)}return b};g.prototype.pitch=function(b,a){for(var f=new g,a=a||!1,c=0;c<this.fragments.length;c++){var d=this.fragments[c].clone();d.pitch*=0.01*b;d.stretch=a;f.add_fragment(d)}return f};g.prototype.stretch=
function(b){return this.pitch(100*(1/(0.01*b)),!0)};g.prototype.pan=function(b){var a=new g;100<b?b=100:0>b&&(b=0);for(var f=0;f<this.fragments.length;f++){var c=this.fragments[f].clone();c.pan=b;a.add_fragment(c)}return a};g.prototype.silence=function(){return h.silence(this.duration())};g.prototype.join=function(b){for(var a=new g,f=0;f<b.length;f++)b[f]instanceof g&&a.add_fragments(b[f].fragments);return a};g.prototype.getBuffer=function(){var b=44100;0<this.fragments.length&&(b=this.fragments[0].samplerate);
var a=new e(this,b),f=this.duration()*b|0;return{samplerate:b,buffer:a.fetch(f)}};k.prototype.duration=function(){return this._duration*(100/this.pitch)};k.prototype.original_duration=function(){return this._duration};k.prototype.isReversed=function(){return this.reverse};k.prototype.isStretched=function(){return this.stretched};k.prototype.create=function(b,a){var f=this.duration();if(b>=f)return[null,b-f,a];b+a>=f?(f-=b,a-=f):(f=a,a=0);var c=this.clone();c.start=this.start+0.01*b*this.pitch;c._duration=
0.01*f*this.pitch;c.reverse=!1;return[c,0,a]};k.prototype.clone=function(){var b=new k;b.buffer=this.buffer;b.samplerate=this.samplerate;b.start=this.start;b._duration=this._duration;b.reverse=this.reverse;b.pitch=this.pitch;b.stretch=this.stretch;b.pan=this.pan;return b};h.Fragment=k;h.TapeStream=e;e.prototype.reset=function(){this.isEnded=!1;this.buffer=null;this.bufferEndIndex=this.bufferBeginIndex=this.bufferIndexIncr=this.bufferIndex=0;this.fragment=null;this.fragmentIndex=0;this.panR=this.panL=
0.5;this.isLooped=!1;return this};e.prototype.fetch=function(b){var a=new i.fn.SignalArray(b),f=new i.fn.SignalArray(b),c=this.fragments;if(0===c.length)return[a,f];for(var e=100*this.samplerate,g=this.buffer,n=this.bufferIndex,h=this.bufferIndexIncr,m=this.bufferBeginIndex,k=this.bufferEndIndex,q=this.fragment,r=this.fragmentIndex,s=this.panL,v=this.panR,t=0;t<b;t++){for(;!g||n<m||n>=k;)if(!q||r<c.length)q=c[r++],g=q.buffer,h=q.samplerate/e*q.pitch,m=q.start*q.samplerate,k=m+q.original_duration()*
q.samplerate,n=0.01*q.pan,s=1-n,v=n,q.reverse?(h*=-1,n=k+h):n=m;else if(this.isLooped)g=null,k=m=h=n=0,q=null,r=0;else{this.isEnded=!0;g=d;n=h=0;break}a[t]=g[n|0]*s;f[t]=g[n|0]*v;n+=h}this.buffer=g;this.bufferIndex=n;this.bufferIndexIncr=h;this.bufferBeginIndex=m;this.bufferEndIndex=k;this.fragment=q;this.fragmentIndex=r;this.panL=s;this.panR=v;return[a,f]};i.modules.Scissor=h})(timbre);
(function(i){function h(g){this.samplerate=g;this.buffersize=1<<Math.ceil(Math.log(1.5*g)*Math.LOG2E);this.buffermask=this.buffersize-1;this.writeBufferL=new i.fn.SignalArray(this.buffersize);this.writeBufferR=new i.fn.SignalArray(this.buffersize);this.readBufferL=this.writeBufferL;this.readBufferR=this.writeBufferR;this.mix=this.cross=this.feedback=this.delaytime=null;this.writeIndex=this.readIndex=this.prevR=this.prevL=0;this.setParams(125,0.25,!1,0.45)}var g=h.prototype;g.setParams=function(g,
e,d,c){this.delaytime!==g&&(this.delaytime=g,g=0.001*g*this.samplerate|0,g>this.buffermask&&(g=this.buffermask),this.writeIndex=this.readIndex+g&this.buffermask);this.feedback!==e&&(this.feedback=e);this.cross!==d&&((this.cross=d)?(this.readBufferL=this.writeBufferR,this.readBufferR=this.writeBufferL):(this.readBufferL=this.writeBufferL,this.readBufferR=this.writeBufferR));this.mix!==c&&(this.mix=c)};g.process=function(g,e){var d=this.readBufferL,c=this.readBufferR,b=this.writeBufferL,a=this.writeBufferR,
f=this.readIndex,j=this.writeIndex,l=this.buffermask,p=this.feedback,n=this.mix,h=1-n,m=this.prevL,i=this.prevR,q,r,s=g.length;for(r=0;r<s;++r)q=d[f],b[j]=g[r]-q*p,g[r]=m=0.5*(g[r]*h+q*n+m),q=c[f],a[j]=e[r]-q*p,e[r]=i=0.5*(e[r]*h+q*n+i),f+=1,j=j+1&l;this.readIndex=f&this.buffermask;this.writeIndex=j;this.prevL=m;this.prevR=i};i.modules.StereoDelay=h})(timbre);
(function(i){var h=i.fn,g=i.modules;h.register("audio",function(d){d=new (h.getClass("buffer"))(d);d.playbackState=h.FINISHED_STATE;d._.isLoaded=!1;Object.defineProperties(d,{isLoaded:{get:function(){return this._.isLoaded}}});d.load=k;d.loadthis=e;return d});var k=function(d){var c=this,b=this._,a=new g.Deferred(this),f=arguments,j=1;a.done(function(){c._.emit("done")});"function"===typeof f[j]&&(a.done(f[j++]),"function"===typeof f[j]&&a.fail(f[j++]));b.loadedTime=0;(new g.Decoder).decode(d,function(b,
f){var d=c._;if(b){c.playbackState=h.PLAYING_STATE;d.samplerate=b.samplerate;d.channels=b.channels;d.bufferMix=null;d.buffer=b.buffer;d.phase=0;d.phaseIncr=b.samplerate/i.samplerate;d.duration=b.duration*1E3;d.currentTime=0;if(d.isReversed){d.phaseIncr=d.phaseIncr*-1;d.phase=b.buffer[0].length+d.phaseIncr}c._.emit("loadedmetadata")}else a.reject(f)},function(){c._.isLoaded=true;c._.plotFlush=true;c._.emit("loadeddata");a.resolveWith(c)});return a.promise()},e=function(){k.apply(this,arguments);return this}})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);g.fixAR(this);a=this._;a.biquad=new e(a.samplerate);a.freq=i(340);a.band=i(1);a.gain=i(0);a.plotBefore=d;a.plotRange=[-18,18];a.plotFlush=!0}var g=i.fn,k=i.modules.FFT,e=i.modules.Biquad;g.extend(h);var d=function(a,b,c,d,e){a.lineWidth=1;a.strokeStyle="rgb(192, 192, 192)";for(var g=0.5*this._.samplerate,h=1;10>=h;++h)for(var i=1;4>=i;i++){var k=h*Math.pow(10,i);20>=k||g<=k||(a.beginPath(),k=Math.log(k/20)/Math.log(g/20),k=(k*d+b|0)+0.5,a.moveTo(k,
c),a.lineTo(k,c+e),a.stroke())}e/=6;for(h=1;6>h;h++)a.beginPath(),g=(c+h*e|0)+0.5,a.moveTo(b,g),a.lineTo(b+d,g),a.stroke()},c=h.prototype;Object.defineProperties(c,{type:{set:function(a){var b=this._;a!==b.biquad.type&&(b.biquad.setType(a),b.plotFlush=!0)},get:function(){return this._.biquad.type}},freq:{set:function(a){this._.freq=i(a)},get:function(){return this._.freq}},cutoff:{set:function(a){this._.freq=i(a)},get:function(){return this._.freq}},res:{set:function(a){this._.band=i(a)},get:function(){return this._.band}},
Q:{set:function(a){this._.band=i(a)},get:function(){return this._.band}},band:{set:function(a){this._.band=i(a)},get:function(){return this._.band}},gain:{set:function(a){this._.gain=i(a)},get:function(){return this._.gain}}});c.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;g.inputSignalAR(this);var c=b.freq.process(a).cells[0][0],d=b.band.process(a).cells[0][0],a=b.gain.process(a).cells[0][0];if(b.prevFreq!==c||b.prevband!==d||b.prevGain!==a)b.prevFreq=c,b.prevband=d,b.prevGain=
a,b.biquad.setParams(c,d,a),b.plotFlush=!0;b.bypassed||b.biquad.process(this.cells[1],this.cells[2]);g.outputSignalAR(this)}return this};var b=new k(2048),a=i.Object.prototype.plot;c.plot=function(f){if(this._.plotFlush){var c=new e(this._.samplerate);c.setType(this.type);c.setParams(this.freq.valueOf(),this.band.valueOf(),this.gain.valueOf());var d=new Float32Array(b.length);d[0]=1;c.process(d,d);b.forward(d);var c=new Float32Array(512),d=0.5*this._.samplerate,g=new Float32Array(512),n,h,m,i;b.getFrequencyData(g);
for(n=0;512>n;++n)m=20*Math.pow(d/20,n/512),h=m/(d/g.length),m=h|0,h-=m,0===m?m=g[m]:(i=g[m-1],m=g[m],m=(1-h)*i+h*m),c[n]=m;this._.plotData=c;this._.plotFlush=null}return a.call(this,f)};g.register("biquad",h);g.register("lowpass",function(a){return(new h(a)).set("type","lowpass")});g.register("highpass",function(a){return(new h(a)).set("type","highpass")});g.register("bandpass",function(a){return(new h(a)).set("type","bandpass")});g.register("lowshelf",function(a){return(new h(a)).set("type","lowshelf")});
g.register("highshelf",function(a){return(new h(a)).set("type","highshelf")});g.register("peaking",function(a){return(new h(a)).set("type","peaking")});g.register("notch",function(a){return(new h(a)).set("type","notch")});g.register("allpass",function(a){return(new h(a)).set("type","allpass")});g.alias("lpf","lowpass");g.alias("hpf","highpass");g.alias("bpf","bandpass");g.alias("bef","notch");g.alias("brf","notch");g.alias("apf","allpass")})(timbre);
(function(i){function h(a){i.Object.call(this,1,a);g.fixAR(this);a=this._;a.pitch=i(1);a.samplerate=44100;a.channels=0;a.bufferMix=null;a.buffer=[];a.isLooped=!1;a.isReversed=!1;a.duration=0;a.currentTime=0;a.currentTimeObj=null;a.phase=0;a.phaseIncr=0;a.onended=g.make_onended(this,0);a.onlooped=d(this)}var g=i.fn,k=i.modules.Scissor.Tape,e=function(a){return g.isSignalArray(a)||a instanceof Float32Array};g.extend(h);var d=function(a){return function(){var b=a._;b.phase>=b.buffer[0].length?b.phase=
0:0>b.phase&&(b.phase=b.buffer[0].length+b.phaseIncr);a._.emit("looped")}},c=h.prototype,b=function(a){var b=this._;if("object"===typeof a){var c=[],d;e(a)?c[0]=a:"object"===typeof a&&(a instanceof i.Object?a=a.buffer:a instanceof k&&(a=a.getBuffer()),Array.isArray(a.buffer)?e(a.buffer[0])&&(c=e(a.buffer[1])&&e(a.buffer[2])?a.buffer:[a.buffer[0]]):e(a.buffer)&&(c=[a.buffer]),"number"===typeof a.samplerate&&(d=a.samplerate));c.length&&(0<d&&(b.samplerate=a.samplerate),b.bufferMix=null,b.buffer=c,b.phase=
0,b.phaseIncr=b.samplerate/i.samplerate,b.duration=1E3*b.buffer[0].length/b.samplerate,b.currentTime=0,b.plotFlush=!0,this.reverse(b.isReversed))}};Object.defineProperties(c,{buffer:{set:b,get:function(){var a=this._;return{samplerate:a.samplerate,channels:a.channels,buffer:a.buffer}}},pitch:{set:function(a){this._.pitch=i(a)},get:function(){return this._.pitch}},isLooped:{get:function(){return this._.isLooped}},isReversed:{get:function(){return this._.isReversed}},samplerate:{get:function(){return this._.samplerate}},
duration:{get:function(){return this._.duration}},currentTime:{set:function(a){if("number"===typeof a){var b=this._;0<=a&&a<=b.duration&&(b.phase=a/1E3*b.samplerate,b.currentTime=a)}else a instanceof i.Object?this._.currentTimeObj=a:null===a&&(this._.currentTimeObj=null)},get:function(){return this._.currentTimeObj?this._.currentTimeObj:this._.currentTime}}});c.clone=function(){var a=this._,c=g.clone(this);a.buffer.length&&b.call(c,{buffer:a.buffer,samplerate:a.samplerate,channels:a.channels});c.loop(a.isLooped);
c.reverse(a.isReversed);return c};c.slice=function(a,c){var d=this._,e=i(d.originkey);if(d.buffer.length){a="number"===typeof a?0.001*a*d.samplerate|0:0;c="number"===typeof c?0.001*c*d.samplerate|0:d.buffer[0].length;if(a>c)var h=a,a=c,c=h;2===d.channels?b.call(e,{buffer:[g.pointer(d.buffer[0],a,c-a),g.pointer(d.buffer[1],a,c-a),g.pointer(d.buffer[2],a,c-a)],samplerate:d.samplerate}):b.call(e,{buffer:g.pointer(d.buffer[0],a,c-a),samplerate:d.samplerate});e.playbackState=g.PLAYING_STATE}e.loop(d.isLooped);
e.reverse(d.isReversed);return e};c.reverse=function(a){var b=this._;b.isReversed=!!a;if(b.isReversed){if(0<b.phaseIncr&&(b.phaseIncr*=-1),0===b.phase&&b.buffer.length)b.phase=b.buffer[0].length+b.phaseIncr}else 0>b.phaseIncr&&(b.phaseIncr*=-1);return this};c.loop=function(a){this._.isLooped=!!a;return this};c.bang=function(a){this.playbackState=!1===a?g.FINISHED_STATE:g.PLAYING_STATE;this._.phase=0;this._.emit("bang");return this};c.process=function(a){var b=this._;if(!b.buffer.length)return this;
if(this.tickID!==a){this.tickID=a;var c=this.cells[1],d=this.cells[2],e=b.phase,h=b.cellsize,m,i;2===b.channels?(m=b.buffer[1],i=b.buffer[2]):m=i=b.buffer[0];if(b.currentTimeObj){for(var k=b.currentTimeObj.process(a).cells[0],r,s=0.001*b.samplerate,a=0;a<h;++a)r=k[a],e=r*s,c[a]=m[e|0]||0,d[a]=i[e|0]||0;b.phase=e;b.currentTime=r}else{a=b.pitch.process(a).cells[0][0];r=b.phaseIncr*a;for(a=0;a<h;++a)c[a]=m[e|0]||0,d[a]=i[e|0]||0,e+=r;e>=m.length?b.isLooped?g.nextTick(b.onlooped):g.nextTick(b.onended):
0>e&&(b.isLooped?g.nextTick(b.onlooped):g.nextTick(b.onended));b.phase=e;b.currentTime+=g.currentTimeIncr}g.outputSignalAR(this)}return this};var a=i.Object.prototype.plot;c.plot=function(b){var c=this._,d,e;if(c.plotFlush){2===c.channels?(d=c.buffer[1],e=c.buffer[2]):d=e=c.buffer[0];for(var g=new Float32Array(2048),h=0,m=d.length/2048,i=0;2048>i;i++)g[i]=0.5*(d[h|0]+e[h|0]),h+=m;c.plotData=g;c.plotFlush=null}return a.call(this,b)};g.register("buffer",h)})(timbre);
(function(i){function h(d){i.Object.call(this,2,d);g.fixAR(this);d=new k(this._.samplerate);d.setDelayTime(20);d.setRate(4);d.depth=20;d.feedback=0.2;d.mix=0.33;this._.chorus=d}var g=i.fn,k=i.modules.Chorus;g.extend(h);var e=h.prototype;Object.defineProperties(e,{type:{set:function(d){this._.chorus.setDelayTime(d)},get:function(){return this._.chorus.wave}},delay:{set:function(d){0.5<=d&&80>=d&&this._.chorus.setDelayTime(d)},get:function(){return this._.chorus.delayTime}},rate:{set:function(d){"number"===
typeof d&&0<d&&this._.chorus.setRate(d)},get:function(){return this._.chorus.rate}},depth:{set:function(d){"number"===typeof d&&(0<=d&&100>=d)&&(d*=this._.samplerate/44100,this._.chorus.depth=d)},get:function(){return this._.chorus.depth}},fb:{set:function(d){"number"===typeof d&&(-1<=d&&1>=d)&&(this._.chorus.feedback=0.99996*d)},get:function(){return this._.chorus.feedback}},mix:{set:function(d){this._.mix=i(d)},get:function(){return this._.mix}}});e.process=function(d){var c=this._;this.tickID!==
d&&(this.tickID=d,g.inputSignalAR(this),c.bypassed||c.chorus.process(this.cells[1],this.cells[2]),g.outputSignalAR(this));return this};g.register("chorus",h)})(timbre);
(function(i){function h(e){i.Object.call(this,2,e);e=this._;e.min=-0.8;e.max=0.8}var g=i.fn;g.extend(h);var k=h.prototype;Object.defineProperties(k,{minmax:{set:function(e){var d=this._;"number"===typeof e&&(d.min=-Math.abs(e),d.max=-d.min)},get:function(){return this._.max}},min:{set:function(e){var d=this._;"number"===typeof e&&(d.max<e?d.max=e:d.min=e)},get:function(){return this._.min}},max:{set:function(e){var d=this._;"number"===typeof e&&(e<d.min?d.min=e:d.max=e)},get:function(){return this._.max}}});
k.process=function(e){var d=this._;if(this.tickID!==e){this.tickID=e;var e=this.cells[1],c=this.cells[2],b=e.length,a=d.min,f=d.max,j;if(d.ar){g.inputSignalAR(this);for(d=0;d<b;++d)j=e[d],j<a?j=a:j>f&&(j=f),e[d]=j,j=c[d],j<a?j=a:j>f&&(j=f),c[d]=j;g.outputSignalAR(this)}else j=g.inputSignalKR(this),j<a?j=a:j>f&&(j=f),this.cells[0][0]=j,g.outputSignalKR(this)}return this};g.register("clip",h)})(timbre);
(function(i){function h(c){i.Object.call(this,2,c);g.fixAR(this);c=this._;c.prevThresh=-24;c.prevKnee=30;c.prevRatio=12;c.thresh=i(c.prevThresh);c.knee=i(c.prevKnee);c.ratio=i(c.prevRatio);c.postGain=6;c.reduction=0;c.attack=3;c.release=25;c.comp=new e(c.samplerate);c.comp.dbPostGain=c.postGain;c.comp.setAttackTime(0.001*c.attack);c.comp.setReleaseTime(0.001*c.release);c.comp.setPreDelayTime(6);c.comp.setParams(c.prevThresh,c.prevKnee,c.prevRatio)}var g=i.fn,k=i.timevalue,e=i.modules.Compressor;g.extend(h);
var d=h.prototype;Object.defineProperties(d,{thresh:{set:function(c){this._.thresh=i(c)},get:function(){return this._.thresh}},thre:{set:function(c){this._.thresh=i(c)},get:function(){return this._.thre}},knee:{set:function(c){this._.kne=i(c)},get:function(){return this._.knee}},ratio:{set:function(c){this._.ratio=i(c)},get:function(){return this._.ratio}},gain:{set:function(c){"number"===typeof c&&(this._.comp.dbPostGain=c)},get:function(){return this._.comp.dbPostGain}},attack:{set:function(c){"string"===
typeof c&&(c=k(c));"number"===typeof c&&(c=0>c?0:1E3<c?1E3:c,this._.attack=c,this._.comp.setAttackTime(0.001*c))},get:function(){return this._.attack}},release:{set:function(c){"string"===typeof c&&(c=k(c));"number"===typeof c&&(c=0>c?0:1E3<c?1E3:c,this._.release=c,this._.comp.setReleaseTime(0.001*c))},get:function(){return this._.release}},reduction:{get:function(){return this._.reduction}}});d.process=function(c){var b=this._;if(this.tickID!==c){this.tickID=c;g.inputSignalAR(this);var a=b.thresh.process(c).cells[0][0],
f=b.knee.process(c).cells[0][0],c=b.ratio.process(c).cells[0][0];if(b.prevThresh!==a||b.prevKnee!==f||b.prevRatio!==c)b.prevThresh=a,b.prevKnee=f,b.prevRatio=c,b.comp.setParams(a,f,c);b.bypassed||(b.comp.process(this.cells[1],this.cells[2]),b.reduction=b.comp.meteringGain);g.outputSignalAR(this)}return this};g.register("comp",h)})(timbre);
(function(i){function h(c){i.Object.call(this,2,c);g.fixAR(this);c=this._;c.time=i(100);c.fb=i(0.2);c.cross=i(!1);c.mix=0.33;c.delay=new e(c.samplerate)}var g=i.fn,k=i.timevalue,e=i.modules.StereoDelay;g.extend(h);var d=h.prototype;Object.defineProperties(d,{time:{set:function(c){"string"===typeof c&&(c=k(c));this._.time=i(c)},get:function(){return this._.time}},fb:{set:function(c){this._.fb=i(c)},get:function(){return this._.fb}},cross:{set:function(c){this._.cross=i(c)},get:function(){return this._.cross}},
mix:{set:function(c){"number"===typeof c&&(this._.mix=1<c?1:0>c?0:c)},get:function(){return this._.mix}}});d.process=function(c){var b=this._;if(this.tickID!==c){this.tickID=c;var a=b.time.process(c).cells[0][0],f=b.fb.process(c).cells[0][0],c=0!==b.cross.process(c).cells[0][0],d=b.mix;if(b.prevTime!==a||b.prevFb!==f||b.prevCross!==c||b.prevMix!==d)b.prevTime=a,b.prevFb=f,b.prevCross=c,b.prevMix=d,b.delay.setParams(a,f,c,d);g.inputSignalAR(this);b.bypassed||b.delay.process(this.cells[1],this.cells[2]);
g.outputSignalAR(this)}return this};g.register("delay",h)})(timbre);
(function(i){function h(e){i.Object.call(this,2,e);g.fixAR(this);e=this._;e.pre=i(60);e.post=i(-18);e.x1L=e.x2L=e.y1L=e.y2L=0;e.x1R=e.x2R=e.y1R=e.y2R=0;e.b0=e.b1=e.b2=e.a1=e.a2=0;e.cutoff=0;e.Q=1;e.preScale=0;e.postScale=0}var g=i.fn;g.extend(h);var k=h.prototype;Object.defineProperties(k,{cutoff:{set:function(e){"number"===typeof e&&0<e&&(this._.cutoff=e)},get:function(){return this._.cutoff}},pre:{set:function(e){this._.pre=i(e)},get:function(){return this._.pre}},post:{set:function(e){this._.post=
i(e)},get:function(){return this._.post}}});k.process=function(e){var d=this._;if(this.tickID!==e){this.tickID=e;g.inputSignalAR(this);var c=-d.pre.process(e).cells[0][0],e=-d.post.process(e).cells[0][0];if(d.prevPreGain!==c||d.prevPostGain!==e)d.prevPreGain=c,d.prevPostGain=e,d.preScale=Math.pow(10,0.05*-c),d.postScale=Math.pow(10,0.05*-e);if(!d.bypassed){var c=this.cells[1],e=this.cells[2],b=d.preScale,a=d.postScale,f,j,l,h,n;if(d.cutoff){d.prevCutoff!==d.cutoff&&(d.prevCutoff=d.cutoff,j=2*Math.PI*
d.cutoff/d.samplerate,f=Math.cos(j),j=Math.sin(j)/(2*d.Q),l=1/(1+j),d.b0=0.5*(1-f)*l,d.b1=1-f*l,d.b2=0.5*(1-f)*l,d.a1=-2*f*l,d.a2=1-j*l);var i=d.x1L,m=d.x2L,k=d.y1L,q=d.y2L,r=d.x1R,s=d.x2R,v=d.y1R,t=d.y2R,w=d.b0,z=d.b1,B=d.b2,E=d.a1,C=d.a2;f=0;for(j=c.length;f<j;++f)h=c[f]*b,n=w*h+z*i+B*m-E*k-C*q,l=n*a,-1>l?l=-1:1<l&&(l=1),c[f]=l,m=i,i=h,q=k,k=n,h=e[f]*b,n=w*h+z*r+B*s-E*v-C*t,l=n*a,-1>l?l=-1:1<l&&(l=1),e[f]=l,s=r,r=h,t=v,v=n;d.x1L=i;d.x2L=m;d.y1L=k;d.y2L=q;d.x1R=r;d.x2R=s;d.y1R=v;d.y2R=t}else{f=0;
for(j=c.length;f<j;++f)l=c[f]*b*a,-1>l?l=-1:1<l&&(l=1),c[f]=l,l=e[f]*b*a,-1>l?l=-1:1<l&&(l=1),e[f]=l}}g.outputSignalAR(this)}return this};g.register("dist",h)})(timbre);
(function(i){function h(g){i.Object.call(this,2,g);this._.ar=!1}var g=i.fn;g.extend(h);h.prototype.process=function(h){var e=this._;if(this.tickID!==h){this.tickID=h;var d=this.nodes,c=this.cells[0],b=this.cells[1],a=this.cells[2],f,j=d.length,l=c.length,p,n;if(e.ar){if(0<d.length){d[0].process(h);p=d[0].cells[1];n=d[0].cells[2];b.set(p);a.set(n);for(f=1;f<j;++f){d[f].process(h);p=d[f].cells[1];n=d[f].cells[2];for(c=0;c<l;++c)e=p[c],b[c]=0===e?0:b[c]/e,e=n[c],a[c]=0===e?0:a[c]/e}}else for(c=0;c<l;++c)b[c]=
a[f]=0;g.outputSignalAR(this)}else{if(0<d.length){b=d[0].process(h).cells[0][0];for(f=1;f<j;++f)e=d[f].process(h).cells[0][0],b=0===e?0:b/e}else b=0;c[0]=b;g.outputSignalKR(this)}}return this};g.register("/",h)})(timbre);
(function(i){function h(c){i.Object.call(this,2,c);c=this._;c.env=new d(c.samplerate);c.env.setStep(c.cellsize);c.tmp=new k.SignalArray(c.cellsize);c.ar=!1;c.plotFlush=!0;c.onended=a(this);this.on("ar",b)}function g(a,b,c,f,d,e){"number"===typeof a[f]?c=a[f]:"number"===typeof a[d]?c=a[d]:e&&("string"===typeof a[f]?c=e(a[f]):"string"===typeof a[d]&&(c=e(a[d])));c<b&&(c=b);return c}var k=i.fn,e=i.timevalue,d=i.modules.Envelope,c=k.isDictionary;k.extend(h);var b=function(a){this._.env.setStep(a?1:this._.cellsize)},
a=function(a){return function(){a._.emit("ended")}},f=h.prototype;Object.defineProperties(f,{table:{set:function(a){if(Array.isArray(a)){for(var b=this._.env,c=[a[0]||l],f,j,g,h,i=1,k=a.length;i<k;++i)f=a[i][0]||l,j=a[i][1],g=a[i][2],"number"!==typeof j&&(j="string"===typeof j?e(j):10),10>j&&(j=10),"number"===typeof g?(h=g,g=d.CurveTypeCurve):(g=d.CurveTypeDict[g]||null,h=0),c.push([f,j,g,h]);b.setTable(c);this._.plotFlush=!0}},get:function(){return this._.env.table}},curve:{set:function(a){this._.env.setCurve(a)},
get:function(){return this._.env.curve}},releaseNode:{set:function(a){this._.env.setReleaseNode(a);this._.plotFlush=!0},get:function(){return this._.env.releaseNode+1}},loopNode:{set:function(a){this._.env.setLoopNode(a);this._.plotFlush=!0},get:function(){return this._.env.loopNode+1}}});f.clone=function(){var a=k.clone(this);a._.env=this._.env.clone();return a};f.reset=function(){this._.env.reset();return this};f.release=function(){var a=this._;a.env.release();a.emit("released");return this};f.bang=
function(){var a=this._;a.env.reset();a.env.status=d.StatusGate;a.emit("bang");return this};f.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;var a=this.cells[1],c=this.cells[2],f,d=b.cellsize;if(this.nodes.length)k.inputSignalAR(this);else for(f=0;f<d;++f)a[f]=c[f]=1;var e;f=null;if(b.ar){e=b.tmp;b.env.process(e);for(f=0;f<d;++f)a[f]*=e[f],c[f]*=e[f]}else{e=b.env.next();for(f=0;f<d;++f)a[f]*=e,c[f]*=e}f=b.env.emit;k.outputSignalAR(this);f&&("ended"===f?k.nextTick(b.onended):this._.emit(f,
b.value))}return this};var j=i.Object.prototype.plot;f.plot=function(a){if(this._.plotFlush){var b=this._.env.clone(),c=b.getInfo(1E3),f=c.totalDuration,e=c.loopBeginTime,g=c.releaseBeginTime,c=new Float32Array(256),l=0,h=f/c.length,i=!1,k=0.001*f*this._.samplerate|0,w,k=k/c.length;b.setStep(k);b.status=d.StatusGate;k=0;for(w=c.length;k<w;++k)c[k]=b.next(),l+=h,!i&&l>=g&&(b.release(),i=!0);this._.plotData=c;this._.plotBefore=function(a,b,c,d,j){var l;Infinity!==e&&Infinity!==g&&(c=b+d*(e/f),l=b+d*
(g/f),a.fillStyle="rgba(224, 224, 224, 0.8)",a.fillRect(c,0,l-c,j));Infinity!==g&&(c=b+d*(g/f),a.fillStyle="rgba(212, 212, 212, 0.8)",a.fillRect(c,0,d-c,j))};b=Infinity;l=-Infinity;for(k=0;k<w;++k)c[k]<b?b=c[k]:c[k]>l&&(l=c[k]);1>l&&(l=1);this._.plotRange=[b,l];this._.plotData=c;this._.plotFlush=null}return j.call(this,a)};k.register("env",h);var l=d.ZERO;k.register("perc",function(a){c(a[0])||a.unshift({});var b=a[0],f=g(b,10,10,"a","attackTime",e),d=g(b,10,1E3,"r","releaseTime",e),j=g(b,l,1,"lv",
"level");b.table=[l,[j,f],[l,d]];return new h(a)});k.register("adsr",function(a){c(a[0])||a.unshift({});var b=a[0],f=g(b,10,10,"a","attackTime",e),d=g(b,10,300,"d","decayTime",e),j=g(b,l,0.5,"s","sustainLevel"),i=g(b,10,1E3,"r","decayTime",e),k=g(b,l,1,"lv","level");b.table=[l,[k,f],[j,d],[l,i]];b.releaseNode=3;return new h(a)});k.register("adshr",function(a){c(a[0])||a.unshift({});var b=a[0],f=g(b,10,10,"a","attackTime",e),d=g(b,10,300,"d","decayTime",e),j=g(b,l,0.5,"s","sustainLevel"),i=g(b,10,
500,"h","holdTime",e),k=g(b,10,1E3,"r","decayTime",e),s=g(b,l,1,"lv","level");b.table=[l,[s,f],[j,d],[j,i],[l,k]];return new h(a)});k.register("asr",function(a){c(a[0])||a.unshift({});var b=a[0],f=g(b,10,10,"a","attackTime",e),d=g(b,l,0.5,"s","sustainLevel"),j=g(b,10,1E3,"r","releaseTime",e);b.table=[l,[d,f],[l,j]];b.releaseNode=2;return new h(a)});k.register("dadsr",function(a){c(a[0])||a.unshift({});var b=a[0],f=g(b,10,100,"dl","delayTime",e),d=g(b,10,10,"a","attackTime",e),j=g(b,10,300,"d","decayTime",
e),i=g(b,l,0.5,"s","sustainLevel"),k=g(b,10,1E3,"r","relaseTime",e),s=g(b,l,1,"lv","level");b.table=[l,[l,f],[s,d],[i,j],[l,k]];b.releaseNode=4;return new h(a)});k.register("ahdsfr",function(a){c(a[0])||a.unshift({});var b=a[0],f=g(b,10,10,"a","attackTime",e),d=g(b,10,10,"h","holdTime",e),j=g(b,10,300,"d","decayTime",e),i=g(b,l,0.5,"s","sustainLevel"),k=g(b,10,5E3,"f","fadeTime",e),s=g(b,10,1E3,"r","relaseTime",e),v=g(b,l,1,"lv","level");b.table=[l,[v,f],[v,d],[i,j],[l,k],[l,s]];b.releaseNode=5;return new h(a)});
k.register("linen",function(a){c(a[0])||a.unshift({});var b=a[0],f=g(b,10,10,"a","attackTime",e),d=g(b,10,1E3,"s","sustainTime",e),j=g(b,10,1E3,"r","releaseTime",e),i=g(b,l,1,"lv","level");b.table=[l,[i,f],[i,d],[l,j]];return new h(a)});k.register("env.tri",function(a){c(a[0])||a.unshift({});var b=a[0],f=g(b,20,1E3,"dur","duration",e),d=g(b,l,1,"lv","level"),f=0.5*f;b.table=[l,[d,f],[l,f]];return new h(a)});k.register("env.cutoff",function(a){c(a[0])||a.unshift({});var b=a[0],f=g(b,10,100,"r","relaseTime",
e),d=g(b,l,1,"lv","level");b.table=[d,[l,f]];return new h(a)})})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);g.fixAR(this);a=this._;a.biquads=Array(7);a.plotBefore=c;a.plotRange=[-18,18];a.plotFlush=!0}var g=i.fn,k=i.modules.FFT,e=i.modules.Biquad,d={hpf:0,lf:1,lmf:2,mf:3,hmf:4,hf:5,lpf:6};g.extend(h);var c=function(a,b,c,f,d){a.lineWidth=1;a.strokeStyle="rgb(192, 192, 192)";for(var e=0.5*this._.samplerate,g=1;10>=g;++g)for(var h=1;4>=h;h++){var i=g*Math.pow(10,h);20>=i||e<=i||(a.beginPath(),i=Math.log(i/20)/Math.log(e/20),i=(i*f+b|0)+0.5,a.moveTo(i,c),
a.lineTo(i,c+d),a.stroke())}d/=6;for(g=1;6>g;g++)a.beginPath(),e=(c+g*d|0)+0.5,a.moveTo(b,e),a.lineTo(b+f,e),a.stroke()},b=h.prototype;Object.defineProperties(b,{params:{set:function(a){if("object"===typeof a)for(var b=Object.keys(a),c=0,f=b.length;c<f;++c){var d=a[b[c]];Array.isArray(d)?this.setParams(b[c],d[0],d[1],d[2]):this.setParams(b[c])}}}});b.setParams=function(a,b,c,f){var g=this._;"string"===typeof a&&(a=d[a]);if(0<=a&&a<g.biquads.length){a|=0;if("number"===typeof b&&"number"===typeof c){"number"!==
typeof f&&(f=0);var h=g.biquads[a];if(!h)switch(h=g.biquads[a]=new e(g.samplerate),a){case 0:h.setType("highpass");break;case g.biquads.length-1:h.setType("lowpass");break;default:h.setType("peaking")}h.setParams(b,c,f)}else g.biquads[a]=void 0;g.plotFlush=!0}return this};b.getParams=function(a){if(a=this._.biquads[a|0])return{freq:a.frequency,Q:a.Q,gain:a.gain}};b.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;g.inputSignalAR(this);if(!b.bypassed)for(var a=this.cells[1],c=this.cells[2],
b=b.biquads,f=0,d=b.length;f<d;++f)b[f]&&b[f].process(a,c);g.outputSignalAR(this)}return this};var a=new k(2048),f=i.Object.prototype.plot;b.plot=function(b){if(this._.plotFlush){var c=this._,d=new Float32Array(a.length);d[0]=1;for(var g=0,h=c.biquads.length;g<h;++g){var i=this.getParams(g);if(i){var k=new e(c.samplerate);0===g?k.setType("highpass"):g===h-1?k.setType("lowpass"):k.setType("peaking");k.setParams(i.freq,i.Q,i.gain);k.process(d,d)}}a.forward(d);var d=new Float32Array(512),c=0.5*c.samplerate,
h=new Float32Array(512),q;a.getFrequencyData(h);for(g=0;512>g;++g)i=20*Math.pow(c/20,g/512),k=i/(c/h.length),i=k|0,k-=i,0===i?i=h[i]:(q=h[i-1],i=h[i],i=(1-k)*q+k*i),d[g]=i;this._.plotData=d;this._.plotFlush=null}return f.call(this,b)};g.register("eq",h)})(timbre);
(function(i){function h(c){i.Object.call(this,2,c);g.listener(this);g.fixAR(this);this.real=new i.ChannelObject(this);this.imag=new i.ChannelObject(this);this.cells[3]=this.real.cell;this.cells[4]=this.imag.cell;c=this._;c.fft=new k(2*c.cellsize);c.fftCell=new g.SignalArray(c.fft.length);c.prevCell=new g.SignalArray(c.cellsize);c.freqs=new g.SignalArray(c.fft.length>>1);c.plotFlush=!0;c.plotRange=[0,32];c.plotBarStyle=!0}var g=i.fn,k=i.modules.FFT;g.extend(h);var e=h.prototype;Object.defineProperties(e,
{window:{set:function(c){this._.fft.setWindow(c)},get:function(){return this._.fft.windowName}},spectrum:{get:function(){return this._.fft.getFrequencyData(this._.freqs)}}});e.process=function(c){var b=this._;if(this.tickID!==c){this.tickID=c;g.inputSignalAR(this);g.outputSignalAR(this);var c=this.cells[0],a=b.cellsize;b.fftCell.set(b.prevCell);b.fftCell.set(c,a);b.fft.forward(b.fftCell);b.prevCell.set(c);b.plotFlush=!0;this.cells[3].set(b.fft.real.subarray(0,a));this.cells[4].set(b.fft.imag.subarray(0,
a))}return this};var d=i.Object.prototype.plot;e.plot=function(c){this._.plotFlush&&(this._.plotData=this.spectrum,this._.plotFlush=null);return d.call(this,c)};g.register("fft",h)})(timbre);
(function(i){function h(e){i.Object.call(this,1,e);g.fixAR(this);e=this._;e.freq=i(440);e.reg=32768;e.shortFlag=!1;e.phase=0;e.lastValue=0}var g=i.fn;g.extend(h);var k=h.prototype;Object.defineProperties(k,{shortFlag:{set:function(e){this._.shortFlag=!!e},get:function(){return this._.shortFlag}},freq:{set:function(e){this._.freq=i(e)},get:function(){return this._.freq}}});k.process=function(e){var d=this._,c=this.cells[0];if(this.tickID!==e){this.tickID=e;var b=d.lastValue,a=d.phase,e=d.freq.process(e).cells[0][0]/
d.samplerate,f=d.reg,g=d.mul,l=d.add,h,i;if(d.shortFlag){h=0;for(i=c.length;h<i;++h)1<=a&&(f>>=1,f|=((f^f>>6)&1)<<15,b=(f&1)-0.5,a-=1),c[h]=b*g+l,a+=e}else{h=0;for(i=c.length;h<i;++h)1<=a&&(f>>=1,f|=((f^f>>1)&1)<<15,b=(f&1)-0.5,a-=1),c[h]=b*g+l,a+=e}d.reg=f;d.phase=a;d.lastValue=b}return this};g.register("fnoise",h)})(timbre);
(function(i){function h(d){i.Object.call(this,2,d);g.fixAR(this);this._.selected=0;this._.outputs=[]}var g=i.fn,k=function(){function d(c){i.Object.call(this,2,[]);g.fixAR(this);this._.parent=c}g.extend(d);d.prototype.process=function(c){this.tickID!==c&&(this.tickID=c,this._.parent.process(c));return this};return d}();g.extend(h);var e=h.prototype;Object.defineProperties(e,{selected:{set:function(d){var c=this._;if("number"===typeof d){c.selected=d;for(var d=c.outputs,c=0,b=d.length;c<b;++c)d[c]&&
(d[c].cells[0].set(g.emptycell),d[c].cells[1].set(g.emptycell),d[c].cells[2].set(g.emptycell))}},get:function(){return this._.selected}}});e.at=function(d){var c=this._,b=c.outputs[d];b||(c.outputs[d]=b=new k(this));return b};e.process=function(d){var c=this._;if(this.tickID!==d&&(this.tickID=d,g.inputSignalAR(this),g.outputSignalAR(this),d=c.outputs[c.selected]))d.cells[0].set(this.cells[0]),d.cells[1].set(this.cells[1]),d.cells[2].set(this.cells[2]);return this};g.register("gate",h)})(timbre);
(function(i){function h(d){i.Object.call(this,1,d);g.fixAR(this);d=this._;d.fft=new k(2*d.cellsize);d.fftCell=new g.SignalArray(this._.fft.length);d.realBuffer=new g.SignalArray(this._.fft.length);d.imagBuffer=new g.SignalArray(this._.fft.length)}var g=i.fn,k=i.modules.FFT;g.extend(h);var e=h.prototype;Object.defineProperties(e,{real:{set:function(d){this._.real=i(d)},get:function(){return this._.real}},imag:{set:function(d){this._.imag=i(d)},get:function(){return this._.imag}}});e.process=function(d){var c=
this._;if(this.tickID!==d&&(this.tickID=d,c.real&&c.imag)){var b=this.cells[0],a=c.realBuffer,f=c.imagBuffer,e=c.real.process(d).cells[0],d=c.imag.process(d).cells[0];a.set(e);f.set(d);b.set(c.fft.inverse(a,f).subarray(0,c.cellsize));g.outputSignalAR(this)}return this};g.register("ifft",h)})(timbre);
(function(i){function h(c){i.Object.call(this,1,c);g.timer(this);g.fixKR(this);c=this._;c.interval=i(1E3);c.count=0;c.delay=0;c.timeout=Infinity;c.currentTime=0;c.delaySamples=0;c.countSamples=0;c.onended=g.make_onended(this);this.on("start",e)}var g=i.fn,k=i.timevalue;g.extend(h);var e=function(){var c=this._;this.playbackState=g.PLAYING_STATE;c.delaySamples=c.samplerate*0.001*c.delay|0;c.countSamples=c.count=c.currentTime=0};Object.defineProperty(e,"unremovable",{value:!0,writable:!1});var d=h.prototype;
Object.defineProperties(d,{interval:{set:function(c){"string"===typeof c&&(c=k(c),0>=c&&(c=0));this._.interval=i(c)},get:function(){return this._.interval}},delay:{set:function(c){"string"===typeof c&&(c=k(c));"number"===typeof c&&0<=c&&(this._.delay=c,this._.delaySamples=this._.samplerate*0.001*c|0)},get:function(){return this._.delay}},count:{set:function(c){"number"===typeof c&&(this._.count=c)},get:function(){return this._.count}},timeout:{set:function(c){"string"===typeof c&&(c=k(c));"number"===
typeof c&&0<=c&&(this._.timeout=c)},get:function(){return this._.timeout}},currentTime:{get:function(){return this._.currentTime}}});d.bang=function(){var c=this._;this.playbackState=g.PLAYING_STATE;c.delaySamples=c.samplerate*0.001*c.delay|0;c.countSamples=c.count=c.currentTime=0;c.emit("bang");return this};d.process=function(c){var b=this.cells[0],a=this._;if(this.tickID!==c){this.tickID=c;0<a.delaySamples&&(a.delaySamples-=b.length);c=a.interval.process(c).cells[0][0];if(0>=a.delaySamples&&(a.countSamples-=
b.length,0>=a.countSamples)){a.countSamples+=0.001*a.samplerate*c|0;for(var c=this.nodes,f=a.count,d=f*a.mul+a.add,e=0,h=b.length;e<h;++e)b[e]=d;b=0;for(d=c.length;b<d;++b)c[b].bang(f);a.count+=1}a.currentTime+=g.currentTimeIncr;a.currentTime>=a.timeout&&g.nextTick(a.onended)}return this};g.register("interval",h)})(timbre);
(function(i){function h(d){i.Object.call(this,1,d);g.fixAR(this);var d=this._,c=Math.ceil(Math.log(d.samplerate)*Math.LOG2E);d.buffersize=1<<c;d.buffermask=d.buffersize-1;d.buffer=new g.SignalArray(d.buffersize);d.time=0;d.readIndex=0;d.writeIndex=0}var g=i.fn,k=i.timevalue;g.extend(h);var e=h.prototype;Object.defineProperties(e,{time:{set:function(d){"string"===typeof d&&(d=k(d));if("number"===typeof d&&0<d){var c=this._;c.time=d;d=0.001*d*c.samplerate|0;d>c.buffermask&&(d=c.buffermask);c.writeIndex=
c.readIndex+d&c.buffermask}},get:function(){return this._.time}}});e.process=function(d){var c=this._;if(this.tickID!==d){this.tickID=d;g.inputSignalAR(this);var d=this.cells[0],b=c.buffer,a=c.buffermask,f=c.readIndex,e=c.writeIndex,l,h=d.length;for(l=0;l<h;++l)b[e]=d[l],d[l]=b[f],f+=1,e=e+1&a;c.readIndex=f&a;c.writeIndex=e;g.outputSignalAR(this)}return this};g.register("lag",h)})(timbre);
(function(i){function h(d){i.Object.call(this,1,d);d=this._;d.input=0;d.value=0;d.prev=null;d.ar=!1;d.map=k}var g=i.fn;g.extend(h);var k=function(d){return d},e=h.prototype;Object.defineProperties(e,{input:{set:function(d){"number"===typeof d&&(this._.input=d)},get:function(){return this._.input}},map:{set:function(d){"function"===typeof d&&(this._.map=d)},get:function(){return this._.map}}});e.bang=function(){this._.prev=null;this._.emit("bang");return this};e.at=function(d){return this._.map?this._.map(d):
0};e.process=function(d){var c=this.cells[0],b=this._;if(this.tickID!==d){this.tickID=d;var a=this.nodes.length,d=c.length;if(b.ar&&a){g.inputSignalAR(this);var f=b.map;if(f)for(a=0;a<d;++a)c[a]=f(c[a]);b.value=c[d-1];g.outputSignalAR(this)}else{a=a?g.inputSignalKR(this):b.input;b.map&&b.prev!==a&&(b.prev=a,b.value=b.map(a));b=b.value*b.mul+b.add;for(a=0;a<d;++a)c[a]=b}}return this};g.register("map",h)})(timbre);
(function(i){function h(g){i.Object.call(this,1,g)}var g=i.fn;g.extend(h);h.prototype.process=function(h){var e=this.cells[0],d=this._;if(this.tickID!==h){this.tickID=h;var c=this.nodes,b=c.length,a,f=e.length,j,l;if(d.ar){if(0<c.length){j=c[0].process(h).cells[0];e.set(j);for(d=1;d<b;++d){j=c[d].process(h).cells[0];for(a=0;a<f;++a)l=j[a],e[a]<l&&(e[a]=l)}}else for(a=0;a<f;++a)e[a]=0;g.outputSignalAR(this)}else{if(0<c.length){j=c[0].process(h).cells[0][0];for(d=1;d<b;++d)l=c[d].process(h).cells[0][0],
j<l&&(j=l)}else j=0;e[0]=j;g.outputSignalKR(this)}}return this};g.register("max",h)})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);g.fixAR(this);a=this._;a.src=a.func=null;a.bufferL=new g.SignalArray(k);a.bufferR=new g.SignalArray(k);a.readIndex=0;a.writeIndex=0;a.totalRead=0;a.totalWrite=0}if("browser"===i.envtype){var g=i.fn,k=4096,e=k-1;g.extend(h);var d=h.prototype;d.listen=function(a){var b=c[i.env];b&&(b.set.call(this,a),b.listen.call(this))};d.unlisten=function(){var a=c[i.env];a&&a.unlisten.call(this);this.cells[0].set(g.emptycell);this.cells[1].set(g.emptycell);this.cells[2].set(g.emptycell);
for(var b=this._,a=b.bufferL,b=b.bufferR,d=0,e=a.length;d<e;++d)a[d]=b[d]=0};d.process=function(a){var b=this._;if(null===b.src)return this;if(this.tickID!==a){this.tickID=a;a=b.cellsize;if(b.totalWrite>b.totalRead+a){var c=b.readIndex,d=c+a;this.cells[1].set(b.bufferL.subarray(c,d));this.cells[2].set(b.bufferR.subarray(c,d));b.readIndex=d&e;b.totalRead+=a}g.outputSignalAR(this)}return this};var c={webkit:{set:function(a){var b=this._;a instanceof HTMLMediaElement&&(b.src=g._audioContext.createMediaElementSource(a))},
listen:function(){var a=this._,c=g._audioContext;a.gain=c.createGainNode();a.gain.gain.value=0;a.node=c.createJavaScriptNode(1024,2,2);a.node.onaudioprocess=b(this);a.src.connect(a.node);a.node.connect(a.gain);a.gain.connect(c.destination)},unlisten:function(){var a=this._;a.src&&a.src.disconnect();a.gain&&a.gain.disconnect();a.node&&a.node.disconnect()}}},b=function(a){return function(b){var c=a._,b=b.inputBuffer,d=b.length,g=c.writeIndex;c.bufferL.set(b.getChannelData(0),g);c.bufferR.set(b.getChannelData(1),
g);c.writeIndex=g+d&e;c.totalWrite+=d}};c.moz={set:function(a){var b=this._;a instanceof HTMLAudioElement&&(b.src=a,b.istep=b.samplerate/a.mozSampleRate)},listen:function(){var a=this._,b=a.bufferL,c=a.bufferR,d=0,g=0;2===a.src.mozChannels?(a.x=0,a.func=function(h){var i=a.writeIndex,k=a.totalWrite,h=h.frameBuffer,u,q=a.istep,r,s=h.length;u=a.x;for(r=0;r<s;r+=2){for(u+=q;0<u;)b[i]=0.5*(h[r]+d),c[i]=0.5*(h[r+1]+g),i=i+1&e,++k,u-=1;d=h[r];g=h[r+1]}a.x=u;a.writeIndex=i;a.totalWrite=k}):(a.x=0,a.func=
function(g){var h=a.writeIndex,i=a.totalWrite,g=g.frameBuffer,k,p=a.istep,r,s=g.length;k=a.x;for(r=0;r<s;++r){for(k+=p;0<=k;)b[h]=c[h]=0.5*(g[r]+d),h=h+1&e,++i,k-=1;d=g[r]}a.x=k;a.writeIndex=h;a.totalWrite=i});a.src.addEventListener("MozAudioAvailable",a.func)},unlisten:function(){var a=this._;a.func&&(a.src.removeEventListener("MozAudioAvailable",a.func),a.func=null)}};g.register("mediastream",h)}})(timbre);
(function(i){function h(e){i.Object.call(this,1,e);e=this._;e.midi=0;e.value=0;e.prev=null;e.a4=440;e.ar=!1}var g=i.fn;g.extend(h);var k=h.prototype;Object.defineProperties(k,{midi:{set:function(e){"number"===typeof e&&(this._.midi=e)},get:function(){return this._.midi}},a4:{set:function(e){"number"===typeof e&&(this._.a4=e,this._.prev=null)},get:function(){return this._.a4}}});k.bang=function(){this._.prev=null;this._.emit("bang");return this};k.at=function(e){return this._.a4*Math.pow(2,(e-69)/
12)};k.process=function(e){var d=this._;if(this.tickID!==e){this.tickID=e;var e=this.cells[0],c=this.nodes.length,b=e.length;if(d.ar&&c){g.inputSignalAR(this);for(var a=d.a4,c=0;c<b;++c)e[c]=a*Math.pow(2,(e[c]-69)/12);d.value=e[b-1];g.outputSignalAR(this)}else b=c?g.inputSignalKR(this):d.midi,d.prev!==b&&(d.prev=b,d.value=d.a4*Math.pow(2,(b-69)/12)),e[0]=d.value,g.outputSignalKR(this)}return this};g.register("midicps",h)})(timbre);
(function(i){function h(e){i.Object.call(this,1,e);e=this._;e.midi=0;e.value=0;e.prev=null;e.range=12;e.ar=!1}var g=i.fn;g.extend(h);var k=h.prototype;Object.defineProperties(k,{midi:{set:function(e){"number"===typeof e&&(this._.midi=e)},get:function(){return this._.midi}},range:{set:function(e){"number"===typeof e&&0<e&&(this._.range=e)},get:function(){return this._.range}}});k.bang=function(){this._.prev=null;this._.emit("bang");return this};k.at=function(e){return Math.pow(2,e/this._.range)};k.process=
function(e){var d=this.cells[0],c=this._;if(this.tickID!==e){this.tickID=e;var b=this.nodes.length,e=d.length;if(c.ar&&b){g.inputSignalAR(this);for(var a=c.range,b=0;b<e;++b)d[b]=Math.pow(2,d[b]/a);c.value=d[e-1];g.outputSignalAR(this)}else{b=this.nodes.length?g.inputSignalKR(this):c.midi;c.prev!==b&&(c.prev=b,c.value=Math.pow(2,b/c.range));c=c.value*c.mul+c.add;for(b=0;b<e;++b)d[b]=c}}return this};g.register("midiratio",h)})(timbre);
(function(i){function h(g){i.Object.call(this,1,g)}var g=i.fn;g.extend(h);h.prototype.process=function(h){var e=this.cells[0],d=this._;if(this.tickID!==h){this.tickID=h;var c=this.nodes,b=c.length,a,f=e.length,j,l;if(d.ar){if(0<c.length){j=c[0].process(h).cells[0];e.set(j);for(d=1;d<b;++d){j=c[d].process(h).cells[0];for(a=0;a<f;++a)l=j[a],e[a]>l&&(e[a]=l)}}else for(a=0;a<f;++a)e[a]=0;g.outputSignalAR(this)}else{if(0<c.length){j=c[0].process(h).cells[0][0];for(d=1;d<b;++d)l=c[d].process(h).cells[0][0],
j>l&&(j=l)}else j=0;e[0]=j;g.outputSignalKR(this)}}return this};g.register("min",h)})(timbre);
(function(i){function h(c){i.Object.call(this,0,c);g.timer(this);g.fixKR(this);c=this._;c.tracks=[];c.onended=g.make_onended(this);c.currentTime=0;this.on("start",k)}var g=i.fn;g.extend(h);var k=function(){var c=this,b=this._,a=b.mml;"string"===typeof a&&(a=[a]);b.tracks=a.map(function(a,b){return new d(c,b,a)});b.currentTime=0;this.playbackState=g.PLAYING_STATE};Object.defineProperty(k,"unremoved",{value:!0,writable:!1});var e=h.prototype;Object.defineProperties(e,{mml:{set:function(c){var b=this._;
if("string"===typeof c||Array.isArray(c))b.mml=c},get:function(){return this._.mml}},currentTime:{get:function(){return this._.currentTime}}});e.on=e.addListener=function(c,b){"mml"===c&&(c="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."));this._.events.on(c,b);return this};e.once=function(c,b){"mml"===c&&(c="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."));this._.events.once(c,b);return this};
e.off=e.removeListener=function(c,b){"mml"===c&&(c="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."));this._.events.off(c,b);return this};e.removeAllListeners=function(c){"mml"===c&&(console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."),c="data");this._.events.removeAllListeners(c);return this};e.listeners=function(c){"mml"===c&&(console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."),
c="data");return this._.events.listeners(c)};e.process=function(c){var b=this._;if(this.tickID!==c){this.tickID=c;var a,f=b.tracks,c=0;for(a=f.length;c<a;++c)f[c].process();for(;c--;)f[c].ended&&f.splice(c,1);0===f.length&&g.nextTick(b.onended);b.currentTime+=g.currentTimeIncr}return this};g.register("mml",h);var d=function(){function c(c,f,d){var e=this._={};e.sequencer=c;e.trackNum=f;e.commands=a(d);e.status={t:120,l:4,o:4,v:12,q:6,dot:0,tie:!1};e.index=0;e.queue=[];e.currentTime=0;e.queueTime=
0;e.segnoIndex=-1;e.loopStack=[];e.prevNote=0;e.remain=Infinity;this.ended=!1;b(this)}c.prototype.process=function(){var a=this._,c=a.sequencer,f=a.trackNum,d=a.queue,e=!1;if(d.length)for(;d[0][0]<=a.currentTime;){var h=a.queue.shift();switch(h[1]){case 1:for(var i=c,k=f,r=h[2],s=h[3],v=void 0,t=void 0,w=void 0,z=i.nodes,t=0,w=z.length;t<w;++t)v=z[t],v.noteOn?v.noteOn(r,s):v.bang();i._.emit("data","noteOn",{trackNum:k,noteNum:r,velocity:s});a.remain=h[4];b(this);break;case 2:i=c;k=f;r=h[2];h=h[3];
t=v=s=void 0;w=i.nodes;v=0;for(t=w.length;v<t;++v)s=w[v],s.noteOff?s.noteOff(r,h):s.release&&s.release();i._.emit("data","noteOff",{trackNum:k,noteNum:r,velocity:h});break;case 3:c._.emit("data","command",{command:h[2]});break;case 0:e=!0}if(0===d.length)break}a.remain-=g.currentTimeIncr;e&&(this.ended=!0);a.currentTime+=g.currentTimeIncr};var b=function(a){var a=a._,b,c=a.commands,f=a.queue,d=a.index,e=a.status,g=a.queueTime,h=a.loopStack,i,k,v,t,w;t=[];a:for(;;){if(c.length<=d)if(0<=a.segnoIndex)d=
a.segnoIndex;else break;b=c[d++];switch(b.name){case "@":f.push([g,3,b.val]);break;case "n":i=e.t||120;null!==b.len?(k=b.len,v=b.dot||0):(k=e.l,v=b.dot||e.dot);i=1E3*60/i*(4/k);i*=[1,1.5,1.75,1.875][v]||1;v=e.v<<3;if(e.tie){for(b=f.length;b--;)if(f[b][2]){f.splice(b,1);break}b=a.prevNote}else b=a.prevNote=b.val+12*(e.o+1),f.push([g,1,b,v,i]);if(0<k){k=e.q/8;if(1>k){k=g+i*k;f.push([k,2,b,v]);b=0;for(w=t.length;b<w;++b)f.push([k,2,t[b],v])}t=[];g+=i;if(!e.tie)break a}else t.push(b);e.tie=!1;break;case "r":i=
e.t||120;null!==b.len?(k=b.len,v=b.dot||0):(k=e.l,v=b.dot||e.dot);0<k&&(i=1E3*60/i*(4/k),i*=[1,1.5,1.75,1.875][v]||1,g+=i);break;case "l":e.l=b.val;e.dot=b.dot;break;case "o":e.o=b.val;break;case "<":9>e.o&&(e.o+=1);break;case ">":0<e.o&&(e.o-=1);break;case "v":e.v=b.val;break;case "(":15>e.v&&(e.v+=1);break;case ")":0<e.v&&(e.v-=1);break;case "q":e.q=b.val;break;case "&":e.tie=!0;break;case "$":a.segnoIndex=d;break;case "[":h.push([d,null,null]);break;case "|":if((i=h[h.length-1])&&1===i[1])h.pop(),
d=i[2];break;case "]":if(i=h[h.length-1])null===i[1]&&(i[1]=b.count,i[2]=d),i[1]-=1,0===i[1]?h.pop():d=i[0];break;case "t":e.t=null===b.val?120:b.val;break;case "EOF":f.push([g,0])}}a.index=d;a.queueTime=g},a=function(a){var b,c,d,e,g,h,i,k=Array(a.length),s=[];g=0;for(h=f.length;g<h;++g){b=f[g];for(c=b.re;d=c.exec(a);){if(!k[d.index]){e=0;for(i=d[0].length;e<i;++e)k[d.index+e]=!0;if(e=b.func?b.func(d):{name:d[0]})e.index=d.index,e.origin=d[0],s.push(e)}for(;c.lastIndex<a.length&&k[c.lastIndex];)++c.lastIndex}}s.sort(function(a,
b){return a.index-b.index});s.push({name:"EOF"});return s},f=[{re:/@(\d*)/g,func:function(a){return{name:"@",val:a[1]||null}}},{re:/([cdefgab])([\-+]?)(\d*)(\.*)/g,func:function(a){return{name:"n",val:{c:0,d:2,e:4,f:5,g:7,a:9,b:11}[a[1]]+({"-":-1,"+":1}[a[2]]||0),len:""===a[3]?null:Math.min(a[3]|0,64),dot:a[4].length}}},{re:/r(\d*)(\.*)/g,func:function(a){return{name:"r",len:""===a[1]?null:Math.max(1,Math.min(a[1]|0,64)),dot:a[2].length}}},{re:/&/g},{re:/l(\d*)(\.*)/g,func:function(a){return{name:"l",
val:""===a[1]?4:Math.min(a[1]|0,64),dot:a[2].length}}},{re:/o([0-9])/g,func:function(a){return{name:"o",val:""===a[1]?4:a[1]|0}}},{re:/[<>]/g},{re:/v(\d*)/g,func:function(a){return{name:"v",val:""===a[1]?12:Math.min(a[1]|0,15)}}},{re:/[()]/g},{re:/q([0-8])/g,func:function(a){return{name:"q",val:""===a[1]?6:Math.min(a[1]|0,8)}}},{re:/\[/g},{re:/\|/g},{re:/\](\d*)/g,func:function(a){return{name:"]",count:a[1]|0||2}}},{re:/t(\d*)/g,func:function(a){return{name:"t",val:""===a[1]?null:Math.max(5,Math.min(a[1]|
0,300))}}},{re:/\$/g}];return c}()})(timbre);(function(i){function h(g){i.Object.call(this,1,g)}var g=i.fn;g.extend(h);h.prototype.process=function(h){var e=this._;this.tickID!==h&&(this.tickID=h,e.ar?(g.inputSignalAR(this),g.outputSignalAR(this)):(this.cells[0][0]=g.inputSignalKR(this),g.outputSignalKR(this)));return this};g.register("mono",h)})(timbre);
(function(i){function h(g){i.Object.call(this,2,g)}var g=i.fn;g.extend(h);h.prototype.process=function(h){var e=this._;if(this.tickID!==h){this.tickID=h;var d=this.nodes,c=this.cells[0],b=this.cells[1],a=this.cells[2],f=d.length,j=c.length,l,i;if(e.ar){if(0<d.length){d[0].process(h);l=d[0].cells[1];i=d[0].cells[2];b.set(l);a.set(i);for(e=1;e<f;++e){d[e].process(h);l=d[e].cells[1];i=d[e].cells[2];for(c=0;c<j;++c)b[c]*=l[c],a[c]*=i[c]}}else for(c=0;c<j;++c)b[c]=a[c]=0;g.outputSignalAR(this)}else{if(0<
d.length){b=d[0].process(h).cells[0][0];for(e=1;e<f;++e)b*=d[e].process(h).cells[0][0]}else b=0;c[0]=b;g.outputSignalKR(this)}}return this};g.register("*",h)})(timbre);
(function(i){function h(e){i.Object.call(this,1,e);e=this._;e.defaultValue=0;e.index=0;e.dict={};e.ar=!1}var g=i.fn;g.extend(h);var k=h.prototype;Object.defineProperties(k,{dict:{set:function(e){if("object"===typeof e)this._.dict=e;else if("function"===typeof e){for(var d={},c=0;128>c;++c)d[c]=e(c);this._.dict=d}},get:function(){return this._.dict}},defaultValue:{set:function(e){"number"===typeof e&&(this._.defaultValue=e)},get:function(){return this._.defaultValue}},index:{set:function(e){"number"===
typeof e&&(this._.index=e)},get:function(){return this._.index}}});k.at=function(e){var d=this._;return(d.dict[e|0]||d.defaultValue)*d.mul+d.add};k.clear=function(){this._.dict={};return this};k.process=function(e){var d=this.cells[0],c=this._;if(this.tickID!==e){this.tickID=e;var b=this.nodes.length,a;a=c.dict;var f=c.defaultValue,j=c.mul,h=c.add,e=d.length;if(c.ar&&b){g.inputSignalAR(this);for(c=0;c<e;++c)b=d[c],b=0>b?b-0.5|0:b+0.5|0,d[c]=(a[b]||f)*j+h;g.outputSignalAR(this)}else{b=this.nodes.length?
g.inputSignalKR(this):c.index;a=(a[0>b?b-0.5|0:b+0.5|0]||f)*j+h;for(c=0;c<e;++c)d[c]=a}}return this};g.register("ndict",h)})(timbre);(function(i){function h(g){i.Object.call(this,1,g)}var g=i.fn;g.extend(h);h.prototype.process=function(g){var e=this.cells[0],d=this._;if(this.tickID!==g){this.tickID=g;var g=d.mul,c=d.add,b;if(d.ar){d=0;for(b=e.length;d<b;++d)e[d]=(2*Math.random()-1)*g+c}else{g=(2*Math.random()+1)*g+c;d=0;for(b=e.length;d<b;++d)e[d]=g}}return this};g.register("noise",h)})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);a=this._;a.freq=i(440);a.phase=i(0);a.osc=new e(a.samplerate);a.tmp=new g.SignalArray(a.cellsize);a.osc.step=a.cellsize;this.once("init",d)}var g=i.fn,k=i.timevalue,e=i.modules.Oscillator;g.extend(h);var d=function(){var a=this._;this.wave||(this.wave="sin");a.plotData=a.osc.wave;a.plotLineWidth=2;a.plotCyclic=!0;a.plotBefore=b},c=h.prototype;Object.defineProperties(c,{wave:{set:function(a){this._.osc.setWave(a)},get:function(){return this._.osc.wave}},
freq:{set:function(a){"string"===typeof a&&(a=k(a),a=0>=a?0:1E3/a);this._.freq=i(a)},get:function(){return this._.freq}},phase:{set:function(a){this._.phase=i(a);this._.osc.feedback=!1},get:function(){return this._.phase}},fb:{set:function(a){this._.phase=i(a);this._.osc.feedback=!0},get:function(){return this._.phase}}});c.clone=function(){var a=g.clone(this);a._.osc=this._.osc.clone();a._.freq=this._.freq;a._.phase=this._.phase;return a};c.bang=function(){this._.osc.reset();this._.emit("bang");
return this};c.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;var c=this.cells[1],d=this.cells[2],e,h=b.cellsize;if(this.nodes.length)g.inputSignalAR(this);else for(e=0;e<h;++e)c[e]=d[e]=1;e=b.osc;var i=b.freq.process(a).cells[0],k=b.phase.process(a).cells[0];e.frequency=i[0];e.phase=k[0];if(b.ar){a=b.tmp;b.freq.isAr?b.phase.isAr?e.processWithFreqAndPhaseArray(a,i,k):e.processWithFreqArray(a,i):b.phase.isAr?e.processWithPhaseArray(a,k):e.process(a);for(e=0;e<h;++e)c[e]*=a[e],d[e]*=
a[e]}else{b=e.next();for(e=0;e<h;++e)c[e]*=b,d[e]*=b}g.outputSignalAR(this)}return this};var b;"browser"===i.envtype&&(b=function(a,b,c,d,e){e=(e>>1)+0.5;a.strokeStyle="#ccc";a.lineWidth=1;a.beginPath();a.moveTo(b,e+c);a.lineTo(b+d,e+c);a.stroke()});g.register("osc",h);g.register("sin",function(a){return(new h(a)).set("wave","sin")});g.register("cos",function(a){return(new h(a)).set("wave","cos")});g.register("pulse",function(a){return(new h(a)).set("wave","pulse")});g.register("tri",function(a){return(new h(a)).set("wave",
"tri")});g.register("saw",function(a){return(new h(a)).set("wave","saw")});g.register("fami",function(a){return(new h(a)).set("wave","fami")});g.register("konami",function(a){return(new h(a)).set("wave","konami")});g.register("+sin",function(a){return(new h(a)).set("wave","+sin").kr()});g.register("+pulse",function(a){return(new h(a)).set("wave","+pulse").kr()});g.register("+tri",function(a){return(new h(a)).set("wave","+tri").kr()});g.register("+saw",function(a){return(new h(a)).set("wave","+saw").kr()});
g.alias("square","pulse")})(timbre);
(function(i){function h(e){i.Object.call(this,2,e);g.fixAR(this);e=this._;e.pos=i(0);e.panL=0.5;e.panR=0.5}var g=i.fn;g.extend(h);var k=h.prototype;Object.defineProperties(k,{pos:{set:function(e){this._.pos=i(e)},get:function(){return this._.pos}}});k.process=function(e){var d=this._;if(this.tickID!==e){this.tickID=e;var c=d.pos.process(e).cells[0][0];d.prevPos!==c&&(d.panL=1-c,d.panR=d.prevPos=c);var b=this.nodes,c=this.cells[1],a=this.cells[2],f,j=b.length,h,i=c.length,k;if(j){k=b[0].process(e).cells[0];
for(h=0;h<i;++h)c[h]=a[h]=k[h];for(f=1;f<j;++f){k=b[f].process(e).cells[0];for(h=0;h<i;++h)c[h]=a[h]+=k[h]}e=d.panL;d=d.panR;for(h=0;h<i;++h)c[h]*=e,a[h]*=d}else c.set(g.emptycell),a.set(g.emptycell);g.outputSignalAR(this)}return this};g.register("pan",h)})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);a=this._;a.value=0;a.env=new d(a.samplerate);a.env.step=a.cellsize;a.curve="lin";a.counter=0;a.ar=!1;a.onended=c(this);this.on("ar",b)}var g=i.fn,k=i.timevalue,e=i.modules.Envelope,d=i.modules.EnvelopeValue;g.extend(h);var c=function(a,b){return function(){if("number"===typeof b)for(var c=a.cells[0],f=a.cells[1],d=a.cells[2],e=a._.env.value,g=0,h=f.length;g<h;++g)c[0]=f[g]=d[g]=e;a._.emit("ended")}},b=function(a){this._.env.step=a?1:this._.cellsize},
a=h.prototype;Object.defineProperties(a,{value:{set:function(a){"number"===typeof a&&(this._.env.value=a)},get:function(){return this._.env.value}}});a.to=function(a,b,c){var f=this._,d=f.env;"string"===typeof b?b=k(b):"undefined"===typeof b&&(b=0);if("undefined"===typeof c)f.counter=d.setNext(a,b,e.CurveTypeLin),f.curve="lin";else{var g=e.CurveTypeDict[c];f.counter="undefined"===typeof g?d.setNext(a,b,e.CurveTypeCurve,c):d.setNext(a,b,g);f.curve=c}f.plotFlush=!0;return this};a.setAt=function(a,b){var c=
this._;this.to(c.env.value,b,"set");c.atValue=a;return this};a.linTo=function(a,b){return this.to(a,b,"lin")};a.expTo=function(a,b){return this.to(a,b,"exp")};a.sinTo=function(a,b){return this.to(a,b,"sin")};a.welTo=function(a,b){return this.to(a,b,"wel")};a.sqrTo=function(a,b){return this.to(a,b,"sqr")};a.cubTo=function(a,b){return this.to(a,b,"cub")};a.cancel=function(){var a=this._;a.counter=a.env.setNext(a.env.value,0,e.CurveTypeSet);return this};a.process=function(a){var b=this._;if(this.tickID!==
a){this.tickID=a;var a=this.cells[1],c=this.cells[2],f,d=b.cellsize,h=b.env,i=b.counter,k;if(this.nodes.length)g.inputSignalAR(this);else for(f=0;f<d;++f)a[f]=c[f]=1;0>=i&&("set"===b.curve?h.setNext(b.atValue,0,e.CurveTypeSet):h.setNext(h.value,0,e.CurveTypeSet),g.nextTick(b.onended),b.counter=Infinity);if(b.ar){for(f=0;f<d;++f)k=h.next(),a[f]*=k,c[f]*=k;b.counter-=b.cellsize}else{k=h.next();for(f=0;f<d;++f)a[f]*=k,c[f]*=k;b.counter-=1}g.outputSignalAR(this);b.value=k}return this};var f=i.Object.prototype.plot;
a.plot=function(a){var b=this._;if(b.plotFlush){var c=new d(128),g=new Float32Array(128),h,i;if("set"===b.curve){h=100;for(i=g.length;h<i;++h)g[h]=1}else{h=e.CurveTypeDict[b.curve];"undefined"===typeof h?c.setNext(1,1E3,e.CurveTypeCurve,b.curve):c.setNext(1,1E3,h);h=0;for(i=g.length;h<i;++h)g[h]=c.next()}b.plotData=g;b.plotRange=[0,1];b.plotFlush=null}return f.call(this,a)};g.register("param",h)})(timbre);
(function(i){function h(d){i.Object.call(this,2,d);g.fixAR(this);d=this._;d.freq=i("sin",{freq:1,add:1E3,mul:250}).kr();d.Q=i(1);d.allpass=[];this.steps=2}var g=i.fn,k=i.modules.Biquad;g.extend(h);var e=h.prototype;Object.defineProperties(e,{freq:{set:function(d){this._.freq=d},get:function(){return this._.freq}},Q:{set:function(d){this._.Q=i(d)},get:function(){return this._.Q}},steps:{set:function(d){if("number"===typeof d){d|=0;if(2===d||4===d||8===d||12===d){var c=this._.allpass;if(c.length<d)for(var b=
c.length;b<d;++b)c[b]=new k(this._.samplerate),c[b].setType("allpass")}this._.steps=d}},get:function(){return this._.steps}}});e.process=function(d){var c=this._;if(this.tickID!==d){this.tickID=d;g.inputSignalAR(this);if(!c.bypassed){var b=this.cells[1],a=this.cells[2],f=c.freq.process(d).cells[0][0],d=c.Q.process(d).cells[0][0],e=c.steps,h;for(h=0;h<e;h+=2)c.allpass[h].setParams(f,d,0),c.allpass[h].process(b,a),c.allpass[h+1].setParams(f,d,0),c.allpass[h+1].process(b,a)}g.outputSignalAR(this)}return this};
g.register("phaser",h)})(timbre);
(function(i){function h(h){i.Object.call(this,1,h);g.fixAR(this);for(var h=new Uint8Array(5),e=0;5>e;++e)h[e]=(1073741824*Math.random()|0)%25;this._.whites=h;this._.key=0}var g=i.fn;g.extend(h);h.prototype.process=function(g){var e=this.cells[0],d=this._;if(this.tickID!==g){this.tickID=g;var c,b,a=d.key,f=d.whites,h=d.mul,i=d.add,p,n,g=0;for(c=e.length;g<c;++g){b=a++;31<a&&(a=0);n=b^a;for(b=p=0;5>b;++b)n&1<<b&&(f[b]=(1073741824*Math.random()|0)%25),p+=f[b];e[g]=(0.01666666*p-1)*h+i}d.key=a}return this};
g.register("pink",h)})(timbre);
(function(i){function h(e){i.Object.call(this,1,e);this._.freq=440;this._.buffer=null;this._.index=0}var g=i.fn;g.extend(h);var k=h.prototype;Object.defineProperties(k,{freq:{set:function(e){"number"===typeof e&&(0>e&&(e=0),this._.freq=e)},get:function(){return this._.freq}}});k.bang=function(){for(var e=this._,d=e.samplerate/e.freq+0.5|0,c=e.buffer=new g.SignalArray(d),b=0;b<d;++b)c[b]=2*Math.random()-1;e.index=0;e.emit("bang");return this};k.process=function(e){var d=this.cells[0],c=this._;if(this.tickID!==
e&&(this.tickID=e,e=c.buffer)){var b=e.length,a=c.index,f,g=c.mul,h=c.add,i,k,o=d.length;for(k=0;k<o;++k)f=a,i=e[a++],a>=b&&(a=0),i=0.5*(i+e[a]),e[f]=i,d[k]=i*g+h;c.index=a}return this};g.register("pluck",h)})(timbre);
(function(i){function h(b){i.Object.call(this,1,b);g.listener(this);g.fixAR(this);b=this._;b.timeout=5E3;b.status=e;b.writeIndex=0;b.writeIndexIncr=1;b.currentTime=0;b.currentTimeIncr=1E3/b.samplerate;b.onended=d(this)}var g=i.fn,k=i.timevalue,e=0;g.extend(h);var d=function(b){return function(){var a=b._,c=new g.SignalArray(a.buffer.subarray(0,a.writeIndex|0));a.status=e;a.writeIndex=0;a.currentTime=0;a.emit("ended",{buffer:c,samplerate:a.samplerate})}},c=h.prototype;Object.defineProperties(c,{timeout:{set:function(b){"string"===
typeof b&&(b=k(b));"number"===typeof b&&0<b&&(this._.timeout=b)},get:function(){return this._.timeout}},samplerate:{set:function(b){"number"===typeof b&&(0<b&&b<=this._.samplerate)&&(this._.samplerate=b)},get:function(){return this._.samplerate}},currentTime:{get:function(){return this._.currentTime}}});c.start=function(){var b=this._,a;if(b.status===e){a=0.01*b.timeout*b.samplerate|0;if(!b.buffer||b.buffer.length<a)b.buffer=new g.SignalArray(a);b.writeIndex=0;b.writeIndexIncr=b.samplerate/i.samplerate;
b.currentTime=0;b.status=1;b.emit("start");this.listen()}return this};c.stop=function(){var b=this._;1===b.status&&(b.status=e,b.emit("stop"),g.nextTick(b.onended),this.unlisten());return this};c.bang=function(){this._.status===e?this.srart():1===this._.status&&this.stop();this._.emit("bang");return this};c.process=function(b){var a=this._,c=this.cells[0];if(this.tickID!==b){this.tickID=b;g.inputSignalAR(this);if(1===a.status){for(var d=c.length,e=a.buffer,h=a.timeout,i=a.writeIndex,k=a.writeIndexIncr,
m=a.currentTime,u=a.currentTimeIncr,b=0;b<d;++b)e[i|0]=c[b],i+=k,m+=u,h<=m&&g.nextTick(a.onended);a.writeIndex=i;a.currentTime=m}g.outputSignalAR(this)}return this};g.register("record",h);g.alias("rec","record")})(timbre);
(function(i){function h(d){i.Object.call(this,2,d);g.fixAR(this);this._.reverb=new k(this._.samplerate,this._.cellsize)}var g=i.fn,k=i.modules.Reverb;g.extend(h);var e=h.prototype;Object.defineProperties(e,{room:{set:function(d){"number"===typeof d&&this._.reverb.setRoomSize(1<d?1:0>d?0:d)},get:function(){return this._.reverb.roomsize}},damp:{set:function(d){"number"===typeof d&&this._.reverb.setDamp(1<d?1:0>d?0:d)},get:function(){return this._.reverb.damp}},mix:{set:function(d){"number"===typeof d&&
(this._.reverb.wet=1<d?1:0>d?0:d)},get:function(){return this._.reverb.wet}}});e.process=function(d){var c=this._;this.tickID!==d&&(this.tickID=d,g.inputSignalAR(this),c.bypassed||c.reverb.process(this.cells[1],this.cells[2]),g.outputSignalAR(this));return this};g.register("reverb",h)})(timbre);
(function(i){function h(d){i.Object.call(this,0,d);g.timer(this);g.fixKR(this);d=this._;d.queue=[];d.currentTime=0;d.maxRemain=1E3}var g=i.fn,k=i.timevalue;g.extend(h);var e=h.prototype;Object.defineProperties(e,{queue:{get:function(){return this._.queue}},remain:{get:function(){return this._.queue.length}},maxRemain:{set:function(d){"number"===typeof d&&0<d&&(this._.maxRemain=d)},get:function(){return this._.maxRemain}},isEmpty:{get:function(){return 0===this._.queue.length}},currentTime:{get:function(){return this._.currentTime}}});
e.sched=function(d,c,b){"string"===typeof d&&(d=k(d));"number"===typeof d&&this.schedAbs(this._.currentTime+d,c,b);return this};e.schedAbs=function(d,c,b){"string"===typeof d&&(d=k(d));if("number"===typeof d){var a=this._,f=a.queue;if(f.length>=a.maxRemain)return this;for(a=f.length;a--&&!(f[a][0]<d););f.splice(a+1,0,[d,i(c),b])}return this};e.advance=function(d){"string"===typeof d&&(d=k(d));"number"===typeof d&&(this._.currentTime+=d);return this};e.clear=function(){this._.queue.splice(0);return this};
e.process=function(d){var c=this._;if(this.tickID!==d){this.tickID=d;var b=null,d=c.queue;if(d.length)for(;d[0][0]<c.currentTime;)if(b=c.queue.shift(),b[1].bang(b[2]),b="sched",0===d.length){b="empty";break}c.currentTime+=g.currentTimeIncr;b&&c.emit(b)}return this};g.register("schedule",h);g.alias("sched","schedule")})(timbre);
(function(i){function h(b){i.Object.call(this,2,b);g.listener(this);g.fixAR(this);b=this._;b.samples=0;b.writeIndex=0;b.plotFlush=!0;this.once("init",e)}var g=i.fn,k=i.timevalue;g.extend(h);var e=function(){this._.buffer||(this.size=1024);this._.interval||(this.interval=1E3)},d=h.prototype;Object.defineProperties(d,{size:{set:function(b){var a=this._;!a.buffer&&"number"===typeof b&&(a.buffer=new g.SignalArray(64>b?64:2048<b?2048:b),a.reservedinterval&&(this.interval=a.reservedinterval,a.reservedinterval=
null))},get:function(){return this._.buffer.length}},interval:{set:function(b){var a=this._;"string"===typeof b&&(b=k(b));"number"===typeof b&&0<b&&(a.buffer?(a.interval=b,a.samplesIncr=0.001*b*a.samplerate/a.buffer.length,1>a.samplesIncr&&(a.samplesIncr=1)):a.reservedinterval=b)},get:function(){return this._.interval}},buffer:{get:function(){return this._.buffer}}});d.bang=function(){for(var b=this._,a=b.buffer,c=0,d=a.length;c<d;++c)a[c]=0;b.samples=0;b.writeIndex=0;this._.emit("bang");return this};
d.process=function(b){var a=this._;if(this.tickID!==b){this.tickID=b;g.inputSignalAR(this);g.outputSignalAR(this);var b=this.cells[0],c,d=a.cellsize,e=a.samples,h=a.samplesIncr,i=a.buffer,k=a.writeIndex,m=!1,u=i.length;for(c=0;c<d;++c)0>=e&&(i[k++]=b[c],k>=u&&(k=0),m=a.plotFlush=!0,e+=h),--e;a.samples=e;a.writeIndex=k;m&&this._.emit("data")}return this};var c=i.Object.prototype.plot;d.plot=function(b){var a=this._;if(a.plotFlush){for(var f=a.buffer,d=f.length-1,e=new Float32Array(f.length),g=a.writeIndex,
h=0,i=f.length;h<i;h++)e[h]=f[++g&d];a.plotData=e;a.plotFlush=null}return c.call(this,b)};g.register("scope",h)})(timbre);
(function(i){function h(b){i.Object.call(this,2,b);e.fixAR(this);b=this._;b.numberOfInputs=0;b.numberOfOutputs=0;b.bufferSize=0;b.bufferMask=0;b.duration=0;b.inputBufferL=null;b.inputBufferR=null;b.outputBufferL=null;b.outputBufferR=null;b.onaudioprocess=null;b.index=0;this.once("init",d)}function g(b,a){this.samplerate=b._.samplerate;this.length=b._.bufferSize;this.duration=b._.duration;this.numberOfChannels=a.length;this.getChannelData=function(b){return a[b]}}function k(b){var a=b._;this.node=
b;this.playbackTime=i.currentTime;this.inputBuffer=2===a.numberOfInputs?new g(b,[a.inputBufferL,a.inputBufferR]):new g(b,[a.inputBufferL]);this.outputBuffer=2===a.numberOfOutputs?new g(b,[a.outputBufferL,a.outputBufferR]):new g(b,[a.outputBufferL])}var e=i.fn;e.extend(h);var d=function(){var b=this._;0===b.numberOfInputs&&(this.numberOfInputs=1);0===b.numberOfOutputs&&(this.numberOfOutputs=1);0===b.bufferSize&&(this.bufferSize=1024)},c=h.prototype;Object.defineProperties(c,{numberOfInputs:{set:function(b){var a=
this._;0===a.numberOfInputs&&(a.numberOfInputs=2===b?2:1)},get:function(){return this._.numberOfInputs}},numberOfOutputs:{set:function(b){var a=this._;0===a.numberOfOutputs&&(a.numberOfOutputs=2===b?2:1)},get:function(){return this._.numberOfOutputs}},bufferSize:{set:function(b){var a=this._;0===a.bufferSize&&-1!==[256,512,1024,2048,4096,8192,16384].indexOf(b)&&(a.bufferSize=b,a.bufferMask=b-1,a.duration=b/a.samplerate,a.inputBufferL=new e.SignalArray(b),a.inputBufferR=new e.SignalArray(b),a.outputBufferL=
new e.SignalArray(b),a.outputBufferR=new e.SignalArray(b))},get:function(){return this._.bufferSize}},onaudioprocess:{set:function(b){"function"===typeof b&&(this._.onaudioprocess=b)},get:function(){return this._.onaudioprocess}}});c.process=function(b){var a=this._;if(this.tickID!==b){this.tickID=b;var b=a.cellsize,c=a.bufferMask,d=a.index,g=d+b,h,i=this.cells[1],o=this.cells[2];e.inputSignalAR(this);if(2===a.numberOfInputs)a.inputBufferL.set(i,d),a.inputBufferR.set(o,d);else{h=a.inputBufferL;for(var m=
0;m<b;m++)h[d+m]=0.5*(i[m]+o[m])}i.set(a.outputBufferL.subarray(d,g));o.set(a.outputBufferR.subarray(d,g));a.index=g&c;0===a.index&&a.onaudioprocess&&(a.onaudioprocess(new k(this)),1===a.numberOfOutputs&&a.outputBufferR.set(a.outputBufferL));e.outputSignalAR(this)}return this};e.register("script",h)})(timbre);
(function(i){function h(e){i.Object.call(this,2,e);this._.selected=0;this._.background=!1}var g=i.fn;g.extend(h);var k=h.prototype;Object.defineProperties(k,{selected:{set:function(e){"number"===typeof e&&(this._.selected=e,this.cells[1].set(g.emptycell),this.cells[2].set(g.emptycell))},get:function(){return this._.selected}},background:{set:function(e){this._.background=!!e},get:function(){return this._.background}}});k.process=function(e){var d=this._;if(this.tickID!==e){this.tickID=e;var c=this.nodes,
b,a=c.length;if(d.background)for(b=0;b<a;++b)c[b].process(e);if(c=c[d.selected])d.background||c.process(e),this.cells[1].set(c.cells[1]),this.cells[2].set(c.cells[2]);g.outputSignalAR(this)}return this};g.register("selector",h)})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);g.listener(this);g.fixAR(this);a=this._;a.status=d;a.samples=0;a.samplesIncr=0;a.writeIndex=0;a.plotFlush=!0;a.plotRange=[0,32];a.plotBarStyle=!0;this.once("init",c)}var g=i.fn,k=i.timevalue,e=i.modules.FFT,d=0;g.extend(h);var c=function(){var a=this._;a.fft||(this.size=512);a.interval||(this.interval=500)},b=h.prototype;Object.defineProperties(b,{size:{set:function(a){var b=this._;if(!b.fft&&"number"===typeof a&&(b.fft=new e(256>a?256:2048<a?2048:
a),b.buffer=new g.SignalArray(b.fft.length),b.freqs=new g.SignalArray(b.fft.length>>1),b.reservedwindow&&(b.fft.setWindow(b.reservedwindow),b.reservedwindow=null),b.reservedinterval))this.interval=b.reservedinterval,b.reservedinterval=null},get:function(){return this._.buffer.length}},window:{set:function(a){this._.fft.setWindow(a)},get:function(){return this._.fft.windowName}},interval:{set:function(a){var b=this._;"string"===typeof a&&(a=k(a));"number"===typeof a&&0<a&&(b.buffer?(b.interval=a,b.samplesIncr=
0.001*a*b.samplerate,b.samplesIncr<b.buffer.length&&(b.samplesIncr=b.buffer.length,b.interval=1E3*b.samplesIncr/b.samplerate)):b.reservedinterval=a)},get:function(){return this._.interval}},spectrum:{get:function(){return this._.fft.getFrequencyData(this._.freqs)}},real:{get:function(){return this._.fft.real}},imag:{get:function(){return this._.fft.imag}}});b.bang=function(){this._.samples=0;this._.writeIndex=0;this._.emit("bang");return this};b.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=
a;g.inputSignalAR(this);g.outputSignalAR(this);var a=this.cells[0],c,e=a.length,h=b.status,i=b.samples,k=b.samplesIncr,u=b.writeIndex,q=b.buffer,r=q.length,s;for(c=0;c<e;++c)0>=i&&h===d&&(h=1,u=0,i+=k),1===h&&(q[u++]=a[c],r<=u&&(b.fft.forward(q),s=b.plotFlush=!0,h=d)),--i;b.samples=i;b.status=h;b.writeIndex=u;s&&this._.emit("data")}return this};var a=i.Object.prototype.plot;b.plot=function(b){this._.plotFlush&&(this._.plotData=this.spectrum,this._.plotFlush=null);return a.call(this,b)};g.register("spectrum",
h)})(timbre);
(function(i){function h(g){i.Object.call(this,2,g);this._.ar=!1}var g=i.fn;g.extend(h);h.prototype.process=function(h){var e=this._;if(this.tickID!==h){this.tickID=h;var d=this.nodes,c=this.cells[0],b=this.cells[1],a=this.cells[2],f,j=d.length,i=c.length,p;if(e.ar){if(0<d.length){d[0].process(h);e=d[0].cells[1];p=d[0].cells[2];b.set(e);a.set(p);for(f=1;f<j;++f){d[f].process(h);e=d[f].cells[1];p=d[f].cells[2];for(c=0;c<i;++c)b[c]-=e[c],a[c]-=p[c]}}else for(c=0;c<i;++c)b[c]=a[f]=0;g.outputSignalAR(this)}else{if(0<d.length){b=
d[0].process(h).cells[0][0];for(f=1;f<j;++f)b-=d[f].process(h).cells[0][0]}else b=0;c[0]=b;g.outputSignalKR(this)}}return this};g.register("-",h)})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);g.fixAR(this);a=this._;this.playbackState=g.FINISHED_STATE;a.poly=4;a.genList=[];a.genDict={};a.synthdef=null;a.remGen=d(this);a.onended=g.make_onended(this)}var g=i.fn;g.extend(h);var k=h.prototype;Object.defineProperties(k,{def:{set:function(a){"function"===typeof a&&(this._.synthdef=a)},get:function(){return this._.synthdef}},poly:{set:function(a){"number"===typeof a&&(0<a&&64>=a)&&(this._.poly=a)},get:function(){return this._.poly}}});var e=function(a,
b){return function(){a._.remGen(b.gen)}},d=function(a){return function(b){var c=a._,d=c.genList.indexOf(b);-1!==d&&c.genList.splice(d,1);"undefined"!==typeof b.noteNum&&(c.genDict[b.noteNum]=null)}},c=function(a,b,c,d){c|=0;0>=c?this.noteOff(this,a):127<c&&(c=127);var h=this._,k=h.genList,m=h.genDict,u=m[a];u&&h.remGen(u);b={freq:b,noteNum:a,velocity:c,mul:0.0078125*c};if(d)for(var q in d)b[q]=d[q];b.doneAction=e(this,b);u=h.synthdef.call(this,b);u instanceof i.Object&&(u.noteNum=a,k.push(u),m[a]=
b.gen=u,this.playbackState=g.PLAYING_STATE,k.length>h.poly&&h.remGen(k[0]))},b=function(){for(var a=new Float32Array(128),b=0;128>b;++b)a[b]=440*Math.pow(2,1*(b-69)/12);return a}();k.noteOn=function(a,d,e){var g=b[a]||440*Math.pow(2,(a-69)/12);c.call(this,a+0.5|0,g,d,e);return this};k.noteOff=function(a){(a=this._.genDict[a])&&a.release&&a.release();return this};k.noteOnWithFreq=function(a,b,d){var e=0<a?12*Math.log(1*a/440)*Math.LOG2E+69:0;c.call(this,e+0.5|0,a,b,d);return this};k.noteOffWithFreq=
function(a){return this.noteOff((0<a?12*Math.log(1*a/440)*Math.LOG2E+69:0)+0.5|0)};k.allNoteOff=function(){for(var a=this._.genList,b=0,c=a.length;b<c;++b)a[b].release&&a[b].release()};k.allSoundOff=function(){for(var a=this._,b=a.genList,a=a.genDict;b.length;)delete a[b.shift().noteNum]};k.synth=function(a){var b=this._,c=b.genList,d={};if(a)for(var h in a)d[h]=a[h];d.doneAction=e(this,d);a=b.synthdef.call(this,d);a instanceof i.Object&&(c.push(a),d.gen=a,this.playbackState=g.PLAYING_STATE,c.length>
b.poly&&b.remGen(c[0]));return this};k.process=function(a){var b=this.cells[0],c=this._;if(this.tickID!==a){this.tickID=a;if(this.playbackState===g.PLAYING_STATE){var d=c.genList,e,h=this.cells[1],i=this.cells[2],k,b=b.length,q,r;if(d.length){e=d[0];e.process(a);h.set(e.cells[1]);i.set(e.cells[2]);c=1;for(k=d.length;c<k;++c){e=d[c];e.process(a);q=e.cells[1];r=e.cells[2];for(e=0;e<b;++e)h[e]+=q[e],i[e]+=r[e]}}else g.nextTick(c.onended)}g.outputSignalAR(this)}return this};g.register("SynthDef",h);var a=
{set:function(a){g.isDictionary(a)?"string"===typeof a.type&&(this._.env=a):a instanceof i.Object&&(this._.env=a)},get:function(){return this._.env}};g.register("OscGen",function(){var b={set:function(a){a instanceof i.Object&&(this._.osc=a)},get:function(){return this._.osc}},c={set:function(a){"string"===typeof a&&(this._.wave=a)},get:function(){return this._.wave}},d=function(a){var b=this._,c,d,f;c=b.osc||null;d=b.env||{};f=d.type||"perc";c instanceof i.Object&&"function"===typeof c.clone&&(c=
c.clone());c||(c=i("osc",{wave:b.wave}));c.freq=a.freq;c.mul=c.mul*a.velocity/128;b=c;d instanceof i.Object?"function"===typeof d.clone&&(b=d.clone().append(b)):b=i(f,d,b);b.on("ended",a.doneAction).bang();return b};return function(e){e=new h(e);e._.wave="sin";Object.defineProperties(e,{env:a,osc:b,wave:c});e.def=d;return e}}());g.register("PluckGen",function(){var b=function(a){var b,c,d;c=this._.env||{};d=c.type||"perc";b=i("pluck",{freq:a.freq,mul:a.velocity/128}).bang();c instanceof i.Object?
"function"===typeof c.clone&&(b=c.clone().append(b)):b=i(d,c,b);b.on("ended",a.doneAction).bang();return b};return function(c){c=new h(c);Object.defineProperties(c,{env:a});c.def=b;return c}}())})(timbre);
(function(i){function h(a){i.Object.call(this,2,a);g.fixAR(this);a=this._;a.isLooped=!1;a.onended=g.make_onended(this,0)}var g=i.fn,k=i.modules.Scissor,e=k.Tape,d=k.TapeStream,c=g.isSignalArray;g.extend(h);var b=h.prototype;Object.defineProperties(b,{tape:{set:function(a){if(a instanceof e)this.playbackState=g.PLAYING_STATE,this._.tape=a,this._.tapeStream=new d(a,this._.samplerate),this._.tapeStream.isLooped=this._.isLooped;else if(a instanceof i.Object&&a.buffer&&(a=a.buffer),"object"===typeof a&&
Array.isArray(a.buffer)&&c(a.buffer[0]))this.playbackState=g.PLAYING_STATE,this._.tape=new k(a),this._.tapeStream=new d(this._.tape,this._.samplerate),this._.tapeStream.isLooped=this._.isLooped},get:function(){return this._.tape}},isLooped:{get:function(){return this._.isLooped}},buffer:{get:function(){if(this._.tape)return this._.tape.getBuffer()}}});b.loop=function(a){this._.isLooped=!!a;this._.tapeStream&&(this._.tapeStream.isLooped=this._.isLooped);return this};b.bang=function(){this.playbackState=
g.PLAYING_STATE;this._.tapeStream&&this._.tapeStream.reset();this._.emit("bang");return this};b.getBuffer=function(){if(this._.tape)return this._.tape.getBuffer()};b.process=function(a){var b=this._;if(this.tickID!==a){this.tickID=a;if(a=b.tapeStream){var c=this.cells[1],d=this.cells[2],e=a.fetch(c.length);c.set(e[0]);d.set(e[1]);this.playbackState===g.PLAYING_STATE&&a.isEnded&&g.nextTick(b.onended)}g.outputSignalAR(this)}return this};g.register("tape",h)})(timbre);
(function(i){function h(a){i.Object.call(this,1,a);g.timer(this);a=this._;this.playbackState=g.FINISHED_STATE;a.task=[];a.i=0;a.j=0;a.imax=0;a.jmax=0;a.wait=0;a.count=0;a.args={};a.doNum=1;a.initFunc=g.nop;a.onended=c(this);this.on("start",d)}var g=i.fn,k=i.timevalue,e=i(function(){}).constructor;g.extend(h);var d=function(){var a=this._,b;this.playbackState=g.PLAYING_STATE;a.task=this.nodes.map(function(a){return a instanceof e?a.func:!1}).filter(function(a){return!!a});a.i=a.j=0;a.imax=a.doNum;
a.jmax=a.task.length;b=a.initFunc();g.isDictionary(b)||(b={param:b});a.args=b},c=function(a){return function(){a.playbackState=g.FINISHED_STATE;var b=a._,c=a.cells[0],d=a.cells[1],e=a.cells[2],h=b.args;if("number"===typeof h)for(var i=0,k=d.length;i<k;++i)c[0]=d[i]=e[i]=h;b.emit("ended",b.args)}},b=h.prototype;Object.defineProperties(b,{"do":{set:function(a){"number"===typeof a&&0<a&&(this._.doNum=Infinity===a?Infinity:a|0)},get:function(){return this._.doNum}},init:{set:function(a){"function"===
typeof a&&(this._.initFunc=a)},get:function(){return this._.initFunc}}});b.bang=function(){var a=this._;a.count=0;a.emit("bang");return this};b.wait=function(a){"string"===typeof a&&(a=k(a));"number"===typeof a&&0<a&&(this._.count+=0.001*this._.samplerate*a|0);return this};b.process=function(a){var b=this.cells[0],c=this._;if(this.tickID!==a&&(this.tickID=a,c.i<c.imax)){for(;0>=c.count;){if(c.j>=c.jmax){++c.i;if(c.i>=c.imax){g.nextTick(c.onended);break}c.j=0}(a=c.task[c.j++])&&a.call(this,c.i,c.args)}c.count-=
b.length}return this};g.register("task",h)})(timbre);
(function(i){function h(b){i.Object.call(this,0,b);g.timer(this);g.fixKR(this);b=this._;this.playbackState=g.FINISHED_STATE;b.currentTime=0;b.samplesMax=0;b.samples=0;b.onended=g.make_onended(this);this.once("init",e);this.on("start",d)}var g=i.fn,k=i.timevalue;g.extend(h);var e=function(){this._.timeout||(this.timeout=1E3)},d=function(){this.playbackState=g.PLAYING_STATE};Object.defineProperty(d,"unremovable",{value:!0,writable:!1});var c=h.prototype;Object.defineProperties(c,{timeout:{set:function(b){var a=
this._;"string"===typeof b&&(b=k(b));"number"===typeof b&&0<=b&&(this.playbackState=g.PLAYING_STATE,a.timeout=b,a.samplesMax=a.samplerate*0.001*b|0,a.samples=a.samplesMax)},get:function(){return this._.timeout}},currentTime:{get:function(){return this._.currentTime}}});c.bang=function(){var b=this._;this.playbackState=g.PLAYING_STATE;b.samples=b.samplesMax;b.currentTime=0;b.emit("bang");return this};c.process=function(b){var a=this.cells[0],c=this._;if(this.tickID!==b){this.tickID=b;0<c.samples&&
(c.samples-=a.length);if(0>=c.samples){for(var b=this.nodes,a=0,d=b.length;a<d;++a)b[a].bang();g.nextTick(c.onended)}c.currentTime+=g.currentTimeIncr}return this};g.register("timeout",h)})(timbre);
(function(i){function h(e){i.Object.call(this,1,e);g.fixAR(this);this._.curve=null}var g=i.fn;g.extend(h);var k=h.prototype;Object.defineProperties(k,{curve:{set:function(e){g.isSignalArray(e)&&(this._.curve=e)},get:function(){return this._.curve}}});k.process=function(e){var d=this._;if(this.tickID!==e){this.tickID=e;g.inputSignalAR(this);if(d.curve){var e=this.cells[0],c=d.curve,b=c.length,a,f=d.cellsize;for(a=0;a<f;++a)d=0.5*(e[a]+1)*b+0.5|0,0>d?d=0:d>=b-1&&(d=b-1),e[a]=c[d]}g.outputSignalAR(this)}return this};
g.register("waveshaper",h)})(timbre);
(function(i){function h(c){i.Object.call(this,1,c);c=this._;c.inMin=0;c.inMax=1;c.outMin=0;c.outMax=1;c.ar=!1;this.once("init",k)}var g=i.fn;g.extend(h);var k=function(){this._.warp||(this.warp="linlin")},e=h.prototype;Object.defineProperties(e,{inMin:{set:function(c){"number"===typeof c&&(this._.inMin=c)},get:function(){return this._.inMin}},inMax:{set:function(c){"number"===typeof c&&(this._.inMax=c)},get:function(){return this._.inMax}},outMin:{set:function(c){"number"===typeof c&&(this._.outMin=
c)},get:function(){return this._.outMin}},outMax:{set:function(c){"number"===typeof c&&(this._.outMax=c)},get:function(){return this._.outMax}},warp:{set:function(c){if("string"===typeof c){var b=d[c];b&&(this._.warp=b,this._.warpName=c)}},get:function(){return this._.warpName}}});e.process=function(c){var b=this._,a=this.cells[0];if(this.tickID!==c){this.tickID=c;var d=b.inMin,e=b.inMax,h=b.outMin,i=b.outMax,k=b.warp,o=this.nodes.length,m=b.mul,u=b.add,c=a.length;if(b.ar&&o){g.inputSignalAR(this);
for(b=0;b<c;++b)a[b]=k(a[b],d,e,h,i)*m+u;g.outputSignalAR(this)}else{b=this.nodes.length?g.inputSignalKR(this):0;d=k(b,d,e,h,i)*m+u;for(b=0;b<c;++b)a[b]=d}}return this};var d={linlin:function(c,b,a,d,e){return c<b?d:c>a?e:a===b?d:(c-b)/(a-b)*(e-d)+d},linexp:function(c,b,a,d,e){return c<b?d:c>a?e:0===d?0:a===b?e:Math.pow(e/d,(c-b)/(a-b))*d},explin:function(c,b,a,d,e){return c<b?d:c>a?e:0===b?e:Math.log(c/b)/Math.log(a/b)*(e-d)+d},expexp:function(c,b,a,d,e){return c<b?d:c>a?e:0===b||0===d?0:Math.pow(e/
d,Math.log(c/b)/Math.log(a/b))*d}};g.register("zmap",h)})(timbre);
