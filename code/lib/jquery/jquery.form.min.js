(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):b("undefined"!=typeof jQuery?jQuery:window.Zepto)})(function(b){function v(a){var h=a.data;a.isDefaultPrevented()||(a.preventDefault(),b(a.target).ajaxSubmit(h))}function r(a){var h=a.target,d=b(h);if(!d.is("[type=submit],[type=image]")){h=d.closest("[type=submit]");if(0===h.length)return;h=h[0]}var c=this;c.clk=h;"image"==h.type&&(void 0!==a.offsetX?(c.clk_x=a.offsetX,c.clk_y=a.offsetY):"function"==typeof b.fn.offset?(d=d.offset(),
c.clk_x=a.pageX-d.left,c.clk_y=a.pageY-d.top):(c.clk_x=a.pageX-h.offsetLeft,c.clk_y=a.pageY-h.offsetTop));setTimeout(function(){c.clk=c.clk_x=c.clk_y=null},100)}function o(){if(b.fn.ajaxSubmit.debug){var a="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(a):window.opera&&window.opera.postError&&window.opera.postError(a)}}var w,y;w=void 0!==b("<input type='file'/>").get(0).files;y=void 0!==window.FormData;var A=!!b.fn.prop;b.fn.attr2=function(){if(!A)return this.attr.apply(this,
arguments);var a=this.prop.apply(this,arguments);return a&&a.jquery||"string"===typeof a?a:this.attr.apply(this,arguments)};b.fn.ajaxSubmit=function(a){function h(c){var c=b.param(c,a.traditional).split("&"),f=c.length,h=[],g,d;for(g=0;g<f;g++)c[g]=c[g].replace(/\+/g," "),d=c[g].split("="),h.push([decodeURIComponent(d[0]),decodeURIComponent(d[1])]);return h}function d(c){for(var f=new FormData,d=0;d<c.length;d++)f.append(c[d].name,c[d].value);if(a.extraData){c=h(a.extraData);for(d=0;d<c.length;d++)c[d]&&
f.append(c[d][0],c[d][1])}a.data=null;d=b.extend(!0,{},b.ajaxSettings,a,{contentType:!1,processData:!1,cache:!1,type:g||"POST"});a.uploadProgress&&(d.xhr=function(){var c=b.ajaxSettings.xhr();c.upload&&c.upload.addEventListener("progress",function(b){var e=0,c=b.loaded||b.position,d=b.total;b.lengthComputable&&(e=Math.ceil(100*(c/d)));a.uploadProgress(b,c,d,e)},!1);return c});d.data=null;var j=d.beforeSend;d.beforeSend=function(b,c){c.data=a.formData?a.formData:f;j&&j.call(this,b,c)};return b.ajax(d)}
function c(c){function d(a){var b=null;try{a.contentWindow&&(b=a.contentWindow.document)}catch(c){o("cannot get iframe.contentWindow document: "+c)}if(b)return b;try{b=a.contentDocument?a.contentDocument:a.document}catch(e){o("cannot get iframe.contentDocument: "+e),b=a.document}return b}function f(){function a(){try{var b=d(s).readyState;o("state = "+b);b&&"uninitialized"==b.toLowerCase()&&setTimeout(a,50)}catch(c){o("Server abort: ",c," (",c.name,")"),h(w),r&&clearTimeout(r),r=void 0}}var c=l.attr2("target"),
i=l.attr2("action"),k=l.attr("enctype")||l.attr("encoding")||"multipart/form-data";j.setAttribute("target",p);(!g||/post/i.test(g))&&j.setAttribute("method","POST");i!=e.url&&j.setAttribute("action",e.url);!e.skipEncodingOverride&&(!g||/post/i.test(g))&&l.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});e.timeout&&(r=setTimeout(function(){v=!0;h(x)},e.timeout));var m=[];try{if(e.extraData)for(var n in e.extraData)e.extraData.hasOwnProperty(n)&&(b.isPlainObject(e.extraData[n])&&
e.extraData[n].hasOwnProperty("name")&&e.extraData[n].hasOwnProperty("value")?m.push(b('<input type="hidden" name="'+e.extraData[n].name+'">').val(e.extraData[n].value).appendTo(j)[0]):m.push(b('<input type="hidden" name="'+n+'">').val(e.extraData[n]).appendTo(j)[0]));e.iframeTarget||t.appendTo("body");s.attachEvent?s.attachEvent("onload",h):s.addEventListener("load",h,!1);setTimeout(a,15);try{j.submit()}catch(q){document.createElement("form").submit.apply(j)}}finally{j.setAttribute("action",i),j.setAttribute("enctype",
k),c?j.setAttribute("target",c):l.removeAttr("target"),b(m).remove()}}function h(a){if(!i.aborted&&!C)if(n=d(s),n||(o("cannot access response document"),a=w),a===x&&i)i.abort("timeout"),u.reject(i,"timeout");else if(a==w&&i)i.abort("server abort"),u.reject(i,"error","server abort");else if(n&&n.location.href!=e.iframeSrc||v){s.detachEvent?s.detachEvent("onload",h):s.removeEventListener("load",h,!1);var a="success",c;try{if(v)throw"timeout";var f="xml"==e.dataType||n.XMLDocument||b.isXMLDoc(n);o("isXml="+
f);if(!f&&(window.opera&&(null===n.body||!n.body.innerHTML))&&--z){o("requeing onLoad callback, DOM not available");setTimeout(h,250);return}var g=n.body?n.body:n.documentElement;i.responseText=g?g.innerHTML:null;i.responseXML=n.XMLDocument?n.XMLDocument:n;f&&(e.dataType="xml");i.getResponseHeader=function(a){return{"content-type":e.dataType}[a.toLowerCase()]};g&&(i.status=Number(g.getAttribute("status"))||i.status,i.statusText=g.getAttribute("statusText")||i.statusText);var j=(e.dataType||"").toLowerCase(),
k=/(json|script|text)/.test(j);if(k||e.textarea){var l=n.getElementsByTagName("textarea")[0];if(l)i.responseText=l.value,i.status=Number(l.getAttribute("status"))||i.status,i.statusText=l.getAttribute("statusText")||i.statusText;else if(k){var m=n.getElementsByTagName("pre")[0],p=n.getElementsByTagName("body")[0];m?i.responseText=m.textContent?m.textContent:m.innerText:p&&(i.responseText=p.textContent?p.textContent:p.innerText)}}else"xml"==j&&(!i.responseXML&&i.responseText)&&(i.responseXML=E(i.responseText));
try{y=F(i,j,e)}catch(D){a="parsererror",i.error=c=D||a}}catch(B){o("error caught: ",B),a="error",i.error=c=B||a}i.aborted&&(o("upload aborted"),a=null);i.status&&(a=200<=i.status&&300>i.status||304===i.status?"success":"error");"success"===a?(e.success&&e.success.call(e.context,y,"success",i),u.resolve(i.responseText,"success",i),q&&b.event.trigger("ajaxSuccess",[i,e])):a&&(void 0===c&&(c=i.statusText),e.error&&e.error.call(e.context,i,a,c),u.reject(i,"error",c),q&&b.event.trigger("ajaxError",[i,
e,c]));q&&b.event.trigger("ajaxComplete",[i,e]);q&&!--b.active&&b.event.trigger("ajaxStop");e.complete&&e.complete.call(e.context,i,a);C=!0;e.timeout&&clearTimeout(r);setTimeout(function(){e.iframeTarget?t.attr("src",e.iframeSrc):t.remove();i.responseXML=null},100)}}var j=l[0],k,e,q,p,t,s,i,v,r,u=b.Deferred();u.abort=function(a){i.abort(a)};if(c)for(k=0;k<m.length;k++)c=b(m[k]),A?c.prop("disabled",!1):c.removeAttr("disabled");e=b.extend(!0,{},b.ajaxSettings,a);e.context=e.context||e;p="jqFormIO"+
(new Date).getTime();e.iframeTarget?(t=b(e.iframeTarget),(k=t.attr2("name"))?p=k:t.attr2("name",p)):(t=b('<iframe name="'+p+'" src="'+e.iframeSrc+'" />'),t.css({position:"absolute",top:"-1000px",left:"-1000px"}));s=t[0];i={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(a){var c=a==="timeout"?"timeout":"aborted";o("aborting upload... "+c);this.aborted=1;try{s.contentWindow.document.execCommand&&
s.contentWindow.document.execCommand("Stop")}catch(d){}t.attr("src",e.iframeSrc);i.error=c;e.error&&e.error.call(e.context,i,c,a);q&&b.event.trigger("ajaxError",[i,e,c]);e.complete&&e.complete.call(e.context,i,c)}};(q=e.global)&&0===b.active++&&b.event.trigger("ajaxStart");q&&b.event.trigger("ajaxSend",[i,e]);if(e.beforeSend&&!1===e.beforeSend.call(e.context,i,e))return e.global&&b.active--,u.reject(),u;if(i.aborted)return u.reject(),u;if(c=j.clk)if((k=c.name)&&!c.disabled)e.extraData=e.extraData||
{},e.extraData[k]=c.value,"image"==c.type&&(e.extraData[k+".x"]=j.clk_x,e.extraData[k+".y"]=j.clk_y);var x=1,w=2,c=b("meta[name=csrf-token]").attr("content");if((k=b("meta[name=csrf-param]").attr("content"))&&c)e.extraData=e.extraData||{},e.extraData[k]=c;e.forceSync?f():setTimeout(f,10);var y,n,z=50,C,E=b.parseXML||function(a,b){if(window.ActiveXObject){b=new ActiveXObject("Microsoft.XMLDOM");b.async="false";b.loadXML(a)}else b=(new DOMParser).parseFromString(a,"text/xml");return b&&b.documentElement&&
b.documentElement.nodeName!="parsererror"?b:null},G=b.parseJSON||function(a){return window.eval("("+a+")")},F=function(a,c,e){var d=a.getResponseHeader("content-type")||"",f=c==="xml"||!c&&d.indexOf("xml")>=0,a=f?a.responseXML:a.responseText;f&&a.documentElement.nodeName==="parsererror"&&b.error&&b.error("parsererror");e&&e.dataFilter&&(a=e.dataFilter(a,c));typeof a==="string"&&(c==="json"||!c&&d.indexOf("json")>=0?a=G(a):(c==="script"||!c&&d.indexOf("javascript")>=0)&&b.globalEval(a));return a};
return u}if(!this.length)return o("ajaxSubmit: skipping submit process - no element selected"),this;var g,f,l=this;"function"==typeof a?a={success:a}:void 0===a&&(a={});g=a.type||this.attr2("method");f=a.url||this.attr2("action");(f=(f="string"===typeof f?b.trim(f):"")||window.location.href||"")&&(f=(f.match(/^([^#]+)/)||[])[1]);a=b.extend(!0,{url:f,success:b.ajaxSettings.success,type:g||b.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},a);f=
{};this.trigger("form-pre-serialize",[this,a,f]);if(f.veto)return o("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(a.beforeSerialize&&!1===a.beforeSerialize(this,a))return o("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var k=a.traditional;void 0===k&&(k=b.ajaxSettings.traditional);var m=[],j,q=this.formToArray(a.semantic,m);a.data&&(a.extraData=a.data,j=b.param(a.data,k));if(a.beforeSubmit&&!1===a.beforeSubmit(q,this,a))return o("ajaxSubmit: submit aborted via beforeSubmit callback"),
this;this.trigger("form-submit-validate",[q,this,a,f]);if(f.veto)return o("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;f=b.param(q,k);j&&(f=f?f+"&"+j:j);"GET"==a.type.toUpperCase()?(a.url+=(0<=a.url.indexOf("?")?"&":"?")+f,a.data=null):a.data=f;var p=[];a.resetForm&&p.push(function(){l.resetForm()});a.clearForm&&p.push(function(){l.clearForm(a.includeHidden)});if(!a.dataType&&a.target){var v=a.success||function(){};p.push(function(c){var d=a.replaceTarget?"replaceWith":"html";
b(a.target)[d](c).each(v,arguments)})}else a.success&&p.push(a.success);a.success=function(b,c,d){for(var f=a.context||this,g=0,h=p.length;g<h;g++)p[g].apply(f,[b,c,d||l,l])};if(a.error){var r=a.error;a.error=function(b,c,d){r.apply(a.context||this,[b,c,d,l])}}if(a.complete){var z=a.complete;a.complete=function(b,c){z.apply(a.context||this,[b,c,l])}}j=0<b("input[type=file]:enabled",this).filter(function(){return b(this).val()!==""}).length;f="multipart/form-data"==l.attr("enctype")||"multipart/form-data"==
l.attr("encoding");k=w&&y;o("fileAPI :"+k);var x;!1!==a.iframe&&(a.iframe||(j||f)&&!k)?a.closeKeepAlive?b.get(a.closeKeepAlive,function(){x=c(q)}):x=c(q):x=(j||f)&&k?d(q):b.ajax(a);l.removeData("jqxhr").data("jqxhr",x);for(j=0;j<m.length;j++)m[j]=null;this.trigger("form-submit-notify",[this,a]);return this};b.fn.ajaxForm=function(a){a=a||{};a.delegation=a.delegation&&b.isFunction(b.fn.on);if(!a.delegation&&0===this.length){var h=this.selector,d=this.context;if(!b.isReady&&h)return o("DOM not ready, queuing ajaxForm"),
b(function(){b(h,d).ajaxForm(a)}),this;o("terminating; zero elements found by selector"+(b.isReady?"":" (DOM not ready)"));return this}return a.delegation?(b(document).off("submit.form-plugin",this.selector,v).off("click.form-plugin",this.selector,r).on("submit.form-plugin",this.selector,a,v).on("click.form-plugin",this.selector,a,r),this):this.ajaxFormUnbind().bind("submit.form-plugin",a,v).bind("click.form-plugin",a,r)};b.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};
b.fn.formToArray=function(a,h){var d=[];if(0===this.length)return d;var c=this[0],g=this.attr("id"),f=a?c.getElementsByTagName("*"):c.elements;f&&!/MSIE [678]/.test(navigator.userAgent)&&(f=b(f).get());g&&(g=b(':input[form="'+g+'"]').get(),g.length&&(f=(f||[]).concat(g)));if(!f||!f.length)return d;var l,k,m,j,o;l=0;for(o=f.length;l<o;l++)if(j=f[l],(g=j.name)&&!j.disabled)if(a&&c.clk&&"image"==j.type)c.clk==j&&(d.push({name:g,value:b(j).val(),type:j.type}),d.push({name:g+".x",value:c.clk_x},{name:g+
".y",value:c.clk_y}));else if((m=b.fieldValue(j,!0))&&m.constructor==Array){h&&h.push(j);k=0;for(j=m.length;k<j;k++)d.push({name:g,value:m[k]})}else if(w&&"file"==j.type)if(h&&h.push(j),m=j.files,m.length)for(k=0;k<m.length;k++)d.push({name:g,value:m[k],type:j.type});else d.push({name:g,value:"",type:j.type});else null!==m&&"undefined"!=typeof m&&(h&&h.push(j),d.push({name:g,value:m,type:j.type,required:j.required}));if(!a&&c.clk&&(f=b(c.clk),l=f[0],(g=l.name)&&!l.disabled&&"image"==l.type))d.push({name:g,
value:f.val()}),d.push({name:g+".x",value:c.clk_x},{name:g+".y",value:c.clk_y});return d};b.fn.formSerialize=function(a){return b.param(this.formToArray(a))};b.fn.fieldSerialize=function(a){var h=[];this.each(function(){var d=this.name;if(d){var c=b.fieldValue(this,a);if(c&&c.constructor==Array)for(var g=0,f=c.length;g<f;g++)h.push({name:d,value:c[g]});else null!==c&&"undefined"!=typeof c&&h.push({name:this.name,value:c})}});return b.param(h)};b.fn.fieldValue=function(a){for(var h=[],d=0,c=this.length;d<
c;d++){var g=b.fieldValue(this[d],a);null===g||("undefined"==typeof g||g.constructor==Array&&!g.length)||(g.constructor==Array?b.merge(h,g):h.push(g))}return h};b.fieldValue=function(a,h){var d=a.name,c=a.type,g=a.tagName.toLowerCase();void 0===h&&(h=!0);if(h&&(!d||a.disabled||"reset"==c||"button"==c||("checkbox"==c||"radio"==c)&&!a.checked||("submit"==c||"image"==c)&&a.form&&a.form.clk!=a||"select"==g&&-1==a.selectedIndex))return null;if("select"==g){var f=a.selectedIndex;if(0>f)return null;for(var d=
[],g=a.options,l=(c="select-one"==c)?f+1:g.length,f=c?f:0;f<l;f++){var k=g[f];if(k.selected){var m=k.value;m||(m=k.attributes&&k.attributes.value&&!k.attributes.value.specified?k.text:k.value);if(c)return m;d.push(m)}}return d}return b(a).val()};b.fn.clearForm=function(a){return this.each(function(){b("input,select,textarea",this).clearFields(a)})};b.fn.clearFields=b.fn.clearInputs=function(a){var h=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var d=
this.type,c=this.tagName.toLowerCase();if(h.test(d)||"textarea"==c)this.value="";else if("checkbox"==d||"radio"==d)this.checked=!1;else if("select"==c)this.selectedIndex=-1;else if("file"==d)/MSIE/.test(navigator.userAgent)?b(this).replaceWith(b(this).clone(!0)):b(this).val("");else if(a&&(!0===a&&/hidden/.test(d)||"string"==typeof a&&b(this).is(a)))this.value=""})};b.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&
this.reset()})};b.fn.enable=function(a){void 0===a&&(a=!0);return this.each(function(){this.disabled=!a})};b.fn.selected=function(a){void 0===a&&(a=!0);return this.each(function(){var h=this.type;"checkbox"==h||"radio"==h?this.checked=a:"option"==this.tagName.toLowerCase()&&(h=b(this).parent("select"),a&&(h[0]&&"select-one"==h[0].type)&&h.find("option").selected(!1),this.selected=a)})};b.fn.ajaxSubmit.debug=!1});
