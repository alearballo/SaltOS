(function(){function O(d){q.push(d);50<q.length&&q.shift()}function z(d){return q[q.length-(d?Math.min(d,1):1)]||""}function k(){1<q.length&&q.pop();return z()}function J(d,e,i,g,j){null==j&&(j=d.getRange(e,i));g&&K&&K.cm==d&&e.line==K.pos.line&&e.ch==K.pos.ch&&d.isClean(K.gen)?q.length?q[q.length-1]+=j:O(j):O(j);d.replaceRange("",e,i,"+delete");K=g?{cm:d,pos:e,gen:d.changeGeneration()}:null}function u(d,e,i){return d.findPosH(e,i,"char",!0)}function C(d,e,i){return d.findPosH(e,i,"word",!0)}function s(d,
e,i){return d.findPosV(e,i,"line",d.doc.sel.goalColumn)}function t(d,e,i){return d.findPosV(e,i,"page",d.doc.sel.goalColumn)}function v(d,e,i){for(var g=e.line,j=d.getLine(g),e=/\S/.test(0>i?j.slice(0,e.ch):j.slice(e.ch)),k=d.firstLine(),n=d.lastLine();;){g+=i;if(g<k||g>n)return d.clipPos(y(g-i,0>i?0:null));j=d.getLine(g);if(/\S/.test(j))e=!0;else if(e)return y(g,0)}}function B(d,e,i){for(var g=e.line,j=e.ch,e=d.getLine(e.line),k=!1;;){var n=e.charAt(j+(0>i?-1:0));if(n){if(k&&/[!?.]/.test(n))return y(g,
j+(0<i?1:0));k||(k=/\w/.test(n));j+=i}else{if(g==(0>i?d.firstLine():d.lastLine()))return y(g,j);e=d.getLine(g+i);if(!/\S/.test(e))return y(g,j);g+=i;j=0>i?e.length:0}}}function G(d,e,i){var g;if(d.findMatchingBracket&&(g=d.findMatchingBracket(e,!0))&&g.match&&(g.forward?1:-1)==i)return 0<i?y(g.to.line,g.to.ch+1):g.to;for(var j=!0;;j=!1){var k=d.getTokenAt(e);g=y(e.line,0>i?k.start:k.end);if(j&&0<i&&k.end==e.ch||!/\w/.test(k.string)){j=d.findPosH(g,i,"char");if(g.line==j.line&&g.ch==j.ch)return e;
e=j}else return g}}function D(d,e){var i=d.state.emacsPrefix;if(!i)return e?null:1;U(d);return"-"==i?-1:Number(i)}function w(d){var e="string"==typeof d?function(e){e.execCommand(d)}:d;return function(d){var g=D(d);e(d);for(var j=1;j<g;++j)e(d)}}function S(d,e,i){var g=d.getCursor(),j=D(d);0>j&&(i=-i,j=-j);for(var k=0;k<j;++k){var n=e(d,g,i);if(n.line==g.line&&n.ch==g.ch)break;g=n}return g}function n(d,e){var i=function(i){i.extendSelection(S(i,d,e))};i.motion=!0;return i}function H(d,e,i){J(d,d.getCursor(),
S(d,e,i),!0)}function F(d,e){d.state.emacsPrefix?"-"!=e&&(d.state.emacsPrefix+=e):(d.state.emacsPrefix=e,d.on("keyHandled",r),d.on("inputRead",x))}function r(d,e){!d.state.emacsPrefixMap&&!V.hasOwnProperty(e)&&U(d)}function U(d){d.state.emacsPrefix=null;d.off("keyHandled",r);d.off("inputRead",x)}function x(d,e){var i=D(d);if(1<i&&"+input"==e.origin){for(var g=e.text.join("\n"),j="",k=1;k<i;++k)j+=g;d.replaceSelection(j,"end","+input")}}function Q(d,e){"string"==typeof e&&(/^\d$/.test(e)||"Ctrl-U"==
e)||(d.removeKeyMap(W),d.state.emacsPrefixMap=!1,d.off("keyHandled",Q),d.off("inputRead",Q))}function L(d){d.setCursor(d.getCursor());d.setExtending(!0);d.on("change",function(){d.setExtending(!1)})}function M(d,e,i){d.openDialog?d.openDialog(e+': <input type="text" style="width: 10em"/>',i,{bottom:!0}):i(prompt(e,""))}function R(d,e){var i=d.getCursor(),g=d.findPosH(i,1,"word");d.replaceRange(e(d.getRange(i,g)),i,g);d.setCursor(g)}function ba(d){W[d]=function(e){F(e,d)};ca["Ctrl-"+d]=function(e){F(e,
d)};V["Ctrl-"+d]=!0}var y=CodeMirror.Pos,q=[],K=null,V={"Alt-G":!0,"Ctrl-X":!0,"Ctrl-Q":!0,"Ctrl-U":!0},ca=CodeMirror.keyMap.emacs={"Ctrl-W":function(d){J(d,d.getCursor("start"),d.getCursor("end"))},"Ctrl-K":w(function(d){var e=d.getCursor(),i=d.clipPos(y(e.line)),g=d.getRange(e,i);/\S/.test(g)||(g+="\n",i=y(e.line+1,0));J(d,e,i,!0,g)}),"Alt-W":function(d){O(d.getSelection())},"Ctrl-Y":function(d){var e=d.getCursor();d.replaceRange(z(D(d)),e,e,"paste");d.setSelection(e,d.getCursor())},"Alt-Y":function(d){d.replaceSelection(k())},
"Ctrl-Space":L,"Ctrl-Shift-2":L,"Ctrl-F":n(u,1),"Ctrl-B":n(u,-1),Right:n(u,1),Left:n(u,-1),"Ctrl-D":function(d){H(d,u,1)},Delete:function(d){H(d,u,1)},"Ctrl-H":function(d){H(d,u,-1)},Backspace:function(d){H(d,u,-1)},"Alt-F":n(C,1),"Alt-B":n(C,-1),"Alt-D":function(d){H(d,C,1)},"Alt-Backspace":function(d){H(d,C,-1)},"Ctrl-N":n(s,1),"Ctrl-P":n(s,-1),Down:n(s,1),Up:n(s,-1),"Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd",End:"goLineEnd",Home:"goLineStart","Alt-V":n(t,-1),"Ctrl-V":n(t,1),PageUp:n(t,-1),PageDown:n(t,
1),"Ctrl-Up":n(v,-1),"Ctrl-Down":n(v,1),"Alt-A":n(B,-1),"Alt-E":n(B,1),"Alt-K":function(d){H(d,B,1)},"Ctrl-Alt-K":function(d){H(d,G,1)},"Ctrl-Alt-Backspace":function(d){H(d,G,-1)},"Ctrl-Alt-F":n(G,1),"Ctrl-Alt-B":n(G,-1),"Shift-Ctrl-Alt-2":function(d){d.setSelection(S(d,G,1),d.getCursor())},"Ctrl-Alt-T":function(d){var e=G(d,d.getCursor(),-1),i=G(d,e,1),g=G(d,i,1),j=G(d,g,-1);d.replaceRange(d.getRange(j,g)+d.getRange(i,j)+d.getRange(e,i),e,g)},"Ctrl-Alt-U":w(function(d){for(var e=d.getCursor(),i=
e.line,e=e.ch,g=[];i>=d.firstLine();){for(var j=d.getLine(i),k=null==e?j.length:e;0<k;)if(e=j.charAt(--k),")"==e)g.push("(");else if("]"==e)g.push("[");else if("}"==e)g.push("{");else if(/[\(\{\[]/.test(e)&&(!g.length||g.pop()!=e))return d.extendSelection(y(i,k));--i;e=null}}),"Alt-Space":function(d){for(var e=d.getCursor(),i=e.ch,g=e.ch,j=d.getLine(e.line);i&&/\s/.test(j.charAt(i-1));)--i;for(;g<j.length&&/\s/.test(j.charAt(g));)++g;d.replaceRange(" ",y(e.line,i),y(e.line,g))},"Ctrl-O":w(function(d){d.replaceSelection("\n",
"start")}),"Ctrl-T":w(function(d){var e=d.getCursor();e.ch<d.getLine(e.line).length&&(e=y(e.line,e.ch+1));var i=d.findPosH(e,-2,"char"),g=d.getRange(i,e);2==g.length&&(d.setSelection(i,e),d.replaceSelection(g.charAt(1)+g.charAt(0),"end"))}),"Alt-C":w(function(d){R(d,function(d){var i=d.search(/\w/);return-1==i?d:d.slice(0,i)+d.charAt(i).toUpperCase()+d.slice(i+1).toLowerCase()})}),"Alt-U":w(function(d){R(d,function(d){return d.toUpperCase()})}),"Alt-L":w(function(d){R(d,function(d){return d.toLowerCase()})}),
"Alt-;":"toggleComment","Ctrl-/":w("undo"),"Shift-Ctrl--":w("undo"),"Ctrl-Z":w("undo"),"Cmd-Z":w("undo"),"Shift-Alt-,":"goDocStart","Shift-Alt-.":"goDocEnd","Ctrl-S":"findNext","Ctrl-R":"findPrev","Ctrl-G":"clearSearch","Shift-Alt-5":"replace","Alt-/":"autocomplete","Ctrl-J":"newlineAndIndent",Enter:!1,Tab:"indentAuto","Alt-G":function(d){d.setOption("keyMap","emacs-Alt-G")},"Ctrl-X":function(d){d.setOption("keyMap","emacs-Ctrl-X")},"Ctrl-Q":function(d){d.setOption("keyMap","emacs-Ctrl-Q")},"Ctrl-U":function(d){d.state.emacsPrefixMap=
!0;d.addKeyMap(W);d.on("keyHandled",Q);d.on("inputRead",Q)}};CodeMirror.keyMap["emacs-Ctrl-X"]={Tab:function(d){d.indentSelection(D(d,!0)||d.getOption("indentUnit"))},"Ctrl-X":function(d){d.setSelection(d.getCursor("head"),d.getCursor("anchor"))},"Ctrl-S":"save","Ctrl-W":"save",S:"saveAll",F:"open",U:w("undo"),K:"close",Delete:function(d){J(d,d.getCursor(),B(d,d.getCursor(),1),!0)},auto:"emacs",nofallthrough:!0,disableInput:!0};CodeMirror.keyMap["emacs-Alt-G"]={G:function(d){var e=D(d,!0);if(null!=
e&&0<e)return d.setCursor(e-1);M(d,"Goto line",function(e){var g;e&&(!isNaN(g=Number(e))&&g==g|0&&0<g)&&d.setCursor(g-1)})},auto:"emacs",nofallthrough:!0,disableInput:!0};CodeMirror.keyMap["emacs-Ctrl-Q"]={Tab:w("insertTab"),auto:"emacs",nofallthrough:!0};for(var W={"Ctrl-G":U},X=0;10>X;++X)ba(""+X);ba("-")})();
(function(){function O(k,J){var u=k.getCursor("head"),C=k.getCursor("anchor");k.operation(function(){var s;var t=Math.min(u.line,C.line),v=Math.max(u.line,C.line);if(!J||t>v)s=0;else{s=k.clipPos(z(t,0));var B=k.clipPos(z(v)),v=k.getRange(s,B);t<=k.firstLine()?k.replaceRange("",s,z(B.line+1,0)):k.replaceRange("",z(s.line-1),B);t=s.line+J;t<=k.firstLine()?(k.replaceRange(v+"\n",z(t,0)),s=k.firstLine()-s.line):(t=k.clipPos(z(t-1)),k.replaceRange("\n"+v,t),s=t.line+1-s.line)}k.setSelection(z(C.line+s,
C.ch),z(u.line+s,u.ch))})}var z=CodeMirror.Pos;CodeMirror.commands.moveLinesUp=function(k){O(k,-1)};CodeMirror.commands.moveLinesDown=function(k){O(k,1)};CodeMirror.keyMap["default"]["Alt-Up"]="moveLinesUp";CodeMirror.keyMap["default"]["Alt-Down"]="moveLinesDown"})();
(function(){var O=[{keys:["<Left>"],type:"keyToKey",toKeys:["h"]},{keys:["<Right>"],type:"keyToKey",toKeys:["l"]},{keys:["<Up>"],type:"keyToKey",toKeys:["k"]},{keys:["<Down>"],type:"keyToKey",toKeys:["j"]},{keys:["<Space>"],type:"keyToKey",toKeys:["l"]},{keys:["<BS>"],type:"keyToKey",toKeys:["h"]},{keys:["<C-Space>"],type:"keyToKey",toKeys:["W"]},{keys:["<C-BS>"],type:"keyToKey",toKeys:["B"]},{keys:["<S-Space>"],type:"keyToKey",toKeys:["w"]},{keys:["<S-BS>"],type:"keyToKey",toKeys:["b"]},{keys:["<C-n>"],
type:"keyToKey",toKeys:["j"]},{keys:["<C-p>"],type:"keyToKey",toKeys:["k"]},{keys:["C-["],type:"keyToKey",toKeys:["<Esc>"]},{keys:["<C-c>"],type:"keyToKey",toKeys:["<Esc>"]},{keys:["s"],type:"keyToKey",toKeys:["c","l"],context:"normal"},{keys:["s"],type:"keyToKey",toKeys:["x","i"],context:"visual"},{keys:["S"],type:"keyToKey",toKeys:["c","c"],context:"normal"},{keys:["S"],type:"keyToKey",toKeys:["d","c","c"],context:"visual"},{keys:["<Home>"],type:"keyToKey",toKeys:["0"]},{keys:["<End>"],type:"keyToKey",
toKeys:["$"]},{keys:["<PageUp>"],type:"keyToKey",toKeys:["<C-b>"]},{keys:["<PageDown>"],type:"keyToKey",toKeys:["<C-f>"]},{keys:["H"],type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:["M"],type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:["L"],type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:["h"],type:"motion",motion:"moveByCharacters",motionArgs:{forward:!1}},{keys:["l"],type:"motion",motion:"moveByCharacters",
motionArgs:{forward:!0}},{keys:["j"],type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:["k"],type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:["g","j"],type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:["g","k"],type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:["w"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},{keys:["W"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,
wordEnd:!1,bigWord:!0}},{keys:["e"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:["E"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:["b"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:["B"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:["g","e"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},
{keys:["g","E"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:["{"],type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:["}"],type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:["<C-f>"],type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:["<C-b>"],type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:["<C-d>"],type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,
explicitRepeat:!0}},{keys:["<C-u>"],type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:["g","g"],type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:["G"],type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:["0"],type:"motion",motion:"moveToStartOfLine"},{keys:["^"],type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},
{keys:["+"],type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0}},{keys:["-"],type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:["_"],type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:["$"],type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:["%"],type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:["f","character"],type:"motion",motion:"moveToCharacter",
motionArgs:{forward:!0,inclusive:!0}},{keys:["F","character"],type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:["t","character"],type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:["T","character"],type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:[";"],type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:[","],type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:["'",
"character"],type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:["`","character"],type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:["]","`"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:["[","`"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:["]","'"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:["[","'"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:["]","character"],
type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:["[","character"],type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:["|"],type:"motion",motion:"moveToColumn",motionArgs:{}},{keys:["d"],type:"operator",operator:"delete"},{keys:["y"],type:"operator",operator:"yank"},{keys:["c"],type:"operator",operator:"change"},{keys:[">"],type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:["<"],type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},
{keys:["g","~"],type:"operator",operator:"swapcase"},{keys:["n"],type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:["N"],type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:["x"],type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:["X"],type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:["D"],
type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},operatorMotionArgs:{visualLine:!0}},{keys:["Y"],type:"operatorMotion",operator:"yank",motion:"moveToEol",motionArgs:{inclusive:!0},operatorMotionArgs:{visualLine:!0}},{keys:["C"],type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},operatorMotionArgs:{visualLine:!0}},{keys:["~"],type:"operatorMotion",operator:"swapcase",operatorArgs:{shouldMoveCursor:!0},motion:"moveByCharacters",motionArgs:{forward:!0}},
{keys:["<C-i>"],type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:["<C-o>"],type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},{keys:["a"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"}},{keys:["A"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"}},{keys:["i"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"}},{keys:["I"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"}},
{keys:["o"],type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0}},{keys:["O"],type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1}},{keys:["v"],type:"action",action:"toggleVisualMode"},{keys:["V"],type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:["J"],type:"action",action:"joinLines",isEdit:!0},{keys:["p"],type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0}},
{keys:["P"],type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:["r","character"],type:"action",action:"replace",isEdit:!0},{keys:["@","character"],type:"action",action:"replayMacro"},{keys:["q","character"],type:"action",action:"enterMacroRecordMode"},{keys:["R"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0}},{keys:["u"],type:"action",action:"undo"},{keys:["<C-r>"],type:"action",action:"redo"},{keys:["m","character"],type:"action",action:"setMark"},
{keys:['"',"character"],type:"action",action:"setRegister"},{keys:["z","z"],type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:["z","."],type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["z","t"],type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:["z","<CR>"],type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["z","-"],
type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:["z","b"],type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["."],type:"action",action:"repeatLastEdit"},{keys:["<C-a>"],type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,backtrack:!1}},{keys:["<C-x>"],type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:["a","character"],type:"motion",
motion:"textObjectManipulation"},{keys:["i","character"],type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:["/"],type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:["?"],type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:["*"],type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:["#"],type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:[":"],type:"ex"}],
z=function(){function k(a,b){var c=a.state.vim;!c.insertMode&&!c.exMode&&(c=b.head,c.ch&&c.ch==a.doc.getLine(c.line).length&&c.ch--)}function J(a,b){for(var c=[],f=a;f<a+b;f++)c.push(String.fromCharCode(f));return c}function u(a){return/^[A-Z]$/.test(a)}function C(a,b){for(var c=0;c<b.length;c++)if(b[c]==a)return!0;return!1}function s(a){a.state.vim||(a.state.vim={inputState:new v,lastEditInputState:void 0,lastEditActionCommand:void 0,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},insertMode:!1,
insertModeRepeat:void 0,visualMode:!1,visualLine:!1});return a.state.vim}function t(){p={searchQuery:null,searchIsReversed:!1,jumpList:za(),macroModeState:Aa(),lastChararacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new G({})}}function v(){this.prefixRepeat=[];this.motionRepeat=[];this.motionArgs=this.motion=this.operatorArgs=this.operator=null;this.keyBuffer=[];this.registerName=null}function B(a,b){this.clear();a&&this.set(a,b)}function G(a){this.registers=a;this.unamedRegister=
a['"']=new B}function D(a,b,c){var f=Math.min(Math.max(a.firstLine(),b.line),a.lastLine()),a=x(a,f)-1,b=Math.min(Math.max(0,b.ch),c?a+1:a);return{line:f,ch:b}}function w(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function S(a,b,c){return{line:a.line+b,ch:a.ch+c}}function n(a,b){for(var c=0;c<a.length;c++)if(a[c]!=b[c]&&"character"!=b[c])return!1;return!0}function H(a,b,c){return function(){for(var f=0;f<c;f++)b(a)}}function F(a,b){return a.ch==b.ch&&a.line==b.line}function r(a,
b){return a.line<b.line||a.line==b.line&&a.ch<b.ch?!0:!1}function U(a,b,c){a=r(a,b);b=r(b,c);return a&&b}function x(a,b){return a.getLine(b).length}function Q(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function L(a){a.off("mousedown",L);var b=a.state.vim;b.visualMode=!1;b.visualLine=!1;var b=a.getCursor("anchor"),c=a.getCursor("head");F(b,c)||a.setCursor(D(a,c));CodeMirror.signal(a,"vim-mode-change",{mode:"normal"})}function M(a){if(!a)return 0;var b=a.search(/\S/);return-1==b?a.length:
b}function R(a,b,c,f,m){var c=a.getCursor(),a=a.getLine(c.line),d=c.ch,h=a.substring(d),m=m?h.search(/\w/):h.search(/\S/);if(-1==m)return null;var d=d+m,h=a.substring(d),m=a.substring(0,d),o;o=f?/^\S+/:/\w/.test(a.charAt(d))?/^\w+/:/^[^\w\s]+/;h=o.exec(h);f=d;d+=h[0].length;m=m.split("").reverse().join("");(o=o.exec(m))&&(f-=o[0].length);b&&(b=a.substring(d).match(/^\s*/)[0].length,0<b?d+=b:(b=m.substring(m.length-f).match(/^\s*/)[0].length,f-=b));return{start:{line:c.line,ch:f},end:{line:c.line,
ch:d}}}function ba(a,b){p.lastChararacterSearch.increment=a;p.lastChararacterSearch.forward=b.forward;p.lastChararacterSearch.selectedCharacter=b.selectedCharacter}function y(a,b,c,f){for(var m=a.getCursor(),d=m.ch,h,o=0;o<b;o++){h=a.getLine(m.line);var e=f,i=void 0;h=i=c?h.indexOf(e,d+1):h.lastIndexOf(e,d-1);if(-1==h)return null;d=h}return{line:a.getCursor().line,ch:h}}function q(a,b,c,f){C(c,Ba)&&(b.marks[c]&&b.marks[c].clear(),b.marks[c]=a.setBookmark(f))}function K(a){return"string"===a||"comment"===
a?1:0}function V(a,b,c){var f=b.line,m=b.ch,c=c?c:a.getLine(f).charAt(m),d=a.getTokenAt({line:f,ch:m+1}).type,d=K(d),h={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{"}[c];if(!h)return b;for(var o={"(":1,"{":1,"[":1}[c]||-1,e=1===o?a.lineCount():-1,i=1,g=c,j=m,m=a.getLine(f);f!==e&&0<i;){j+=o;g=m.charAt(j);g||(f+=o,m=a.getLine(f)||"",0<o?j=0:(g=m.length,j=0<g?g-1:0),g=m.charAt(j));var l=a.getTokenAt({line:f,ch:j+1}).type,l=K(l);d>=l&&(g===c?i++:g===h&&i--)}return g?{line:f,ch:j}:b}function ca(a,b,
c){var f=a.getCursor(),b=V(a,f,b),a=V(a,b);a.ch+=c?1:0;b.ch+=c?0:1;return{start:a,end:b}}function W(a,b,c){var f=a.getCursor(),a=a.getLine(f.line).split(""),m,d,h,o;h=a.indexOf(b);f.ch<h?f.ch=h:h<f.ch&&a[f.ch]==b&&(d=f.ch,--f.ch);if(a[f.ch]==b&&!d)m=f.ch+1;else for(h=f.ch;-1<h&&!m;h--)a[h]==b&&(m=h+1);if(m&&!d){h=m;for(o=a.length;h<o&&!d;h++)a[h]==b&&(d=h)}if(!m||!d)return{start:f,end:f};c&&(--m,++d);return{start:{line:f.line,ch:m},end:{line:f.line,ch:d}}}function X(){}function d(a){a=a.state.vim;
return a.searchState_||(a.searchState_=new X)}function e(a){for(var b=!1,c=[],f=0;f<a.length;f++){var m=a.charAt(f);!b&&"/"==m&&c.push(f);b="\\"==m}return c}function i(a,b){a.openNotification?a.openNotification('<span style="color: red">'+b+"</span>",{bottom:!0,duration:5E3}):alert(b)}function g(a,b){var c=(b.prefix||"")+" "+(b.desc||""),f=b.prefix,m=b.desc,d="";f&&(d+='<span style="font-family: monospace">'+f+"</span>");d+='<input type="text"/> <span style="color: #888">';m&&(d=d+'<span style="color: #888">'+
m+"</span>");f=b.onClose;a.openDialog?a.openDialog(d,f,{bottom:!0,value:b.value,onKeyDown:b.onKeyDown,onKeyUp:b.onKeyUp}):f(prompt(c,""))}function j(a,b,c,f){if(b){var m=d(a);c=!!c;f=!!f;if(!(b instanceof RegExp)){var T=e(b),h,o;T.length?(h=b.substring(0,T[0]),o=-1!=b.substring(T[0]).indexOf("i")):h=b;h?(f&&(c=/^[^A-Z]*$/.test(h)),b=RegExp(h,c||o?"i":void 0)):b=null}if(b){na(a,b);a:if(a=m.getQuery(),b instanceof RegExp&&a instanceof RegExp){o=["global","multiline","ignoreCase","source"];for(c=0;c<
o.length;c++)if(f=o[c],b[f]!==a[f]){a=!1;break a}a=!0}else a=!1;if(a)return b;m.setQuery(b);return b}}}function ya(a){if("^"==a.source.charAt(0))var b=!0;return{token:function(c){if(b&&!c.sol())c.skipToEnd();else{var f=c.match(a,!1);if(f){if(0==f[0].length)return c.next(),"searching";if(!c.sol()&&(c.backUp(1),!a.exec(c.next()+f[0])))return c.next(),null;c.match(a);return"searching"}for(;!c.eol()&&!(c.next(),c.match(a,!1)););}},query:a}}function na(a,b){var c=d(a).getOverlay();if(!c||b!=c.query)c&&
a.removeOverlay(c),c=ya(b),a.addOverlay(c),d(a).setOverlay(c)}function oa(a,b,c,f){void 0===f&&(f=1);return a.operation(function(){for(var m=a.getCursor(),d=a.getSearchCursor(c,m),h=0;h<f;h++){var o=d.find(b);0==h&&(o&&F(d.from(),m))&&(o=d.find(b));if(!o&&(d=a.getSearchCursor(c,b?{line:a.lastLine()}:{line:a.firstLine(),ch:0}),!d.find(b)))return}return d.from()})}function ia(a){a.removeOverlay(d(a).getOverlay());d(a).setOverlay(null)}function ja(a){var b=a.getScrollInfo(),c=a.coordsChar({left:0,top:6+
b.top},"local"),a=a.coordsChar({left:0,top:b.clientHeight-10+b.top},"local");return{top:c.line,bottom:a.line}}function ea(a){for(var b,c,f=[];a;){c=/<\w+-.+?>|<\w+>|./.exec(a);if(null===c)break;b=c[0];a=a.substring(c.index+b.length);f.push(b)}return f}function Ca(a,b,c,f,m,d,h){function o(){a.operation(function(){for(;!l;)e(),Y();j()})}function e(){var b=a.getRange(m.from(),m.to()).replace(d,h);m.replace(b)}function Y(){if(m.findNext()){var b;b=m.from();var d=c,h=f;"number"!=typeof b&&(b=b.line);
b=d instanceof Array?C(b,d):h?b>=d&&b<=h:b==d;b?(a.scrollIntoView(m.from(),30),a.setSelection(m.from(),m.to()),A=m.from(),l=!1):l=!0}else l=!0}function j(b){b&&b();a.focus();A&&(a.setCursor(A),b=a.state.vim,b.exMode=!1,b.lastHPos=b.lastHSPos=A.ch)}function k(b,c,f){CodeMirror.e_stop(b);switch(CodeMirror.keyName(b)){case "Y":e();Y();break;case "N":Y();break;case "A":a.operation(o);break;case "L":e();case "Q":case "Esc":case "Ctrl-C":case "Ctrl-[":j(f)}l&&j(f)}a.state.vim.exMode=!0;var l=!1,A=m.from();
Y();l?i(a,"No matches for "+d.source):b?g(a,{prefix:"replace with <strong>"+h+"</strong> (y/n/a/q/l)",onKeyDown:k}):o()}function fa(a){var b=a.state.vim,c=p.macroModeState.inReplay;c||(a.off("change",pa),a.off("cursorActivity",qa),CodeMirror.off(a.getInputField(),"keydown",ra));!c&&1<b.insertModeRepeat&&(sa(a,b,b.insertModeRepeat-1,!0),b.lastEditInputState.repeatOverride=b.insertModeRepeat);delete b.insertModeRepeat;a.setCursor(a.getCursor().line,a.getCursor().ch-1,!0);b.insertMode=!1;a.setOption("keyMap",
"vim");a.toggleOverwrite(!1);CodeMirror.signal(a,"vim-mode-change",{mode:"normal"})}function pa(a,b){for(var c=p.macroModeState.lastInsertModeChanges;b;){c.expectCursorActivityForChange=!0;if("+input"==b.origin||"paste"==b.origin||void 0===b.origin){var f=b.text.join("\n");c.changes.push(f)}b=b.next}}function qa(){var a=p.macroModeState.lastInsertModeChanges;a.expectCursorActivityForChange?a.expectCursorActivityForChange=!1:a.changes=[]}function ka(a){this.keyName=a}function ra(a){function b(){c.changes.push(new ka(f));
return!0}var c=p.macroModeState.lastInsertModeChanges,f=CodeMirror.keyName(a);(-1!=f.indexOf("Delete")||-1!=f.indexOf("Backspace"))&&CodeMirror.lookupKey(f,["vim-insert"],b)}function sa(a,b,c,f){function m(){e?Z.processAction(a,b,b.lastEditActionCommand):Z.evalInput(a,b)}function d(c){0<h.lastInsertModeChanges.changes.length&&(c=!b.lastEditActionCommand?1:c,Da(a,c,h))}var h=p.macroModeState;h.inReplay=!0;var e=!!b.lastEditActionCommand,N=b.inputState;b.inputState=b.lastEditInputState;if(e&&b.lastEditActionCommand.interlaceInsertRepeat)for(var i=
0;i<c;i++)m(),d(1);else f||m(),d(c);b.inputState=N;b.insertMode&&!f&&fa(a);h.inReplay=!1}function Da(a,b,c){function f(b){if("string"==typeof b)CodeMirror.commands[b](a);else b(a);return!0}for(var c=c.lastInsertModeChanges,m=0;m<b;m++)for(var d=0;d<c.changes.length;d++){var h=c.changes[d];if(h instanceof ka)CodeMirror.lookupKey(h.keyName,["vim-insert"],f);else{var e=a.getCursor();a.replaceRange(h,e,e)}}}CodeMirror.defineOption("vimMode",!1,function(a,b){if(b){a.setOption("keyMap","vim");CodeMirror.signal(a,
"vim-mode-change",{mode:"normal"});a.on("beforeSelectionChange",k);s(a)}else if(a.state.vim){a.setOption("keyMap","default");a.off("beforeSelectionChange",k);a.state.vim=null}});var Ea=/[\d]/,Fa=[/\w/,/[^\w\s]/],Ga=[/\S/],da=J(65,26),ga=J(97,26),ha=J(48,10),la="~`!@#$%^&*()_-+=[{}]\\|/?.,<>:;\"'".split(""),ta="Left Right Up Down Space Backspace Esc Home End PageUp PageDown Enter".split(" "),Ba=[].concat(da,ga,ha,["<",">"]),Ha=[].concat(da,ga,ha,["-",'"']),za=function(){var a=100,b=-1,c=0,f=0,d=Array(a);
return{cachedCursor:void 0,add:function(T,h,e){function i(c){var f=++b%a,h=d[f];h&&h.clear();d[f]=T.setBookmark(c)}var g=d[b%a];g?(g=g.find())&&!F(g,h)&&i(h):i(h);i(e);c=b;f=b-a+1;0>f&&(f=0)},move:function(T,h){b+=h;b>c?b=c:b<f&&(b=f);var e=d[(a+b)%a];if(e&&!e.find()){var i=0<h?1:-1,g,j=T.getCursor();do if(b+=i,(e=d[(a+b)%a])&&(g=e.find())&&!F(j,g))break;while(b<c&&b>f)}return e}}},Aa=function(){return{macroKeyBuffer:[],latestRegister:void 0,inReplay:!1,lastInsertModeChanges:{changes:[],expectCursorActivityForChange:!1},
enteredMacroMode:void 0,isMacroPlaying:!1,toggle:function(a,b){this.enteredMacroMode?(this.enteredMacroMode(),this.enteredMacroMode=void 0):(this.latestRegister=b,this.enteredMacroMode=a.openDialog("(recording)["+b+"]",null,{bottom:!0}))}}},p,ga={buildKeyMap:function(){},getRegisterController:function(){return p.registerController},resetVimGlobalState_:t,getVimGlobalState_:function(){return p},maybeInitVimState_:s,InsertModeKey:ka,map:function(a,b){$.map(a,b)},defineEx:function(a,b,c){if(0!==a.indexOf(b))throw Error('(Vim.defineEx) "'+
b+'" is not a prefix of "'+a+'", command not registered');ua[a]=c;$.commandMap_[b]={name:a,shortName:b,type:"api"}},handleKey:function(a,b){var c,f=s(a),d=p.macroModeState;if(d.enteredMacroMode&&"q"==b)ma.exitMacroRecordMode(),f.inputState=new v;else if("<Esc>"==b)f.inputState=new v,f.visualMode&&L(a);else{!f.visualMode&&!F(a.getCursor("head"),a.getCursor("anchor"))&&(f.visualMode=!0,f.visualLine=!1,CodeMirror.signal(a,"vim-mode-change",{mode:"visual"}),a.on("mousedown",L));if("0"!=b||"0"==b&&0===
f.inputState.getRepeat())c=Z.matchCommand(b,O,f);if(c)if("keyToKey"==c.type)for(f=0;f<c.toKeys.length;f++)this.handleKey(a,c.toKeys[f]);else d.enteredMacroMode&&(d.isMacroPlaying||d.macroKeyBuffer.push(b)),Z.processCommand(a,f,c);else Ea.test(b)&&f.inputState.pushRepeatDigit(b)}},handleEx:function(a,b){$.processCommand(a,b)}};v.prototype.pushRepeatDigit=function(a){this.operator?this.motionRepeat=this.motionRepeat.concat(a):this.prefixRepeat=this.prefixRepeat.concat(a)};v.prototype.getRepeat=function(){var a=
0;if(0<this.prefixRepeat.length||0<this.motionRepeat.length)a=1,0<this.prefixRepeat.length&&(a*=parseInt(this.prefixRepeat.join(""),10)),0<this.motionRepeat.length&&(a*=parseInt(this.motionRepeat.join(""),10));return a};B.prototype={set:function(a,b){this.text=a;this.linewise=!!b},append:function(a,b){b||this.linewise?(this.text+="\n"+a,this.linewise=!0):this.text+=a},clear:function(){this.text="";this.linewise=!1},toString:function(){return this.text}};G.prototype={pushText:function(a,b,c,f){f&&
"\n"==c.charAt(0)&&(c=c.slice(1)+"\n");f&&"\n"!==c.charAt(c.length-1)&&(c+="\n");var d=this.isValidRegister(a)?this.getRegister(a):null;if(d)u(a)?(d.append(c,f),this.unamedRegister.append(c,f)):(d.set(c,f),this.unamedRegister.set(c,f));else{switch(b){case "yank":this.registers["0"]=new B(c,f);break;case "delete":case "change":-1==c.indexOf("\n")?this.registers["-"]=new B(c,f):(this.shiftNumericRegisters_(),this.registers["1"]=new B(c,f))}this.unamedRegister.set(c,f)}},setRegisterText:function(a,b,
c){this.getRegister(a).set(b,c)},getRegister:function(a){if(!this.isValidRegister(a))return this.unamedRegister;a=a.toLowerCase();this.registers[a]||(this.registers[a]=new B);return this.registers[a]},isValidRegister:function(a){return a&&C(a,Ha)},shiftNumericRegisters_:function(){for(var a=9;2<=a;a--)this.registers[a]=this.getRegister(""+(a-1))}};var Z={matchCommand:function(a,b,c){function f(b){if(e.length<b.keys.length)return d.keyBuffer.push(a),null;"character"==b.keys[e.length-1]&&(d.selectedCharacter=
o);d.keyBuffer=[];return b}for(var d=c.inputState,e=d.keyBuffer.concat(a),h=[],o,i=0;i<b.length;i++){var g=b[i];if(n(e,g.keys)&&!(d.operator&&"action"==g.type)){if("character"==g.keys[e.length-1]&&(o=e[e.length-1],1<o.length))switch(o){case "<CR>":o="\n";break;case "<Space>":o=" ";break;default:continue}h.push(g)}}if(h.length){if(1==h.length)return f(h[0]);b=c.visualMode?"visual":"normal";c=h[0];for(i=0;i<h.length;i++)if(h[i].context==b){c=h[i];break}return f(c)}d.keyBuffer=[];return null},processCommand:function(a,
b,c){b.inputState.repeatOverride=c.repeatOverride;switch(c.type){case "motion":this.processMotion(a,b,c);break;case "operator":this.processOperator(a,b,c);break;case "operatorMotion":this.processOperatorMotion(a,b,c);break;case "action":this.processAction(a,b,c);break;case "search":this.processSearch(a,b,c);break;case "ex":case "keyToEx":this.processEx(a,b,c)}},processMotion:function(a,b,c){b.inputState.motion=c.motion;b.inputState.motionArgs=w(c.motionArgs);this.evalInput(a,b)},processOperator:function(a,
b,c){var f=b.inputState;if(f.operator){if(f.operator==c.operator){f.motion="expandToLine";f.motionArgs={linewise:!0};this.evalInput(a,b);return}b.inputState=new v}f.operator=c.operator;f.operatorArgs=w(c.operatorArgs);b.visualMode&&this.evalInput(a,b)},processOperatorMotion:function(a,b,c){var f=b.visualMode,d=w(c.operatorMotionArgs);d&&(f&&d.visualLine)&&(b.visualLine=!0);this.processOperator(a,b,c);f||this.processMotion(a,b,c)},processAction:function(a,b,c){var f=b.inputState,d=f.getRepeat(),e=
!!d,h=w(c.actionArgs)||{};f.selectedCharacter&&(h.selectedCharacter=f.selectedCharacter);c.operator&&this.processOperator(a,b,c);c.motion&&this.processMotion(a,b,c);(c.motion||c.operator)&&this.evalInput(a,b);h.repeat=d||1;h.repeatIsExplicit=e;h.registerName=f.registerName;b.inputState=new v;b.lastMotion=null;c.isEdit&&this.recordLastEdit(b,f,c);ma[c.action](a,h,b)},processSearch:function(a,b,c){function f(f,d,m){try{j(a,f,d,m)}catch(h){i(a,"Invalid regex: "+f);return}Z.processMotion(a,b,{type:"motion",
motion:"findNext",motionArgs:{forward:!0,toJumplist:c.searchArgs.toJumplist}})}function m(b){a.scrollTo(k.left,k.top);f(b,!0,!0)}function e(b,c){var f;try{f=j(a,c,!0,!0)}catch(d){}f?a.scrollIntoView(oa(a,!o,f),30):(ia(a),a.scrollTo(k.left,k.top))}function h(b,c,f){c=CodeMirror.keyName(b);if("Esc"==c||"Ctrl-C"==c||"Ctrl-["==c)j(a,Y),ia(a),a.scrollTo(k.left,k.top),CodeMirror.e_stop(b),f(),a.focus()}if(a.getSearchCursor){var o=c.searchArgs.forward;d(a).setReversed(!o);var N=o?"/":"?",Y=d(a).getQuery(),
k=a.getScrollInfo();switch(c.searchArgs.querySrc){case "prompt":g(a,{onClose:m,prefix:N,desc:Ia,onKeyUp:e,onKeyDown:h});break;case "wordUnderCursor":var N=R(a,!1,!0,!1,!0),n=!0;N||(N=R(a,!1,!0,!1,!1),n=!1);if(!N)break;var l=a.getLine(N.start.line).substring(N.start.ch,N.end.ch),l=n?"\\b"+l+"\\b":l.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1");p.jumpList.cachedCursor=a.getCursor();a.setCursor(N.start);f(l,!0,!1)}}},processEx:function(a,b,c){function f(b){$.processCommand(a,b)}function d(b,c,f){c=CodeMirror.keyName(b);
if("Esc"==c||"Ctrl-C"==c||"Ctrl-["==c)CodeMirror.e_stop(b),f(),a.focus()}"keyToEx"==c.type?$.processCommand(a,c.exArgs.input):b.visualMode?g(a,{onClose:f,prefix:":",value:"'<,'>",onKeyDown:d}):g(a,{onClose:f,prefix:":",onKeyDown:d})},evalInput:function(a,b){var c=b.inputState,f=c.motion,d=c.motionArgs||{},e=c.operator,h=c.operatorArgs||{},i=c.registerName,g=a.getCursor("head"),j=a.getCursor("anchor"),k={line:g.line,ch:g.ch},n={line:k.line,ch:k.ch},l,A;e&&this.recordLastEdit(b,c);A=void 0!==c.repeatOverride?
c.repeatOverride:c.getRepeat();if(0<A&&d.explicitRepeat)d.repeatIsExplicit=!0;else if(d.noRepeat||!d.explicitRepeat&&0===A)A=1,d.repeatIsExplicit=!1;c.selectedCharacter&&(d.selectedCharacter=h.selectedCharacter=c.selectedCharacter);d.repeat=A;b.inputState=new v;if(f){l=aa[f](a,d,b);b.lastMotion=aa[f];if(!l)return;d.toJumplist&&(f=p.jumpList,(c=f.cachedCursor)?(F(c,l)||p.jumpList.add(a,c,l),delete f.cachedCursor):F(n,l)||p.jumpList.add(a,n,l));l instanceof Array&&(k=l[0],l=l[1]);l||(l={ch:k.ch,line:k.line});
if(b.visualMode){if(r(j,g)&&(F(j,l)||r(l,j)))j.ch+=1;else if(r(g,j)&&(F(j,l)||r(j,l)))j.ch-=1;g=l;b.visualLine&&(r(j,g)?(j.ch=0,f=a.lastLine(),g.line>f&&(g.line=f),g.ch=x(a,g.line)):(g.ch=0,j.ch=x(a,j.line)));a.setSelection(j,g);q(a,b,"<",r(j,g)?j:g);q(a,b,">",r(j,g)?g:j)}else e||(l=D(a,l),a.setCursor(l.line,l.ch))}if(e){f=!1;b.lastMotion=null;h.repeat=A;b.visualMode&&(k=j,l=g,d.inclusive=!0);r(l,k)&&(g=k,k=l,l=g,f=!0);d.inclusive&&(!b.visualMode||!f)&&l.ch++;if(g=d.linewise||b.visualMode&&b.visualLine)d=
l,k.ch=0,d.ch=0,d.line++;else if(d.forward&&(d=l,j=a.getRange(k,d),/\n\s*$/.test(j))){j=j.split("\n");j.pop();for(A=j.pop();0<j.length&&A&&/^\s*$/.test(A);A=j.pop())d.line--,d.ch=0;A?(d.line--,d.ch=x(a,d.line)):d.ch=0}h.registerName=i;h.linewise=g;Ja[e](a,h,b,k,l,n);b.visualMode&&L(a)}},recordLastEdit:function(a,b,c){var f=p.macroModeState;f.inReplay||(a.lastEditInputState=b,a.lastEditActionCommand=c,f.lastInsertModeChanges.changes=[],f.lastInsertModeChanges.expectCursorActivityForChange=!1)}},aa=
{moveToTopLine:function(a,b){var c=ja(a).top+b.repeat-1;return{line:c,ch:M(a.getLine(c))}},moveToMiddleLine:function(a){var b=ja(a),b=Math.floor(0.5*(b.top+b.bottom));return{line:b,ch:M(a.getLine(b))}},moveToBottomLine:function(a,b){var c=ja(a).bottom-b.repeat+1;return{line:c,ch:M(a.getLine(c))}},expandToLine:function(a,b){return{line:a.getCursor().line+b.repeat-1,ch:Infinity}},findNext:function(a,b){var c=d(a),f=c.getQuery();if(f){var m=!b.forward,m=c.isReversed()?!m:m;na(a,f);return oa(a,m,f,b.repeat)}},
goToMark:function(a,b,c){return(a=c.marks[b.selectedCharacter])?a.find():null},jumpToMark:function(a,b,c){for(var f=a.getCursor(),d=0;d<b.repeat;d++){var e=f,h;for(h in c.marks)if(/^[a-z]$/.test(h)){var g=c.marks[h].find();if(!(b.forward?r(g,e):r(e,g))&&!(b.linewise&&g.line==e.line)){var i=F(e,f),j=b.forward?U(e,g,f):U(f,g,e);if(i||j)f=g}}}b.linewise&&(f.ch=M(a.getLine(f.line)));return f},moveByCharacters:function(a,b){var c=a.getCursor(),f=b.repeat;return{line:c.line,ch:b.forward?c.ch+f:c.ch-f}},
moveByLines:function(a,b,c){var f=a.getCursor(),d=f.ch;switch(c.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:d=c.lastHPos;break;default:c.lastHPos=d}var e=b.repeat+(b.repeatOffset||0),e=b.forward?f.line+e:f.line-e,h=a.firstLine(),g=a.lastLine();if(!(e<h&&f.line==h||e>g&&f.line==g))return b.toFirstChar&&(d=M(a.getLine(e)),c.lastHPos=d),c.lastHSPos=a.charCoords({line:e,ch:d},"div").left,{line:e,ch:d}},moveByDisplayLines:function(a,
b,c){var f=a.getCursor();switch(c.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:c.lastHSPos=a.charCoords(f,"div").left}var d=b.repeat,f=a.findPosV(f,b.forward?d:-d,"line",c.lastHSPos);f.hitSide&&(b.forward?b={top:a.charCoords(f,"div").top+8,left:c.lastHSPos}:(b=a.charCoords({line:a.firstLine(),ch:0},"div"),b.left=c.lastHSPos),f=a.coordsChar(b,"div"));c.lastHPos=f.ch;return f},moveByPage:function(a,b){var c=
a.getCursor(),f=b.repeat;a.moveV(b.forward?f:-f,"page");f=a.getCursor();a.setCursor(c);return f},moveByParagraph:function(a,b){for(var c=a.getCursor().line,f=b.repeat,d=b.forward?1:-1,e=0;e<f&&!(!b.forward&&c===a.firstLine()||b.forward&&c==a.lastLine());e++)for(c+=d;c!==a.firstLine()&&c!=a.lastLine()&&a.getLine(c);)c+=d;return{line:c,ch:0}},moveByScroll:function(a,b,c){var f=a.getScrollInfo(),d=null;(d=b.repeat)||(d=f.clientHeight/(2*a.defaultTextHeight()));var e=a.charCoords(a.getCursor(),"local");
b.repeat=d;d=aa.moveByDisplayLines(a,b,c);if(!d)return null;b=a.charCoords(d,"local");a.scrollTo(null,f.top+b.top-e.top);return d},moveByWords:function(a,b){var c;var f=b.repeat;c=!!b.forward;var d=!!b.wordEnd,e=!!b.bigWord,h=a.getCursor(),g=h.line,i=h.ch,j=[];(c&&!d||!c&&d)&&f++;for(var k=!(c&&d),n=0;n<f;n++){var l;b:{l=a;var p=c,s=e,u=k,E=h.line,I=h.ch,P=l.getLine(E),r=p?1:-1,s=s?Ga:Fa;if(u&&""==P){E+=r;P=l.getLine(E);if(!(E>=l.firstLine()&&E<=l.lastLine())){l=null;break b}I=p?0:P.length}for(;;){if(u&&
""==P){l={from:0,to:0,line:E};break b}for(var q=p=0<r?P.length:-1,t=p;I!=p;){for(var w=!1,v=0;v<s.length&&!w;++v)if(s[v].test(P.charAt(I))){for(q=I;I!=p&&s[v].test(P.charAt(I));)I+=r;t=I;w=q!=t;if(!(q==h.ch&&E==h.line&&t==q+r)){l={from:Math.min(q,t+1),to:Math.max(q,t),line:E};break b}}w||(I+=r)}E+=r;if(!(E>=l.firstLine()&&E<=l.lastLine())){l=null;break b}P=l.getLine(E);I=0<r?0:P.length}throw Error("The impossible happened.");}if(!l){e=x(a,a.lastLine());j.push(c?{line:a.lastLine(),from:e,to:e}:{line:0,
from:0,to:0});break}j.push(l);h={line:l.line,ch:c?l.to-1:l.from}}f=j.length!=f;e=j[0];k=j.pop();if(c&&!d){if(!f&&(e.from!=i||e.line!=g))k=j.pop();c={line:k.line,ch:k.from}}else if(c&&d)c={line:k.line,ch:k.to-1};else if(!c&&d){if(!f&&(e.to!=i||e.line!=g))k=j.pop();c={line:k.line,ch:k.to}}else c={line:k.line,ch:k.from};return c},moveTillCharacter:function(a,b){var c=y(a,b.repeat,b.forward,b.selectedCharacter),f=b.forward?-1:1;ba(f,b);if(!c)return a.getCursor();c.ch+=f;return c},moveToCharacter:function(a,
b){var c=b.repeat;ba(0,b);return y(a,c,b.forward,b.selectedCharacter)||a.getCursor()},moveToSymbol:function(a,b){var c;c=b.repeat;var f=b.forward,d=b.selectedCharacter,e=a.getCursor(),h=f?1:-1,g=f?a.lineCount():-1,i=e.ch,j=e.line,k=a.getLine(j),f={lineText:k,nextCh:k.charAt(i),lastCh:null,index:i,symb:d,reverseSymb:(f?{")":"(","}":"{"}:{"(":")","{":"}"})[d],forward:f,depth:0,curMoveThrough:!1};if(i=Ka[d]){d=va[i].init;i=va[i].isComplete;for(d&&d(f);j!==g&&c;)if(f.index+=h,f.nextCh=f.lineText.charAt(f.index),
f.nextCh||(j+=h,f.lineText=a.getLine(j)||"",0<h?f.index=0:(d=f.lineText.length,f.index=0<d?d-1:0),f.nextCh=f.lineText.charAt(f.index)),i(f))e.line=j,e.ch=f.index,c--;c=f.nextCh||f.curMoveThrough?{line:j,ch:f.index}:e}else c=e;return c||a.getCursor()},moveToColumn:function(a,b,c){b=b.repeat;c.lastHPos=b-1;c.lastHSPos=a.charCoords(a.getCursor(),"div").left;c=a.getCursor().line;return D(a,{line:c,ch:b-1})},moveToEol:function(a,b,c){var f=a.getCursor();c.lastHPos=Infinity;b={line:f.line+b.repeat-1,ch:Infinity};
f=a.clipPos(b);f.ch--;c.lastHSPos=a.charCoords(f,"div").left;return b},moveToFirstNonWhiteSpaceCharacter:function(a){var b=a.getCursor();return{line:b.line,ch:M(a.getLine(b.line))}},moveToMatchedSymbol:function(a){var b=a.getCursor(),c=b.line,f=b.ch,d=a.getLine(c),e;e=a.getTokenAt(b).type;var h=K(e);do if((e=d.charAt(f++))&&-1!="()[]{}".indexOf(e)){var g=a.getTokenAt({line:c,ch:f}).type,g=K(g);if(h>=g)break}while(e);return e?V(a,{line:c,ch:f-1},e):b},moveToStartOfLine:function(a){return{line:a.getCursor().line,
ch:0}},moveToLineOrEdgeOfDocument:function(a,b){var c=b.forward?a.lastLine():a.firstLine();b.repeatIsExplicit&&(c=b.repeat-a.getOption("firstLineNumber"));return{line:c,ch:M(a.getLine(c))}},textObjectManipulation:function(a,b){var c=b.selectedCharacter;if(!wa[c])return null;c=wa[c](a,!b.textObjectInner);return[c.start,c.end]},repeatLastCharacterSearch:function(a,b){var c=p.lastChararacterSearch,f=b.repeat,d=b.forward===c.forward,e=(c.increment?1:0)*(d?-1:1);a.moveH(-e,"char");b.inclusive=d?!0:!1;
c=y(a,f,d,c.selectedCharacter);if(!c)return a.moveH(e,"char"),a.getCursor();c.ch+=e;return c}},Ja={change:function(a,b,c,f,d){p.registerController.pushText(b.registerName,"change",a.getRange(f,d),b.linewise);b.linewise?(b=d.line>a.lastLine()?"":"\n",a.replaceRange(b,f,d),a.indentLine(f.line,"smart"),f.ch=null):(b=a.getRange(f,d),/^\s*$/.test(b)||(b=/\s+$/.exec(b))&&(d=S(d,0,-b[0].length)),a.replaceRange("",f,d));ma.enterInsertMode(a,{},a.state.vim);a.setCursor(f)},"delete":function(a,b,c,f,d){b.linewise&&
(d.line>a.lastLine()&&f.line>a.firstLine())&&(f.line--,f.ch=x(a,f.line));p.registerController.pushText(b.registerName,"delete",a.getRange(f,d),b.linewise);a.replaceRange("",f,d);b.linewise?a.setCursor(aa.moveToFirstNonWhiteSpaceCharacter(a)):a.setCursor(f)},indent:function(a,b,c,d,e){var g=d.line,e=e.line,c=c.visualMode?b.repeat:1;for(b.linewise&&e--;g<=e;g++)for(var h=0;h<c;h++)a.indentLine(g,b.indentRight);a.setCursor(d);a.setCursor(aa.moveToFirstNonWhiteSpaceCharacter(a))},swapcase:function(a,
b,c,d,e,g){for(var c=a.getRange(d,e),h="",i=0;i<c.length;i++)var j=c.charAt(i),h=h+(u(j)?j.toLowerCase():j.toUpperCase());a.replaceRange(h,d,e);b.shouldMoveCursor||a.setCursor(g)},yank:function(a,b,c,d,e,g){p.registerController.pushText(b.registerName,"yank",a.getRange(d,e),b.linewise);a.setCursor(g)}},ma={jumpListWalk:function(a,b,c){c.visualMode||(c=b.repeat,b=(b=(b=p.jumpList.move(a,b.forward?c:-c))?b.find():void 0)?b:a.getCursor(),a.setCursor(b))},scrollToCursor:function(a,b){var c=a.getCursor().line,
d=a.charCoords({line:c,ch:0},"local"),c=a.getScrollInfo().clientHeight,e=d.top,d=d.bottom-e;switch(b.position){case "center":e=e-c/2+d;break;case "bottom":e=e-c+1.4*d;break;case "top":e+=0.4*d}a.scrollTo(null,e)},replayMacro:function(a,b){var c=b.selectedCharacter,d=b.repeat,e=p.macroModeState;"@"==c&&(c=e.latestRegister);var g,h,i=p.registerController.getRegister(c).toString(),c=e.macroKeyBuffer;e.isMacroPlaying||(e.macroKeyBuffer.length=0);do{g=/<\w+-.+?>|<\w+>|./.exec(i);if(null===g)break;h=g[0];
i=i.substring(g.index+h.length);c.push(h)}while(i);for(;d--;){g=a;h=e;i=c;h.isMacroPlaying=!0;for(var j=0,k=i.length;j<k;j++)CodeMirror.Vim.handleKey(g,i[j]);h.isMacroPlaying=!1}},exitMacroRecordMode:function(){var a=p.macroModeState;a.toggle();var b=a.latestRegister,a=a.macroKeyBuffer.join("");p.registerController.setRegisterText(b,a)},enterMacroRecordMode:function(a,b){var c=p.macroModeState;c.toggle(a,b.selectedCharacter);c.isMacroPlaying||(c.macroKeyBuffer.length=0)},enterInsertMode:function(a,
b,c){if(!a.getOption("readOnly")&&(c.insertMode=!0,c.insertModeRepeat=b&&b.repeat||1,c=b?b.insertAt:null,"eol"==c?(c=a.getCursor(),c={line:c.line,ch:x(a,c.line)},a.setCursor(c)):"charAfter"==c?a.setCursor(S(a.getCursor(),0,1)):"firstNonBlank"==c&&a.setCursor(aa.moveToFirstNonWhiteSpaceCharacter(a)),a.setOption("keyMap","vim-insert"),b&&b.replace?(a.toggleOverwrite(!0),a.setOption("keyMap","vim-replace"),CodeMirror.signal(a,"vim-mode-change",{mode:"replace"})):(a.setOption("keyMap","vim-insert"),CodeMirror.signal(a,
"vim-mode-change",{mode:"insert"})),!p.macroModeState.inReplay))a.on("change",pa),a.on("cursorActivity",qa),CodeMirror.on(a.getInputField(),"keydown",ra)},toggleVisualMode:function(a,b,c){var d=b.repeat,e=a.getCursor();c.visualMode?(e=a.getCursor("anchor"),d=a.getCursor("head"),!c.visualLine&&b.linewise?(c.visualLine=!0,e.ch=r(e,d)?0:x(a,e.line),d.ch=r(e,d)?x(a,d.line):0,a.setSelection(e,d),CodeMirror.signal(a,"vim-mode-change",{mode:"visual",subMode:"linewise"})):c.visualLine&&!b.linewise?(c.visualLine=
!1,CodeMirror.signal(a,"vim-mode-change",{mode:"visual"})):L(a)):(a.on("mousedown",L),c.visualMode=!0,c.visualLine=!!b.linewise,c.visualLine?(e.ch=0,d=D(a,{line:e.line+d-1,ch:x(a,e.line)},!0)):d=D(a,{line:e.line,ch:e.ch+d},!0),!b.repeatIsExplicit&&!c.visualLine?(a.setCursor(d),a.setSelection(d,e)):a.setSelection(e,d),CodeMirror.signal(a,"vim-mode-change",{mode:"visual",subMode:c.visualLine?"linewise":""}));q(a,c,"<",r(e,d)?e:d);q(a,c,">",r(e,d)?d:e)},joinLines:function(a,b,c){var d,e;c.visualMode?
(d=a.getCursor("anchor"),e=a.getCursor("head"),e.ch=x(a,e.line)-1):(b=Math.max(b.repeat,2),d=a.getCursor(),e=D(a,{line:d.line+b-1,ch:Infinity}));var g=0;a.operation(function(){for(var b=d.line;b<e.line;b++){g=x(a,d.line);var c={line:d.line+1,ch:x(a,d.line+1)},i=a.getRange(d,c),i=i.replace(/\n\s*/g," ");a.replaceRange(i,d,c)}a.setCursor({line:d.line,ch:g})})},newLineAndEnterInsertMode:function(a,b,c){c.insertMode=!0;var d=a.getCursor();d.line===a.firstLine()&&!b.after?(a.replaceRange("\n",{line:a.firstLine(),
ch:0}),a.setCursor(a.firstLine(),0)):(d.line=b.after?d.line:d.line-1,d.ch=x(a,d.line),a.setCursor(d),(CodeMirror.commands.newlineAndIndentContinueComment||CodeMirror.commands.newlineAndIndent)(a));this.enterInsertMode(a,{repeat:b.repeat},c)},paste:function(a,b){var c=a.getCursor(),d=p.registerController.getRegister(b.registerName);if(d.text){for(var e="",g=0;g<b.repeat;g++)e+=d.text;(d=d.linewise)?b.after?(e="\n"+e.slice(0,e.length-1),c.ch=x(a,c.line)):c.ch=0:c.ch+=b.after?1:0;a.replaceRange(e,c);
d&&b.after?e={line:c.line+1,ch:M(a.getLine(c.line+1))}:d&&!b.after?e={line:c.line,ch:M(a.getLine(c.line))}:!d&&b.after?(c=a.indexFromPos(c),e=a.posFromIndex(c+e.length-1)):(c=a.indexFromPos(c),e=a.posFromIndex(c+e.length));a.setCursor(e)}},undo:function(a,b){a.operation(function(){H(a,CodeMirror.commands.undo,b.repeat)();a.setCursor(a.getCursor("anchor"))})},redo:function(a,b){H(a,CodeMirror.commands.redo,b.repeat)()},setRegister:function(a,b,c){c.inputState.registerName=b.selectedCharacter},setMark:function(a,
b,c){q(a,c,b.selectedCharacter,a.getCursor())},replace:function(a,b,c){var d=b.selectedCharacter,e=a.getCursor(),g;c.visualMode?(e=a.getCursor("start"),g=a.getCursor("end"),g=a.clipPos({line:g.line,ch:g.ch+1})):(g=a.getLine(e.line),b=e.ch+b.repeat,b>g.length&&(b=g.length),g={line:e.line,ch:b});"\n"==d?(c.visualMode||a.replaceRange("",e,g),(CodeMirror.commands.newlineAndIndentContinueComment||CodeMirror.commands.newlineAndIndent)(a)):(b=a.getRange(e,g),b=b.replace(/[^\n]/g,d),a.replaceRange(b,e,g),
c.visualMode?(a.setCursor(e),L(a)):a.setCursor(S(g,0,-1)))},incrementNumberToken:function(a,b){for(var c=a.getCursor(),d=a.getLine(c.line),e=/-?\d+/g,g,h,i,j;null!==(g=e.exec(d))&&!(j=g[0],h=g.index,i=h+j.length,c.ch<i););if((b.backtrack||!(i<=c.ch))&&j)d=b.increase?1:-1,d=parseInt(j)+d*b.repeat,j={ch:h,line:c.line},i={ch:i,line:c.line},d=d.toString(),a.replaceRange(d,j,i),a.setCursor({line:c.line,ch:h+d.length-1})},repeatLastEdit:function(a,b,c){if(c.lastEditInputState){var d=b.repeat;d&&b.repeatIsExplicit?
c.lastEditInputState.repeatOverride=d:d=c.lastEditInputState.repeatOverride||d;sa(a,c,d,!1)}}},wa={w:function(a,b){return R(a,b,!0,!1)},W:function(a,b){return R(a,b,!0,!0)},"{":function(a,b){return ca(a,"}",b)},"(":function(a,b){return ca(a,")",b)},"[":function(a,b){return ca(a,"]",b)},"'":function(a,b){return W(a,"'",b)},'"':function(a,b){return W(a,'"',b)}},Ka={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},
va={bracket:{isComplete:function(a){if(a.nextCh===a.symb){if(a.depth++,1<=a.depth)return!0}else a.nextCh===a.reverseSymb&&a.depth--;return!1}},section:{init:function(a){a.curMoveThrough=!0;a.symb=(a.forward?"]":"[")===a.symb?"{":"}"},isComplete:function(a){return 0===a.index&&a.nextCh===a.symb}},comment:{isComplete:function(a){var b="*"===a.lastCh&&"/"===a.nextCh;a.lastCh=a.nextCh;return b}},method:{init:function(a){a.symb="m"===a.symb?"{":"}";a.reverseSymb="{"===a.symb?"}":"{"},isComplete:function(a){return a.nextCh===
a.symb?!0:!1}},preprocess:{init:function(a){a.index=0},isComplete:function(a){if("#"===a.nextCh){var b=a.lineText.match(/#(\w+)/)[1];if("endif"===b){if(a.forward&&0===a.depth)return!0;a.depth++}else if("if"===b){if(!a.forward&&0===a.depth)return!0;a.depth--}if("else"===b&&0===a.depth)return!0}return!1}}};X.prototype={getQuery:function(){return p.query},setQuery:function(a){p.query=a},getOverlay:function(){return this.searchOverlay},setOverlay:function(a){this.searchOverlay=a},isReversed:function(){return p.isReversed},
setReversed:function(a){p.isReversed=a}};var Ia="(Javascript regexp)",xa=[{name:"map",type:"builtIn"},{name:"write",shortName:"w",type:"builtIn"},{name:"undo",shortName:"u",type:"builtIn"},{name:"redo",shortName:"red",type:"builtIn"},{name:"sort",shortName:"sor",type:"builtIn"},{name:"substitute",shortName:"s",type:"builtIn"},{name:"nohlsearch",shortName:"noh",type:"builtIn"},{name:"delmarks",shortName:"delm",type:"builtin"}];z.ExCommandDispatcher=function(){this.buildCommandMap_()};z.ExCommandDispatcher.prototype=
{processCommand:function(a,b){a.state.vim.visualMode&&L(a);var c=new CodeMirror.StringStream(b),d={};d.input=b;try{this.parseInput_(a,c,d)}catch(e){i(a,e);return}var g;if(d.commandName){var h=this.matchCommand_(d.commandName);if(h){g=h.name;this.parseCommandArgs_(c,d,h);if("exToKey"==h.type){for(c=0;c<h.toKeys.length;c++)CodeMirror.Vim.handleKey(a,h.toKeys[c]);return}if("exToEx"==h.type){this.processCommand(a,h.toInput);return}}}else void 0!==d.line&&(g="move");if(g)try{ua[g](a,d)}catch(j){throw i(a,
j),j;}else i(a,'Not an editor command ":'+b+'"')},parseInput_:function(a,b,c){b.eatWhile(":");b.eat("%")?(c.line=a.firstLine(),c.lineEnd=a.lastLine()):(c.line=this.parseLineSpec_(a,b),void 0!==c.line&&b.eat(",")&&(c.lineEnd=this.parseLineSpec_(a,b)));a=b.match(/^(\w+)/);c.commandName=a?a[1]:b.match(/.*/)[0];return c},parseLineSpec_:function(a,b){var c=b.match(/^(\d+)/);if(c)return parseInt(c[1],10)-1;switch(b.next()){case ".":return a.getCursor().line;case "$":return a.lastLine();case "'":if((c=a.state.vim.marks[b.next()])&&
c.find())return c.find().line;throw Error("Mark not set");default:b.backUp(1)}},parseCommandArgs_:function(a,b,c){a.eol()||(b.argString=a.match(/.*/)[0],a=c.argDelimiter||/\s+/,a=Q(b.argString).split(a),a.length&&a[0]&&(b.args=a))},matchCommand_:function(a){for(var b=a.length;0<b;b--){var c=a.substring(0,b);if(this.commandMap_[c]&&(c=this.commandMap_[c],0===c.name.indexOf(a)))return c}return null},buildCommandMap_:function(){this.commandMap_={};for(var a=0;a<xa.length;a++){var b=xa[a];this.commandMap_[b.shortName||
b.name]=b}},map:function(a,b){if(":"!=a&&":"==a.charAt(0)){var c=a.substring(1);this.commandMap_[c]=":"!=b&&":"==b.charAt(0)?{name:c,type:"exToEx",toInput:b.substring(1)}:{name:c,type:"exToKey",toKeys:ea(b)}}else":"!=b&&":"==b.charAt(0)?O.unshift({keys:ea(a),type:"keyToEx",exArgs:{input:b.substring(1)}}):O.unshift({keys:ea(a),type:"keyToKey",toKeys:ea(b)})}};var ua={map:function(a,b){var c=b.args;!c||2>c.length?a&&i(a,"Invalid mapping: "+b.input):$.map(c[0],c[1],a)},move:function(a,b){Z.processCommand(a,
a.state.vim,{type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:b.line+1})},sort:function(a,b){function c(a,b){if(d){var c;c=a;a=b;b=c}e&&(a=a.toLowerCase(),b=b.toLowerCase());c=h&&p.exec(a);var g=h&&p.exec(b);if(!c)return a<b?-1:1;c=parseInt((c[1]+c[2]).toLowerCase(),s);g=parseInt((g[1]+g[2]).toLowerCase(),s);return c-g}var d,e,g,h,j=function(){if(b.argString){var a=new CodeMirror.StringStream(b.argString);a.eat("!")&&(d=!0);if(!a.eol()){if(!a.eatSpace())return"Invalid arguments";
var c=a.match(/[a-z]+/);if(c){c=c[0];e=-1!=c.indexOf("i");g=-1!=c.indexOf("u");var i=-1!=c.indexOf("d")&&1,j=-1!=c.indexOf("x")&&1,c=-1!=c.indexOf("o")&&1;if(1<i+j+c)return"Invalid arguments";h=i&&"decimal"||j&&"hex"||c&&"octal"}a.eatSpace()&&a.match(/\/.*\//)&&"patterns not supported"}}}();if(j)i(a,j+": "+b.argString);else{var j=b.line||a.firstLine(),k=b.lineEnd||b.line||a.lastLine();if(j!=k){var j={line:j,ch:0},k={line:k,ch:x(a,k)},n=a.getRange(j,k).split("\n"),p="decimal"==h?/(-?)([\d]+)/:"hex"==
h?/(-?)(?:0x)?([0-9a-f]+)/i:"octal"==h?/([0-7]+)/:null,s="decimal"==h?10:"hex"==h?16:"octal"==h?8:null,l=[],r=[];if(h)for(var q=0;q<n.length;q++)p.exec(n[q])?l.push(n[q]):r.push(n[q]);else r=n;l.sort(c);r.sort(c);n=!d?r.concat(l):l.concat(r);if(g)for(var l=n,t,n=[],q=0;q<l.length;q++)l[q]!=t&&n.push(l[q]),t=l[q];a.replaceRange(n.join("\n"),j,k)}}},substitute:function(a,b){if(!a.getSearchCursor)throw Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");
var c=b.argString,f=e(c);if(0!==f[0])i(a,"Substitutions should be of the form :s/pattern/replace/");else{var g=c.substring(f[0]+1,f[1]),k="",h,o,n=!1;f[1]&&(k=c.substring(f[1]+1,f[2]));f[2]&&(o=c.substring(f[2]+1).split(" "),h=o[0],o=parseInt(o[1]));h&&(-1!=h.indexOf("c")&&(n=!0,h.replace("c","")),g=g+"/"+h);if(g)try{j(a,g,!0,!0)}catch(p){i(a,"Invalid regex: "+g);return}g=d(a).getQuery();h=void 0!==b.line?b.line:a.getCursor().line;c=b.lineEnd||h;o&&(h=c,c=h+o-1);o=D(a,{line:h,ch:0});o=a.getSearchCursor(g,
o);Ca(a,n,h,c,o,g,k)}},redo:CodeMirror.commands.redo,undo:CodeMirror.commands.undo,write:function(a){CodeMirror.commands.save?CodeMirror.commands.save(a):a.save()},nohlsearch:function(a){ia(a)},delmarks:function(a,b){if(!b.argString||!Q(b.argString))i(a,"Argument required");else for(var c=a.state.vim,d=new CodeMirror.StringStream(Q(b.argString));!d.eol();){d.eatSpace();var e=d.pos;if(!d.match(/[a-zA-Z]/,!1)){i(a,"Invalid argument: "+b.argString.substring(e));break}var g=d.next();if(d.match("-",!0)){if(!d.match(/[a-zA-Z]/,
!1)){i(a,"Invalid argument: "+b.argString.substring(e));break}var h=d.next();if(/^[a-z]$/.test(g)&&/^[a-z]$/.test(h)||u(g)&&u(h)){g=g.charCodeAt(0);h=h.charCodeAt(0);if(g>=h){i(a,"Invalid argument: "+b.argString.substring(e));break}for(e=0;e<=h-g;e++){var j=String.fromCharCode(g+e);delete c.marks[j]}}else{i(a,"Invalid argument: "+g+"-");break}}else delete c.marks[g]}}},$=new z.ExCommandDispatcher;CodeMirror.keyMap.vim=function(){function a(a){return function(b){CodeMirror.Vim.handleKey(b,a)}}function b(b,
d){for(var e=0;e<b.length;e++){var g=b[e];!d&&C(g,la)&&(g="'"+g+"'");var i=d,j=b[e];u(j)&&("Shift"==i?i=null:j=j.toLowerCase());i&&(j=i.charAt(0)+"-"+j);j=(i={Enter:"CR",Backspace:"BS",Delete:"Del"}[j])?i:j;j=1<j.length?"<"+j+">":j;c[d?d+"-"+g:g]=a(j)}}var c={nofallthrough:!0,disableInput:!0,style:"fat-cursor"};b(da);b(da,"Shift");b(da,"Ctrl");b(la);b(la,"Ctrl");b(ha);b(ha,"Ctrl");b(ta);b(ta,"Ctrl");return c}();CodeMirror.keyMap["vim-insert"]={Esc:fa,"Ctrl-[":fa,"Ctrl-C":fa,"Ctrl-N":"autocomplete",
"Ctrl-P":"autocomplete",Enter:function(a){(CodeMirror.commands.newlineAndIndentContinueComment||CodeMirror.commands.newlineAndIndent)(a)},fallthrough:["default"]};CodeMirror.keyMap["vim-replace"]={Backspace:"goCharLeft",fallthrough:["vim-insert"]};t();return ga};CodeMirror.Vim=z()})();
