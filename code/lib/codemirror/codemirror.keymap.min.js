(function(){function M(c){v.push(c);50<v.length&&v.shift()}function y(c){return v[v.length-(c?Math.min(c,1):1)]||""}function m(){1<v.length&&v.pop();return y()}function K(c,f,g,i,j){null==j&&(j=c.getRange(f,g));i&&G&&G.cm==c&&f.line==G.pos.line&&f.ch==G.pos.ch&&c.isClean(G.gen)?v.length?v[v.length-1]+=j:M(j):M(j);c.replaceRange("",f,g,"+delete");G=i?{cm:c,pos:f,gen:c.changeGeneration()}:null}function u(c,f,g){return c.findPosH(f,g,"char",!0)}function B(c,f,g){return c.findPosH(f,g,"word",!0)}function r(c,
f,g){return c.findPosV(f,g,"line",c.doc.sel.goalColumn)}function q(c,f,g){return c.findPosV(f,g,"page",c.doc.sel.goalColumn)}function I(c,f,g){for(var i=f.line,j=c.getLine(i),f=/\S/.test(0>g?j.slice(0,f.ch):j.slice(f.ch)),k=c.firstLine(),m=c.lastLine();;){i+=g;if(i<k||i>m)return c.clipPos(z(i-g,0>g?0:null));j=c.getLine(i);if(/\S/.test(j))f=!0;else if(f)return z(i,0)}}function w(c,f,g){for(var i=f.line,j=f.ch,f=c.getLine(f.line),k=!1;;){var m=f.charAt(j+(0>g?-1:0));if(m){if(k&&/[!?.]/.test(m))return z(i,
j+(0<g?1:0));k||(k=/\w/.test(m));j+=g}else{if(i==(0>g?c.firstLine():c.lastLine()))return z(i,j);f=c.getLine(i+g);if(!/\S/.test(f))return z(i,j);i+=g;j=0>g?f.length:0}}}function A(c,f,g){var i;if(c.findMatchingBracket&&(i=c.findMatchingBracket(f,!0))&&i.match&&(i.forward?1:-1)==g)return 0<g?z(i.to.line,i.to.ch+1):i.to;for(var j=!0;;j=!1){var k=c.getTokenAt(f);i=z(f.line,0>g?k.start:k.end);if(j&&0<g&&k.end==f.ch||!/\w/.test(k.string)){j=c.findPosH(i,g,"char");if(i.line==j.line&&i.ch==j.ch)return f;
f=j}else return i}}function N(c,f){var g=c.state.emacsPrefix;if(!g)return f?null:1;s(c);return"-"==g?-1:Number(g)}function t(c){var f="string"==typeof c?function(f){f.execCommand(c)}:c;return function(c){var i=N(c);f(c);for(var j=1;j<i;++j)f(c)}}function P(c,f,g){var i=c.getCursor(),j=N(c);0>j&&(g=-g,j=-j);for(var k=0;k<j;++k){var m=f(c,i,g);if(m.line==i.line&&m.ch==i.ch)break;i=m}return i}function k(c,f){var g=function(i){i.extendSelection(P(i,c,f))};g.motion=!0;return g}function J(c,f,g){K(c,c.getCursor(),
P(c,f,g),!0)}function Y(c,f){c.state.emacsPrefix?"-"!=f&&(c.state.emacsPrefix+=f):(c.state.emacsPrefix=f,c.on("keyHandled",E),c.on("inputRead",Z))}function E(c,f){!c.state.emacsPrefixMap&&!Q.hasOwnProperty(f)&&s(c)}function s(c){c.state.emacsPrefix=null;c.off("keyHandled",E);c.off("inputRead",Z)}function Z(c,f){var g=N(c);if(1<g&&"+input"==f.origin){for(var i=f.text.join("\n"),j="",k=1;k<g;++k)j+=i;c.replaceSelection(j,"end","+input")}}function x(c,f){"string"==typeof f&&(/^\d$/.test(f)||"Ctrl-U"==
f)||(c.removeKeyMap(R),c.state.emacsPrefixMap=!1,c.off("keyHandled",x),c.off("inputRead",x))}function T(c){c.setCursor(c.getCursor());c.setExtending(!0);c.on("change",function(){c.setExtending(!1)})}function L(c,f,g){c.openDialog?c.openDialog(f+': <input type="text" style="width: 10em"/>',g,{bottom:!0}):g(prompt(f,""))}function F(c,f){var g=c.getCursor(),i=c.findPosH(g,1,"word");c.replaceRange(f(c.getRange(g,i)),g,i);c.setCursor(i)}function S(c){R[c]=function(f){Y(f,c)};$["Ctrl-"+c]=function(f){Y(f,
c)};Q["Ctrl-"+c]=!0}var z=CodeMirror.Pos,v=[],G=null,Q={"Alt-G":!0,"Ctrl-X":!0,"Ctrl-Q":!0,"Ctrl-U":!0},$=CodeMirror.keyMap.emacs={"Ctrl-W":function(c){K(c,c.getCursor("start"),c.getCursor("end"))},"Ctrl-K":t(function(c){var f=c.getCursor(),g=c.clipPos(z(f.line)),i=c.getRange(f,g);/\S/.test(i)||(i+="\n",g=z(f.line+1,0));K(c,f,g,!0,i)}),"Alt-W":function(c){M(c.getSelection());c.setExtending(!1);c.setCursor(c.getCursor())},"Ctrl-Y":function(c){var f=c.getCursor();c.replaceRange(y(N(c)),f,f,"paste");
c.setSelection(f,c.getCursor())},"Alt-Y":function(c){c.replaceSelection(m())},"Ctrl-Space":T,"Ctrl-Shift-2":T,"Ctrl-F":k(u,1),"Ctrl-B":k(u,-1),Right:k(u,1),Left:k(u,-1),"Ctrl-D":function(c){J(c,u,1)},Delete:function(c){J(c,u,1)},"Ctrl-H":function(c){J(c,u,-1)},Backspace:function(c){J(c,u,-1)},"Alt-F":k(B,1),"Alt-B":k(B,-1),"Alt-D":function(c){J(c,B,1)},"Alt-Backspace":function(c){J(c,B,-1)},"Ctrl-N":k(r,1),"Ctrl-P":k(r,-1),Down:k(r,1),Up:k(r,-1),"Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd",End:"goLineEnd",
Home:"goLineStart","Alt-V":k(q,-1),"Ctrl-V":k(q,1),PageUp:k(q,-1),PageDown:k(q,1),"Ctrl-Up":k(I,-1),"Ctrl-Down":k(I,1),"Alt-A":k(w,-1),"Alt-E":k(w,1),"Alt-K":function(c){J(c,w,1)},"Ctrl-Alt-K":function(c){J(c,A,1)},"Ctrl-Alt-Backspace":function(c){J(c,A,-1)},"Ctrl-Alt-F":k(A,1),"Ctrl-Alt-B":k(A,-1),"Shift-Ctrl-Alt-2":function(c){c.setSelection(P(c,A,1),c.getCursor())},"Ctrl-Alt-T":function(c){var f=A(c,c.getCursor(),-1),g=A(c,f,1),i=A(c,g,1),j=A(c,i,-1);c.replaceRange(c.getRange(j,i)+c.getRange(g,
j)+c.getRange(f,g),f,i)},"Ctrl-Alt-U":t(function(c){for(var f=c.getCursor(),g=f.line,f=f.ch,i=[];g>=c.firstLine();){for(var j=c.getLine(g),k=null==f?j.length:f;0<k;)if(f=j.charAt(--k),")"==f)i.push("(");else if("]"==f)i.push("[");else if("}"==f)i.push("{");else if(/[\(\{\[]/.test(f)&&(!i.length||i.pop()!=f))return c.extendSelection(z(g,k));--g;f=null}}),"Alt-Space":function(c){for(var f=c.getCursor(),g=f.ch,i=f.ch,j=c.getLine(f.line);g&&/\s/.test(j.charAt(g-1));)--g;for(;i<j.length&&/\s/.test(j.charAt(i));)++i;
c.replaceRange(" ",z(f.line,g),z(f.line,i))},"Ctrl-O":t(function(c){c.replaceSelection("\n","start")}),"Ctrl-T":t(function(c){var f=c.getCursor();f.ch<c.getLine(f.line).length&&(f=z(f.line,f.ch+1));var g=c.findPosH(f,-2,"char"),i=c.getRange(g,f);2==i.length&&(c.setSelection(g,f),c.replaceSelection(i.charAt(1)+i.charAt(0),"end"))}),"Alt-C":t(function(c){F(c,function(c){var g=c.search(/\w/);return-1==g?c:c.slice(0,g)+c.charAt(g).toUpperCase()+c.slice(g+1).toLowerCase()})}),"Alt-U":t(function(c){F(c,
function(c){return c.toUpperCase()})}),"Alt-L":t(function(c){F(c,function(c){return c.toLowerCase()})}),"Alt-;":"toggleComment","Ctrl-/":t("undo"),"Shift-Ctrl--":t("undo"),"Ctrl-Z":t("undo"),"Cmd-Z":t("undo"),"Shift-Alt-,":"goDocStart","Shift-Alt-.":"goDocEnd","Ctrl-S":"findNext","Ctrl-R":"findPrev","Ctrl-G":function(c){c.execCommand("clearSearch");c.setExtending(!1);c.setCursor(c.getCursor())},"Shift-Alt-5":"replace","Alt-/":"autocomplete","Ctrl-J":"newlineAndIndent",Enter:!1,Tab:"indentAuto","Alt-G":function(c){c.setOption("keyMap",
"emacs-Alt-G")},"Ctrl-X":function(c){c.setOption("keyMap","emacs-Ctrl-X")},"Ctrl-Q":function(c){c.setOption("keyMap","emacs-Ctrl-Q")},"Ctrl-U":function(c){c.state.emacsPrefixMap=!0;c.addKeyMap(R);c.on("keyHandled",x);c.on("inputRead",x)}};CodeMirror.keyMap["emacs-Ctrl-X"]={Tab:function(c){c.indentSelection(N(c,!0)||c.getOption("indentUnit"))},"Ctrl-X":function(c){c.setSelection(c.getCursor("head"),c.getCursor("anchor"))},"Ctrl-S":"save","Ctrl-W":"save",S:"saveAll",F:"open",U:t("undo"),K:"close",Delete:function(c){K(c,
c.getCursor(),w(c,c.getCursor(),1),!0)},auto:"emacs",nofallthrough:!0,disableInput:!0};CodeMirror.keyMap["emacs-Alt-G"]={G:function(c){var f=N(c,!0);if(null!=f&&0<f)return c.setCursor(f-1);L(c,"Goto line",function(f){var i;f&&(!isNaN(i=Number(f))&&i==i|0&&0<i)&&c.setCursor(i-1)})},auto:"emacs",nofallthrough:!0,disableInput:!0};CodeMirror.keyMap["emacs-Ctrl-Q"]={Tab:t("insertTab"),auto:"emacs",nofallthrough:!0};for(var R={"Ctrl-G":s},U=0;10>U;++U)S(""+U);S("-")})();
(function(){function M(m,K){var u=m.getCursor("head"),B=m.getCursor("anchor");m.operation(function(){var r;var q=Math.min(u.line,B.line),I=Math.max(u.line,B.line);if(!K||q>I)r=0;else{r=m.clipPos(y(q,0));var w=m.clipPos(y(I)),I=m.getRange(r,w);q<=m.firstLine()?m.replaceRange("",r,y(w.line+1,0)):m.replaceRange("",y(r.line-1),w);q=r.line+K;q<=m.firstLine()?(m.replaceRange(I+"\n",y(q,0)),r=m.firstLine()-r.line):(q=m.clipPos(y(q-1)),m.replaceRange("\n"+I,q),r=q.line+1-r.line)}m.setSelection(y(B.line+r,
B.ch),y(u.line+r,u.ch))})}var y=CodeMirror.Pos;CodeMirror.commands.moveLinesUp=function(m){M(m,-1)};CodeMirror.commands.moveLinesDown=function(m){M(m,1)};CodeMirror.keyMap["default"]["Alt-Up"]="moveLinesUp";CodeMirror.keyMap["default"]["Alt-Down"]="moveLinesDown"})();
(function(){var M=[{keys:["<Left>"],type:"keyToKey",toKeys:["h"]},{keys:["<Right>"],type:"keyToKey",toKeys:["l"]},{keys:["<Up>"],type:"keyToKey",toKeys:["k"]},{keys:["<Down>"],type:"keyToKey",toKeys:["j"]},{keys:["<Space>"],type:"keyToKey",toKeys:["l"]},{keys:["<BS>"],type:"keyToKey",toKeys:["h"]},{keys:["<C-Space>"],type:"keyToKey",toKeys:["W"]},{keys:["<C-BS>"],type:"keyToKey",toKeys:["B"]},{keys:["<S-Space>"],type:"keyToKey",toKeys:["w"]},{keys:["<S-BS>"],type:"keyToKey",toKeys:["b"]},{keys:["<C-n>"],
type:"keyToKey",toKeys:["j"]},{keys:["<C-p>"],type:"keyToKey",toKeys:["k"]},{keys:["<C-[>"],type:"keyToKey",toKeys:["<Esc>"]},{keys:["<C-c>"],type:"keyToKey",toKeys:["<Esc>"]},{keys:["s"],type:"keyToKey",toKeys:["c","l"],context:"normal"},{keys:["s"],type:"keyToKey",toKeys:["x","i"],context:"visual"},{keys:["S"],type:"keyToKey",toKeys:["c","c"],context:"normal"},{keys:["S"],type:"keyToKey",toKeys:["d","c","c"],context:"visual"},{keys:["<Home>"],type:"keyToKey",toKeys:["0"]},{keys:["<End>"],type:"keyToKey",
toKeys:["$"]},{keys:["<PageUp>"],type:"keyToKey",toKeys:["<C-b>"]},{keys:["<PageDown>"],type:"keyToKey",toKeys:["<C-f>"]},{keys:["<CR>"],type:"keyToKey",toKeys:["j","^"],context:"normal"},{keys:["H"],type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:["M"],type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:["L"],type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:["h"],type:"motion",motion:"moveByCharacters",
motionArgs:{forward:!1}},{keys:["l"],type:"motion",motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:["j"],type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:["k"],type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:["g","j"],type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:["g","k"],type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:["w"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,
wordEnd:!1}},{keys:["W"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1,bigWord:!0}},{keys:["e"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:["E"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:["b"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:["B"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:["g","e"],
type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},{keys:["g","E"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:["{"],type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:["}"],type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:["<C-f>"],type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:["<C-b>"],type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},
{keys:["<C-d>"],type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,explicitRepeat:!0}},{keys:["<C-u>"],type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:["g","g"],type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:["G"],type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:["0"],type:"motion",motion:"moveToStartOfLine"},
{keys:["^"],type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["+"],type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0}},{keys:["-"],type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:["_"],type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:["$"],type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:["%"],type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},
{keys:["f","character"],type:"motion",motion:"moveToCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:["F","character"],type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:["t","character"],type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:["T","character"],type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:[";"],type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:[","],type:"motion",motion:"repeatLastCharacterSearch",
motionArgs:{forward:!1}},{keys:["'","character"],type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:["`","character"],type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:["]","`"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:["[","`"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:["]","'"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:["[","'"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,
linewise:!0}},{keys:["]","character"],type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:["[","character"],type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:["|"],type:"motion",motion:"moveToColumn",motionArgs:{}},{keys:["d"],type:"operator",operator:"delete"},{keys:["y"],type:"operator",operator:"yank"},{keys:["c"],type:"operator",operator:"change"},{keys:[">"],type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:["<"],
type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},{keys:["g","~"],type:"operator",operator:"swapcase"},{keys:["n"],type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:["N"],type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:["x"],type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:["X"],type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},
operatorMotionArgs:{visualLine:!0}},{keys:["D"],type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},operatorMotionArgs:{visualLine:!0}},{keys:["Y"],type:"operatorMotion",operator:"yank",motion:"moveToEol",motionArgs:{inclusive:!0},operatorMotionArgs:{visualLine:!0}},{keys:["C"],type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},operatorMotionArgs:{visualLine:!0}},{keys:["~"],type:"operatorMotion",operator:"swapcase",operatorArgs:{shouldMoveCursor:!0},
motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:["<C-i>"],type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:["<C-o>"],type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},{keys:["<C-e>"],type:"action",action:"scroll",actionArgs:{forward:!0,linewise:!0}},{keys:["<C-y>"],type:"action",action:"scroll",actionArgs:{forward:!1,linewise:!0}},{keys:["a"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"}},{keys:["A"],type:"action",action:"enterInsertMode",
isEdit:!0,actionArgs:{insertAt:"eol"}},{keys:["i"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"}},{keys:["I"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"}},{keys:["o"],type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0}},{keys:["O"],type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1}},{keys:["v"],type:"action",action:"toggleVisualMode"},
{keys:["V"],type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:["J"],type:"action",action:"joinLines",isEdit:!0},{keys:["p"],type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0}},{keys:["P"],type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:["r","character"],type:"action",action:"replace",isEdit:!0},{keys:["@","character"],type:"action",action:"replayMacro"},{keys:["q","character"],type:"action",action:"enterMacroRecordMode"},{keys:["R"],
type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0}},{keys:["u"],type:"action",action:"undo"},{keys:["<C-r>"],type:"action",action:"redo"},{keys:["m","character"],type:"action",action:"setMark"},{keys:['"',"character"],type:"action",action:"setRegister"},{keys:["z","z"],type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:["z","."],type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["z",
"t"],type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:["z","<CR>"],type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["z","-"],type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:["z","b"],type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["."],type:"action",action:"repeatLastEdit"},{keys:["<C-a>"],type:"action",action:"incrementNumberToken",
isEdit:!0,actionArgs:{increase:!0,backtrack:!1}},{keys:["<C-x>"],type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:["a","character"],type:"motion",motion:"textObjectManipulation"},{keys:["i","character"],type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:["/"],type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:["?"],type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:["*"],
type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:["#"],type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:[":"],type:"ex"}],y=function(){function m(a,b){var d=a.state.vim;!d.insertMode&&!d.exMode&&(d=b.head,d.ch&&d.ch==a.doc.getLine(d.line).length&&d.ch--)}function K(a){var b=a.state.vim;b.onPasteFn||(b.onPasteFn=function(){b.insertMode||(a.setCursor(k(a.getCursor(),0,1)),ba.enterInsertMode(a,{},b))});return b.onPasteFn}function u(a,
b){for(var d=[],e=a;e<a+b;e++)d.push(String.fromCharCode(e));return d}function B(a){return/^[A-Z]$/.test(a)}function r(a,b){for(var d=0;d<b.length;d++)if(b[d]==a)return!0;return!1}function q(a){a.state.vim||(a.state.vim={inputState:new w,lastEditInputState:void 0,lastEditActionCommand:void 0,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},insertMode:!1,insertModeRepeat:void 0,visualMode:!1,visualLine:!1});return a.state.vim}function I(){p={searchQuery:null,searchIsReversed:!1,jumpList:za(),macroModeState:Aa(),
lastChararacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new N({})}}function w(){this.prefixRepeat=[];this.motionRepeat=[];this.motionArgs=this.motion=this.operatorArgs=this.operator=null;this.keyBuffer=[];this.registerName=null}function A(a,b){this.clear();a&&this.set(a,b)}function N(a){this.registers=a;this.unamedRegister=a['"']=new A}function t(a,b,d){var e=Math.min(Math.max(a.firstLine(),b.line),a.lastLine()),a=x(a,e)-1,b=Math.min(Math.max(0,b.ch),d?a+1:a);return{line:e,
ch:b}}function P(a){var b={},d;for(d in a)a.hasOwnProperty(d)&&(b[d]=a[d]);return b}function k(a,b,d){return{line:a.line+b,ch:a.ch+d}}function J(a,b){for(var d=0;d<a.length;d++)if(a[d]!=b[d]&&"character"!=b[d])return!1;return!0}function Y(a,b,d){return function(){for(var e=0;e<d;e++)b(a)}}function E(a,b){return a.ch==b.ch&&a.line==b.line}function s(a,b){return a.line<b.line||a.line==b.line&&a.ch<b.ch?!0:!1}function Z(a,b,d){a=s(a,b);b=s(b,d);return a&&b}function x(a,b){return a.getLine(b).length}
function T(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function L(a){a.off("mousedown",L);var b=a.state.vim;b.visualMode=!1;b.visualLine=!1;var b=a.getCursor("anchor"),d=a.getCursor("head");E(b,d)||a.setCursor(t(a,d));CodeMirror.signal(a,"vim-mode-change",{mode:"normal"})}function F(a){if(!a)return 0;var b=a.search(/\S/);return-1==b?a.length:b}function S(a,b,d,e,n){var d=a.getCursor(),a=a.getLine(d.line),c=d.ch,h=a.substring(c),n=n?h.search(/\w/):h.search(/\S/);if(-1==n)return null;var c=
c+n,h=a.substring(c),n=a.substring(0,c),C;C=e?/^\S+/:/\w/.test(a.charAt(c))?/^\w+/:/^[^\w\s]+/;h=C.exec(h);e=c;c+=h[0].length;n=n.split("").reverse().join("");(C=C.exec(n))&&(e-=C[0].length);b&&(b=a.substring(c).match(/^\s*/)[0].length,0<b?c+=b:(b=n.substring(n.length-e).match(/^\s*/)[0].length,e-=b));return{start:{line:d.line,ch:e},end:{line:d.line,ch:c}}}function z(a,b){p.lastChararacterSearch.increment=a;p.lastChararacterSearch.forward=b.forward;p.lastChararacterSearch.selectedCharacter=b.selectedCharacter}
function v(a,b,d,e){for(var n=a.getCursor(),c=n.ch,h,C=0;C<b;C++){h=a.getLine(n.line);var f=e,i=void 0;h=i=d?h.indexOf(f,c+1):h.lastIndexOf(f,c-1);if(-1==h)return null;c=h}return{line:a.getCursor().line,ch:h}}function G(a,b,d,e){r(d,Da)&&(b.marks[d]&&b.marks[d].clear(),b.marks[d]=a.setBookmark(e))}function Q(a){return"string"===a||"comment"===a?1:0}function $(a,b,d){var e=b.line,n=b.ch,d=d?d:a.getLine(e).charAt(n),c=a.getTokenAt({line:e,ch:n+1}).type,c=Q(c),h={"(":")",")":"(","[":"]","]":"[","{":"}",
"}":"{"}[d];if(!h)return b;for(var f={"(":1,"{":1,"[":1}[d]||-1,o=1===f?a.lineCount():-1,i=1,g=d,j=n,n=a.getLine(e);e!==o&&0<i;){j+=f;g=n.charAt(j);g||(e+=f,n=a.getLine(e)||"",0<f?j=0:(g=n.length,j=0<g?g-1:0),g=n.charAt(j));var l=a.getTokenAt({line:e,ch:j+1}).type,l=Q(l);c>=l&&(g===d?i++:g===h&&i--)}return g?{line:e,ch:j}:b}function R(a,b,d){var e=a.getCursor(),b=$(a,e,b),a=$(a,b);a.ch+=d?1:0;b.ch+=d?0:1;return{start:a,end:b}}function U(a,b,d){var e=a.getCursor(),a=a.getLine(e.line).split(""),n,c,
h,f;h=a.indexOf(b);e.ch<h?e.ch=h:h<e.ch&&a[e.ch]==b&&(c=e.ch,--e.ch);if(a[e.ch]==b&&!c)n=e.ch+1;else for(h=e.ch;-1<h&&!n;h--)a[h]==b&&(n=h+1);if(n&&!c){h=n;for(f=a.length;h<f&&!c;h++)a[h]==b&&(c=h)}if(!n||!c)return{start:e,end:e};d&&(--n,++c);return{start:{line:e.line,ch:n},end:{line:e.line,ch:c}}}function c(){}function f(a){a=a.state.vim;return a.searchState_||(a.searchState_=new c)}function g(a){for(var b=!1,d=[],e=0;e<a.length;e++){var n=a.charAt(e);!b&&"/"==n&&d.push(e);b=!b&&"\\"==n}return d}
function i(a,b){a.openNotification?a.openNotification('<span style="color: red">'+b+"</span>",{bottom:!0,duration:5E3}):alert(b)}function j(a,b){var d=(b.prefix||"")+" "+(b.desc||""),e=b.prefix,n=b.desc,c="";e&&(c+='<span style="font-family: monospace">'+e+"</span>");c+='<input type="text"/> <span style="color: #888">';n&&(c=c+'<span style="color: #888">'+n+"</span>");e=b.onClose;a.openDialog?a.openDialog(c,e,{bottom:!0,value:b.value,onKeyDown:b.onKeyDown,onKeyUp:b.onKeyUp}):e(prompt(d,""))}function aa(a,
b,d,e){if(b){var n=f(a);d=!!d;e=!!e;if(!(b instanceof RegExp)){var c=g(b),h,C;c.length?(h=b.substring(0,c[0]),C=-1!=b.substring(c[0]).indexOf("i")):h=b;h?(e&&(d=/^[^A-Z]*$/.test(h)),b=RegExp(h,d||C?"i":void 0)):b=null}if(b){ma(a,b);a:if(a=n.getQuery(),b instanceof RegExp&&a instanceof RegExp){C=["global","multiline","ignoreCase","source"];for(d=0;d<C.length;d++)if(e=C[d],b[e]!==a[e]){a=!1;break a}a=!0}else a=!1;if(a)return b;n.setQuery(b);return b}}}function ya(a){if("^"==a.source.charAt(0))var b=
!0;return{token:function(d){if(b&&!d.sol())d.skipToEnd();else{var e=d.match(a,!1);if(e){if(0==e[0].length)return d.next(),"searching";if(!d.sol()&&(d.backUp(1),!a.exec(d.next()+e[0])))return d.next(),null;d.match(a);return"searching"}for(;!d.eol()&&!(d.next(),d.match(a,!1)););}},query:a}}function ma(a,b){var d=f(a).getOverlay();if(!d||b!=d.query)d&&a.removeOverlay(d),d=ya(b),a.addOverlay(d),f(a).setOverlay(d)}function na(a,b,d,e){void 0===e&&(e=1);return a.operation(function(){for(var n=a.getCursor(),
c=a.getSearchCursor(d,n),h=0;h<e;h++){var f=c.find(b);0==h&&(f&&E(c.from(),n))&&(f=c.find(b));if(!f&&(c=a.getSearchCursor(d,b?{line:a.lastLine()}:{line:a.firstLine(),ch:0}),!c.find(b)))return}return c.from()})}function ia(a){a.removeOverlay(f(a).getOverlay());f(a).setOverlay(null)}function ja(a){var b=a.getScrollInfo(),d=a.coordsChar({left:0,top:6+b.top},"local"),a=a.coordsChar({left:0,top:b.clientHeight-10+b.top},"local");return{top:d.line,bottom:a.line}}function ca(a){for(var b,d,e=[];a;){d=/<\w+-.+?>|<\w+>|./.exec(a);
if(null===d)break;b=d[0];a=a.substring(d.index+b.length);e.push(b)}return e}function Ea(a,b,d,e,n,c,h){function f(){a.operation(function(){for(;!l;)o(),g();ha()})}function o(){var b=a.getRange(n.from(),n.to()).replace(c,h);n.replace(b)}function g(){if(n.findNext()){var b;b=n.from();var c=d,h=e;"number"!=typeof b&&(b=b.line);b=c instanceof Array?r(b,c):h?b>=c&&b<=h:b==c;b?(a.scrollIntoView(n.from(),30),a.setSelection(n.from(),n.to()),da=n.from(),l=!1):l=!0}else l=!0}function ha(b){b&&b();a.focus();
da&&(a.setCursor(da),b=a.state.vim,b.exMode=!1,b.lastHPos=b.lastHSPos=da.ch)}function k(b,d,e){CodeMirror.e_stop(b);switch(CodeMirror.keyName(b)){case "Y":o();g();break;case "N":g();break;case "A":a.operation(f);break;case "L":o();case "Q":case "Esc":case "Ctrl-C":case "Ctrl-[":ha(e)}l&&ha(e)}a.state.vim.exMode=!0;var l=!1,da=n.from();g();l?i(a,"No matches for "+c.source):b?j(a,{prefix:"replace with <strong>"+h+"</strong> (y/n/a/q/l)",onKeyDown:k}):f()}function ea(a){var b=a.state.vim,d=p.macroModeState.inReplay;
d||(a.off("change",oa),a.off("cursorActivity",pa),CodeMirror.off(a.getInputField(),"keydown",qa));!d&&1<b.insertModeRepeat&&(ra(a,b,b.insertModeRepeat-1,!0),b.lastEditInputState.repeatOverride=b.insertModeRepeat);delete b.insertModeRepeat;a.setCursor(a.getCursor().line,a.getCursor().ch-1,!0);b.insertMode=!1;a.setOption("keyMap","vim");a.setOption("disableInput",!0);a.toggleOverwrite(!1);CodeMirror.signal(a,"vim-mode-change",{mode:"normal"})}function oa(a,b){for(var d=p.macroModeState.lastInsertModeChanges;b;){d.expectCursorActivityForChange=
!0;if("+input"==b.origin||"paste"==b.origin||void 0===b.origin){var e=b.text.join("\n");d.changes.push(e)}b=b.next}}function pa(){var a=p.macroModeState.lastInsertModeChanges;a.expectCursorActivityForChange?a.expectCursorActivityForChange=!1:a.changes=[]}function ka(a){this.keyName=a}function qa(a){function b(){d.changes.push(new ka(e));return!0}var d=p.macroModeState.lastInsertModeChanges,e=CodeMirror.keyName(a);(-1!=e.indexOf("Delete")||-1!=e.indexOf("Backspace"))&&CodeMirror.lookupKey(e,["vim-insert"],
b)}function ra(a,b,d,e){function n(){f?V.processAction(a,b,b.lastEditActionCommand):V.evalInput(a,b)}function c(d){0<h.lastInsertModeChanges.changes.length&&(d=!b.lastEditActionCommand?1:d,Fa(a,d,h))}var h=p.macroModeState;h.inReplay=!0;var f=!!b.lastEditActionCommand,o=b.inputState;b.inputState=b.lastEditInputState;if(f&&b.lastEditActionCommand.interlaceInsertRepeat)for(var i=0;i<d;i++)n(),c(1);else e||n(),c(d);b.inputState=o;b.insertMode&&!e&&ea(a);h.inReplay=!1}function Fa(a,b,d){function e(b){if("string"==
typeof b)CodeMirror.commands[b](a);else b(a);return!0}for(var d=d.lastInsertModeChanges,n=0;n<b;n++)for(var c=0;c<d.changes.length;c++){var h=d.changes[c];if(h instanceof ka)CodeMirror.lookupKey(h.keyName,["vim-insert"],e);else{var f=a.getCursor();a.replaceRange(h,f,f)}}}CodeMirror.defineOption("vimMode",!1,function(a,b){if(b){a.setOption("keyMap","vim");a.setOption("disableInput",true);CodeMirror.signal(a,"vim-mode-change",{mode:"normal"});a.on("beforeSelectionChange",m);q(a);CodeMirror.on(a.getInputField(),
"paste",K(a))}else if(a.state.vim){a.setOption("keyMap","default");a.setOption("disableInput",false);a.off("beforeSelectionChange",m);CodeMirror.off(a.getInputField(),"paste",K(a));a.state.vim=null}});var Ga=/[\d]/,Ha=[/\w/,/[^\w\s]/],Ia=[/\S/],fa=u(65,26),la=u(97,26),ga=u(48,10),sa="~`!@#$%^&*()_-+=[{}]\\|/?.,<>:;\"'".split(""),ta="Left Right Up Down Space Backspace Esc Home End PageUp PageDown Enter".split(" "),Da=[].concat(fa,la,ga,["<",">"]),Ja=[].concat(fa,la,ga,["-",'"']),za=function(){var a=
100,b=-1,d=0,e=0,n=Array(a);return{cachedCursor:void 0,add:function(c,h,f){function o(d){var e=++b%a,h=n[e];h&&h.clear();n[e]=c.setBookmark(d)}var i=n[b%a];i?(i=i.find())&&!E(i,h)&&o(h):o(h);o(f);d=b;e=b-a+1;0>e&&(e=0)},move:function(c,h){b+=h;b>d?b=d:b<e&&(b=e);var f=n[(a+b)%a];if(f&&!f.find()){var o=0<h?1:-1,i,g=c.getCursor();do if(b+=o,(f=n[(a+b)%a])&&(i=f.find())&&!E(g,i))break;while(b<d&&b>e)}return f}}},Aa=function(){return{macroKeyBuffer:[],latestRegister:void 0,inReplay:!1,lastInsertModeChanges:{changes:[],
expectCursorActivityForChange:!1},enteredMacroMode:void 0,isMacroPlaying:!1,toggle:function(a,b){this.enteredMacroMode?(this.enteredMacroMode(),this.enteredMacroMode=void 0):(this.latestRegister=b,this.enteredMacroMode=a.openDialog("(recording)["+b+"]",null,{bottom:!0}))}}},p,Ka={buildKeyMap:function(){},getRegisterController:function(){return p.registerController},resetVimGlobalState_:I,getVimGlobalState_:function(){return p},maybeInitVimState_:q,InsertModeKey:ka,map:function(a,b,d){W.map(a,b,d)},
defineEx:function(a,b,d){if(0!==a.indexOf(b))throw Error('(Vim.defineEx) "'+b+'" is not a prefix of "'+a+'", command not registered');ua[a]=d;W.commandMap_[b]={name:a,shortName:b,type:"api"}},handleKey:function(a,b){var d,e=q(a),c=p.macroModeState;if(c.enteredMacroMode&&"q"==b)ba.exitMacroRecordMode(),e.inputState=new w;else if("<Esc>"==b)e.inputState=new w,e.visualMode&&L(a);else{!e.visualMode&&!E(a.getCursor("head"),a.getCursor("anchor"))&&(e.visualMode=!0,e.visualLine=!1,CodeMirror.signal(a,"vim-mode-change",
{mode:"visual"}),a.on("mousedown",L));if("0"!=b||"0"==b&&0===e.inputState.getRepeat())d=V.matchCommand(b,M,e);if(d)if("keyToKey"==d.type)for(e=0;e<d.toKeys.length;e++)this.handleKey(a,d.toKeys[e]);else c.enteredMacroMode&&(c.isMacroPlaying||c.macroKeyBuffer.push(b)),V.processCommand(a,e,d);else Ga.test(b)&&e.inputState.pushRepeatDigit(b)}},handleEx:function(a,b){W.processCommand(a,b)}};w.prototype.pushRepeatDigit=function(a){this.operator?this.motionRepeat=this.motionRepeat.concat(a):this.prefixRepeat=
this.prefixRepeat.concat(a)};w.prototype.getRepeat=function(){var a=0;if(0<this.prefixRepeat.length||0<this.motionRepeat.length)a=1,0<this.prefixRepeat.length&&(a*=parseInt(this.prefixRepeat.join(""),10)),0<this.motionRepeat.length&&(a*=parseInt(this.motionRepeat.join(""),10));return a};A.prototype={set:function(a,b){this.text=a;this.linewise=!!b},append:function(a,b){b||this.linewise?(this.text+="\n"+a,this.linewise=!0):this.text+=a},clear:function(){this.text="";this.linewise=!1},toString:function(){return this.text}};
N.prototype={pushText:function(a,b,d,e){e&&"\n"==d.charAt(0)&&(d=d.slice(1)+"\n");e&&"\n"!==d.charAt(d.length-1)&&(d+="\n");var c=this.isValidRegister(a)?this.getRegister(a):null;if(c)B(a)?(c.append(d,e),this.unamedRegister.append(d,e)):(c.set(d,e),this.unamedRegister.set(d,e));else{switch(b){case "yank":this.registers["0"]=new A(d,e);break;case "delete":case "change":-1==d.indexOf("\n")?this.registers["-"]=new A(d,e):(this.shiftNumericRegisters_(),this.registers["1"]=new A(d,e))}this.unamedRegister.set(d,
e)}},setRegisterText:function(a,b,d){this.getRegister(a).set(b,d)},getRegister:function(a){if(!this.isValidRegister(a))return this.unamedRegister;a=a.toLowerCase();this.registers[a]||(this.registers[a]=new A);return this.registers[a]},isValidRegister:function(a){return a&&r(a,Ja)},shiftNumericRegisters_:function(){for(var a=9;2<=a;a--)this.registers[a]=this.getRegister(""+(a-1))}};var V={matchCommand:function(a,b,d){function e(b){if(f.length<b.keys.length)return c.keyBuffer.push(a),null;"character"==
b.keys[f.length-1]&&(c.selectedCharacter=i);c.keyBuffer=[];return b}for(var c=d.inputState,f=c.keyBuffer.concat(a),h=[],i,o=0;o<b.length;o++){var g=b[o];if(J(f,g.keys)&&!(c.operator&&"action"==g.type)){if("character"==g.keys[f.length-1]&&(i=f[f.length-1],1<i.length))switch(i){case "<CR>":i="\n";break;case "<Space>":i=" ";break;default:continue}h.push(g)}}if(h.length){if(1==h.length)return e(h[0]);for(var b=d.visualMode?"visual":"normal",j,o=0;o<h.length;o++)if(d=h[o],d.context==b){j=d;break}else!j&&
!d.context&&(j=d);return e(j)}c.keyBuffer=[];return null},processCommand:function(a,b,d){b.inputState.repeatOverride=d.repeatOverride;switch(d.type){case "motion":this.processMotion(a,b,d);break;case "operator":this.processOperator(a,b,d);break;case "operatorMotion":this.processOperatorMotion(a,b,d);break;case "action":this.processAction(a,b,d);break;case "search":this.processSearch(a,b,d);break;case "ex":case "keyToEx":this.processEx(a,b,d)}},processMotion:function(a,b,d){b.inputState.motion=d.motion;
b.inputState.motionArgs=P(d.motionArgs);this.evalInput(a,b)},processOperator:function(a,b,d){var e=b.inputState;if(e.operator){if(e.operator==d.operator){e.motion="expandToLine";e.motionArgs={linewise:!0};this.evalInput(a,b);return}b.inputState=new w}e.operator=d.operator;e.operatorArgs=P(d.operatorArgs);b.visualMode&&this.evalInput(a,b)},processOperatorMotion:function(a,b,d){var e=b.visualMode,c=P(d.operatorMotionArgs);c&&(e&&c.visualLine)&&(b.visualLine=!0);this.processOperator(a,b,d);e||this.processMotion(a,
b,d)},processAction:function(a,b,d){var e=b.inputState,c=e.getRepeat(),f=!!c,h=P(d.actionArgs)||{};e.selectedCharacter&&(h.selectedCharacter=e.selectedCharacter);d.operator&&this.processOperator(a,b,d);d.motion&&this.processMotion(a,b,d);(d.motion||d.operator)&&this.evalInput(a,b);h.repeat=c||1;h.repeatIsExplicit=f;h.registerName=e.registerName;b.inputState=new w;b.lastMotion=null;d.isEdit&&this.recordLastEdit(b,e,d);ba[d.action](a,h,b)},processSearch:function(a,b,d){function e(e,c,n){try{aa(a,e,
c,n)}catch(h){i(a,"Invalid regex: "+e);return}V.processMotion(a,b,{type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:d.searchArgs.toJumplist}})}function c(b){a.scrollTo(k.left,k.top);e(b,!0,!0)}function Ba(b,d){var e;try{e=aa(a,d,!0,!0)}catch(c){}e?a.scrollIntoView(na(a,!g,e),30):(ia(a),a.scrollTo(k.left,k.top))}function h(b,d,e){d=CodeMirror.keyName(b);if("Esc"==d||"Ctrl-C"==d||"Ctrl-["==d)aa(a,Ca),ia(a),a.scrollTo(k.left,k.top),CodeMirror.e_stop(b),e(),a.focus()}if(a.getSearchCursor){var g=
d.searchArgs.forward;f(a).setReversed(!g);var o=g?"/":"?",Ca=f(a).getQuery(),k=a.getScrollInfo();switch(d.searchArgs.querySrc){case "prompt":j(a,{onClose:c,prefix:o,desc:La,onKeyUp:Ba,onKeyDown:h});break;case "wordUnderCursor":var o=S(a,!1,!0,!1,!0),m=!0;o||(o=S(a,!1,!0,!1,!1),m=!1);if(!o)break;var l=a.getLine(o.start.line).substring(o.start.ch,o.end.ch),l=m?"\\b"+l+"\\b":l.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1");p.jumpList.cachedCursor=a.getCursor();a.setCursor(o.start);e(l,!0,!1)}}},processEx:function(a,
b,d){function e(b){W.processCommand(a,b)}function c(b,d,e){d=CodeMirror.keyName(b);if("Esc"==d||"Ctrl-C"==d||"Ctrl-["==d)CodeMirror.e_stop(b),e(),a.focus()}"keyToEx"==d.type?W.processCommand(a,d.exArgs.input):b.visualMode?j(a,{onClose:e,prefix:":",value:"'<,'>",onKeyDown:c}):j(a,{onClose:e,prefix:":",onKeyDown:c})},evalInput:function(a,b){var d=b.inputState,e=d.motion,c=d.motionArgs||{},f=d.operator,h=d.operatorArgs||{},i=d.registerName,o=a.getCursor("head"),g=a.getCursor("anchor"),j={line:o.line,
ch:o.ch},k={line:j.line,ch:j.ch},l,m;f&&this.recordLastEdit(b,d);m=void 0!==d.repeatOverride?d.repeatOverride:d.getRepeat();if(0<m&&c.explicitRepeat)c.repeatIsExplicit=!0;else if(c.noRepeat||!c.explicitRepeat&&0===m)m=1,c.repeatIsExplicit=!1;d.selectedCharacter&&(c.selectedCharacter=h.selectedCharacter=d.selectedCharacter);c.repeat=m;b.inputState=new w;if(e){l=X[e](a,c,b);b.lastMotion=X[e];if(!l)return;c.toJumplist&&(e=p.jumpList,(d=e.cachedCursor)?(E(d,l)||p.jumpList.add(a,d,l),delete e.cachedCursor):
E(k,l)||p.jumpList.add(a,k,l));l instanceof Array&&(j=l[0],l=l[1]);l||(l={ch:j.ch,line:j.line});if(b.visualMode){if(s(g,o)&&(E(g,l)||s(l,g)))g.ch+=1;else if(s(o,g)&&(E(g,l)||s(g,l)))g.ch-=1;o=l;b.visualLine&&(s(g,o)?(g.ch=0,e=a.lastLine(),o.line>e&&(o.line=e),o.ch=x(a,o.line)):(o.ch=0,g.ch=x(a,g.line)));a.setSelection(g,o);G(a,b,"<",s(g,o)?g:o);G(a,b,">",s(g,o)?o:g)}else f||(l=t(a,l),a.setCursor(l.line,l.ch))}if(f){e=!1;b.lastMotion=null;h.repeat=m;b.visualMode&&(j=g,l=o,c.inclusive=!0);s(l,j)&&(o=
j,j=l,l=o,e=!0);c.inclusive&&(!b.visualMode||!e)&&l.ch++;if(o=c.linewise||b.visualMode&&b.visualLine)c=l,j.ch=0,c.ch=0,c.line++;else if(c.forward&&(c=l,g=a.getRange(j,c),/\n\s*$/.test(g))){g=g.split("\n");g.pop();for(m=g.pop();0<g.length&&m&&/^\s*$/.test(m);m=g.pop())c.line--,c.ch=0;m?(c.line--,c.ch=x(a,c.line)):c.ch=0}h.registerName=i;h.linewise=o;Ma[f](a,h,b,j,l,k);b.visualMode&&L(a)}},recordLastEdit:function(a,b,d){var e=p.macroModeState;e.inReplay||(a.lastEditInputState=b,a.lastEditActionCommand=
d,e.lastInsertModeChanges.changes=[],e.lastInsertModeChanges.expectCursorActivityForChange=!1)}},X={moveToTopLine:function(a,b){var d=ja(a).top+b.repeat-1;return{line:d,ch:F(a.getLine(d))}},moveToMiddleLine:function(a){var b=ja(a),b=Math.floor(0.5*(b.top+b.bottom));return{line:b,ch:F(a.getLine(b))}},moveToBottomLine:function(a,b){var d=ja(a).bottom-b.repeat+1;return{line:d,ch:F(a.getLine(d))}},expandToLine:function(a,b){return{line:a.getCursor().line+b.repeat-1,ch:Infinity}},findNext:function(a,b){var d=
f(a),e=d.getQuery();if(e){var c=!b.forward,c=d.isReversed()?!c:c;ma(a,e);return na(a,c,e,b.repeat)}},goToMark:function(a,b,d){return(a=d.marks[b.selectedCharacter])?a.find():null},jumpToMark:function(a,b,d){for(var e=a.getCursor(),c=0;c<b.repeat;c++){var f=e,h;for(h in d.marks)if(/^[a-z]$/.test(h)){var g=d.marks[h].find();if(!(b.forward?s(g,f):s(f,g))&&!(b.linewise&&g.line==f.line)){var i=E(f,e),j=b.forward?Z(f,g,e):Z(e,g,f);if(i||j)e=g}}}b.linewise&&(e.ch=F(a.getLine(e.line)));return e},moveByCharacters:function(a,
b){var d=a.getCursor(),e=b.repeat;return{line:d.line,ch:b.forward?d.ch+e:d.ch-e}},moveByLines:function(a,b,d){var e=a.getCursor(),c=e.ch;switch(d.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:c=d.lastHPos;break;default:d.lastHPos=c}var f=b.repeat+(b.repeatOffset||0),f=b.forward?e.line+f:e.line-f,h=a.firstLine(),g=a.lastLine();if(!(f<h&&e.line==h||f>g&&e.line==g))return b.toFirstChar&&(c=F(a.getLine(f)),d.lastHPos=c),
d.lastHSPos=a.charCoords({line:f,ch:c},"div").left,{line:f,ch:c}},moveByDisplayLines:function(a,b,d){var e=a.getCursor();switch(d.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:d.lastHSPos=a.charCoords(e,"div").left}var c=b.repeat,e=a.findPosV(e,b.forward?c:-c,"line",d.lastHSPos);e.hitSide&&(b.forward?b={top:a.charCoords(e,"div").top+8,left:d.lastHSPos}:(b=a.charCoords({line:a.firstLine(),ch:0},"div"),
b.left=d.lastHSPos),e=a.coordsChar(b,"div"));d.lastHPos=e.ch;return e},moveByPage:function(a,b){var d=a.getCursor(),e=b.repeat;a.moveV(b.forward?e:-e,"page");e=a.getCursor();a.setCursor(d);return e},moveByParagraph:function(a,b){for(var d=a.getCursor().line,e=b.repeat,c=b.forward?1:-1,f=0;f<e&&!(!b.forward&&d===a.firstLine()||b.forward&&d==a.lastLine());f++)for(d+=c;d!==a.firstLine()&&d!=a.lastLine()&&a.getLine(d);)d+=c;return{line:d,ch:0}},moveByScroll:function(a,b,d){var e=a.getScrollInfo(),c=null;
(c=b.repeat)||(c=e.clientHeight/(2*a.defaultTextHeight()));var f=a.charCoords(a.getCursor(),"local");b.repeat=c;c=X.moveByDisplayLines(a,b,d);if(!c)return null;b=a.charCoords(c,"local");a.scrollTo(null,e.top+b.top-f.top);return c},moveByWords:function(a,b){var d;var e=b.repeat;d=!!b.forward;var c=!!b.wordEnd,f=!!b.bigWord,h=a.getCursor(),g=h.line,i=h.ch,j=[];(d&&!c||!d&&c)&&e++;for(var k=!(d&&c),m=0;m<e;m++){var l;b:{l=a;var p=d,r=f,t=k,D=h.line,H=h.ch,O=l.getLine(D),s=p?1:-1,r=r?Ia:Ha;if(t&&""==
O){D+=s;O=l.getLine(D);if(!(D>=l.firstLine()&&D<=l.lastLine())){l=null;break b}H=p?0:O.length}for(;;){if(t&&""==O){l={from:0,to:0,line:D};break b}for(var q=p=0<s?O.length:-1,u=p;H!=p;){for(var w=!1,v=0;v<r.length&&!w;++v)if(r[v].test(O.charAt(H))){for(q=H;H!=p&&r[v].test(O.charAt(H));)H+=s;u=H;w=q!=u;if(!(q==h.ch&&D==h.line&&u==q+s)){l={from:Math.min(q,u+1),to:Math.max(q,u),line:D};break b}}w||(H+=s)}D+=s;if(!(D>=l.firstLine()&&D<=l.lastLine())){l=null;break b}O=l.getLine(D);H=0<s?0:O.length}throw Error("The impossible happened.");
}if(!l){f=x(a,a.lastLine());j.push(d?{line:a.lastLine(),from:f,to:f}:{line:0,from:0,to:0});break}j.push(l);h={line:l.line,ch:d?l.to-1:l.from}}e=j.length!=e;f=j[0];k=j.pop();if(d&&!c){if(!e&&(f.from!=i||f.line!=g))k=j.pop();d={line:k.line,ch:k.from}}else if(d&&c)d={line:k.line,ch:k.to-1};else if(!d&&c){if(!e&&(f.to!=i||f.line!=g))k=j.pop();d={line:k.line,ch:k.to}}else d={line:k.line,ch:k.from};return d},moveTillCharacter:function(a,b){var d=v(a,b.repeat,b.forward,b.selectedCharacter),e=b.forward?-1:
1;z(e,b);if(!d)return null;d.ch+=e;return d},moveToCharacter:function(a,b){var d=b.repeat;z(0,b);return v(a,d,b.forward,b.selectedCharacter)||a.getCursor()},moveToSymbol:function(a,b){var d;d=b.repeat;var e=b.forward,c=b.selectedCharacter,f=a.getCursor(),h=e?1:-1,g=e?a.lineCount():-1,i=f.ch,j=f.line,k=a.getLine(j),e={lineText:k,nextCh:k.charAt(i),lastCh:null,index:i,symb:c,reverseSymb:(e?{")":"(","}":"{"}:{"(":")","{":"}"})[c],forward:e,depth:0,curMoveThrough:!1};if(i=Na[c]){c=va[i].init;i=va[i].isComplete;
for(c&&c(e);j!==g&&d;)if(e.index+=h,e.nextCh=e.lineText.charAt(e.index),e.nextCh||(j+=h,e.lineText=a.getLine(j)||"",0<h?e.index=0:(c=e.lineText.length,e.index=0<c?c-1:0),e.nextCh=e.lineText.charAt(e.index)),i(e))f.line=j,f.ch=e.index,d--;d=e.nextCh||e.curMoveThrough?{line:j,ch:e.index}:f}else d=f;return d||a.getCursor()},moveToColumn:function(a,b,d){b=b.repeat;d.lastHPos=b-1;d.lastHSPos=a.charCoords(a.getCursor(),"div").left;d=a.getCursor().line;return t(a,{line:d,ch:b-1})},moveToEol:function(a,b,
d){var e=a.getCursor();d.lastHPos=Infinity;b={line:e.line+b.repeat-1,ch:Infinity};e=a.clipPos(b);e.ch--;d.lastHSPos=a.charCoords(e,"div").left;return b},moveToFirstNonWhiteSpaceCharacter:function(a){var b=a.getCursor();return{line:b.line,ch:F(a.getLine(b.line))}},moveToMatchedSymbol:function(a){var b=a.getCursor(),d=b.line,e=b.ch,c=a.getLine(d),f;f=a.getTokenAt(b).type;var h=Q(f);do if((f=c.charAt(e++))&&-1!="()[]{}".indexOf(f)){var g=a.getTokenAt({line:d,ch:e}).type,g=Q(g);if(h>=g)break}while(f);
return f?$(a,{line:d,ch:e-1},f):b},moveToStartOfLine:function(a){return{line:a.getCursor().line,ch:0}},moveToLineOrEdgeOfDocument:function(a,b){var d=b.forward?a.lastLine():a.firstLine();b.repeatIsExplicit&&(d=b.repeat-a.getOption("firstLineNumber"));return{line:d,ch:F(a.getLine(d))}},textObjectManipulation:function(a,b){var d=b.selectedCharacter;if(!wa[d])return null;d=wa[d](a,!b.textObjectInner);return[d.start,d.end]},repeatLastCharacterSearch:function(a,b){var d=p.lastChararacterSearch,e=b.repeat,
c=b.forward===d.forward,f=(d.increment?1:0)*(c?-1:1);a.moveH(-f,"char");b.inclusive=c?!0:!1;d=v(a,e,c,d.selectedCharacter);if(!d)return a.moveH(f,"char"),a.getCursor();d.ch+=f;return d}},Ma={change:function(a,b,d,e,c){p.registerController.pushText(b.registerName,"change",a.getRange(e,c),b.linewise);b.linewise?(b=c.line>a.lastLine()?"":"\n",a.replaceRange(b,e,c),a.indentLine(e.line,"smart"),e.ch=null):(b=a.getRange(e,c),/^\s*$/.test(b)||(b=/\s+$/.exec(b))&&(c=k(c,0,-b[0].length)),a.replaceRange("",
e,c));ba.enterInsertMode(a,{},a.state.vim);a.setCursor(e)},"delete":function(a,b,d,e,c){b.linewise&&(c.line>a.lastLine()&&e.line>a.firstLine())&&(e.line--,e.ch=x(a,e.line));p.registerController.pushText(b.registerName,"delete",a.getRange(e,c),b.linewise);a.replaceRange("",e,c);b.linewise?a.setCursor(X.moveToFirstNonWhiteSpaceCharacter(a)):a.setCursor(e)},indent:function(a,b,d,e,c){var f=e.line,c=c.line,d=d.visualMode?b.repeat:1;for(b.linewise&&c--;f<=c;f++)for(var h=0;h<d;h++)a.indentLine(f,b.indentRight);
a.setCursor(e);a.setCursor(X.moveToFirstNonWhiteSpaceCharacter(a))},swapcase:function(a,b,d,e,c,f){for(var d=a.getRange(e,c),h="",g=0;g<d.length;g++)var i=d.charAt(g),h=h+(B(i)?i.toLowerCase():i.toUpperCase());a.replaceRange(h,e,c);b.shouldMoveCursor||a.setCursor(f)},yank:function(a,b,d,e,c,f){p.registerController.pushText(b.registerName,"yank",a.getRange(e,c),b.linewise);a.setCursor(f)}},ba={jumpListWalk:function(a,b,d){d.visualMode||(d=b.repeat,b=(b=(b=p.jumpList.move(a,b.forward?d:-d))?b.find():
void 0)?b:a.getCursor(),a.setCursor(b))},scroll:function(a,b,d){if(!d.visualMode){var e=b.repeat||1,d=a.defaultTextHeight(),c=a.getScrollInfo().top,e=d*e,c=b.forward?c+e:c-e,e=a.getCursor(),f=a.charCoords(e,"local");b.forward?c>f.top?(e.line+=(c-f.top)/d,e.line=Math.ceil(e.line),a.setCursor(e),f=a.charCoords(e,"local"),a.scrollTo(null,f.top)):a.scrollTo(null,c):(b=c+a.getScrollInfo().clientHeight,b<f.bottom?(e.line-=(f.bottom-b)/d,e.line=Math.floor(e.line),a.setCursor(e),f=a.charCoords(e,"local"),
a.scrollTo(null,f.bottom-a.getScrollInfo().clientHeight)):a.scrollTo(null,c))}},scrollToCursor:function(a,b){var d=a.getCursor().line,c=a.charCoords({line:d,ch:0},"local"),d=a.getScrollInfo().clientHeight,f=c.top,c=c.bottom-f;switch(b.position){case "center":f=f-d/2+c;break;case "bottom":f=f-d+1.4*c;break;case "top":f+=0.4*c}a.scrollTo(null,f)},replayMacro:function(a,b){var d=b.selectedCharacter,c=b.repeat,f=p.macroModeState;"@"==d&&(d=f.latestRegister);var g,h,i=p.registerController.getRegister(d).toString(),
d=f.macroKeyBuffer;f.isMacroPlaying||(f.macroKeyBuffer.length=0);do{g=/<\w+-.+?>|<\w+>|./.exec(i);if(null===g)break;h=g[0];i=i.substring(g.index+h.length);d.push(h)}while(i);for(;c--;){g=a;h=f;i=d;h.isMacroPlaying=!0;for(var j=0,k=i.length;j<k;j++)CodeMirror.Vim.handleKey(g,i[j]);h.isMacroPlaying=!1}},exitMacroRecordMode:function(){var a=p.macroModeState;a.toggle();var b=a.latestRegister,a=a.macroKeyBuffer.join("");p.registerController.setRegisterText(b,a)},enterMacroRecordMode:function(a,b){var d=
p.macroModeState;d.toggle(a,b.selectedCharacter);d.isMacroPlaying||(d.macroKeyBuffer.length=0)},enterInsertMode:function(a,b,d){if(!a.getOption("readOnly")&&(d.insertMode=!0,d.insertModeRepeat=b&&b.repeat||1,d=b?b.insertAt:null,"eol"==d?(d=a.getCursor(),d={line:d.line,ch:x(a,d.line)},a.setCursor(d)):"charAfter"==d?a.setCursor(k(a.getCursor(),0,1)):"firstNonBlank"==d&&a.setCursor(X.moveToFirstNonWhiteSpaceCharacter(a)),a.setOption("keyMap","vim-insert"),a.setOption("disableInput",!1),b&&b.replace?
(a.toggleOverwrite(!0),a.setOption("keyMap","vim-replace"),CodeMirror.signal(a,"vim-mode-change",{mode:"replace"})):(a.setOption("keyMap","vim-insert"),CodeMirror.signal(a,"vim-mode-change",{mode:"insert"})),!p.macroModeState.inReplay))a.on("change",oa),a.on("cursorActivity",pa),CodeMirror.on(a.getInputField(),"keydown",qa)},toggleVisualMode:function(a,b,d){var c=b.repeat,f=a.getCursor();d.visualMode?(f=a.getCursor("anchor"),c=a.getCursor("head"),!d.visualLine&&b.linewise?(d.visualLine=!0,f.ch=s(f,
c)?0:x(a,f.line),c.ch=s(f,c)?x(a,c.line):0,a.setSelection(f,c),CodeMirror.signal(a,"vim-mode-change",{mode:"visual",subMode:"linewise"})):d.visualLine&&!b.linewise?(d.visualLine=!1,CodeMirror.signal(a,"vim-mode-change",{mode:"visual"})):L(a)):(a.on("mousedown",L),d.visualMode=!0,d.visualLine=!!b.linewise,d.visualLine?(f.ch=0,c=t(a,{line:f.line+c-1,ch:x(a,f.line)},!0)):c=t(a,{line:f.line,ch:f.ch+c},!0),!b.repeatIsExplicit&&!d.visualLine?(a.setCursor(c),a.setSelection(c,f)):a.setSelection(f,c),CodeMirror.signal(a,
"vim-mode-change",{mode:"visual",subMode:d.visualLine?"linewise":""}));G(a,d,"<",s(f,c)?f:c);G(a,d,">",s(f,c)?c:f)},joinLines:function(a,b,d){var c,f;d.visualMode?(c=a.getCursor("anchor"),f=a.getCursor("head"),f.ch=x(a,f.line)-1):(b=Math.max(b.repeat,2),c=a.getCursor(),f=t(a,{line:c.line+b-1,ch:Infinity}));var g=0;a.operation(function(){for(var b=c.line;b<f.line;b++){g=x(a,c.line);var d={line:c.line+1,ch:x(a,c.line+1)},i=a.getRange(c,d),i=i.replace(/\n\s*/g," ");a.replaceRange(i,c,d)}a.setCursor({line:c.line,
ch:g})})},newLineAndEnterInsertMode:function(a,b,d){d.insertMode=!0;var c=a.getCursor();c.line===a.firstLine()&&!b.after?(a.replaceRange("\n",{line:a.firstLine(),ch:0}),a.setCursor(a.firstLine(),0)):(c.line=b.after?c.line:c.line-1,c.ch=x(a,c.line),a.setCursor(c),(CodeMirror.commands.newlineAndIndentContinueComment||CodeMirror.commands.newlineAndIndent)(a));this.enterInsertMode(a,{repeat:b.repeat},d)},paste:function(a,b){var d=a.getCursor(),c=p.registerController.getRegister(b.registerName);if(c.text){for(var f=
"",g=0;g<b.repeat;g++)f+=c.text;(c=c.linewise)?b.after?(f="\n"+f.slice(0,f.length-1),d.ch=x(a,d.line)):d.ch=0:d.ch+=b.after?1:0;a.replaceRange(f,d);c&&b.after?f={line:d.line+1,ch:F(a.getLine(d.line+1))}:c&&!b.after?f={line:d.line,ch:F(a.getLine(d.line))}:!c&&b.after?(d=a.indexFromPos(d),f=a.posFromIndex(d+f.length-1)):(d=a.indexFromPos(d),f=a.posFromIndex(d+f.length));a.setCursor(f)}},undo:function(a,b){a.operation(function(){Y(a,CodeMirror.commands.undo,b.repeat)();a.setCursor(a.getCursor("anchor"))})},
redo:function(a,b){Y(a,CodeMirror.commands.redo,b.repeat)()},setRegister:function(a,b,d){d.inputState.registerName=b.selectedCharacter},setMark:function(a,b,d){G(a,d,b.selectedCharacter,a.getCursor())},replace:function(a,b,d){var c=b.selectedCharacter,f=a.getCursor(),g;d.visualMode?(f=a.getCursor("start"),g=a.getCursor("end"),g=a.clipPos({line:g.line,ch:g.ch+1})):(g=a.getLine(f.line),b=f.ch+b.repeat,b>g.length&&(b=g.length),g={line:f.line,ch:b});"\n"==c?(d.visualMode||a.replaceRange("",f,g),(CodeMirror.commands.newlineAndIndentContinueComment||
CodeMirror.commands.newlineAndIndent)(a)):(b=a.getRange(f,g),b=b.replace(/[^\n]/g,c),a.replaceRange(b,f,g),d.visualMode?(a.setCursor(f),L(a)):a.setCursor(k(g,0,-1)))},incrementNumberToken:function(a,b){for(var d=a.getCursor(),c=a.getLine(d.line),f=/-?\d+/g,g,h,i,j;null!==(g=f.exec(c))&&!(j=g[0],h=g.index,i=h+j.length,d.ch<i););if((b.backtrack||!(i<=d.ch))&&j)c=b.increase?1:-1,c=parseInt(j)+c*b.repeat,j={ch:h,line:d.line},i={ch:i,line:d.line},c=c.toString(),a.replaceRange(c,j,i),a.setCursor({line:d.line,
ch:h+c.length-1})},repeatLastEdit:function(a,b,d){if(d.lastEditInputState){var c=b.repeat;c&&b.repeatIsExplicit?d.lastEditInputState.repeatOverride=c:c=d.lastEditInputState.repeatOverride||c;ra(a,d,c,!1)}}},wa={w:function(a,b){return S(a,b,!0,!1)},W:function(a,b){return S(a,b,!0,!0)},"{":function(a,b){return R(a,"}",b)},"(":function(a,b){return R(a,")",b)},"[":function(a,b){return R(a,"]",b)},"'":function(a,b){return U(a,"'",b)},'"':function(a,b){return U(a,'"',b)}},Na={"(":"bracket",")":"bracket",
"{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},va={bracket:{isComplete:function(a){if(a.nextCh===a.symb){if(a.depth++,1<=a.depth)return!0}else a.nextCh===a.reverseSymb&&a.depth--;return!1}},section:{init:function(a){a.curMoveThrough=!0;a.symb=(a.forward?"]":"[")===a.symb?"{":"}"},isComplete:function(a){return 0===a.index&&a.nextCh===a.symb}},comment:{isComplete:function(a){var b="*"===a.lastCh&&"/"===a.nextCh;a.lastCh=a.nextCh;
return b}},method:{init:function(a){a.symb="m"===a.symb?"{":"}";a.reverseSymb="{"===a.symb?"}":"{"},isComplete:function(a){return a.nextCh===a.symb?!0:!1}},preprocess:{init:function(a){a.index=0},isComplete:function(a){if("#"===a.nextCh){var b=a.lineText.match(/#(\w+)/)[1];if("endif"===b){if(a.forward&&0===a.depth)return!0;a.depth++}else if("if"===b){if(!a.forward&&0===a.depth)return!0;a.depth--}if("else"===b&&0===a.depth)return!0}return!1}}};c.prototype={getQuery:function(){return p.query},setQuery:function(a){p.query=
a},getOverlay:function(){return this.searchOverlay},setOverlay:function(a){this.searchOverlay=a},isReversed:function(){return p.isReversed},setReversed:function(a){p.isReversed=a}};var La="(Javascript regexp)",xa=[{name:"map"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s"},{name:"nohlsearch",shortName:"noh"},{name:"delmarks",shortName:"delm"}];
y.ExCommandDispatcher=function(){this.buildCommandMap_()};y.ExCommandDispatcher.prototype={processCommand:function(a,b){a.state.vim.visualMode&&L(a);var d=new CodeMirror.StringStream(b),c={};c.input=b;try{this.parseInput_(a,d,c)}catch(f){i(a,f);return}var g;if(c.commandName){var h=this.matchCommand_(c.commandName);if(h){g=h.name;this.parseCommandArgs_(d,c,h);if("exToKey"==h.type){for(d=0;d<h.toKeys.length;d++)CodeMirror.Vim.handleKey(a,h.toKeys[d]);return}if("exToEx"==h.type){this.processCommand(a,
h.toInput);return}}}else void 0!==c.line&&(g="move");if(g)try{ua[g](a,c)}catch(j){throw i(a,j),j;}else i(a,'Not an editor command ":'+b+'"')},parseInput_:function(a,b,d){b.eatWhile(":");b.eat("%")?(d.line=a.firstLine(),d.lineEnd=a.lastLine()):(d.line=this.parseLineSpec_(a,b),void 0!==d.line&&b.eat(",")&&(d.lineEnd=this.parseLineSpec_(a,b)));a=b.match(/^(\w+)/);d.commandName=a?a[1]:b.match(/.*/)[0];return d},parseLineSpec_:function(a,b){var d=b.match(/^(\d+)/);if(d)return parseInt(d[1],10)-1;switch(b.next()){case ".":return a.getCursor().line;
case "$":return a.lastLine();case "'":if((d=a.state.vim.marks[b.next()])&&d.find())return d.find().line;throw Error("Mark not set");default:b.backUp(1)}},parseCommandArgs_:function(a,b,d){a.eol()||(b.argString=a.match(/.*/)[0],a=d.argDelimiter||/\s+/,a=T(b.argString).split(a),a.length&&a[0]&&(b.args=a))},matchCommand_:function(a){for(var b=a.length;0<b;b--){var d=a.substring(0,b);if(this.commandMap_[d]&&(d=this.commandMap_[d],0===d.name.indexOf(a)))return d}return null},buildCommandMap_:function(){this.commandMap_=
{};for(var a=0;a<xa.length;a++){var b=xa[a];this.commandMap_[b.shortName||b.name]=b}},map:function(a,b,d){if(":"!=a&&":"==a.charAt(0)){if(d)throw Error("Mode not supported for ex mappings");d=a.substring(1);this.commandMap_[d]=":"!=b&&":"==b.charAt(0)?{name:d,type:"exToEx",toInput:b.substring(1)}:{name:d,type:"exToKey",toKeys:ca(b)}}else b=":"!=b&&":"==b.charAt(0)?{keys:ca(a),type:"keyToEx",exArgs:{input:b.substring(1)}}:{keys:ca(a),type:"keyToKey",toKeys:ca(b)},d&&(b.context=d),M.unshift(b)}};var ua=
{map:function(a,b,d){var c=b.args;!c||2>c.length?a&&i(a,"Invalid mapping: "+b.input):W.map(c[0],c[1],d)},nmap:function(a,b){this.map(a,b,"normal")},vmap:function(a,b){this.map(a,b,"visual")},move:function(a,b){V.processCommand(a,a.state.vim,{type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:b.line+1})},sort:function(a,b){function c(a,b){if(e){var d;d=a;a=b;b=d}f&&(a=a.toLowerCase(),b=b.toLowerCase());d=h&&p.exec(a);var g=h&&p.exec(b);
if(!d)return a<b?-1:1;d=parseInt((d[1]+d[2]).toLowerCase(),s);g=parseInt((g[1]+g[2]).toLowerCase(),s);return d-g}var e,f,g,h,j=function(){if(b.argString){var a=new CodeMirror.StringStream(b.argString);a.eat("!")&&(e=!0);if(!a.eol()){if(!a.eatSpace())return"Invalid arguments";var c=a.match(/[a-z]+/);if(c){c=c[0];f=-1!=c.indexOf("i");g=-1!=c.indexOf("u");var d=-1!=c.indexOf("d")&&1,i=-1!=c.indexOf("x")&&1,c=-1!=c.indexOf("o")&&1;if(1<d+i+c)return"Invalid arguments";h=d&&"decimal"||i&&"hex"||c&&"octal"}a.eatSpace()&&
a.match(/\/.*\//)&&"patterns not supported"}}}();if(j)i(a,j+": "+b.argString);else{var j=b.line||a.firstLine(),k=b.lineEnd||b.line||a.lastLine();if(j!=k){var j={line:j,ch:0},k={line:k,ch:x(a,k)},m=a.getRange(j,k).split("\n"),p="decimal"==h?/(-?)([\d]+)/:"hex"==h?/(-?)(?:0x)?([0-9a-f]+)/i:"octal"==h?/([0-7]+)/:null,s="decimal"==h?10:"hex"==h?16:"octal"==h?8:null,l=[],r=[];if(h)for(var q=0;q<m.length;q++)p.exec(m[q])?l.push(m[q]):r.push(m[q]);else r=m;l.sort(c);r.sort(c);m=!e?r.concat(l):l.concat(r);
if(g)for(var l=m,t,m=[],q=0;q<l.length;q++)l[q]!=t&&m.push(l[q]),t=l[q];a.replaceRange(m.join("\n"),j,k)}}},substitute:function(a,b){if(!a.getSearchCursor)throw Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");var c=b.argString,e=g(c);if(0!==e[0])i(a,"Substitutions should be of the form :s/pattern/replace/");else{var j=c.substring(e[0]+1,e[1]),k="",h,m,o=!1;if(e[1]){for(var k=c.substring(e[1]+1,e[2]),p=!1,q=[],r=0;r<k.length;r++){var l=k.charAt(r),
s=k.charAt(r+1),s="\\"==s||"/"==s;"\\"!==l||p||!s?(q.push(l),p=!1):p=!0}k=q.join("")}e[2]&&(m=c.substring(e[2]+1).split(" "),h=m[0],m=parseInt(m[1]));h&&(-1!=h.indexOf("c")&&(o=!0,h.replace("c","")),j=j+"/"+h);if(j)try{aa(a,j,!0,!0)}catch(u){i(a,"Invalid regex: "+j);return}j=f(a).getQuery();h=void 0!==b.line?b.line:a.getCursor().line;c=b.lineEnd||h;m&&(h=c,c=h+m-1);m=t(a,{line:h,ch:0});m=a.getSearchCursor(j,m);Ea(a,o,h,c,m,j,k)}},redo:CodeMirror.commands.redo,undo:CodeMirror.commands.undo,write:function(a){CodeMirror.commands.save?
CodeMirror.commands.save(a):a.save()},nohlsearch:function(a){ia(a)},delmarks:function(a,b){if(!b.argString||!T(b.argString))i(a,"Argument required");else for(var c=a.state.vim,e=new CodeMirror.StringStream(T(b.argString));!e.eol();){e.eatSpace();var f=e.pos;if(!e.match(/[a-zA-Z]/,!1)){i(a,"Invalid argument: "+b.argString.substring(f));break}var g=e.next();if(e.match("-",!0)){if(!e.match(/[a-zA-Z]/,!1)){i(a,"Invalid argument: "+b.argString.substring(f));break}var h=e.next();if(/^[a-z]$/.test(g)&&/^[a-z]$/.test(h)||
B(g)&&B(h)){g=g.charCodeAt(0);h=h.charCodeAt(0);if(g>=h){i(a,"Invalid argument: "+b.argString.substring(f));break}for(f=0;f<=h-g;f++){var j=String.fromCharCode(g+f);delete c.marks[j]}}else{i(a,"Invalid argument: "+g+"-");break}}else delete c.marks[g]}}},W=new y.ExCommandDispatcher;CodeMirror.keyMap.vim=function(){function a(a){return function(b){CodeMirror.Vim.handleKey(b,a)}}function b(b,f){for(var g=0;g<b.length;g++){var h=b[g];!f&&1==h.length&&(h="'"+h+"'");var i=f,j=b[g];B(j)&&"Ctrl"==i&&(j=j.toLowerCase());
i&&(j=i.charAt(0)+"-"+j);j=(i={Enter:"CR",Backspace:"BS",Delete:"Del"}[j])?i:j;j=1<j.length?"<"+j+">":j;c[f?f+"-"+h:h]=a(j)}}var c={nofallthrough:!0,style:"fat-cursor"};b(fa);b(la);b(fa,"Ctrl");b(sa);b(sa,"Ctrl");b(ga);b(ga,"Ctrl");b(ta);b(ta,"Ctrl");return c}();CodeMirror.keyMap["vim-insert"]={Esc:ea,"Ctrl-[":ea,"Ctrl-C":ea,"Ctrl-N":"autocomplete","Ctrl-P":"autocomplete",Enter:function(a){(CodeMirror.commands.newlineAndIndentContinueComment||CodeMirror.commands.newlineAndIndent)(a)},fallthrough:["default"]};
CodeMirror.keyMap["vim-replace"]={Backspace:"goCharLeft",fallthrough:["vim-insert"]};I();return Ka};CodeMirror.Vim=y()})();
