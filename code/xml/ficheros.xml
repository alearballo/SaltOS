<?xml version="1.0" encoding="UTF-8" ?>
<!--
 ____        _ _    ___  ____
/ ___|  __ _| | |_ / _ \/ ___|
\___ \ / _` | | __| | | \___ \
 ___) | (_| | | |_| |_| |___) |
|____/ \__,_|_|\__|\___/|____/

SaltOS: Framework to develop Rich Internet Applications
Copyright (C) 2007-2014 by Josep Sanz CampderrÃ³s
More information in http://www.saltos.net or info@saltos.net

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<root>
	<list>
		<title lang="true">list</title>
		<actions include="xml/common/actions.xml" replace="true" />
		<actions path="actions" append="true">
			<download>
				<label lang="true">download</label>
				<onclick>download2('ID')</onclick>
				<icon>download</icon>
			</download>
			<viewpdf>
				<label lang="true">view2</label>
				<onclick>viewpdf2('ID')</onclick>
				<icon>view2</icon>
			</viewpdf>
		</actions>
		<nodata path="nodata/label" replace="true">
			<label eval="true">LANG(getParam("filtro")?"nodata":"nosearch")</label>
		</nodata>
		<width>100%</width>
		<fields>
			<field>
				<name>id2</name>
				<label lang="true">id</label>
				<sort>true</sort>
				<order>id</order>
			</field>
			<field>
				<name>aplicacion</name>
				<label lang="true">aplicacion</label>
				<sort>true</sort>
			</field>
			<field>
				<name>nombre</name>
				<label lang="true">nombre</label>
				<sort>true</sort>
				<size>40</size>
			</field>
			<field>
				<name>usuario</name>
				<label lang="true">username</label>
				<sort>true</sort>
			</field>
			<field>
				<name>datetime</name>
				<label lang="true">datetime</label>
				<sort>true</sort>
			</field>
			<field>
				<name>fichero</name>
				<label lang="true">fichero</label>
				<sort>true</sort>
				<size>40</size>
			</field>
			<field>
				<name>fichero_size2</name>
				<label lang="true">size</label>
				<sort>true</sort>
				<order>fichero_size</order>
			</field>
		</fields>
		<javascript>
			<javascript include="xml/common/jslist.xml" replace="true"/>
			<function>download2(cid) { cid=explode("_",cid); download("cid="+cid[0]+"&amp;page="+cid[1]+"&amp;id="+cid[2]); }</function>
			<function>viewpdf2(cid) { cid=explode("_",cid); viewpdf("cid="+cid[0]+"&amp;page="+cid[1]+"&amp;id="+cid[2]); }</function>
		</javascript>
		<quick>
			<row>
				<field>
					<type>separator</type>
					<width>100%</width>
				</field>
				<field ifeval="!ismobile() &amp;&amp; check_filter(array('filtro'=>'','id_aplicacion'=>'','id_usuario'=>''))">
					<type>label</type>
					<label lang="true">usedfilter</label>
					<class>nowrap</class>
					<class2>info</class2>
				</field>
				<field>
					<name>buscar</name>
					<label lang="true">buscar</label>
					<type>text</type>
					<width>240px</width>
					<value global="filtro" eval="true">stripslashes($filtro=getParam("filtro"))</value>
					<onchange>copy_value("filtro","buscar");</onchange>
					<onkey>if(is_enterkey(event)) { copy_value("filtro","buscar");buscar(); }</onkey>
					<focus>true</focus>
					<speech>true</speech>
					<class3>shortcut_ctrl_f</class3>
				</field>
				<field>
					<type>button</type>
					<value lang="true">buscar</value>
					<tip lang="true">buscartip</tip>
					<onclick>buscar()</onclick>
					<icon>find</icon>
					<class>nowrap</class>
				</field>
				<field>
					<type>button</type>
					<value lang="true">limpiar</value>
					<tip lang="true">limpiartip</tip>
					<onclick>limpiar()</onclick>
					<icon>refresh</icon>
					<class>nowrap contextmenu</class>
				</field>
			</row>
		</quick>
		<form>
			<name>list</name>
			<action></action>
			<method>get</method>
			<fields>
				<title lang="true">filter</title>
				<buttons>true</buttons>
				<row>
					<field include="xml/common/hiddenslist.xml" replace="true" />
					<field>
						<name>id_usuario</name>
						<label lang="true">username</label>
						<type>select</type>
						<width>240px</width>
						<query eval="true">make_select_query("usuarios","tbl_usuarios",array(make_extra_query_with_login(),"id_aplicacion,id_registro,login"),"SELECT id FROM tbl_usuarios WHERE activo=1 AND id IN (SELECT DISTINCT id_usuario FROM tbl_ficheros)")." UNION SELECT '' `value`,'".LANG_ESCAPE("todoslosusuarios")."' label,'-1' pos ORDER BY `pos` ASC,`label` ASC,`value` ASC"</query>
						<value global="id_usuario" eval="true">$id_usuario=getParam("id_usuario")</value>
						<colspan>3</colspan>
					</field>
					<field>
						<type>separator</type>
						<width>10px</width>
					</field>
					<field>
						<name>id_aplicacion</name>
						<label lang="true">aplicacion</label>
						<type>select</type>
						<width>240px</width>
						<query eval="true">make_select_query("","tbl_aplicaciones","nombre","SELECT DISTINCT id_aplicacion FROM tbl_ficheros")." UNION SELECT '' `value`,'".LANG_ESCAPE("todaslasaplicaciones")."' label,-1 pos ORDER BY `pos` ASC,`label` ASC,`value` ASC"</query>
						<value global="id_aplicacion" eval="true">$id_aplicacion=getParam("id_aplicacion")</value>
					</field>
				</row>
				<row>
					<field>
						<name>filtro</name>
						<label lang="true">filtro</label>
						<type>text</type>
						<width>240px</width>
						<value global="filtro" eval="true">stripslashes($filtro=getParam("filtro"))</value>
						<onchange>copy_value("buscar","filtro");</onchange>
						<colspan>3</colspan>
						<speech>true</speech>
					</field>
				</row>
			</fields>
			<fields include="xml/common/filters.xml" replace="true" />
			<fields include="xml/common/helplist.xml" replace="true" />
			<buttons include="xml/common/buttonslist.xml" />
		</form>
		<pager include="xml/common/pagerlist.xml"/>
		<query global="page,id_usuario,id_aplicacion,filtro" eval="true">"SELECT id, id_aplicacion, id_registro, id_usuario, datetime, fichero, fichero_file, fichero_size, fichero_type, id2, id_grupo, action_id, aplicacion, usuario, email_privated, nombre, action_title, fichero_size2, action_download, action_viewpdf FROM (
			SELECT a.*,LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0) id2,
			d.id_grupo id_grupo,
			 CONCAT(a.id,'_',(SELECT codigo FROM tbl_aplicaciones WHERE id=a.id_aplicacion),'_',a.id_registro) action_id,
			(SELECT  CONCAT('link:opencontent(\"?page=',codigo,'\"):',nombre)  FROM tbl_aplicaciones WHERE id=a.id_aplicacion) aplicacion,
			".make_extra_query_with_login("d.")." usuario,
			CASE e.id_aplicacion
				WHEN '".page2id("correo")."' THEN (SELECT email_privated FROM tbl_usuarios_c WHERE id=(SELECT id_cuenta FROM tbl_correo WHERE e.id_registro=id))
				ELSE 0
			END email_privated,
			CASE a.id_aplicacion
				WHEN '".page2id("actas")."' THEN (SELECT  CONCAT('link:actas(',-id,'):',nombre)  FROM tbl_actas WHERE id=a.id_registro)
				WHEN '".page2id("agenda")."' THEN (SELECT  CONCAT('link:agenda(',-id,'):',nombre)  FROM tbl_agenda WHERE id=a.id_registro)
				WHEN '".page2id("campanyas")."' THEN (SELECT  CONCAT('link:campanyas(',-id,'):',nombre)  FROM tbl_campanyas WHERE id=a.id_registro)
				WHEN '".page2id("clientes")."' THEN (SELECT  CONCAT('link:clientes(',-id,'):',nombre)  FROM tbl_clientes WHERE id=a.id_registro)
				WHEN '".page2id("contactos")."' THEN (SELECT  CONCAT('link:contactos(',-id,'):',nombre)  FROM tbl_contactos WHERE id=a.id_registro)
				WHEN '".page2id("correo")."' THEN (SELECT  CONCAT('link:correo(',-id,'):',`from`,' - ',CASE WHEN subject='' THEN '".LANG_ESCAPE("sinsubject","correo")."' ELSE subject END,' (',
				TRIM( CONCAT(
				CASE state_sent WHEN 1 THEN '".LANG_ESCAPE("statesent","correo")." ' ELSE '' END,
				CASE state_error WHEN '' THEN '' ELSE '".LANG_ESCAPE("stateerror","correo")." ' END,
				CASE WHEN is_outbox=1 AND state_sent=0 AND state_error='' THEN ' (".LANG_ESCAPE("statenotsent","correo").") ' ELSE '' END,
				CASE state_new WHEN 1 THEN '".LANG_ESCAPE("statenew","correo")." ' ELSE '' END,
				CASE state_reply WHEN 1 THEN '".LANG_ESCAPE("statereply","correo")." ' ELSE '' END,
				CASE state_forward WHEN 1 THEN '".LANG_ESCAPE("stateforward","correo")." ' ELSE '' END,
				CASE state_wait WHEN 1 THEN '".LANG_ESCAPE("statewait","correo")." ' ELSE '' END,
				CASE state_spam WHEN 1 THEN '".LANG_ESCAPE("statespam","correo")." ' ELSE '' END,
				CASE priority WHEN -1 THEN '".LANG_ESCAPE("prioritylow","correo")." ' WHEN 1 THEN '".LANG_ESCAPE("priorityhigh","correo")." ' ELSE '' END,
				CASE sensitivity WHEN 1 THEN '".LANG_ESCAPE("sensitivitypersonal","correo")." ' WHEN 2 THEN '".LANG_ESCAPE("sensitivityprivate","correo")." ' WHEN 3 THEN '".LANG_ESCAPE("sensitivityconfidential","correo")." ' ELSE '' END,
				CASE is_outbox+state_new+state_reply+state_forward+state_wait+state_spam+priority*10+sensitivity WHEN 0 THEN '".LANG_ESCAPE("stateread","correo")." ' ELSE '' END)
				)
				 ,')')  FROM tbl_correo WHERE id=a.id_registro)
				WHEN '".page2id("cuentas")."' THEN (SELECT  CONCAT('link:cuentas(',-id,'):',nombre)  FROM tbl_cuentas WHERE id=a.id_registro)
				WHEN '".page2id("documentos")."' THEN (SELECT  CONCAT('link:documentos(',-id,'):',nombre)  FROM tbl_documentos WHERE id=a.id_registro)
				WHEN '".page2id("empleados")."' THEN (SELECT  CONCAT('link:empleados(',-id,'):',nombre)  FROM tbl_empleados WHERE id=a.id_registro)
				WHEN '".page2id("epigrafes")."' THEN (SELECT  CONCAT('link:epigrafes(',-id,'):',nombre)  FROM tbl_epigrafes WHERE id=a.id_registro)
				WHEN '".page2id("estados")."' THEN (SELECT  CONCAT('link:estados(',-id,'):',nombre)  FROM tbl_estados WHERE id=a.id_registro)
				WHEN '".page2id("facturas")."' THEN (SELECT CASE num WHEN '' THEN  CONCAT('link:facturas(',-id,'):','".LANG_ESCAPE("albaran")."',' ',LPAD(id,".intval(CONFIG("zero_padding_digits")).",0),' ',nombre)  ELSE  CONCAT('link:facturas(',-id,'):','".LANG_ESCAPE("factura")."',' ',num,' ',nombre,CASE cobrado WHEN '1' THEN '".LANG_ESCAPE("cobrado","facturas")."' ELSE '&lt;strike&gt;".LANG_ESCAPE("cobrado","facturas")."&lt;/strike&gt;' END)  END FROM tbl_facturas WHERE id=a.id_registro)
				WHEN '".page2id("feeds")."' THEN (SELECT  CONCAT('link:feeds(',-id,'):',(SELECT title FROM tbl_usuarios_f WHERE id=tbl_feeds.id_feed),' - ',title,' (',
				TRIM( CONCAT(
				CASE WHEN state_new=1 AND state_modified=0 THEN '".LANG_ESCAPE("statenew","feeds")." ' ELSE '' END,
				CASE state_modified WHEN 1 THEN '".LANG_ESCAPE("statemodified","feeds")." ' ELSE '' END,
				CASE state_wait WHEN 1 THEN '".LANG_ESCAPE("statewait","feeds")." ' ELSE '' END,
				CASE state_cool WHEN 1 THEN '".LANG_ESCAPE("statecool","feeds")." ' ELSE '' END,
				CASE state_new+state_modified+state_wait+state_cool WHEN 0 THEN '".LANG_ESCAPE("stateread","feeds")." ' ELSE '' END)
				)
				 ,')')  FROM tbl_feeds WHERE id=a.id_registro)
				WHEN '".page2id("formaspago")."' THEN (SELECT  CONCAT('link:formaspago(',-id,'):',nombre)  FROM tbl_formaspago WHERE id=a.id_registro)
				WHEN '".page2id("gastos")."' THEN (SELECT  CONCAT('link:gastos(',-id,'):',descripcion)  FROM tbl_gastos WHERE id=a.id_registro)
				WHEN '".page2id("grupos")."' THEN (SELECT  CONCAT('link:grupos(',-id,'):',nombre)  FROM tbl_grupos WHERE id=a.id_registro)
				WHEN '".page2id("importaciones")."' THEN (SELECT  CONCAT('link:importaciones(',-id,'):',nombre)  FROM tbl_importaciones WHERE id=a.id_registro)
				WHEN '".page2id("incidencias")."' THEN (SELECT  CONCAT('link:incidencias(',-id,'):',nombre)  FROM tbl_incidencias WHERE id=a.id_registro)
				WHEN '".page2id("partes")."' THEN (SELECT  CONCAT('link:partes(',-id,'):',tarea)  FROM tbl_partes WHERE id=a.id_registro)
				WHEN '".page2id("periodicas")."' THEN (SELECT (SELECT  CONCAT('link:periodicas(',-id,'):',nombre)  FROM tbl_clientes WHERE id=id_cliente) FROM tbl_periodicas WHERE id=a.id_registro)
				WHEN '".page2id("posiblescli")."' THEN (SELECT  CONCAT('link:posiblescli(',-id,'):',nombre)  FROM tbl_posiblescli WHERE id=a.id_registro)
				WHEN '".page2id("presupuestos")."' THEN (SELECT  CONCAT('link:presupuestos(',-id,'):',nombre)  FROM tbl_presupuestos WHERE id=a.id_registro)
				WHEN '".page2id("prioridades")."' THEN (SELECT  CONCAT('link:prioridades(',-id,'):',nombre)  FROM tbl_prioridades WHERE id=a.id_registro)
				WHEN '".page2id("productos")."' THEN (SELECT  CONCAT('link:productos(',-id,'):',nombre)  FROM tbl_productos WHERE id=a.id_registro)
				WHEN '".page2id("proveedores")."' THEN (SELECT  CONCAT('link:proveedores(',-id,'):',nombre)  FROM tbl_proveedores WHERE id=a.id_registro)
				WHEN '".page2id("proyectos")."' THEN (SELECT  CONCAT('link:proyectos(',-id,'):',nombre)  FROM tbl_proyectos WHERE id=a.id_registro)
				WHEN '".page2id("seguimientos")."' THEN (SELECT  CONCAT('link:seguimientos(',-id,'):',comentarios)  FROM tbl_seguimientos WHERE id=a.id_registro)
				WHEN '".page2id("textos")."' THEN (SELECT  CONCAT('link:textos(',-id,'):',nombre)  FROM tbl_textos WHERE id=a.id_registro)
				WHEN '".page2id("tiposevento")."' THEN (SELECT  CONCAT('link:tiposevento(',-id,'):',nombre)  FROM tbl_tiposevento WHERE id=a.id_registro)
				WHEN '".page2id("usuarios")."' THEN (SELECT  CONCAT('link:usuarios(',-id,'):',login)  FROM tbl_usuarios WHERE id=a.id_registro)
				WHEN '".page2id("favoritos")."' THEN (SELECT  CONCAT('link:openwin(\"',REPLACE(url,':','%3A'),'\"):',nombre)  FROM tbl_favoritos WHERE id=a.id_registro)
			END nombre,
			CASE a.id_aplicacion
				WHEN '".page2id("actas")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_actas WHERE id=a.id_registro)
				WHEN '".page2id("agenda")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_agenda WHERE id=a.id_registro)
				WHEN '".page2id("campanyas")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_campanyas WHERE id=a.id_registro)
				WHEN '".page2id("clientes")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_clientes WHERE id=a.id_registro)
				WHEN '".page2id("contactos")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_contactos WHERE id=a.id_registro)
				WHEN '".page2id("correo")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',`from`,' - ',(CASE WHEN subject='' THEN '".LANG_ESCAPE("sinsubject","correo")."' ELSE subject END),
				CASE state_sent WHEN 1 THEN ' (".LANG_ESCAPE("statesent","correo").")' ELSE '' END,
				CASE state_error WHEN '' THEN '' ELSE ' (".LANG_ESCAPE("stateerror","correo").")' END,
				CASE is_outbox WHEN 1 THEN CASE WHEN state_sent=0 AND state_error='' THEN ' (".LANG_ESCAPE("statenotsent","correo").")' ELSE '' END ELSE '' END,
				CASE state_new WHEN 1 THEN ' (".LANG_ESCAPE("statenew","correo").")' ELSE '' END,
				CASE state_reply WHEN 1 THEN ' (".LANG_ESCAPE("statereply","correo").")' ELSE '' END,
				CASE state_forward WHEN 1 THEN ' (".LANG_ESCAPE("stateforward","correo").")' ELSE '' END,
				CASE state_wait WHEN 1 THEN ' (".LANG_ESCAPE("statewait","correo").")' ELSE '' END,
				CASE state_spam WHEN 1 THEN ' (".LANG_ESCAPE("statespam","correo").")' ELSE '' END,
				CASE is_outbox WHEN 0 THEN CASE state_new+state_reply+state_forward+state_wait+state_spam WHEN 0 THEN ' (".LANG_ESCAPE("stateread","correo").")' ELSE '' END ELSE '' END)  FROM tbl_correo WHERE id=a.id_registro)
				WHEN '".page2id("cuentas")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_cuentas WHERE id=a.id_registro)
				WHEN '".page2id("documentos")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_documentos WHERE id=a.id_registro)
				WHEN '".page2id("empleados")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_empleados WHERE id=a.id_registro)
				WHEN '".page2id("epigrafes")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_epigrafes WHERE id=a.id_registro)
				WHEN '".page2id("estados")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_estados WHERE id=a.id_registro)
				WHEN '".page2id("facturas")."' THEN (SELECT CASE num WHEN '' THEN  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ','".LANG_ESCAPE("albaran")."',' ',LPAD(id,".intval(CONFIG("zero_padding_digits")).",0),' ',nombre)  ELSE  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ','".LANG_ESCAPE("factura")."',' ',num,' ',nombre,CASE cobrado WHEN '1' THEN '".LANG_ESCAPE("cobrado","facturas")."' ELSE '&lt;strike&gt;".LANG_ESCAPE("cobrado","facturas")."&lt;/strike&gt;' END)  END FROM tbl_facturas WHERE id=a.id_registro)
				WHEN '".page2id("feeds")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',(SELECT title FROM tbl_usuarios_f WHERE id=tbl_feeds.id_feed),' - ',title,
				CASE WHEN state_new=1 AND state_modified=0 THEN ' (".LANG_ESCAPE("statenew","feeds").")' ELSE '' END,
				CASE state_modified WHEN 1 THEN ' (".LANG_ESCAPE("statemodified","feeds").")' ELSE '' END,
				CASE state_wait WHEN 1 THEN ' (".LANG_ESCAPE("statewait","feeds").")' ELSE '' END,
				CASE state_cool WHEN 1 THEN ' (".LANG_ESCAPE("statecool","feeds").")' ELSE '' END,
				CASE state_new+state_modified+state_wait+state_cool WHEN 0 THEN ' (".LANG_ESCAPE("stateread","feeds").")' ELSE '' END)  FROM tbl_feeds WHERE id=a.id_registro)
				WHEN '".page2id("formaspago")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_formaspago WHERE id=a.id_registro)
				WHEN '".page2id("gastos")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',descripcion)  FROM tbl_gastos WHERE id=a.id_registro)
				WHEN '".page2id("grupos")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_grupos WHERE id=a.id_registro)
				WHEN '".page2id("importaciones")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_importaciones WHERE id=a.id_registro)
				WHEN '".page2id("incidencias")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_incidencias WHERE id=a.id_registro)
				WHEN '".page2id("partes")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',tarea)  FROM tbl_partes WHERE id=a.id_registro)
				WHEN '".page2id("periodicas")."' THEN (SELECT (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_clientes WHERE id=id_cliente) FROM tbl_periodicas WHERE id=a.id_registro)
				WHEN '".page2id("posiblescli")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_posiblescli WHERE id=a.id_registro)
				WHEN '".page2id("presupuestos")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_presupuestos WHERE id=a.id_registro)
				WHEN '".page2id("prioridades")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_prioridades WHERE id=a.id_registro)
				WHEN '".page2id("productos")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_productos WHERE id=a.id_registro)
				WHEN '".page2id("proveedores")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_proveedores WHERE id=a.id_registro)
				WHEN '".page2id("proyectos")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_proyectos WHERE id=a.id_registro)
				WHEN '".page2id("seguimientos")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',comentarios)  FROM tbl_seguimientos WHERE id=a.id_registro)
				WHEN '".page2id("textos")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_textos WHERE id=a.id_registro)
				WHEN '".page2id("tiposevento")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_tiposevento WHERE id=a.id_registro)
				WHEN '".page2id("usuarios")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',login)  FROM tbl_usuarios WHERE id=a.id_registro)
				WHEN '".page2id("favoritos")."' THEN (SELECT  CONCAT(LPAD(a.id_registro,".intval(CONFIG("zero_padding_digits")).",0),' - ',nombre)  FROM tbl_favoritos WHERE id=a.id_registro)
			END action_title,
			CASE WHEN fichero_size&gt;1073741824 THEN  CONCAT(ROUND(fichero_size/1073741824.0,2),' Gbytes')
				WHEN fichero_size&gt;1048576 THEN  CONCAT(ROUND(fichero_size/1048576.0,2),' Mbytes')
				WHEN fichero_size&gt;1024 THEN  CONCAT(ROUND(fichero_size/1024.0,2),' Kbytes')
				ELSE  CONCAT(fichero_size,' bytes')
			END fichero_size2,
			'true' action_download,
			'true' action_viewpdf
			FROM tbl_ficheros a
			LEFT JOIN tbl_registros_i e ON e.id_aplicacion=a.id_aplicacion AND e.id_registro=a.id_registro
			LEFT JOIN tbl_usuarios d ON e.id_usuario=d.id) z
			WHERE (id_aplicacion='$id_aplicacion' OR ''='$id_aplicacion')
			AND ".($filtro?make_like_query("fichero,fichero_file,fichero_type,fichero_size,usuario,aplicacion,id2,nombre,datetime,search",$filtro):"(1=0)")."
			AND ".($id_usuario?"(id_usuario='$id_usuario')":"(1=1)")."
			AND (TRIM(IFNULL(email_privated,0))='0' OR (TRIM(IFNULL(email_privated,0))='1' AND id_usuario='".current_user()."'))
			AND ".check_sql($page,"list")</query>
		<order global="order" eval="true">$order</order>
		<limit global="limit" eval="true">$limit</limit>
		<offset global="offset" eval="true">$offset</offset>
	</list>
</root>
